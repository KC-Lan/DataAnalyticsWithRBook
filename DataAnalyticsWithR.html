<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>資料科學與R語言</title>
  <meta name="description" content="介紹如何使用R語言完成資料讀取、處理、分析與呈現，以及大數據技術與R的整合" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="資料科學與R語言" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://yijutseng.github.io/DataScienceRBook" />
  
  <meta property="og:description" content="介紹如何使用R語言完成資料讀取、處理、分析與呈現，以及大數據技術與R的整合" />
  <meta name="github-repo" content="yijutseng/DataAnalyticsWithRBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="資料科學與R語言" />
  
  <meta name="twitter:description" content="介紹如何使用R語言完成資料讀取、處理、分析與呈現，以及大數據技術與R的整合" />
  

<meta name="author" content="曾意儒 Yi-Ju Tseng" />


<meta name="date" content="2019-10-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script src="libs/detect-resize/jquery.resize.js"></script>
<link href="libs/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui/jquery-ui.min.js"></script>
<script src="libs/d3/d3.min.js"></script>
<script src="libs/vega/vega.min.js"></script>
<script src="libs/lodash/lodash.min.js"></script>
<script>var lodash = _.noConflict();</script>
<link href="libs/ggvis/css/ggvis.css" rel="stylesheet" />
<script src="libs/ggvis/js/ggvis.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">資料科學與R語言</h1>
<p class="author"><em>曾意儒 Yi-Ju Tseng</em></p>
<p class="date"><em>2019-10-15</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#preface"></a></li>
<li><a href="#intro"><span class="toc-section-number">1</span> R語言101</a><ul>
<li><a href="#什麼是r語言"><span class="toc-section-number">1.1</span> 什麼是R語言</a></li>
<li><a href="#函數使用"><span class="toc-section-number">1.2</span> 函數使用</a></li>
<li><a href="#變數設定"><span class="toc-section-number">1.3</span> 變數設定</a></li>
<li><a href="#執行視窗"><span class="toc-section-number">1.4</span> 執行視窗</a></li>
<li><a href="#DataType"><span class="toc-section-number">1.5</span> 資料型態</a><ul>
<li><a href="#數值-numeric"><span class="toc-section-number">1.5.1</span> 數值 numeric</a></li>
<li><a href="#字串-character"><span class="toc-section-number">1.5.2</span> 字串 character</a></li>
<li><a href="#布林變數-logic"><span class="toc-section-number">1.5.3</span> 布林變數 logic</a></li>
<li><a href="#日期-date"><span class="toc-section-number">1.5.4</span> 日期 (Date)</a></li>
</ul></li>
<li><a href="#基本運算子"><span class="toc-section-number">1.6</span> 基本運算子</a><ul>
<li><a href="#數學基本運算"><span class="toc-section-number">1.6.1</span> 數學基本運算</a></li>
<li><a href="#邏輯運算"><span class="toc-section-number">1.6.2</span> 邏輯運算</a></li>
</ul></li>
<li><a href="#錯誤訊息"><span class="toc-section-number">1.7</span> 錯誤訊息</a></li>
<li><a href="#help"><span class="toc-section-number">1.8</span> Help</a></li>
</ul></li>
<li><a href="#RDataStructure"><span class="toc-section-number">2</span> R 資料結構</a><ul>
<li><a href="#向量-vector"><span class="toc-section-number">2.1</span> 向量 vector</a><ul>
<li><a href="#快速產生向量函數"><span class="toc-section-number">2.1.1</span> 快速產生向量函數</a></li>
<li><a href="#向量運算"><span class="toc-section-number">2.1.2</span> 向量運算</a></li>
</ul></li>
<li><a href="#因子-factor"><span class="toc-section-number">2.2</span> 因子 factor</a></li>
<li><a href="#列表-list"><span class="toc-section-number">2.3</span> 列表 list</a><ul>
<li><a href="#列表資料擷取"><span class="toc-section-number">2.3.1</span> 列表資料擷取</a></li>
<li><a href="#列表資料編輯設定"><span class="toc-section-number">2.3.2</span> 列表資料編輯設定</a></li>
</ul></li>
<li><a href="#矩陣-matrix"><span class="toc-section-number">2.4</span> 矩陣 matrix</a></li>
<li><a href="#資料框-data.frame"><span class="toc-section-number">2.5</span> 資料框 data.frame</a></li>
<li><a href="#資料表-data.table"><span class="toc-section-number">2.6</span> 資料表 data.table</a></li>
<li><a href="#資料屬性查詢函數"><span class="toc-section-number">2.7</span> 資料屬性查詢函數</a></li>
</ul></li>
<li><a href="#controlstructure"><span class="toc-section-number">3</span> 控制流程</a><ul>
<li><a href="#條件判斷"><span class="toc-section-number">3.1</span> 條件判斷</a><ul>
<li><a href="#if-else敘述"><span class="toc-section-number">3.1.1</span> if-else敘述</a></li>
<li><a href="#if-else-if-else"><span class="toc-section-number">3.1.2</span> if-else if-else</a></li>
</ul></li>
</ul></li>
<li><a href="#function"><span class="toc-section-number">4</span> 函數</a></li>
<li><a href="#io"><span class="toc-section-number">5</span> 資料讀取與匯出</a><ul>
<li><a href="#純文字資料-無分隔"><span class="toc-section-number">5.0.1</span> 純文字資料 (無分隔)</a></li>
<li><a href="#其他讀檔注意事項"><span class="toc-section-number">5.0.2</span> 其他讀檔注意事項</a></li>
<li><a href="#api"><span class="toc-section-number">5.0.3</span> API (Application programming interfaces)</a></li>
<li><a href="#xml"><span class="toc-section-number">5.0.4</span> XML 可延伸標記式語言</a></li>
<li><a href="#網頁爬蟲-webscraping"><span class="toc-section-number">5.0.5</span> 網頁爬蟲 Webscraping</a></li>
<li><a href="#facebook資料擷取"><span class="toc-section-number">5.1</span> Facebook資料擷取</a><ul>
<li><a href="#graph-api-in-r"><span class="toc-section-number">5.1.1</span> Graph API in R</a></li>
<li><a href="#rfacebook-package"><span class="toc-section-number">5.1.2</span> Rfacebook package</a></li>
</ul></li>
</ul></li>
<li><a href="#manipulation"><span class="toc-section-number">6</span> 資料處理與清洗</a><ul>
<li><a href="#tidy-data"><span class="toc-section-number">6.1</span> Tidy Data</a></li>
<li><a href="#資料型別轉換處理"><span class="toc-section-number">6.2</span> 資料型別轉換處理</a></li>
<li><a href="#文字字串處理"><span class="toc-section-number">6.3</span> 文字字串處理</a><ul>
<li><a href="#基本處理"><span class="toc-section-number">6.3.1</span> 基本處理</a></li>
<li><a href="#搜尋字串"><span class="toc-section-number">6.3.2</span> 搜尋字串</a></li>
<li><a href="#正規表示式-regular-expression"><span class="toc-section-number">6.3.3</span> 正規表示式 (Regular Expression)</a></li>
<li><a href="#載入資料"><span class="toc-section-number">6.3.4</span> 載入資料</a></li>
</ul></li>
</ul></li>
<li><a href="#eda"><span class="toc-section-number">7</span> 探索式資料分析</a><ul>
<li><a href="#什麼是探索式資料分析"><span class="toc-section-number">7.1</span> 什麼是探索式資料分析</a></li>
<li><a href="#datatable"><span class="toc-section-number">7.2</span> data.table</a><ul>
<li><a href="#i-觀察值篩選邏輯"><span class="toc-section-number">7.2.1</span> i 觀察值篩選邏輯</a></li>
<li><a href="#j-欄位選擇運算"><span class="toc-section-number">7.2.2</span> j 欄位選擇運算</a></li>
<li><a href="#by-分組依據"><span class="toc-section-number">7.2.3</span> by 分組依據</a></li>
<li><a href="#參考文件與資源"><span class="toc-section-number">7.2.4</span> 參考文件與資源</a></li>
</ul></li>
<li><a href="#dplyr"><span class="toc-section-number">7.3</span> dplyr</a><ul>
<li><a href="#select"><span class="toc-section-number">7.3.1</span> select()</a></li>
<li><a href="#filter"><span class="toc-section-number">7.3.2</span> filter()</a></li>
<li><a href="#mutate"><span class="toc-section-number">7.3.3</span> mutate()</a></li>
<li><a href="#summarise"><span class="toc-section-number">7.3.4</span> summarise()</a></li>
<li><a href="#group_by"><span class="toc-section-number">7.3.5</span> group_by()</a></li>
<li><a href="#arrange"><span class="toc-section-number">7.3.6</span> arrange()</a></li>
<li><a href="#rename"><span class="toc-section-number">7.3.7</span> rename()</a></li>
<li><a href="#參考文件與資源-1"><span class="toc-section-number">7.3.8</span> 參考文件與資源</a></li>
</ul></li>
</ul></li>
<li><a href="#vis"><span class="toc-section-number">8</span> 資料視覺化</a><ul>
<li><a href="#資料視覺化的目的"><span class="toc-section-number">8.1</span> 資料視覺化的目的</a></li>
<li><a href="#ggplot2簡介"><span class="toc-section-number">8.2</span> ggplot2簡介</a><ul>
<li><a href="#qplot"><span class="toc-section-number">8.2.1</span> qplot()</a></li>
<li><a href="#ggplot"><span class="toc-section-number">8.2.2</span> ggplot()</a></li>
</ul></li>
<li><a href="#ggplot2地圖"><span class="toc-section-number">8.3</span> ggplot2+地圖</a><ul>
<li><a href="#choropleth-map面量圖"><span class="toc-section-number">8.3.1</span> Choropleth map面量圖</a></li>
<li><a href="#ggmap"><span class="toc-section-number">8.3.2</span> ggmap()</a></li>
</ul></li>
<li><a href="#taiwan的面量圖"><span class="toc-section-number">8.4</span> Taiwan的面量圖</a><ul>
<li><a href="#ggmap面量圖"><span class="toc-section-number">8.4.1</span> ggmap+面量圖</a></li>
</ul></li>
<li><a href="#treemap"><span class="toc-section-number">8.5</span> Treemap</a></li>
<li><a href="#參考文件與資源-2"><span class="toc-section-number">8.6</span> 參考文件與資源</a></li>
</ul></li>
<li><a href="#InteractiveGraphics"><span class="toc-section-number">9</span> 互動式資料呈現</a><ul>
<li><a href="#ggvis"><span class="toc-section-number">9.1</span> ggvis</a></li>
<li><a href="#plot.ly"><span class="toc-section-number">9.2</span> Plot.ly</a></li>
<li><a href="#shiny簡介"><span class="toc-section-number">9.3</span> Shiny簡介</a></li>
</ul></li>
<li><a href="#datamining"><span class="toc-section-number">10</span> 資料探勘</a><ul>
<li><a href="#什麼是資料探勘"><span class="toc-section-number">10.1</span> 什麼是資料探勘</a></li>
<li><a href="#regression-迴歸"><span class="toc-section-number">10.2</span> Regression 迴歸</a><ul>
<li><a href="#linear-regression-線性迴歸"><span class="toc-section-number">10.2.1</span> Linear Regression 線性迴歸</a></li>
<li><a href="#logistic-regression-羅吉斯迴歸"><span class="toc-section-number">10.2.2</span> Logistic Regression 羅吉斯迴歸</a></li>
<li><a href="#最佳模型篩選"><span class="toc-section-number">10.2.3</span> 最佳模型篩選</a></li>
</ul></li>
<li><a href="#decision-trees-決策樹"><span class="toc-section-number">10.3</span> Decision Trees 決策樹</a></li>
<li><a href="#clustering-分群"><span class="toc-section-number">10.4</span> Clustering 分群</a><ul>
<li><a href="#hierarchical-clustering-階層式分群"><span class="toc-section-number">10.4.1</span> Hierarchical clustering 階層式分群</a></li>
<li><a href="#k-means-clustering"><span class="toc-section-number">10.4.2</span> K-means clustering</a></li>
</ul></li>
<li><a href="#association-rules-關聯式規則"><span class="toc-section-number">10.5</span> Association Rules 關聯式規則</a></li>
<li><a href="#open-source-packages"><span class="toc-section-number">10.6</span> Open Source Packages</a><ul>
<li><a href="#prophet"><span class="toc-section-number">10.6.1</span> Prophet</a></li>
<li><a href="#tensorflow"><span class="toc-section-number">10.6.2</span> TensorFlow</a></li>
<li><a href="#mxnet"><span class="toc-section-number">10.6.3</span> MXNet</a></li>
</ul></li>
<li><a href="#模型驗證"><span class="toc-section-number">10.7</span> 模型驗證</a><ul>
<li><a href="#regression-迴歸驗證"><span class="toc-section-number">10.7.1</span> Regression 迴歸驗證</a></li>
<li><a href="#logistic-regression-邏輯迴歸驗證"><span class="toc-section-number">10.7.2</span> Logistic Regression 邏輯迴歸驗證</a></li>
<li><a href="#decision-trees-決策樹驗證"><span class="toc-section-number">10.7.3</span> Decision Trees 決策樹驗證</a></li>
</ul></li>
<li><a href="#case-study"><span class="toc-section-number">10.8</span> Case Study</a></li>
<li><a href="#參考資料-1"><span class="toc-section-number">10.9</span> 參考資料</a></li>
</ul></li>
<li><a href="#big"><span class="toc-section-number">11</span> 從小數據到大數據分析</a><ul>
<li><a href="#r-hadoop"><span class="toc-section-number">11.1</span> R + Hadoop</a></li>
<li><a href="#rhadoop安裝測試流程-cloudera"><span class="toc-section-number">11.2</span> RHadoop安裝測試流程 (Cloudera)</a><ul>
<li><a href="#系統軟體版本資訊"><span class="toc-section-number">11.2.1</span> 系統/軟體版本資訊</a></li>
<li><a href="#參考資料-2"><span class="toc-section-number">11.2.2</span> 參考資料</a></li>
<li><a href="#安裝步驟"><span class="toc-section-number">11.2.3</span> 安裝步驟</a></li>
<li><a href="#測試前先解決權限問題"><span class="toc-section-number">11.2.4</span> 測試前，先解決權限問題</a></li>
<li><a href="#測試"><span class="toc-section-number">11.2.5</span> 測試</a></li>
<li><a href="#安裝rstudio-server"><span class="toc-section-number">11.2.6</span> 安裝RStudio Server</a></li>
</ul></li>
<li><a href="#rhadoop-mapreduce-easy-word-count"><span class="toc-section-number">11.3</span> RHadoop MapReduce: easy word count</a></li>
<li><a href="#r-spark"><span class="toc-section-number">11.4</span> R + Spark</a></li>
</ul></li>
<li><a href="#install"><span class="toc-section-number">12</span> 軟體安裝介紹</a><ul>
<li><a href="#r安裝"><span class="toc-section-number">12.1</span> R安裝</a></li>
<li><a href="#rstudio安裝"><span class="toc-section-number">12.2</span> RStudio安裝</a></li>
<li><a href="#rstudio使用簡介"><span class="toc-section-number">12.3</span> RStudio使用簡介</a><ul>
<li><a href="#專案"><span class="toc-section-number">12.3.1</span> 專案</a></li>
<li><a href="#rstudio介面"><span class="toc-section-number">12.3.2</span> RStudio介面</a></li>
</ul></li>
</ul></li>
<li><a href="#author">作者資訊</a></li>
<li><a href="#references">References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">資料科學與R語言</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="preface" class="section level1 unnumbered">
<h1></h1>
<p>本書介紹如何使用<a href="http://www.r-project.org/" target="_blank">R語言</a>完成資料讀取 (檔案、透過API擷取或爬蟲)、資料清洗與處理、探索式資料分析、資料視覺化、互動式資料呈現 (搭配Shiny) 與資料探勘等，並介紹R與Hadoop Ecosystems介接方法。</p>
<p>資料探勘章節尚未完成，epub版本格式微調中。</p>
<p>如要一次安裝所有本書會使用到的套件，可在R內執行以下程式碼：</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;yijutseng/DataAnalyticsWithRBook&quot;</span>)</a></code></pre></div>
<p>本書為<a href="http://im.cgu.edu.tw/bin/home.php" target="_blank">長庚大學資訊管理學系</a> <a href="https://github.com/yijutseng/BigDataCGUIM" target="_blank">大數據分析方法</a>課程教學使用書籍</p>
<p>如果您想修改文字或範例，歡迎透過<a href="https://goo.gl/forms/5Htobvwy2vsB7yiF3" target="_blank">此連結</a>或是透過<a href="https://github.com/yijutseng/DataAnalyticsWithRBook/issues" target="_blank">GitHub</a> issue提供建議與回饋。</p>
<p>本書程式碼執行環境：</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17763)
## 
## Matrix products: default
## 
## Random number generation:
##  RNG:     Mersenne-Twister 
##  Normal:  Inversion 
##  Sample:  Rounding 
##  
## locale:
## [1] LC_COLLATE=Chinese (Traditional)_Taiwan.950 
## [2] LC_CTYPE=Chinese (Traditional)_Taiwan.950   
## [3] LC_MONETARY=Chinese (Traditional)_Taiwan.950
## [4] LC_NUMERIC=C                                
## [5] LC_TIME=Chinese (Traditional)_Taiwan.950    
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] treemap_2.4-2         purrr_0.3.2           caret_6.0-84         
##  [4] lattice_0.20-38       MASS_7.3-51.4         arulesViz_1.3-3      
##  [7] fields_9.9            maps_3.3.0            spam_2.3-0           
## [10] dotCall64_1.0-0       rpart.plot_3.0.8      rpart_4.1-15         
## [13] googleVis_0.6.4       ggvis_0.4.4           plotly_4.9.0         
## [16] shiny_1.4.0           treemapify_2.5.3.9001 WDI_2.6.0            
## [19] choroplethrMaps_1.0.1 choroplethr_3.6.3     acs_2.1.4            
## [22] ggmap_3.0.0           maptools_0.9-8        rgeos_0.5-2          
## [25] rgdal_1.4-6           sp_1.3-1              rvest_0.3.4          
## [28] xml2_1.2.2            Rfacebook_0.6.15      httpuv_1.5.2         
## [31] rjson_0.2.20          httr_1.4.1            XML_3.98-1.20        
## [34] jsonlite_1.6          readxl_1.3.1          readr_1.3.1          
## [37] SportsAnalytics_0.2   reshape2_1.4.3        stringr_1.4.0        
## [40] data.table_1.12.4     RCurl_1.95-4.12       bitops_1.0-6         
## [43] rmarkdown_1.16        knitr_1.25            bookdown_0.14        
## [46] bit64_0.9-7           bit_1.1-14            lubridate_1.7.4      
## [49] dplyr_0.8.3           ggplot2_3.2.1         arules_1.6-4         
## [52] Matrix_1.2-17        
## 
## loaded via a namespace (and not attached):
##   [1] uuid_0.1-2           backports_1.1.5      Hmisc_4.2-0         
##   [4] igraph_1.2.4.1       plyr_1.8.4           lazyeval_0.2.2      
##   [7] splines_3.6.1        gridBase_0.4-7       digest_0.6.21       
##  [10] foreach_1.4.7        htmltools_0.4.0      viridis_0.5.1       
##  [13] gdata_2.18.0         magrittr_1.5         checkmate_1.9.4     
##  [16] cluster_2.1.0        gclus_1.3.2          recipes_0.1.7       
##  [19] ggfittext_0.8.1      gower_0.2.1          jpeg_0.1-8          
##  [22] colorspace_1.4-1     rappdirs_0.3.1       xfun_0.10           
##  [25] crayon_1.3.4         zeallot_0.1.0        zoo_1.8-6           
##  [28] survival_2.44-1.1    tigris_0.8.2         iterators_1.0.12    
##  [31] glue_1.3.1           registry_0.5-1       gtable_0.3.0        
##  [34] ipred_0.9-9          scales_1.0.0         DBI_1.0.0           
##  [37] Rcpp_1.0.2           viridisLite_0.3.0    xtable_1.8-4        
##  [40] htmlTable_1.13.2     units_0.6-5          foreign_0.8-71      
##  [43] Formula_1.2-3        stats4_3.6.1         lava_1.6.6          
##  [46] prodlim_2018.04.18   DT_0.9               vcd_1.4-4           
##  [49] htmlwidgets_1.5.1    gplots_3.0.1.1       RColorBrewer_1.1-2  
##  [52] acepack_1.4.1        pkgconfig_2.0.3      nnet_7.3-12         
##  [55] RJSONIO_1.3-1.3      tidyselect_0.2.5     rlang_0.4.0         
##  [58] later_1.0.0          visNetwork_2.0.8     munsell_0.5.0       
##  [61] cellranger_1.1.0     tools_3.6.1          generics_0.0.2      
##  [64] evaluate_0.14        fastmap_1.0.1        yaml_2.2.0          
##  [67] ModelMetrics_1.2.2   caTools_1.17.1.2     RgoogleMaps_1.4.4   
##  [70] dendextend_1.12.0    nlme_3.1-140         mime_0.7            
##  [73] compiler_3.6.1       rstudioapi_0.10      png_0.1-7           
##  [76] e1071_1.7-2          tibble_2.1.3         stringi_1.4.3       
##  [79] classInt_0.4-1       vctrs_0.2.0          pillar_1.4.2        
##  [82] lifecycle_0.1.0      lmtest_0.9-37        seriation_1.2-8     
##  [85] R6_2.4.0             latticeExtra_0.6-28  promises_1.1.0      
##  [88] TSP_1.1-7            KernSmooth_2.23-15   gridExtra_2.3       
##  [91] codetools_0.2-16     gtools_3.8.1         assertthat_0.2.1    
##  [94] withr_2.1.2          hms_0.5.1            timeDate_3043.102   
##  [97] tidyr_1.0.0          class_7.3-15         sf_0.8-0            
## [100] scatterplot3d_0.3-41 base64enc_0.1-3</code></pre>
<p>本書使用套件版本：</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">pkgInfo&lt;-<span class="kw">lapply</span>(pkg, packageDescription, <span class="dt">fields =</span> <span class="kw">c</span>(<span class="st">&quot;Package&quot;</span>, <span class="st">&quot;Version&quot;</span>))</a>
<a class="sourceLine" id="cb4-2" title="2">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">Package=</span><span class="kw">sapply</span>(pkgInfo, <span class="st">`</span><span class="dt">[[</span><span class="st">`</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="dt">Version=</span><span class="kw">sapply</span>(pkgInfo, <span class="st">`</span><span class="dt">[[</span><span class="st">`</span>, <span class="dv">2</span>)))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ggplot2</td>
<td align="left">3.2.1</td>
</tr>
<tr class="even">
<td align="left">dplyr</td>
<td align="left">0.8.3</td>
</tr>
<tr class="odd">
<td align="left">lubridate</td>
<td align="left">1.7.4</td>
</tr>
<tr class="even">
<td align="left">bit64</td>
<td align="left">0.9-7</td>
</tr>
<tr class="odd">
<td align="left">bookdown</td>
<td align="left">0.14</td>
</tr>
<tr class="even">
<td align="left">knitr</td>
<td align="left">1.25</td>
</tr>
<tr class="odd">
<td align="left">rmarkdown</td>
<td align="left">1.16</td>
</tr>
<tr class="even">
<td align="left">RCurl</td>
<td align="left">1.95-4.12</td>
</tr>
<tr class="odd">
<td align="left">data.table</td>
<td align="left">1.12.4</td>
</tr>
<tr class="even">
<td align="left">stringr</td>
<td align="left">1.4.0</td>
</tr>
<tr class="odd">
<td align="left">reshape2</td>
<td align="left">1.4.3</td>
</tr>
<tr class="even">
<td align="left">SportsAnalytics</td>
<td align="left">0.2</td>
</tr>
<tr class="odd">
<td align="left">readr</td>
<td align="left">1.3.1</td>
</tr>
<tr class="even">
<td align="left">readxl</td>
<td align="left">1.3.1</td>
</tr>
<tr class="odd">
<td align="left">jsonlite</td>
<td align="left">1.6</td>
</tr>
<tr class="even">
<td align="left">XML</td>
<td align="left">3.98-1.20</td>
</tr>
<tr class="odd">
<td align="left">Rfacebook</td>
<td align="left">0.6.15</td>
</tr>
<tr class="even">
<td align="left">rvest</td>
<td align="left">0.3.4</td>
</tr>
<tr class="odd">
<td align="left">rgdal</td>
<td align="left">1.4-6</td>
</tr>
<tr class="even">
<td align="left">rgeos</td>
<td align="left">0.5-2</td>
</tr>
<tr class="odd">
<td align="left">maptools</td>
<td align="left">0.9-8</td>
</tr>
<tr class="even">
<td align="left">ggmap</td>
<td align="left">3.0.0</td>
</tr>
<tr class="odd">
<td align="left">choroplethr</td>
<td align="left">3.6.3</td>
</tr>
<tr class="even">
<td align="left">choroplethrMaps</td>
<td align="left">1.0.1</td>
</tr>
<tr class="odd">
<td align="left">WDI</td>
<td align="left">2.6.0</td>
</tr>
<tr class="even">
<td align="left">treemapify</td>
<td align="left">2.5.3.9001</td>
</tr>
<tr class="odd">
<td align="left">shiny</td>
<td align="left">1.4.0</td>
</tr>
<tr class="even">
<td align="left">plotly</td>
<td align="left">4.9.0</td>
</tr>
<tr class="odd">
<td align="left">ggvis</td>
<td align="left">0.4.4</td>
</tr>
<tr class="even">
<td align="left">googleVis</td>
<td align="left">0.6.4</td>
</tr>
<tr class="odd">
<td align="left">rpart</td>
<td align="left">4.1-15</td>
</tr>
<tr class="even">
<td align="left">rpart.plot</td>
<td align="left">3.0.8</td>
</tr>
<tr class="odd">
<td align="left">fields</td>
<td align="left">9.9</td>
</tr>
<tr class="even">
<td align="left">arules</td>
<td align="left">1.6-4</td>
</tr>
<tr class="odd">
<td align="left">datasets</td>
<td align="left">3.6.1</td>
</tr>
<tr class="even">
<td align="left">arulesViz</td>
<td align="left">1.3-3</td>
</tr>
<tr class="odd">
<td align="left">MASS</td>
<td align="left">7.3-51.4</td>
</tr>
<tr class="even">
<td align="left">caret</td>
<td align="left">6.0-84</td>
</tr>
<tr class="odd">
<td align="left">purrr</td>
<td align="left">0.3.2</td>
</tr>
<tr class="even">
<td align="left">treemap</td>
<td align="left">2.4-2</td>
</tr>
</tbody>
</table>
<p>本著作係採用創用 CC 姓名標示-非商業性-禁止改作 3.0 台灣 授權條款授權。</p>
<!--chapter:end:index.Rmd-->
</div>
<div id="intro" class="section level1">
<h1><span class="header-section-number">1</span> R語言101</h1>
<p>本章節介紹學習R語言的基本知識，包括基本指令操作、運算子介紹等。</p>
<div id="什麼是r語言" class="section level2">
<h2><span class="header-section-number">1.1</span> 什麼是R語言</h2>
<p><a href="http://www.r-project.org/" target="_blank">R語言</a>是一種自由軟體程式語言，主要用於資料分析與統計運算，2000年時終於發表R 1.0.0，有關R語言的發展歷史可參考<a href="https://zh.wikipedia.org/wiki/R%E8%AF%AD%E8%A8%80" target="_blank">維基百科</a>。基本的R軟體已經內建多種統計及分析功能，其餘功能可以透過安裝<strong>套件（Packages）</strong>加載，眾多的套件使R的使用者可以【站在巨人的肩膀上(Standing on the shoulders of
giants (Hal R. Varian, Google))】做資料分析，截至2017年1月為止，R軟體可另外安裝的套件數目共有10,000個以上 (<a href="https://www.rstudio.com/rviews/2017/01/06/10000-cran-packages/" target="_blank">R Studio報導</a>)。常用的套件清單可參考各項網路資訊，如<a href="https://support.rstudio.com/hc/en-us/articles/201057987-Quick-list-of-useful-R-packages" target="_blank">R Studio的整理：Quick list of useful R packages</a></p>
<p>安裝套件Package的方法如下：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;套件名稱&quot;</span>)</a></code></pre></div>
<p>值得注意的是，套件名稱需要加上雙引號，舉例來說，若要安裝<code>ggplot2</code>套件，則要在R的Console視窗內輸入：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</a></code></pre></div>
<p>若要載入<strong>已安裝</strong>的套件，則輸入<code>library(套件名稱)</code>，範例：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>載入已安裝的套件時，可以<strong>不用</strong>在套件名稱前後加雙引號，但也可以加 （<a href="http://stackoverflow.com/questions/25210455/how-can-library-accept-both-quoted-and-unquoted-strings" target="_blank">參考資料</a>）。</p>
</div>
<div id="函數使用" class="section level2">
<h2><span class="header-section-number">1.2</span> 函數使用</h2>
<p>在R中有許多內建函數，安裝套件後各套件也會提供各式各樣寫好的函數，函數使用方式為<code>函數名稱(參數1,參數2,....)</code>，以計算平均數為例，可使用<code>mean()</code>函數，範例如下:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)) <span class="co">##計算1~6的平均數</span></a></code></pre></div>
<pre><code>## [1] 3.5</code></pre>
<p>若想知道各函數所需參數，可使用<code>?函數名稱</code>觀看函數作者所撰寫的說明文件</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">?mean</a></code></pre></div>
<p>除非有指定參數名稱，函數的參數設定有順序性，如序列產生函數<code>seq()</code>，參數順序為<code>from, to, by</code>，代表序列起點、序列終點，以及相隔單位。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">1</span>,<span class="dt">to=</span><span class="dv">9</span>,<span class="dt">by=</span><span class="dv">2</span>)<span class="co">#1~9，每隔2產生一數字</span></a></code></pre></div>
<pre><code>## [1] 1 3 5 7 9</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>)<span class="co">#按照順序輸入參數，可省去參數名稱</span></a></code></pre></div>
<pre><code>## [1] 1 3 5 7 9</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">seq</span>(<span class="dt">by=</span><span class="dv">2</span>,<span class="dt">to=</span><span class="dv">9</span>,<span class="dt">from=</span><span class="dv">1</span>)<span class="co">#若不想照順序輸入參數，需要指定參數名稱</span></a></code></pre></div>
<pre><code>## [1] 1 3 5 7 9</code></pre>
</div>
<div id="變數設定" class="section level2">
<h2><span class="header-section-number">1.3</span> 變數設定</h2>
<p>在開始深入學習R語言之前，首要任務是學習最基本的R程式碼：<strong>變數設定</strong>，在R語言中，主要使用<code>&lt;-</code>設定變數，設定方法為：<strong>變數名稱</strong><code>&lt;-</code><strong>變數內容(值)</strong>，雖然<strong>變數名稱</strong>可依箭頭方向放置於左側<code>&lt;-</code>或右側<code>-&gt;</code>，但為方便閱讀，<strong>變數名稱</strong>多放置於左側。</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">a&lt;-<span class="dv">1</span> </a>
<a class="sourceLine" id="cb17-2" title="2"><span class="dv">2</span>-&gt;b</a>
<a class="sourceLine" id="cb17-3" title="3">a</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">b</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>R語言也接受使用<code>=</code>設定變數，此時<strong>變數名稱</strong>必須在左側，如：<strong>變數名稱</strong><code>=</code><strong>變數內容</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">c=<span class="dv">1</span> </a>
<a class="sourceLine" id="cb21-2" title="2">c</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>除了<strong>變數設定</strong>外，<code>str()</code>函數也為常用基本函數，<code>str()</code>用在檢查與總覽各類變數型態。</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">d&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">str</span>(d)</a></code></pre></div>
<pre><code>##  num 3</code></pre>
<p>變數的命名有以下規則:</p>
<ul>
<li>不可使用保留字，如break, else, FALSE, for, function, if, Inf, NA, NaN,
next, repeat, return, TRUE, while等</li>
<li>開頭只能是英文字，或 <code>.</code></li>
<li>大小寫敏感</li>
</ul>
</div>
<div id="執行視窗" class="section level2">
<h2><span class="header-section-number">1.4</span> 執行視窗</h2>
<p>R是可直譯的語言，也就是說，可以在執行視窗(Console)直接打程式碼，在視窗出現<code>&gt;</code>時，表示可輸入指令，若視窗出現<code>+</code>時，表示前面的程式碼還沒打完，必須鍵入完整的程式碼讓R執行。</p>
</div>
<div id="DataType" class="section level2">
<h2><span class="header-section-number">1.5</span> 資料型態</h2>
<p>在R語言中，常用的資料型態包括<strong>數值 (numeric)</strong>、<strong>字串 (character)</strong>、<strong>布林變數 (logic)</strong>以及<strong>日期 (Date)</strong>等。</p>
<div id="數值-numeric" class="section level3">
<h3><span class="header-section-number">1.5.1</span> 數值 numeric</h3>
<p>數值包括整數（沒有小數點）與浮點數（有小數點）的數值</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">num1&lt;-<span class="dv">100</span> </a>
<a class="sourceLine" id="cb25-2" title="2">num2&lt;-<span class="fl">1000.001</span></a></code></pre></div>
<p>值得注意的是，若數值長度超過 <code>2^53</code>，必須導入<code>bit64</code> package <span class="citation">(Oehlschlagel <a href="#ref-R-bit64" role="doc-biblioref">2017</a>)</span>，將數值長度上限提高為<code>2^63</code>，才能表示完整數值</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">print</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">53</span>, <span class="dt">digits=</span><span class="dv">20</span>) </a></code></pre></div>
<pre><code>## [1] 9007199254740992</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">print</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">53</span><span class="op">+</span><span class="dv">1</span>, <span class="dt">digits=</span><span class="dv">20</span>) <span class="co"># +1後，數值仍與2^53相同</span></a></code></pre></div>
<pre><code>## [1] 9007199254740992</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">library</span>(bit64) <span class="co"># 導入bit64 package</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">print</span>(<span class="kw">as.integer64</span>(<span class="dv">2</span>)<span class="op">^</span><span class="dv">53</span>, <span class="dt">digits=</span><span class="dv">20</span>)</a></code></pre></div>
<pre><code>## integer64
## [1] 9007199254740992</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">print</span>(<span class="kw">as.integer64</span>(<span class="dv">2</span>)<span class="op">^</span><span class="dv">53</span><span class="op">+</span><span class="dv">1</span>, <span class="dt">digits=</span><span class="dv">20</span>)<span class="co"># 導入bit64後，可得正確答案</span></a></code></pre></div>
<pre><code>## integer64
## [1] 9007199254740993</code></pre>
</div>
<div id="字串-character" class="section level3">
<h3><span class="header-section-number">1.5.2</span> 字串 character</h3>
<p>用雙引號<code>"</code>框起的文字會被儲存為字串格式，若在數字前後加上雙引號，數字也會被儲存為文字形式，無法進行數值的加減乘除等運算。</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">char1&lt;-<span class="st">&quot;abcTest&quot;</span> </a>
<a class="sourceLine" id="cb34-2" title="2">char2&lt;-<span class="st">&quot;100&quot;</span></a>
<a class="sourceLine" id="cb34-3" title="3">char3&lt;-<span class="st">&quot;200&quot;</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co">#char2+char3 #會輸出Error message: non-numeric argument to binary operator</span></a></code></pre></div>
</div>
<div id="布林變數-logic" class="section level3">
<h3><span class="header-section-number">1.5.3</span> 布林變數 logic</h3>
<p>用於邏輯判斷，可使用大寫<strong>TRUE</strong>或<strong>T</strong>代表<strong>真</strong>，大寫<strong>FALSE</strong>或<strong>F</strong>代表假。</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">boolT&lt;-<span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb35-2" title="2">boolT1&lt;-T</a>
<a class="sourceLine" id="cb35-3" title="3">boolF&lt;-<span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb35-4" title="4">boolF1&lt;-F</a></code></pre></div>
</div>
<div id="日期-date" class="section level3">
<h3><span class="header-section-number">1.5.4</span> 日期 (Date)</h3>
<p>用於表示日期，於資料分析中常用，使用<code>Sys.Date()</code>指令可得系統日期。</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">dateBook&lt;-<span class="kw">Sys.Date</span>()</a>
<a class="sourceLine" id="cb36-2" title="2">dateBook</a></code></pre></div>
<pre><code>## [1] &quot;2019-10-15&quot;</code></pre>
<p>日期與字串的相關轉換操作可考慮使用簡單易懂的<code>lubridate</code><span class="citation">(Spinu, Grolemund, and Wickham <a href="#ref-R-lubridate" role="doc-biblioref">2018</a>)</span> package，如果想要將<code>年/月/日</code>格式的文字轉換為日期物件，可使用<code>ymd()</code>函數（y表年year，m表月month，d表日day），如果想要將<code>月/日/年</code>格式的文字轉換為日期物件，則使用<code>mdy()</code>函數，以此類推。</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">ymd</span>(<span class="st">&#39;2012/3/3&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;2012-03-03&quot;</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">mdy</span>(<span class="st">&#39;3/3/2012&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;2012-03-03&quot;</code></pre>
<p>其他使用方式可參考 <a href="http://blog.yhat.com/static/pdf/R_date_cheat_sheet.pdf" target="_blank">The Yhat Blog</a>。</p>
</div>
</div>
<div id="基本運算子" class="section level2">
<h2><span class="header-section-number">1.6</span> 基本運算子</h2>
<div id="數學基本運算" class="section level3">
<h3><span class="header-section-number">1.6.1</span> 數學基本運算</h3>
<p>在R中，數學運算與其他程式語言相同</p>
<ul>
<li>加 <code>+</code></li>
<li>減 <code>-</code></li>
<li>乘 <code>*</code></li>
<li>除 <code>/</code></li>
<li>餘數 <code>%%</code></li>
<li>次方 <code>^</code></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">num1&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb42-2" title="2">num2&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb42-3" title="3">num1<span class="op">+</span>num2</a></code></pre></div>
<pre><code>## [1] 101</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">num1<span class="op">-</span>num2</a></code></pre></div>
<pre><code>## [1] -99</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">num1<span class="op">*</span>num2</a></code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">num1<span class="op">/</span>num2</a></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="dv">100</span><span class="op">%%</span><span class="dv">3</span> <span class="co">##100除以3後所得餘數</span></a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="dv">2</span><span class="op">^</span><span class="dv">3</span> <span class="co">##2的3次方</span></a></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>###進階數學函數
- 四捨五入 <code>round()</code>
- 無條件捨去 <code>floor()</code>
- 無條件進位 <code>ceiling()</code></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">num1&lt;-<span class="fl">1.568</span></a>
<a class="sourceLine" id="cb54-2" title="2">num2&lt;-<span class="fl">2.121</span></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="kw">round</span>(num2,<span class="dt">digits =</span> <span class="dv">1</span>) <span class="co">#2.121四捨五入至小數點第一位</span></a></code></pre></div>
<pre><code>## [1] 2.1</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">floor</span>(num1) <span class="co">##1.568</span></a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">ceiling</span>(num2) <span class="co">##2.121</span></a></code></pre></div>
<pre><code>## [1] 3</code></pre>
</div>
<div id="邏輯運算" class="section level3">
<h3><span class="header-section-number">1.6.2</span> 邏輯運算</h3>
<p>常用之邏輯判斷也可在R中直接使用</p>
<ul>
<li>大於 <code>&gt;</code></li>
<li>小於 <code>&lt;</code></li>
<li>等於 <code>==</code>，為了不與變數設定混淆，判斷兩變數是否相等，要用<strong>雙等號</strong></li>
<li>大於等於 <code>&gt;=</code></li>
<li>小於等於 <code>&lt;=</code></li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">num1&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb60-2" title="2">num2&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb60-3" title="3">num1<span class="op">&gt;</span>num2</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">num1<span class="op">&lt;</span>num2</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>文字字串也可比較大小</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">char1&lt;-<span class="st">&quot;abcTest&quot;</span> </a>
<a class="sourceLine" id="cb64-2" title="2">char2&lt;-<span class="st">&quot;defTest&quot;</span></a>
<a class="sourceLine" id="cb64-3" title="3">char1<span class="op">&gt;</span>char2</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>邏輯混合判斷，和JAVA等語言不同的是，在R中使用<strong>單符號</strong>即可表示且<code>&amp;</code>和或<code>|</code></p>
<ul>
<li>且 <code>&amp;</code></li>
<li>或 <code>|</code></li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="ot">TRUE</span> <span class="op">&amp;</span><span class="st"> </span><span class="ot">TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="ot">TRUE</span> <span class="op">&amp;</span><span class="st"> </span><span class="ot">FALSE</span></a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="ot">TRUE</span> <span class="op">|</span><span class="st"> </span><span class="ot">TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="ot">TRUE</span> <span class="op">|</span><span class="st"> </span><span class="ot">FALSE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>反向布林變數<code>!</code></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="op">!</span><span class="ot">TRUE</span></a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="op">!</span><span class="ot">FALSE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="錯誤訊息" class="section level2">
<h2><span class="header-section-number">1.7</span> 錯誤訊息</h2>
<ul>
<li>Message：有可能的錯誤通知，程式會繼續執行</li>
<li>Warning：有錯誤，但是不會影響太多，程式會繼續執行</li>
<li>Error：有錯，而且無法繼續執行程式</li>
<li>Condition：可能會發生的情況</li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">log</span>(<span class="op">-</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Warning in log(-1): NaNs produced</code></pre>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">mena</span>(<span class="ot">NA</span>)</a></code></pre></div>
<pre><code>## Error in mena(NA): could not find function &quot;mena&quot;</code></pre>
<p>錯誤訊息範例1:</p>
<pre><code># Error: could not find function &quot;fetch_NBAPlayerStatistics&quot;
# 找不到&quot;fetch_NBAPlayerStatistics&quot; function</code></pre>
<p>可能原因：沒安裝或沒讀入SportsAnalytics package</p>
<p>錯誤訊息範例2:</p>
<pre><code># Error in library(knitr): there is no package called &#39;knitr&#39;
# 找不到&quot;knitr&quot; package</code></pre>
<p>可能原因：沒安裝knitr package</p>
</div>
<div id="help" class="section level2">
<h2><span class="header-section-number">1.8</span> Help</h2>
<p>R語言與套件均有完整的文件與範例可以參考，在R的執行視窗中，輸入<code>?函數名稱</code>或<code>?套件名稱</code>即可看到函數或套件的使用說明</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">?ggplot2</a>
<a class="sourceLine" id="cb85-2" title="2">?ymd</a></code></pre></div>
<p>除此之外，<a href="http://stackoverflow.com/" target="_blank">Stack Overflow</a>中也有許多問答，可直接在網站中搜尋關鍵字與錯誤訊息。</p>
<p>如果找不到解答，發問時請附上可以重現錯誤的<strong>程式碼</strong>與<strong>資料</strong>，以及系統/套件的版本資訊，版本資訊可以透過執行下列程式碼取得：</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17763)
## 
## Matrix products: default
## 
## Random number generation:
##  RNG:     Mersenne-Twister 
##  Normal:  Inversion 
##  Sample:  Rounding 
##  
## locale:
## [1] LC_COLLATE=Chinese (Traditional)_Taiwan.950 
## [2] LC_CTYPE=Chinese (Traditional)_Taiwan.950   
## [3] LC_MONETARY=Chinese (Traditional)_Taiwan.950
## [4] LC_NUMERIC=C                                
## [5] LC_TIME=Chinese (Traditional)_Taiwan.950    
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] treemap_2.4-2         purrr_0.3.2           caret_6.0-84         
##  [4] lattice_0.20-38       MASS_7.3-51.4         arulesViz_1.3-3      
##  [7] fields_9.9            maps_3.3.0            spam_2.3-0           
## [10] dotCall64_1.0-0       rpart.plot_3.0.8      rpart_4.1-15         
## [13] googleVis_0.6.4       ggvis_0.4.4           plotly_4.9.0         
## [16] shiny_1.4.0           treemapify_2.5.3.9001 WDI_2.6.0            
## [19] choroplethrMaps_1.0.1 choroplethr_3.6.3     acs_2.1.4            
## [22] ggmap_3.0.0           maptools_0.9-8        rgeos_0.5-2          
## [25] rgdal_1.4-6           sp_1.3-1              rvest_0.3.4          
## [28] xml2_1.2.2            Rfacebook_0.6.15      httpuv_1.5.2         
## [31] rjson_0.2.20          httr_1.4.1            XML_3.98-1.20        
## [34] jsonlite_1.6          readxl_1.3.1          readr_1.3.1          
## [37] SportsAnalytics_0.2   reshape2_1.4.3        stringr_1.4.0        
## [40] data.table_1.12.4     RCurl_1.95-4.12       bitops_1.0-6         
## [43] rmarkdown_1.16        knitr_1.25            bookdown_0.14        
## [46] bit64_0.9-7           bit_1.1-14            lubridate_1.7.4      
## [49] dplyr_0.8.3           ggplot2_3.2.1         arules_1.6-4         
## [52] Matrix_1.2-17        
## 
## loaded via a namespace (and not attached):
##   [1] uuid_0.1-2           backports_1.1.5      Hmisc_4.2-0         
##   [4] igraph_1.2.4.1       plyr_1.8.4           lazyeval_0.2.2      
##   [7] splines_3.6.1        gridBase_0.4-7       digest_0.6.21       
##  [10] foreach_1.4.7        htmltools_0.4.0      viridis_0.5.1       
##  [13] gdata_2.18.0         magrittr_1.5         checkmate_1.9.4     
##  [16] cluster_2.1.0        gclus_1.3.2          recipes_0.1.7       
##  [19] ggfittext_0.8.1      gower_0.2.1          jpeg_0.1-8          
##  [22] colorspace_1.4-1     rappdirs_0.3.1       xfun_0.10           
##  [25] crayon_1.3.4         zeallot_0.1.0        zoo_1.8-6           
##  [28] survival_2.44-1.1    tigris_0.8.2         iterators_1.0.12    
##  [31] glue_1.3.1           registry_0.5-1       gtable_0.3.0        
##  [34] ipred_0.9-9          scales_1.0.0         DBI_1.0.0           
##  [37] Rcpp_1.0.2           viridisLite_0.3.0    xtable_1.8-4        
##  [40] htmlTable_1.13.2     units_0.6-5          foreign_0.8-71      
##  [43] Formula_1.2-3        stats4_3.6.1         lava_1.6.6          
##  [46] prodlim_2018.04.18   DT_0.9               vcd_1.4-4           
##  [49] htmlwidgets_1.5.1    gplots_3.0.1.1       RColorBrewer_1.1-2  
##  [52] acepack_1.4.1        pkgconfig_2.0.3      nnet_7.3-12         
##  [55] RJSONIO_1.3-1.3      tidyselect_0.2.5     rlang_0.4.0         
##  [58] later_1.0.0          visNetwork_2.0.8     munsell_0.5.0       
##  [61] cellranger_1.1.0     tools_3.6.1          generics_0.0.2      
##  [64] evaluate_0.14        fastmap_1.0.1        yaml_2.2.0          
##  [67] ModelMetrics_1.2.2   caTools_1.17.1.2     RgoogleMaps_1.4.4   
##  [70] dendextend_1.12.0    nlme_3.1-140         mime_0.7            
##  [73] compiler_3.6.1       rstudioapi_0.10      png_0.1-7           
##  [76] e1071_1.7-2          tibble_2.1.3         stringi_1.4.3       
##  [79] highr_0.8            classInt_0.4-1       vctrs_0.2.0         
##  [82] pillar_1.4.2         lifecycle_0.1.0      lmtest_0.9-37       
##  [85] seriation_1.2-8      R6_2.4.0             latticeExtra_0.6-28 
##  [88] promises_1.1.0       TSP_1.1-7            KernSmooth_2.23-15  
##  [91] gridExtra_2.3        codetools_0.2-16     gtools_3.8.1        
##  [94] assertthat_0.2.1     withr_2.1.2          hms_0.5.1           
##  [97] timeDate_3043.102    tidyr_1.0.0          class_7.3-15        
## [100] sf_0.8-0             scatterplot3d_0.3-41 base64enc_0.1-3</code></pre>
<!--chapter:end:01-intro.Rmd-->
</div>
</div>
<div id="RDataStructure" class="section level1">
<h1><span class="header-section-number">2</span> R 資料結構</h1>
<div id="向量-vector" class="section level2">
<h2><span class="header-section-number">2.1</span> 向量 vector</h2>
<p>向量為一維資料的表現和儲存方式，用<code>c()</code>函數可定義向量，如：</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">vec&lt;-<span class="kw">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>)</a></code></pre></div>
<p>a~e為vec向量中的<strong>元素(element)</strong>，各元素在向量中的順序固定，<code>a</code>為<code>vec</code>向量中的第<strong>1</strong>個元素，<code>b</code>則為第<strong>2</strong>個元素，以此類推，若要將<code>vec</code>向量的第<strong>4</strong>個元素取出，可使用</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">vec[<span class="dv">4</span>] <span class="co">## 第4個元素</span></a></code></pre></div>
<pre><code>## [1] &quot;d&quot;</code></pre>
<p>也可同時取出多個元素</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">vec[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)] <span class="co">## 第2與第3個元素</span></a></code></pre></div>
<pre><code>## [1] &quot;b&quot; &quot;c&quot;</code></pre>
<p>此外，在同一向量中，所有元素之<strong>資料型態必須相同</strong>，如上述<code>vec</code>向量，元素均為文字型態，若放不同類別的資料進同一個向量，資料型態會被自動轉成一樣的，範例如下</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">a&lt;-<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="st">&quot;a&quot;</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">str</span>(a)</a></code></pre></div>
<pre><code>##  chr [1:3] &quot;TRUE&quot; &quot;a&quot; &quot;1&quot;</code></pre>
<p>和變數指定類似，向量中的元素也可以使用<code>&lt;-</code>重新指定</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">vec[<span class="dv">3</span>]</a></code></pre></div>
<pre><code>## [1] &quot;c&quot;</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">vec[<span class="dv">3</span>]&lt;-<span class="st">&#39;z&#39;</span> <span class="co">##第三個元素值設定為“z”</span></a>
<a class="sourceLine" id="cb97-2" title="2">vec</a></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;z&quot; &quot;d&quot; &quot;e&quot;</code></pre>
<div id="快速產生向量函數" class="section level3">
<h3><span class="header-section-number">2.1.1</span> 快速產生向量函數</h3>
<p>若要產生連續向量，如1~20，可使用<code>:</code>來串連首字與最後一字</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="dv">1</span><span class="op">:</span><span class="dv">20</span> <span class="co">## c(1,2,...,19,20)</span></a></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</code></pre>
<p>或是使用<code>seq()</code>函數</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">1</span>,<span class="dt">to=</span><span class="dv">20</span>,<span class="dt">by=</span><span class="dv">1</span>) <span class="co">##1~20，中間相隔1</span></a></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">1</span>,<span class="dt">to=</span><span class="dv">50</span>,<span class="dt">by=</span><span class="dv">2</span>) <span class="co">##1~50，中間相隔2</span></a></code></pre></div>
<pre><code>##  [1]  1  3  5  7  9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47 49</code></pre>
</div>
<div id="向量運算" class="section level3">
<h3><span class="header-section-number">2.1.2</span> 向量運算</h3>
<p>向量也可直接做加減乘除運算，如</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">numvec&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="co">## c(1,2,3,4,5,6,7,8,9,10)</span></a>
<a class="sourceLine" id="cb105-2" title="2">numvec<span class="op">+</span><span class="dv">3</span> <span class="co">## 所有元素+3</span></a></code></pre></div>
<pre><code>##  [1]  4  5  6  7  8  9 10 11 12 13</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">numvec<span class="op">*</span><span class="dv">2</span> <span class="co">## 所有元素*2</span></a></code></pre></div>
<pre><code>##  [1]  2  4  6  8 10 12 14 16 18 20</code></pre>
<p>向量和向量也可做運算，如</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">numvec1&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="co">## c(1,2,3)</span></a>
<a class="sourceLine" id="cb109-2" title="2">numvec2&lt;-<span class="dv">4</span><span class="op">:</span><span class="dv">6</span> <span class="co">## c(4,5,6)</span></a>
<a class="sourceLine" id="cb109-3" title="3">numvec1<span class="op">+</span>numvec2</a></code></pre></div>
<pre><code>## [1] 5 7 9</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">numvec1<span class="op">*</span>numvec2</a></code></pre></div>
<pre><code>## [1]  4 10 18</code></pre>
</div>
</div>
<div id="因子-factor" class="section level2">
<h2><span class="header-section-number">2.2</span> 因子 factor</h2>
<p>因子是由向量轉換而成，多用於表示<strong>類別</strong>數據，如大學中有大學生、碩士班學生與博士班學生三種類別的學生，使用方法為<code>factor(資料向量,levels=類別次序)</code>，<code>levels</code>參數可設定各類別的次序</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;大學生&quot;</span>,<span class="st">&quot;碩士班學生&quot;</span>,<span class="st">&quot;博士班學生&quot;</span>),</a>
<a class="sourceLine" id="cb113-2" title="2">       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;大學生&quot;</span>,<span class="st">&quot;碩士班學生&quot;</span>,<span class="st">&quot;博士班學生&quot;</span>))</a></code></pre></div>
<pre><code>## [1] 大學生     碩士班學生 博士班學生
## Levels: 大學生 碩士班學生 博士班學生</code></pre>
<p>因子變量一但決定其類別的種類與數目時，通常不會再作更動，也就是任何新增的元素都要是大學生、碩士班學生與博士班學生其中一種。</p>
</div>
<div id="列表-list" class="section level2">
<h2><span class="header-section-number">2.3</span> 列表 list</h2>
<p>由於向量和因子都只能儲存一種元素，使用上彈性較不足，在R語言中，有一彈性很大的資料型態<strong>列表list</strong>，在列表中，元素可分屬不同資料類別，除了可包括<strong>數值</strong>與<strong>文字</strong>外，也可以包括資料集，如<strong>向量</strong>和<strong>因子</strong>等，更進階的使用，還可以包括矩陣與資料框。如要建立列表，可使用<code>list()</code>函數</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">listSample&lt;-<span class="kw">list</span>(<span class="dt">Students=</span><span class="kw">c</span>(<span class="st">&quot;Tom&quot;</span>,<span class="st">&quot;Kobe&quot;</span>,<span class="st">&quot;Emma&quot;</span>,<span class="st">&quot;Amy&quot;</span>),<span class="dt">Year=</span><span class="dv">2017</span>,</a>
<a class="sourceLine" id="cb115-2" title="2">                 <span class="dt">Score=</span><span class="kw">c</span>(<span class="dv">60</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">40</span>),<span class="dt">School=</span><span class="st">&quot;CGU&quot;</span>)</a>
<a class="sourceLine" id="cb115-3" title="3">listSample</a></code></pre></div>
<pre><code>## $Students
## [1] &quot;Tom&quot;  &quot;Kobe&quot; &quot;Emma&quot; &quot;Amy&quot; 
## 
## $Year
## [1] 2017
## 
## $Score
## [1] 60 50 80 40
## 
## $School
## [1] &quot;CGU&quot;</code></pre>
<div id="列表資料擷取" class="section level3">
<h3><span class="header-section-number">2.3.1</span> 列表資料擷取</h3>
<p>列表可用<code>$</code>符號做資料擷取</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">listSample<span class="op">$</span>Students <span class="co">##取得中表中的Students變量</span></a></code></pre></div>
<pre><code>## [1] &quot;Tom&quot;  &quot;Kobe&quot; &quot;Emma&quot; &quot;Amy&quot;</code></pre>
<p>也可和向量一樣，使用索引值來擷取資料，和向量不同的是，若要取得<strong>值</strong>，要使用雙中括號<code>[[ ]]</code></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">listSample[[<span class="dv">1</span>]] <span class="co">##取得中表中第一個變量的值</span></a></code></pre></div>
<pre><code>## [1] &quot;Tom&quot;  &quot;Kobe&quot; &quot;Emma&quot; &quot;Amy&quot;</code></pre>
<p>如果只使用單中括號，回傳的資料型態會是列表list，並非列表中的值</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">listSample[<span class="dv">1</span>] <span class="co">##取得中表中第一個變量（列表型態）</span></a></code></pre></div>
<pre><code>## $Students
## [1] &quot;Tom&quot;  &quot;Kobe&quot; &quot;Emma&quot; &quot;Amy&quot;</code></pre>
</div>
<div id="列表資料編輯設定" class="section level3">
<h3><span class="header-section-number">2.3.2</span> 列表資料編輯設定</h3>
<p>列表資料也可和向量資料一樣，重新編輯設定</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">listSample[[<span class="dv">1</span>]] </a></code></pre></div>
<pre><code>## [1] &quot;Tom&quot;  &quot;Kobe&quot; &quot;Emma&quot; &quot;Amy&quot;</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">listSample[[<span class="dv">1</span>]]&lt;-<span class="kw">c</span>(<span class="st">&quot;小明&quot;</span>,<span class="st">&quot;大雄&quot;</span>,<span class="st">&quot;胖虎&quot;</span>,<span class="st">&quot;小新&quot;</span>,<span class="st">&quot;大白&quot;</span>) <span class="co">##將Students變量重新設定</span></a>
<a class="sourceLine" id="cb125-2" title="2">listSample[[<span class="dv">1</span>]] </a></code></pre></div>
<pre><code>## [1] &quot;小明&quot; &quot;大雄&quot; &quot;胖虎&quot; &quot;小新&quot; &quot;大白&quot;</code></pre>
<p>除了編輯以外，列表資料也能用<code>$</code>符號與<code>&lt;-</code>變數設定符號新增</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">listSample<span class="op">$</span>Gender&lt;-<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>) <span class="co">##新增Gender變量，並設定向量值</span></a></code></pre></div>
<p>若需刪除某變量，可將變量值設定為<code>NULL</code></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">listSample<span class="op">$</span>Score&lt;-<span class="ot">NULL</span> <span class="co">##刪除Score變量</span></a>
<a class="sourceLine" id="cb128-2" title="2">listSample</a></code></pre></div>
<pre><code>## $Students
## [1] &quot;小明&quot; &quot;大雄&quot; &quot;胖虎&quot; &quot;小新&quot; &quot;大白&quot;
## 
## $Year
## [1] 2017
## 
## $School
## [1] &quot;CGU&quot;
## 
## $Gender
## [1] &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot;</code></pre>
</div>
</div>
<div id="矩陣-matrix" class="section level2">
<h2><span class="header-section-number">2.4</span> 矩陣 matrix</h2>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">2</span>) <span class="co">##建立3x2的矩陣，分別填入1~6的值</span></a>
<a class="sourceLine" id="cb130-2" title="2">a</a></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
</div>
<div id="資料框-data.frame" class="section level2">
<h2><span class="header-section-number">2.5</span> 資料框 data.frame</h2>
<p>資料框是非常常見的二維資料格式，由一系列的欄位（Column）和列（Row）所組成，常見的Excel試算表也是類似的資料表現形式，可使用<code>data.frame()</code>來創建新的資料框</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">StuDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">StuID=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="co">##欄位名稱=欄位值</span></a>
<a class="sourceLine" id="cb132-2" title="2">                  <span class="dt">name=</span><span class="kw">c</span>(<span class="st">&quot;小明&quot;</span>,<span class="st">&quot;大雄&quot;</span>,<span class="st">&quot;胖虎&quot;</span>,<span class="st">&quot;小新&quot;</span>,<span class="st">&quot;大白&quot;</span>),</a>
<a class="sourceLine" id="cb132-3" title="3">                  <span class="dt">score=</span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">70</span>,<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb132-4" title="4">StuDF </a></code></pre></div>
<pre><code>##   StuID name score
## 1     1 小明    80
## 2     2 大雄    60
## 3     3 胖虎    90
## 4     4 小新    70
## 5     5 大白    50</code></pre>
<p>如範例所示，每個欄位都有名稱（StuID, name, score），若沒有設定欄位名稱，R會自動指派 V1 - Vn 作為欄位名稱。在R中，每個欄位的資料型態必須相同，如StuID和score為數值型態，name為文字型態。每一列也有預設的列名，R自動依序指派 1 - n 作為列名。
如需檢查欄位名稱與列名，可使用<code>colnames()</code>和<code>rownames()</code></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw">colnames</span>(StuDF) <span class="co">##欄位名稱</span></a></code></pre></div>
<pre><code>## [1] &quot;StuID&quot; &quot;name&quot;  &quot;score&quot;</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">rownames</span>(StuDF) <span class="co">##列名</span></a></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;</code></pre>
<p>如需檢查個欄位之資料型別，可使用<code>str()</code>函數</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="kw">str</span>(StuDF) </a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5 obs. of  3 variables:
##  $ StuID: num  1 2 3 4 5
##  $ name : Factor w/ 5 levels &quot;大白&quot;,&quot;大雄&quot;,..: 3 2 5 4 1
##  $ score: num  80 60 90 70 50</code></pre>
<p>資料框可用<code>$</code>符號做<strong>欄位</strong>資料擷取</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1">iris<span class="op">$</span>Species <span class="co">##取得iris資料框中的Species欄位</span></a></code></pre></div>
<pre><code>##   [1] setosa     setosa     setosa     setosa     setosa     setosa    
##   [7] setosa     setosa     setosa     setosa     setosa     setosa    
##  [13] setosa     setosa     setosa     setosa     setosa     setosa    
##  [19] setosa     setosa     setosa     setosa     setosa     setosa    
##  [25] setosa     setosa     setosa     setosa     setosa     setosa    
##  [31] setosa     setosa     setosa     setosa     setosa     setosa    
##  [37] setosa     setosa     setosa     setosa     setosa     setosa    
##  [43] setosa     setosa     setosa     setosa     setosa     setosa    
##  [49] setosa     setosa     versicolor versicolor versicolor versicolor
##  [55] versicolor versicolor versicolor versicolor versicolor versicolor
##  [61] versicolor versicolor versicolor versicolor versicolor versicolor
##  [67] versicolor versicolor versicolor versicolor versicolor versicolor
##  [73] versicolor versicolor versicolor versicolor versicolor versicolor
##  [79] versicolor versicolor versicolor versicolor versicolor versicolor
##  [85] versicolor versicolor versicolor versicolor versicolor versicolor
##  [91] versicolor versicolor versicolor versicolor versicolor versicolor
##  [97] versicolor versicolor versicolor versicolor virginica  virginica 
## [103] virginica  virginica  virginica  virginica  virginica  virginica 
## [109] virginica  virginica  virginica  virginica  virginica  virginica 
## [115] virginica  virginica  virginica  virginica  virginica  virginica 
## [121] virginica  virginica  virginica  virginica  virginica  virginica 
## [127] virginica  virginica  virginica  virginica  virginica  virginica 
## [133] virginica  virginica  virginica  virginica  virginica  virginica 
## [139] virginica  virginica  virginica  virginica  virginica  virginica 
## [145] virginica  virginica  virginica  virginica  virginica  virginica 
## Levels: setosa versicolor virginica</code></pre>
<p>資料框可用<code>$</code>符號做<strong>欄位</strong>資料擷取後，當成<strong>向量</strong>，並使用<strong><a href="#preface"></a></strong>做資料編輯。</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">iris<span class="op">$</span>Species[<span class="dv">2</span>]&lt;-<span class="st">&quot;versicolor&quot;</span></a>
<a class="sourceLine" id="cb142-2" title="2"><span class="kw">head</span>(iris<span class="op">$</span>Species)</a></code></pre></div>
<pre><code>## [1] setosa     versicolor setosa     setosa     setosa     setosa    
## Levels: setosa versicolor virginica</code></pre>
<p>若需刪除某欄位，可將欄位值設定為<code>NULL</code></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">iris<span class="op">$</span>Species&lt;-<span class="ot">NULL</span> <span class="co">##刪除Species欄位</span></a>
<a class="sourceLine" id="cb144-2" title="2"><span class="kw">head</span>(iris)</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1          5.1         3.5          1.4         0.2
## 2          4.9         3.0          1.4         0.2
## 3          4.7         3.2          1.3         0.2
## 4          4.6         3.1          1.5         0.2
## 5          5.0         3.6          1.4         0.2
## 6          5.4         3.9          1.7         0.4</code></pre>
</div>
<div id="資料表-data.table" class="section level2">
<h2><span class="header-section-number">2.6</span> 資料表 data.table</h2>
<p>data.table是data.frame資料框型別的延伸，如要使用必須安裝data.table <span class="citation">(Dowle and Srinivasan <a href="#ref-R-data.table" role="doc-biblioref">2019</a>)</span> package，使用<code>data.table</code>讀取大型資料的速度比使用資料框快上數倍，進階處理語言也相當好用，在探索式資料分析章節Chapter @ref(eda)會詳細介紹。其他詳細教學可見 Chapter @ref(datatable) ，DataCamp也提供<a href="https://www.datacamp.com/courses/data-table-data-manipulation-r-tutorial" target="_blank">互動式教學課程</a>，可自行參閱。</p>
</div>
<div id="資料屬性查詢函數" class="section level2">
<h2><span class="header-section-number">2.7</span> 資料屬性查詢函數</h2>
<p>資料屬性可透過下列函數查詢:</p>
<ul>
<li>名稱 <code>names()</code></li>
<li>各維度名稱 <code>dimnames()</code></li>
<li>長度 <code>length()</code></li>
<li>各維度長度 <code>dim()</code></li>
<li>資料型態 <code>class()</code></li>
<li>各類資料計數 <code>table()</code></li>
<li>總覽資料 <code>str()</code></li>
</ul>
<p>透過<code>names()</code>函數，可取得各種資料之名稱</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">head</span>(islands) <span class="co">##R內建的資料</span></a></code></pre></div>
<pre><code>##       Africa   Antarctica         Asia    Australia Axel Heiberg       Baffin 
##        11506         5500        16988         2968           16          184</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">head</span>(<span class="kw">names</span>(islands)) <span class="co">##顯示上述資料之資料名稱</span></a></code></pre></div>
<pre><code>## [1] &quot;Africa&quot;       &quot;Antarctica&quot;   &quot;Asia&quot;         &quot;Australia&quot;    &quot;Axel Heiberg&quot;
## [6] &quot;Baffin&quot;</code></pre>
<p>若為資料框，則會顯示行（欄位）名稱</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"><span class="kw">head</span>(USArrests) <span class="co">##R內建的資料</span></a></code></pre></div>
<pre><code>##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58   21
## Alaska       10.0     263       48   44
## Arizona       8.1     294       80   31
## Arkansas      8.8     190       50   20
## California    9.0     276       91   41
## Colorado      7.9     204       78   39</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">head</span>(<span class="kw">names</span>(USArrests)) <span class="co">##顯示上述資料之資料名稱</span></a></code></pre></div>
<pre><code>## [1] &quot;Murder&quot;   &quot;Assault&quot;  &quot;UrbanPop&quot; &quot;Rape&quot;</code></pre>
<p>透過<code>dimnames()</code>函數可顯示資料框列與行的名稱，先顯示列，再顯示行</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="kw">dimnames</span>(USArrests) </a></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;Alabama&quot;        &quot;Alaska&quot;         &quot;Arizona&quot;        &quot;Arkansas&quot;      
##  [5] &quot;California&quot;     &quot;Colorado&quot;       &quot;Connecticut&quot;    &quot;Delaware&quot;      
##  [9] &quot;Florida&quot;        &quot;Georgia&quot;        &quot;Hawaii&quot;         &quot;Idaho&quot;         
## [13] &quot;Illinois&quot;       &quot;Indiana&quot;        &quot;Iowa&quot;           &quot;Kansas&quot;        
## [17] &quot;Kentucky&quot;       &quot;Louisiana&quot;      &quot;Maine&quot;          &quot;Maryland&quot;      
## [21] &quot;Massachusetts&quot;  &quot;Michigan&quot;       &quot;Minnesota&quot;      &quot;Mississippi&quot;   
## [25] &quot;Missouri&quot;       &quot;Montana&quot;        &quot;Nebraska&quot;       &quot;Nevada&quot;        
## [29] &quot;New Hampshire&quot;  &quot;New Jersey&quot;     &quot;New Mexico&quot;     &quot;New York&quot;      
## [33] &quot;North Carolina&quot; &quot;North Dakota&quot;   &quot;Ohio&quot;           &quot;Oklahoma&quot;      
## [37] &quot;Oregon&quot;         &quot;Pennsylvania&quot;   &quot;Rhode Island&quot;   &quot;South Carolina&quot;
## [41] &quot;South Dakota&quot;   &quot;Tennessee&quot;      &quot;Texas&quot;          &quot;Utah&quot;          
## [45] &quot;Vermont&quot;        &quot;Virginia&quot;       &quot;Washington&quot;     &quot;West Virginia&quot; 
## [49] &quot;Wisconsin&quot;      &quot;Wyoming&quot;       
## 
## [[2]]
## [1] &quot;Murder&quot;   &quot;Assault&quot;  &quot;UrbanPop&quot; &quot;Rape&quot;</code></pre>
<p>透過<code>length()</code>函數可顯示資料長度，包括向量與資料框，若資料行態為資料框，則會顯示行（欄位）數</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="kw">length</span>(islands) </a></code></pre></div>
<pre><code>## [1] 48</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">length</span>(USArrests) </a></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>透過<code>dim()</code>函數可顯示資料框列與行的長度，與<code>dimnames()</code>相同，先顯示列，後顯示行</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1"><span class="kw">dim</span>(USArrests) </a></code></pre></div>
<pre><code>## [1] 50  4</code></pre>
<p>使用<code>class()</code>函數可知道變數類別</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">class</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="kw">class</span>(<span class="st">&quot;Test&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="kw">class</span>(<span class="kw">Sys.Date</span>())</a></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>使用<code>table()</code>函數可知道向量中每個值出現幾次</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1">iris<span class="op">$</span>Species <span class="co">##原始值</span></a></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="kw">table</span>(iris<span class="op">$</span>Species) <span class="co">##統計結果</span></a></code></pre></div>
<pre><code>## &lt; table of extent 0 &gt;</code></pre>
<p>使用<code>str()</code>函數可總覽變數資訊</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="kw">str</span>(iris)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  4 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">str</span>(listSample)</a></code></pre></div>
<pre><code>## List of 4
##  $ Students: chr [1:5] &quot;小明&quot; &quot;大雄&quot; &quot;胖虎&quot; &quot;小新&quot; ...
##  $ Year    : num 2017
##  $ School  : chr &quot;CGU&quot;
##  $ Gender  : chr [1:5] &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; ...</code></pre>
<!--chapter:end:02-data.Rmd-->
</div>
</div>
<div id="controlstructure" class="section level1">
<h1><span class="header-section-number">3</span> 控制流程</h1>
<div id="條件判斷" class="section level2">
<h2><span class="header-section-number">3.1</span> 條件判斷</h2>
<div id="if-else敘述" class="section level3">
<h3><span class="header-section-number">3.1.1</span> if-else敘述</h3>
<p><strong>if-else</strong>敘述使用在邏輯判斷，若需要依條件改變需要執行的程式碼，就會使用<strong>if-else</strong>，若<strong>if</strong>後所接邏輯判斷為<strong>真(TRUE)</strong>，就會執行if下方之程式碼，若為<strong>偽(FALSE)</strong>，則執行<strong>else</strong>下方之程式碼，若程式中沒有<strong>else</strong>片段，則不執行任何程式碼。
<img src="figure/ifelse.png" width="1000" /></p>
<p><code>if</code>與<code>else</code>下方的程式碼必須要使用<code>{}</code>將程式碼包起來，若程式碼只有一行，可省略<code>{}</code>，但為閱讀方便，建議不要省略<code>{}</code>。</p>
<p>舉例來說，若考試分數<strong>大於等於60分</strong>，則印出<strong>及格</strong>字樣，小於60分則印出<strong>不及格</strong>字樣，程式範例如下:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1">score&lt;-<span class="dv">59</span></a>
<a class="sourceLine" id="cb176-2" title="2"><span class="cf">if</span>(score<span class="op">&gt;=</span><span class="dv">60</span>){</a>
<a class="sourceLine" id="cb176-3" title="3">  <span class="kw">print</span>(<span class="st">&quot;及格&quot;</span>)</a>
<a class="sourceLine" id="cb176-4" title="4">}<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb176-5" title="5">  <span class="kw">print</span>(<span class="st">&quot;不及格&quot;</span>)</a>
<a class="sourceLine" id="cb176-6" title="6">}</a></code></pre></div>
<pre><code>## [1] &quot;不及格&quot;</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1">score&lt;-<span class="dv">80</span></a>
<a class="sourceLine" id="cb178-2" title="2"><span class="cf">if</span>(score<span class="op">&gt;=</span><span class="dv">60</span>){</a>
<a class="sourceLine" id="cb178-3" title="3">  <span class="kw">print</span>(<span class="st">&quot;及格&quot;</span>)</a>
<a class="sourceLine" id="cb178-4" title="4">}<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb178-5" title="5">  <span class="kw">print</span>(<span class="st">&quot;不及格&quot;</span>)</a>
<a class="sourceLine" id="cb178-6" title="6">}</a></code></pre></div>
<pre><code>## [1] &quot;及格&quot;</code></pre>
</div>
<div id="if-else-if-else" class="section level3">
<h3><span class="header-section-number">3.1.2</span> if-else if-else</h3>
<p>很多時候必須要使用多重邏輯判斷，若考試分數大於等於90分，印出<strong>優良</strong>，介於60到90分間，印出<strong>及格</strong>，小於60分則印出<strong>不及格</strong>，此時就會用到多重邏輯，使用多重邏輯時，會在<code>if</code>和<code>else</code>間新增邏輯區段<strong>else if</strong>，程式範例如下:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1">score&lt;-<span class="dv">95</span></a>
<a class="sourceLine" id="cb180-2" title="2"><span class="cf">if</span>(score<span class="op">&gt;=</span><span class="dv">90</span>){</a>
<a class="sourceLine" id="cb180-3" title="3">  <span class="kw">print</span>(<span class="st">&quot;優秀&quot;</span>)</a>
<a class="sourceLine" id="cb180-4" title="4">}<span class="cf">else</span> <span class="cf">if</span>(score<span class="op">&gt;=</span><span class="dv">60</span>){</a>
<a class="sourceLine" id="cb180-5" title="5">  <span class="kw">print</span>(<span class="st">&quot;及格&quot;</span>)</a>
<a class="sourceLine" id="cb180-6" title="6">}<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb180-7" title="7">  <span class="kw">print</span>(<span class="st">&quot;不及格&quot;</span>)</a>
<a class="sourceLine" id="cb180-8" title="8">}</a></code></pre></div>
<pre><code>## [1] &quot;優秀&quot;</code></pre>
<p><code>if-else if-else</code>敘述是有順序的，若在<code>if</code>敘述判斷為真，就算後方<code>else if</code>判斷也為真，也只會執行<code>if</code>區段的程式碼，如上述範例，95分大於等於90分(if邏輯)，也大於等於60分(else if邏輯)，但最後只印出<strong>優秀</strong>字樣。</p>
<p>###巢狀if
巢狀if是指在<code>if</code>區段程式碼內包含其他<code>if-else</code>判斷，舉例來說，若國文分數與英文分數皆大於等於60分，印出<strong>全部及格</strong>，國文分數大於等於60分，英文小於60分，則印<strong>國文及格，英文再加油</strong>，以此類推，程式範例如下:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1">CHscore&lt;-<span class="dv">95</span> <span class="co">##國文成績</span></a>
<a class="sourceLine" id="cb182-2" title="2">ENscore&lt;-<span class="dv">55</span> <span class="co">##英文成績</span></a>
<a class="sourceLine" id="cb182-3" title="3"><span class="cf">if</span>(CHscore<span class="op">&gt;=</span><span class="dv">60</span>){</a>
<a class="sourceLine" id="cb182-4" title="4">  <span class="cf">if</span>(ENscore<span class="op">&gt;=</span><span class="dv">60</span>){</a>
<a class="sourceLine" id="cb182-5" title="5">    <span class="kw">print</span>(<span class="st">&quot;全部及格&quot;</span>)</a>
<a class="sourceLine" id="cb182-6" title="6">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb182-7" title="7">    <span class="kw">print</span>(<span class="st">&quot;國文及格，英文再加油&quot;</span>)</a>
<a class="sourceLine" id="cb182-8" title="8">  }</a>
<a class="sourceLine" id="cb182-9" title="9">}<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb182-10" title="10">  <span class="cf">if</span>(ENscore<span class="op">&gt;=</span><span class="dv">60</span>){</a>
<a class="sourceLine" id="cb182-11" title="11">    <span class="kw">print</span>(<span class="st">&quot;英文及格，國文再加油&quot;</span>)</a>
<a class="sourceLine" id="cb182-12" title="12">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb182-13" title="13">    <span class="kw">print</span>(<span class="st">&quot;全部不及格&quot;</span>)</a>
<a class="sourceLine" id="cb182-14" title="14">  }</a>
<a class="sourceLine" id="cb182-15" title="15">}</a></code></pre></div>
<pre><code>## [1] &quot;國文及格，英文再加油&quot;</code></pre>
<p>###ifelse()
<code>ifelse()</code>函數可用最短的方式取代<code>if-else</code>敘述，使用方法為<code>ifelse(邏輯判斷,判斷為真要執行的程式碼,判斷為偽要執行的程式碼)</code>，依上述範例，重寫程式碼如下:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1">score&lt;-<span class="dv">80</span></a>
<a class="sourceLine" id="cb184-2" title="2"><span class="kw">ifelse</span>(score<span class="op">&gt;=</span><span class="dv">60</span>,<span class="st">&quot;及格&quot;</span>,<span class="st">&quot;不及格&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;及格&quot;</code></pre>
<p>值得注意的是，<code>ifelse()</code>可判斷向量，也就是可一次<strong>判斷多個元素</strong></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" title="1">scoreVector&lt;-<span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">90</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">80</span>)</a>
<a class="sourceLine" id="cb186-2" title="2"><span class="kw">ifelse</span>(scoreVector<span class="op">&gt;=</span><span class="dv">60</span>,<span class="st">&quot;及格&quot;</span>, <span class="st">&quot;不及格&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;不及格&quot; &quot;及格&quot;   &quot;不及格&quot; &quot;及格&quot;   &quot;及格&quot;</code></pre>
<p>##迴圈</p>
<p>###for
R語言的<code>for</code>迴圈寫法和其他語言不同，首先必須建立需要逐一執行的參數向量或序列，再使用<code>for</code>迴圈逐一執行，程式寫法為<code>for (單一變數 in 參數向量){ 程式碼 }</code>，範例如下:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1"><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){ <span class="co">#n為單一變數，1:10為需要逐一執行的參數向量</span></a>
<a class="sourceLine" id="cb188-2" title="2">  <span class="kw">print</span>(n)</a>
<a class="sourceLine" id="cb188-3" title="3">}</a></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<p><code>for</code>迴圈也可和<code>if-else</code>函數合併使用，如:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1"><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb190-2" title="2">  <span class="cf">if</span>(n<span class="op">%%</span><span class="dv">2</span><span class="op">==</span><span class="dv">0</span>){ <span class="co">#偶數直接輸出數字</span></a>
<a class="sourceLine" id="cb190-3" title="3">    <span class="kw">print</span>(n)</a>
<a class="sourceLine" id="cb190-4" title="4">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb190-5" title="5">    <span class="kw">print</span>(<span class="st">&quot;奇數&quot;</span>) <span class="co">#奇數則輸出&quot;奇數&quot;</span></a>
<a class="sourceLine" id="cb190-6" title="6">  }</a>
<a class="sourceLine" id="cb190-7" title="7">}</a></code></pre></div>
<pre><code>## [1] &quot;奇數&quot;
## [1] 2
## [1] &quot;奇數&quot;
## [1] 4
## [1] &quot;奇數&quot;
## [1] 6
## [1] &quot;奇數&quot;
## [1] 8
## [1] &quot;奇數&quot;
## [1] 10</code></pre>
<p>###while
<code>while</code>函數則是在每次執行迴圈時檢查while邏輯判斷是否為真，若邏輯判斷為真，就會執行區段程式碼，若邏輯判斷為偽，則會結束迴圈執行。</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" title="1">x&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb192-2" title="2"><span class="cf">while</span>(x<span class="op">&lt;=</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb192-3" title="3">  <span class="kw">print</span>(x)</a>
<a class="sourceLine" id="cb192-4" title="4">  x&lt;-x<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb192-5" title="5">}</a></code></pre></div>
<pre><code>## [1] 0
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5</code></pre>
<p>###break
若遇特殊情形想<strong>結束</strong>迴圈執行，可使用<code>break</code>指令</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" title="1"><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb194-2" title="2">  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb194-3" title="3">    <span class="cf">break</span> <span class="co">##一執行到5，跳出迴圈，不再執行之後的迴圈</span></a>
<a class="sourceLine" id="cb194-4" title="4">  }</a>
<a class="sourceLine" id="cb194-5" title="5">  <span class="kw">print</span>(n)</a>
<a class="sourceLine" id="cb194-6" title="6">}</a></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4</code></pre>
<p>###next
若遇特殊情形想<strong>跳過</strong>迴圈執行，可使用<code>next</code>指令</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" title="1"><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb196-2" title="2">  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb196-3" title="3">    <span class="cf">next</span> <span class="co">##跳過5，直接執行下一個迴圈</span></a>
<a class="sourceLine" id="cb196-4" title="4">  }</a>
<a class="sourceLine" id="cb196-5" title="5">  <span class="kw">print</span>(n)</a>
<a class="sourceLine" id="cb196-6" title="6">}</a></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 6
## [1] 7
## [1] 8
## [1] 9
## [1] 10</code></pre>
<p>##purrr
better than sapply() and lapply()</p>
<!--chapter:end:03-controlstructure.Rmd-->
</div>
</div>
</div>
<div id="function" class="section level1">
<h1><span class="header-section-number">4</span> 函數</h1>
<p><strong>撰寫中</strong></p>
<p>如果同一段程式碼已經被剪下貼上兩次，那就是寫一個函式(Function)的時機。</p>
<p>函數包含四個重要的部分:</p>
<ul>
<li>名字</li>
<li>參數</li>
<li>程式碼本體</li>
<li>回傳值</li>
</ul>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1">名字&lt;-<span class="cf">function</span>(參數1,參數2,...){</a>
<a class="sourceLine" id="cb198-2" title="2">  程式碼本體</a>
<a class="sourceLine" id="cb198-3" title="3">  最後一行的輸出自動設為回傳值</a>
<a class="sourceLine" id="cb198-4" title="4">}</a></code></pre></div>
<p>寫函數的四個步驟:</p>
<ul>
<li>先寫出可以用的程式碼</li>
<li>將程式碼內可以重複使用的部分指派給臨時變數</li>
<li>其餘程式碼用臨時變數表示，讓程式碼變簡潔</li>
<li>把程式碼變成函數function</li>
</ul>
<p>寫好的函數的方法:</p>
<ul>
<li>正確</li>
<li>容易閱讀與理解</li>
</ul>
<p>函數命名原則:</p>
<ul>
<li>長的函數名稱要遵循一樣的命名樣式</li>
<li>不要用原本就存在R中的函數名稱</li>
<li>可以被理解的名稱，通常是<strong>動詞</strong></li>
</ul>
<p>參數命名原則:</p>
<ul>
<li>可以被理解的名稱</li>
<li>通常是<strong>名詞</strong></li>
<li>輸入資料參數通常放在第一個</li>
<li>其他設定值通常會設定預設值</li>
</ul>
<!--chapter:end:04-function.Rmd-->
</div>
<div id="io" class="section level1">
<h1><span class="header-section-number">5</span> 資料讀取與匯出</h1>
<p>資料(Data)在<a href="http://en.wikipedia.org/wiki/Data" target="_blank">維基百科</a>的定義是<code>values of qualitative or quantitative variables, belonging to a set of items.</code>，一般來說，在資料分析前會經過多個步驟，包括<strong>資料匯入</strong>Chapter @ref(io)、<strong>資料清洗處理</strong>Chapter @ref(manipulation)並轉換為Tidy data、<strong>資料分析</strong>Chapter @ref(eda)、<strong>資料呈現與視覺化</strong>Chapter @ref(vis)。</p>
<p>資料有多種可能來源，包括:</p>
<ul>
<li>硬碟</li>
<li>網路下載</li>
<li>Open Data (API)</li>
<li>網頁裡 (爬蟲！)</li>
<li>任何地方</li>
</ul>
<p>以下介紹由檔案、網路等來源匯入多種資料格式的匯入方式，以及建議的資料匯出方法。</p>
<p>##從檔案匯入基本資料格式 {#file}</p>
<p>###Import Dataset功能 (RStudio)
<a href="https://www.rstudio.com/" target="_blank">RStudio</a> 1.0版後即提供很好的資料匯入介面，使用者可以不用撰寫任何程式碼，就能完成<code>.csv</code>、<code>Excel</code>以及<code>SAS</code>等檔案匯入。首先選取RStudio四分割視窗右上角的Environment標籤，選擇<strong>Import Dataset</strong>，就會出現檔案格式的選項</p>
<p><img src="figure/import.png" width="592" /></p>
<p>以csv檔案為例，在選單中選取<code>From CSV</code>，選取後會跳出資料匯入輔助視窗，點選<code>Browse</code>按鈕開啟檔案選取器，並點選欲匯入之文字檔案</p>
<p><img src="figure/csv.png" width="497" /></p>
<p>檔案選取後，資料匯入輔助視窗有預覽功能，供使用者檢查資料匯入方法是否正確，若需調整各項參數，可利用下方<code>Import Options</code>的選項微調，最常用的調整功能是<code>Delimiter</code>分隔符號與<code>First Row as Names</code>首列是否為欄位名稱。</p>
<p><img src="figure/csv2.png" width="960" /></p>
<p>如果要匯入的檔案為<strong>tab分隔文字檔</strong>，一樣可以選擇<code>.csv</code>選項，再修改<code>Delimiter</code>參數為<code>Tab</code>即可。</p>
<p>資料匯入輔助視窗右下方<code>Code Preview:</code>子視窗中會自動產生資料匯入程式碼，如果未來想再使用視窗匯入，希望透過程式碼匯入，可以將此段程式碼複製貼上到R程式碼檔案(.R)，供後續分析使用。</p>
<p>###分隔文字檔 .txt
<code>readr</code> <span class="citation">(Wickham, Hester, and Francois <a href="#ref-R-readr" role="doc-biblioref">2018</a>)</span> package提供完整的文字檔讀取功能，各讀取函數的第一個參數通常為<strong>檔案路徑與名稱</strong>，<code>read_delim()</code>函數可用來讀取所有用分隔符號分隔的文字檔案，以tab分隔為例，只需將<code>delim</code>參數設定為<code>\t</code>，即可用tab將各欄位分開讀取。此外，<code>col_names</code>參數也常被使用，TRUE代表資料內有包含欄位名稱(通常在首列)，預設為TRUE，如果設定為FALSE，欄位名稱則會依順序被設定為 X1, X2, X3 …。</p>
<p>參數整理如下 (可用?read_delim指令閱讀官方說明)：</p>
<ul>
<li><code>file</code>, 檔名</li>
<li><code>delim</code>, 分隔符號</li>
<li><code>quote</code>, 把欄位包起來的符號</li>
<li><code>escape_backslash</code>, 預設FALSE，是否用/作為逃脫符號</li>
<li><code>escape_double</code>, 預設TRUE，是否用quote符號作為逃脫符號</li>
<li><code>col_names</code>, 是否有欄位名稱（表頭）（T/F）</li>
<li><code>col_types</code>, 每一個欄位的類別，用向量表示</li>
<li><code>comment</code>, 備註標示符號，在備註標示符號之後的文字不會被讀入</li>
<li><code>skip</code>, 要跳過幾行？</li>
</ul>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb199-2" title="2">dataset &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;檔案路徑與名稱&quot;</span>, <span class="dt">delim=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a></code></pre></div>
<p>###CSV檔案 .csv {#csv}
<code>readr</code> <span class="citation">(Wickham, Hester, and Francois <a href="#ref-R-readr" role="doc-biblioref">2018</a>)</span> package也提供CSV (逗號分隔)檔案的讀取功能，<code>read_csv()</code></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb200-2" title="2">dataset &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;檔案路徑與名稱&quot;</span>)</a></code></pre></div>
<p>###Excel檔案 .xls
<code>readxl</code> <span class="citation">(Wickham and Bryan <a href="#ref-R-readxl" role="doc-biblioref">2019</a>)</span> package提供讀取Excel檔案 (xls, xlsx)的函數<code>read_excel()</code>，除了常用的<code>col_names</code>參數外，也可使用<code>sheet</code>參數設定要讀取的工作表(sheet)</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb201-2" title="2">dataset &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;檔案路徑與名稱&quot;</span>)</a></code></pre></div>
<p>###R物件 .rds
R物件有檔案小與讀取快速的優點，如果在R程式處理資料後必須儲存一份以供後續分析的話，使用R物件儲存是最佳的方式，讀取R物件有多種函數可供選擇，推薦使用<code>readRDS()</code>函數 (參考資料:<a href="http://www.fromthebottomoftheheap.net/2012/04/01/saving-and-loading-r-objects/" target="_blank">A better way of saving and loading objects in R</a>)</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1">dataset &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;檔案路徑與名稱&quot;</span>)</a></code></pre></div>
<p>###R程式 .R
<code>source</code>, 讀R的Obejct or script, 執行, ASCII (<code>dump</code>的相反)</p>
<div id="純文字資料-無分隔" class="section level3">
<h3><span class="header-section-number">5.0.1</span> 純文字資料 (無分隔)</h3>
<p><code>readLines</code>, 逐行讀取文字資料</p>
<p>###其他格式
透過載入套件，R可讀入許多其他格式的檔案:</p>
<ul>
<li>MySQL <code>RMySQL</code></li>
<li>HDF5 <code>rhdf5</code></li>
<li>Weka <code>foreign</code></li>
<li>Stata <code>foreign</code></li>
<li>SPSS <code>Hmisc</code></li>
<li>SAS <code>Hmisc</code></li>
<li>GIS <code>rgdal</code></li>
<li>Images <code>jpeg</code></li>
<li>Music <code>tuneR</code></li>
</ul>
</div>
<div id="其他讀檔注意事項" class="section level3">
<h3><span class="header-section-number">5.0.2</span> 其他讀檔注意事項</h3>
<p>讀檔的時候R會自動</p>
<ul>
<li>跳過#開頭的任何行（Row）</li>
<li>判斷要讀幾行</li>
<li>判斷每個列（Column）的類別</li>
<li>把欄位包起來的符號</li>
</ul>
<p>如果讀取時已指定<strong>Column類別</strong>以及<strong>把欄位包起來的符號</strong>，讀取速度會快很多。</p>
<p>##從網路匯入資料
### Open Data
<strong>開放資料</strong> (Open data) 指的是一種經過挑選與許可的資料，這些資料不受著作權、專利權，以及其他管理機制所限制，可以開放給社會公眾，任何人都可以自由出版使用，不論是要拿來出版或是做其他的運用都不加以限制。Open data 運動希望達成的目標與開放原始碼、內容開放、開放獲取等其他「開放」運動類似。Open data 背後的核心思想由來已，但 Open data 這名詞直到近代才出現，拜網際網路崛起而為人所知，尤其是 Data.gov 等 Open data 政府組織的設立。(<a href="https://zh.wikipedia.org/wiki/%E9%96%8B%E6%94%BE%E8%B3%87%E6%96%99" target="_blank">維基百科</a>)</p>
<p>台灣政府從2011年開始大力推動開放政府與開放資料的概念，多個機關與縣市政府架設開放資料平台，供民眾擷取或再利用各項資料</p>
<ul>
<li><a href="http://data.gov.tw/" target="_blank">政府資料開放平台</a></li>
<li><a href="http://data.taipei/" target="_blank">Data Taipei</a></li>
<li><a href="http://data.tycg.gov.tw/" target="_blank">開放資料 x 開放桃園</a></li>
<li><a href="http://data.moi.gov.tw/" target="_blank">內政資料開放平台</a></li>
</ul>
<p>Open Data常見的儲存方式為: <code>CSV</code>Chapter @ref(csv)、<code>JSON</code>Chapter @ref(json)、<code>XML</code>Chapter @ref(xml)，開放資料網站通常有提供民眾<strong>直接下載</strong>檔案的服務，針對可下載的CSV格式資料，可以下載完成後，透過上述<strong>由檔案匯入資料</strong> Chapter @ref(file)方法匯入即可。</p>
</div>
<div id="api" class="section level3">
<h3><span class="header-section-number">5.0.3</span> API (Application programming interfaces)</h3>
<p>應用程式介面 Application programming interfaces (API) 通常是特定軟體、程序或系統，廠商或開發人員，為了能夠讓第三方的開發者可以額外開發應用程式來強化他們的產品，所推出可以與他們系統溝通的介面。(<a href="https://zh.wikipedia.org/zh-tw/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3" target="_blank">維基百科</a>)</p>
<p>以下載Open Data為例，若檔案更新頻繁，使用手動下載相當耗時。如<a href="http://data.taipei/opendata/datalist/datasetMeta?oid=6a3e862a-e1cb-4e44-b989-d35609559463" target="_blank">臺北市開放認養動物</a>資料，更新頻率為每日，所以許多開放資料也提供透過<strong>API</strong>下載的服務，透過API下載的資料格式會是JSON格式Chapter @ref(json)，如<a href="http://data.taipei/opendata/datalist/datasetMeta/outboundDesc?id=6a3e862a-e1cb-4e44-b989-d35609559463&amp;rid=f4a75ba9-7721-4363-884d-c3820b0b917c" target="_blank">臺北市開放認養動物API資訊</a>所示，開放資料網站會提供<strong>資料集ID</strong>與<strong>資料RID</strong></p>
<ul>
<li><strong>資料集ID</strong>: 紀錄資料的基本參數，如包含欄位、更新頻率等</li>
<li><strong>資料RID</strong>: 資料集</li>
</ul>
<p>並同時提供擷取範例，如果需要下載原始資料，可直接從範例複製貼上即可，如http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&amp;rid=f4a75ba9-7721-4363-884d-c3820b0b917c</p>
<p>###JSON格式檔案 {#json}
JSON (<strong>J</strong>ava<strong>s</strong>cript <strong>O</strong>bject <strong>N</strong>otation)是一種輕量級的資料交換語言 (<a href="http://en.wikipedia.org/wiki/JSON" target="_blank">Wiki</a>)，特色如下:</p>
<ul>
<li>from <strong>a</strong>pplication <strong>p</strong>rogramming <strong>i</strong>nterfaces (APIs)</li>
<li>JavaScript、Java、Node.js應用</li>
<li>一些NoSQL非關連型資料庫用JSON儲存資料：<strong>MongoDB</strong></li>
<li>資料儲存格式
<ul>
<li>Numbers (double)</li>
<li>Strings (double quoted)</li>
<li>Boolean (<em>true</em> or <em>false</em>)</li>
<li>Array (ordered, comma separated enclosed in square brackets <em><a href="#preface"></a></em>)</li>
<li>Object (unorderd, comma separated collection of <strong>key:value</strong> pairs in curley brackets <em>{}</em>)</li>
</ul></li>
</ul>
<p><a href="https://api.github.com/users/yijutseng/repos" target="_blank">JSON檔案範例</a></p>
<p>許多Open Data也用JSON格式儲存，例如<a href="http://data.taipei/opendata/datalist/datasetMeta?oid=6a3e862a-e1cb-4e44-b989-d35609559463" target="_blank">臺北市開放認養動物</a>資料，根據資料的API資訊，可得資料擷取網址http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&amp;rid=f4a75ba9-7721-4363-884d-c3820b0b917c 。</p>
<p>將JSON檔案匯入R可以使用<code>jsonlite</code><span class="citation">(Ooms, Temple Lang, and Hilaiel <a href="#ref-R-jsonlite" role="doc-biblioref">2018</a>)</span> package，套件使用前必須安裝，安裝套件方法請參考Chapter @ref(intro)，載入後，可使用<code>fromJSON()</code>函數載入JSON資料。
如API網址為<strong>httr</strong>類別，需要載入<code>httr</code><span class="citation">(<span class="citeproc-not-found" data-reference-id="httr"><strong>???</strong></span>)</span> package，並使用<code>GET()</code>函數處理資料擷取網址。</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1">PetData&lt;-jsonlite<span class="op">::</span><span class="kw">fromJSON</span>(<span class="st">&quot;http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&amp;rid=f4a75ba9-7721-4363-884d-c3820b0b917c&quot;</span>)</a>
<a class="sourceLine" id="cb203-2" title="2"><span class="kw">str</span>(PetData)</a></code></pre></div>
<pre><code>## List of 1
##  $ result:List of 5
##   ..$ limit  : int 1000
##   ..$ offset : int 0
##   ..$ count  : int 365
##   ..$ sort   : chr &quot;&quot;
##   ..$ results:&#39;data.frame&#39;:  365 obs. of  20 variables:
##   .. ..$ AcceptNum      : chr [1:365] &quot;106060601&quot; &quot;106060401&quot; &quot;106060210&quot; &quot;106060207&quot; ...
##   .. ..$ IsSterilization: chr [1:365] &quot;未絕育&quot; &quot;已絕育&quot; &quot;未絕育&quot; &quot;未絕育&quot; ...
##   .. ..$ Name           : chr [1:365] &quot;&quot; &quot;&quot; &quot;俊俊&quot; &quot;小莊&quot; ...
##   .. ..$ Variety        : chr [1:365] &quot;米克斯&quot; &quot;米克斯&quot; &quot;米克斯&quot; &quot;米克斯&quot; ...
##   .. ..$ Age            : chr [1:365] &quot;成年&quot; &quot;成年&quot; &quot;成年&quot; &quot;成年&quot; ...
##   .. ..$ ChildreAnlong  : chr [1:365] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##   .. ..$ Resettlement   : chr [1:365] &quot;臺北市動物之家 收容編號106060601&quot; &quot;&quot; &quot;臺北市動物之家 收容編號106060210&quot; &quot;臺北市動物之家 收容編號106060207&quot; ...
##   .. ..$ Sex            : chr [1:365] &quot;雄&quot; &quot;雌&quot; &quot;雄&quot; &quot;雄&quot; ...
##   .. ..$ Note           : chr [1:365] &quot;左剪耳 輕微脫水 精神食慾不佳&quot; &quot;&quot; &quot;嗨~~我的名字叫俊俊，希望帥氣的我可以受您的青睞，快來動物之家看看我吧!\n&quot; &quot;哈囉~我的名字叫小莊，目前我在動物之家生活，希望能快快找到，願意認養我的人來帶我回家!!\n&quot; ...
##   .. ..$ Phone          : chr [1:365] &quot;02-87913063&quot; &quot;&quot; &quot;02-87913062&quot; &quot;02-87913062&quot; ...
##   .. ..$ Reason         : chr [1:365] &quot;民眾不擬續養&quot; &quot;民眾不擬續養&quot; &quot;動物管制&quot; &quot;動物管制&quot; ...
##   .. ..$ ImageName      : chr [1:365] &quot;http://163.29.39.183/uploads/images/medium/c0f66294-143c-4406-8714-2e6764352b13.jpg&quot; &quot;http://163.29.39.183/uploads/images/medium/4ffa231f-3108-43c1-8ccf-b8578bdf1e1a.jpg&quot; &quot;http://163.29.39.183/uploads/images/medium/e68771df-747e-4544-846a-bdd6099e7f90.jpg&quot; &quot;http://163.29.39.183/uploads/images/medium/fd75d049-5310-4016-b1f4-71d69c4a9912.jpg&quot; ...
##   .. ..$ HairType       : chr [1:365] &quot;虎斑白&quot; &quot;黃白&quot; &quot;黃白&quot; &quot;黃&quot; ...
##   .. ..$ Build          : chr [1:365] &quot;中&quot; &quot;中&quot; &quot;中&quot; &quot;中&quot; ...
##   .. ..$ AnimalAnlong   : chr [1:365] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##   .. ..$ ChipNum        : chr [1:365] &quot;900073000086900&quot; &quot;900073000086481&quot; &quot;&quot; &quot;&quot; ...
##   .. ..$ _id            : int [1:365] 1 2 3 4 5 6 7 8 9 10 ...
##   .. ..$ Type           : chr [1:365] &quot;貓&quot; &quot;貓&quot; &quot;貓&quot; &quot;貓&quot; ...
##   .. ..$ Email          : chr [1:365] &quot;tcapoa8@mail.taipei.gov.tw&quot; &quot;&quot; &quot;tcapoa8@mail.taipei.gov.tw&quot; &quot;tcapoa8@mail.taipei.gov.tw&quot; ...
##   .. ..$ Bodyweight     : chr [1:365] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...</code></pre>
<p>由資料結構可知，經過<code>fromJSON()</code>函數匯入的JSON檔案被轉存為<code>列表list</code>的型態，且在result元素中包含五個子元素(offset, limit, count, sort, results)，其中，results子元素的類別為資料框data.frame，內含開放認養動物清單，因此，可使用<code>$</code>符號截取元素與子元素</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1"><span class="kw">head</span>(PetData<span class="op">$</span>result<span class="op">$</span>results)</a></code></pre></div>
<pre><code>##   AcceptNum IsSterilization Name Variety  Age ChildreAnlong
## 1 106060601          未絕育       米克斯 成年              
## 2 106060401          已絕育       米克斯 成年              
## 3 106060210          未絕育 俊俊  米克斯 成年              
## 4 106060207          未絕育 小莊  米克斯 成年              
## 5 106060203          未絕育 好橙  米克斯 成年              
## 6 106053107          未絕育 歐雅  米克斯 年輕              
##                       Resettlement Sex
## 1 臺北市動物之家 收容編號106060601  雄
## 2                                   雌
## 3 臺北市動物之家 收容編號106060210  雄
## 4 臺北市動物之家 收容編號106060207  雄
## 5 臺北市動物之家 收容編號106060203  雄
## 6 臺北市動物之家 收容編號106053107  雌
##                                                                                      Note
## 1                                                            左剪耳 輕微脫水 精神食慾不佳
## 2                                                                                        
## 3                 嗨~~我的名字叫俊俊，希望帥氣的我可以受您的青睞，快來動物之家看看我吧!\n
## 4 哈囉~我的名字叫小莊，目前我在動物之家生活，希望能快快找到，願意認養我的人來帶我回家!!\n
## 5                    嗨~我的名字叫好橙，害羞的我想要一個溫暖的家，您可以給我這個機會嗎?\n
## 6            大家好~我的名字叫歐雅，我的個性緊張，想帶我回家，要有耐心陪伴我渡過適應期唷!
##         Phone       Reason
## 1 02-87913063 民眾不擬續養
## 2             民眾不擬續養
## 3 02-87913062     動物管制
## 4 02-87913062     動物管制
## 5 02-87913062     動物管制
## 6 02-87913062     動物管制
##                                                                             ImageName
## 1 http://163.29.39.183/uploads/images/medium/c0f66294-143c-4406-8714-2e6764352b13.jpg
## 2 http://163.29.39.183/uploads/images/medium/4ffa231f-3108-43c1-8ccf-b8578bdf1e1a.jpg
## 3 http://163.29.39.183/uploads/images/medium/e68771df-747e-4544-846a-bdd6099e7f90.jpg
## 4 http://163.29.39.183/uploads/images/medium/fd75d049-5310-4016-b1f4-71d69c4a9912.jpg
## 5 http://163.29.39.183/uploads/images/medium/2f750fef-b696-4595-8fbf-cc6adf8f72d5.jpg
## 6 http://163.29.39.183/uploads/images/medium/1c293e5e-99db-466e-a156-ff33fef368b4.jpg
##   HairType Build AnimalAnlong         ChipNum _id Type
## 1   虎斑白    中              900073000086900   1   貓
## 2     黃白    中              900073000086481   2   貓
## 3     黃白    中                                3   貓
## 4       黃    中                                4   貓
## 5       黃    中                                5   貓
## 6       黑    中                                6   貓
##                        Email Bodyweight
## 1 tcapoa8@mail.taipei.gov.tw           
## 2                                      
## 3 tcapoa8@mail.taipei.gov.tw           
## 4 tcapoa8@mail.taipei.gov.tw           
## 5 tcapoa8@mail.taipei.gov.tw           
## 6 tcapoa8@mail.taipei.gov.tw</code></pre>
<p>results資料框中包含20個欄位，可以像分析資料框一樣，針對此資料框做分析，舉例來說，可分析各項<strong>開放認養理由</strong>出現次數</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="kw">table</span>(PetData<span class="op">$</span>result<span class="op">$</span>results<span class="op">$</span>Reason)</a></code></pre></div>
<pre><code>## 
##              民眾不擬續養     民眾拾獲     動物救援     動物管制 
##           28           50           23          109          155</code></pre>
<p>分析可知開放認養理由以動物管制與未填寫居多。</p>
<p>如果需要將資料框轉換成JSON檔案可以使用<code>jsonlite</code> package所提供的<code>toJSON()</code>函數。</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">myjson &lt;-<span class="st"> </span>jsonlite<span class="op">::</span><span class="kw">toJSON</span>(iris, <span class="dt">pretty=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb209-2" title="2"><span class="kw">str</span>(myjson)</a></code></pre></div>
<pre><code>##  &#39;json&#39; chr &quot;[\n  {\n    \&quot;Sepal.Length\&quot;: 5.1,\n    \&quot;Sepal.Width\&quot;: 3.5,\n    \&quot;Petal.Length\&quot;: 1.4,\n    \&quot;Petal.Width\&quot;:&quot;| __truncated__</code></pre>
</div>
<div id="xml" class="section level3">
<h3><span class="header-section-number">5.0.4</span> XML 可延伸標記式語言</h3>
<ul>
<li>E<strong>x</strong>tensible <strong>m</strong>arkup <strong>l</strong>anguage</li>
<li>描述<strong>結構化</strong>資料的語言</li>
<li>處理XML檔案是網頁<strong>Html</strong>爬蟲的基礎</li>
<li>Components
<ul>
<li>Markup 標記 - labels that give the text structure</li>
<li>Content 內文 - the actual text of the document</li>
</ul></li>
<li><a href="https://zh.wikipedia.org/wiki/XML" target="_blank">XML Wiki</a></li>
</ul>
<p>Tags, elements and attributes</p>
<ul>
<li>Tags correspond to general labels
<ul>
<li>Start tags <code>&lt;breakfast_menu&gt;</code>, <code>&lt;price&gt;</code></li>
<li>End tags <code>&lt;/breakfast_menu&gt;</code>,<code>&lt;/price&gt;</code></li>
<li>Empty tags <code>&lt;line-break /&gt;</code></li>
</ul></li>
<li>Elements are specific examples of tags
<ul>
<li><code>&lt;name&gt;Belgian Waffles&lt;/name&gt;</code></li>
</ul></li>
<li>Attributes are components of the label
<ul>
<li><code>&lt;book category="web"&gt;</code></li>
</ul></li>
</ul>
<p>許多Open Data也用XML格式儲存，例如<a href="http://data.taipei/opendata/datalist/datasetMeta/download?id=961ca397-4a59-45e8-b312-697f26b059dc&amp;rid=190796c8-7c56-42e0-8068-39242b8ec927" target="_blank">臺北市水質監測資訊</a>。如需將XML檔案匯入R中，需要安裝<code>XML</code> <span class="citation">(Temple Lang and CRAN Team <a href="#ref-R-XML" role="doc-biblioref">2019</a>)</span> package，使用<code>xmlParse()</code>函數將檔案匯入。若出現<code>Error: 1: Unknown IO error2: failed to load external entity</code>，是因為XML套件處理http轉https的功能的不好，載入httr套件後，先使用GET()功能取用網址，再放入xmlParse()就不會有問題。</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1"><span class="kw">library</span>(XML)</a>
<a class="sourceLine" id="cb211-2" title="2"><span class="kw">library</span>(httr)</a>
<a class="sourceLine" id="cb211-3" title="3">waterQ &lt;-<span class="st"> </span><span class="kw">xmlParse</span>(<span class="kw">GET</span>(<span class="st">&quot;https://data.taipei/opendata/datalist/datasetMeta/download?id=961ca397-4a59-45e8-b312-697f26b059dc&amp;rid=190796c8-7c56-42e0-8068-39242b8ec927&quot;</span>))</a></code></pre></div>
<p>完成資料讀取後，使用<code>xpathSApply()</code>函數搭配<strong>XPath</strong>語法取得指定標籤內的資料，依需求也可改用<code>xpathApply()</code>函數，差別在於<code>xpathSApply()</code>函數回傳的物件是Vector 向量
，而<code>xpathApply()</code>回傳的物件是List 列表。</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1"><span class="co">#取得所有&quot;code_name&quot;標籤內的資料</span></a>
<a class="sourceLine" id="cb212-2" title="2"><span class="kw">xpathSApply</span>(waterQ,<span class="st">&quot;//code_name&quot;</span>,xmlValue)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<pre><code>##  [1] &quot;雙溪淨水場&quot;               &quot;衛理女中&quot;                
##  [3] &quot;雙溪國小                &quot; &quot;華興加壓站&quot;              
##  [5] &quot;長興淨水場&quot;               &quot;市政大樓&quot;                
##  [7] &quot;市議會&quot;                   &quot;捷運忠孝復興站&quot;          
##  [9] &quot;南港高工&quot;                 &quot;南港加壓站&quot;</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" title="1"><span class="co">#取得各監測站的經度</span></a>
<a class="sourceLine" id="cb214-2" title="2"><span class="kw">xpathSApply</span>(waterQ,<span class="st">&quot;//longitude&quot;</span>,xmlValue)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<pre><code>##  [1] &quot;121.569433&quot; &quot;121.55231&quot;  &quot;121.563886&quot; &quot;121.544384&quot; &quot;121.547873&quot;
##  [6] &quot;121.563997&quot; &quot;121.561975&quot; &quot;121.54342&quot;  &quot;121.607462&quot; &quot;121.616217&quot;</code></pre>
<p>在<code>xpathApply()</code>與<code>xpathSApply()</code>函數中，第二個參數為<strong>XPath</strong>，<strong>XPath</strong>是XML路徑語言（XML Path Language），基於XML的樹狀結構，提供在資料結構樹中找尋節點的能力，<strong>XPath</strong>語法的邏輯，可參考<a href="https://www.w3schools.com/xml/xpath_syntax.asp" target="_blank">W3C Schools</a>或是Google搜尋相關中文教學，如<a href="http://tech-marsw.logdown.com/blog/2016/01/11/parsing-lxml-xpath-sheet" target="_blank">lxml、XPath 常用語法</a>。在此列舉幾個常用的語法:</p>
<pre><code>// : 子結點資料, 如所有連結標籤 //a
@ : 屬性資料, 如所有連結標籤內的連結網址 //a/@href</code></pre>
</div>
<div id="網頁爬蟲-webscraping" class="section level3">
<h3><span class="header-section-number">5.0.5</span> 網頁爬蟲 Webscraping</h3>
<p>由於不是每個網站都提供API，但網頁上卻有你想要分析的資料（像是ptt推文！？），除了人工複製貼上以外，也可以將網頁處理程式化，以程式化的方式擷取網頁資料就叫做<strong>網頁爬蟲（Webscraping）</strong>（<a href="http://en.wikipedia.org/wiki/Web_scraping" target="_blank">Webscraping Wiki</a>）。在R中可以直接把HTML檔案當作XML檔案處理分析，也可使用<code>rvest</code><span class="citation">(Wickham <a href="#ref-R-rvest" role="doc-biblioref">2019</a><a href="#ref-R-rvest" role="doc-biblioref">a</a>)</span> package輔助爬蟲程式撰寫。</p>
<p>此外，網頁爬蟲可能耗費很多網頁流量和資源，所以在許多網站被視為非法行為，如果一次讀太多太快，很可能被鎖IP。</p>
<p>以<a href="http://im.cgu.edu.tw/bin/home.php" target="_blank">長庚資管系</a>網站為例，可直接逐行讀取 <code>readLines()</code></p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">con &lt;-<span class="st"> </span><span class="kw">url</span>(<span class="st">&quot;http://im.cgu.edu.tw/bin/home.php&quot;</span>)</a>
<a class="sourceLine" id="cb217-2" title="2">htmlCode &lt;-<span class="kw">readLines</span>(con)</a></code></pre></div>
<pre><code>## Warning in readLines(con): incomplete final line found on &#39;http://im.cgu.edu.tw/
## bin/home.php&#39;</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1"><span class="kw">close</span>(con)</a>
<a class="sourceLine" id="cb219-2" title="2">htmlCode[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>## [1] &quot;&lt;!DOCTYPE html PUBLIC \&quot;-//W3C//DTD XHTML 1.0 Transitional//EN\&quot; \&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\&quot;&gt;&quot;                                                             
## [2] &quot;&lt;html xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot; lang=\&quot;zh-tw\&quot;&gt;&quot;                                                                                                                              
## [3] &quot;&lt;head&gt;&quot;                                                                                                                                                                                    
## [4] &quot;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=utf-8\&quot; /&gt;&quot;                                                                                                                 
## [5] &quot;&lt;meta http-equiv=\&quot;X-UA-Compatible\&quot; content=\&quot;IE=EmulateIE7\&quot; /&gt;&lt;meta name=\&quot;keywords\&quot; content=\&quot;隢‵撖怎雯蝡\x97閮\xba\xbc\xe5\x8d\xa7\u0080\x99\x9f(,)\xe9\x9a\x96\x8b\&quot; /&gt;&quot;</code></pre>
<p>或是使用XML工具分析擷取網頁 (<code>XML</code> package)，使用方法與XML檔案處理方法類似，搭配<strong>XPath</strong>語言，篩選所需資料</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">html &lt;-<span class="st"> </span><span class="kw">htmlParse</span>(<span class="st">&quot;http://im.cgu.edu.tw/bin/home.php&quot;</span>)</a>
<a class="sourceLine" id="cb221-2" title="2"><span class="kw">xpathSApply</span>(html, <span class="st">&quot;//title&quot;</span>, xmlValue)</a></code></pre></div>
<pre><code>## [1] &quot;長庚大學 資訊管理學系 &quot;</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="kw">xpathSApply</span>(html, <span class="st">&quot;//span[@class=&#39;ptname &#39;]&quot;</span>, xmlValue)</a></code></pre></div>
<pre><code>##  [1] &quot;大數據資料科學與產業應用學程&quot;       &quot;資訊與醫療安全學程&quot;                
##  [3] &quot;物聯網產業創新應用學程&quot;             &quot;機器人智能互動與創新應用(暑期)學程&quot;
##  [5] &quot;校務資訊系統&quot;                       &quot;人事教育訓練資訊網&quot;                
##  [7] &quot;畢業校友登錄系統&quot;                   &quot;碩博士論文網&quot;                      
##  [9] &quot;資管系導師名單&quot;                     &quot;國內資管系所&quot;                      
## [11] &quot;資管系分機表&quot;                       &quot;資管系學會&quot;                        
## [13] &quot;管理學院&quot;                           &quot;醫務管理學系&quot;                      
## [15] &quot;工商管理學系&quot;                       &quot;工業設計學系&quot;                      
## [17] &quot;企業管理研究所博士班&quot;               &quot;商管專業學院&quot;                      
## [19] &quot;長庚大學行事曆&quot;</code></pre>
<p>除了把HTML檔案當作XML處理外，<code>rvest</code><span class="citation">(Wickham <a href="#ref-R-rvest" role="doc-biblioref">2019</a><a href="#ref-R-rvest" role="doc-biblioref">a</a>)</span> package是R語言中最常被使用的爬蟲套件，使用前一樣需要安裝與載入</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;rvest&quot;</span>) <span class="co">##安裝</span></a></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1"><span class="kw">library</span>(rvest) <span class="co">##載入</span></a></code></pre></div>
<p>載入<code>rvest</code>套件後，經由以下步驟進行網站解析：</p>
<ul>
<li>使用<code>read_html(“欲擷取的網站網址”)</code>函數讀取網頁</li>
<li>使用<code>html_nodes()</code>函數擷取所需內容 (條件為CSS或xpath標籤)</li>
<li>使用<code>html_text()</code>函數處理/清洗擷取內容，留下需要的資料</li>
<li>使用<code>html_attr()</code>函數擷取資料參數（如連結url）</li>
</ul>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1">YahooNewsurl=<span class="st">&quot;https://tw.news.yahoo.com/&quot;</span></a>
<a class="sourceLine" id="cb227-2" title="2">news_title =<span class="st"> </span><span class="kw">read_html</span>(YahooNewsurl) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;.tpl-title a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</a>
<a class="sourceLine" id="cb227-3" title="3">news_url =<span class="st"> </span><span class="kw">read_html</span>(YahooNewsurl) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;.tpl-title a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>)</a>
<a class="sourceLine" id="cb227-4" title="4">Yahoo_news =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">title =</span> news_title, <span class="dt">url=</span>news_url)</a>
<a class="sourceLine" id="cb227-5" title="5"><span class="kw">head</span>(Yahoo_news)</a></code></pre></div>
<pre><code>                                    title                                                           url
1         曾1妻5妾好風光 男星慘賣豪宅還債 /從1妻5妾的風光到變賣豪宅還債-網友噓雷洪：活該-091741737.html
2          美報告：美棄「一中」台灣更危險               /美報告-美拋棄-中-台灣處境更危險-081036215.html
3           藍色凍蕃薯！1張圖看寒流有多冷       /霸王級寒流再襲台-張圖看懂這波寒流有多強-101500692.html
4           他被妻子戴綠帽 對象竟是親弟弟                 /他被妻子戴綠帽-對象竟是親弟弟-072010033.html
5               匆忙推出移民禁令 他後悔了           /匆忙推移民禁令-美國土安全部長表後悔-044517088.html
6 蔡政府對釣魚台態度 國民黨憂美日安保質變       /蔡政府對釣魚台態度-國民黨憂美日安保質變-160200179.html</code></pre>
<p>在<code>html_nodes()</code>、<code>html_text()</code>和<code>html_attr()</code>函數中，擷取條件的撰寫會因網頁語法不同而有差異，必須要使用<strong>Google Chrome開發工具</strong>等工具輔助觀察需要擷取資料的條件。以上述Yahoo新聞為例，需要擷取的資料所在HTML片段如下：</p>
<pre><code>&lt;ul class=&quot;tpl-title yom-list list-style-none&quot; id=&quot;yui_3_9_1_1_1486568229946_2408&quot;&gt;
&lt;li class=&quot;list-story first&quot; id=&quot;yui_3_9_1_1_1486568229946_2407&quot;&gt;
&lt;div class=&quot;txt&quot; id=&quot;yui_3_9_1_1_1486568229946_2406&quot;&gt;
&lt;a href=&quot;/從1妻5妾的風光到變賣豪宅還債-網友噓雷洪：活該-091741737.html&quot; class=&quot;title &quot; data-ylk=&quot;pkg:96a0ca11-47bc-3100-81ad-0a288707f150;ver:60cdb126-ee0c-11e6-bb9b-8a777738a932;lt:i;pos:1;&quot; data-rapid_p=&quot;1&quot;&gt;曾1妻5妾好風光 男星慘賣豪宅還債&lt;/a&gt;
&lt;cite id=&quot;yui_3_9_1_1_1486568229946_2405&quot;&gt;
&lt;span class=&quot;provider&quot; id=&quot;yui_3_9_1_1_1486568229946_2404&quot;&gt;Yahoo奇摩娛樂新聞&lt;/span&gt;
&lt;/cite&gt;&lt;/div&gt;&lt;/li&gt;
....</code></pre>
<p>觀察上述程式碼可已發現新聞清單被包含在<code>ul</code>標籤下，且css class為<code>tpl-title yom-list list-style-none</code>，所以這邊可以使用第一個class<code>tpl-title</code>為篩選條件。CSS 標籤的意義可參考<a href="https://www.w3schools.com/cssref/css_selectors.asp">W3C Schools</a>的教學{target="_blank"}。在此整理常用的語法：</p>
<ul>
<li>CSS Selector 常見語法 <a href="https://www.w3schools.com/cssref/css_selectors.asp">參考資料</a>
<ul>
<li><strong>.</strong>xxx：select elements with class=“xxx”</li>
<li><strong>#</strong>xxx：select elements with id=“xxx”</li>
<li><strong>[<strong>yyy</strong>]</strong>：select elements with attribute yyy</li>
<li><strong>[<strong>yyy=zzz</strong>]</strong>：select elements with attribute yyy=“zzz”</li>
</ul></li>
</ul>
<p>網頁爬蟲需要多做觀察與練習，才可熟知篩選技巧。</p>
<p>其他爬蟲相關參考資源:</p>
<ul>
<li><a href="https://www.slideshare.net/secret/mdfHLPgvIW1kPR" target="_blank">網路爬蟲實作 - 用 r 語言打造自己的爬蟲程式</a></li>
<li><a href="https://github.com/hadley/rvest" target="_blank">rvest GitHub</a></li>
<li>R Bloggers 有很多<a href="http://www.r-bloggers.com/?s=Web+Scraping" target="_blank">爬蟲範例</a>（英文）</li>
<li><a href="http://bryannotes.blogspot.tw/2014/08/r-ptt-wantedsocial-network-analysis.html" target="_blank">Ptt爬蟲實作</a></li>
<li><a href="http://www.largitdata.com/course_list/1" target="_blank">大數學堂 網頁爬蟲課程</a></li>
<li><a href="https://github.com/CGUIM-BigDataAnalysis/BigDataCGUIM/blob/master/105/JiebaR.md" target="_blank">搭配結巴中文斷詞的使用範例</a></li>
</ul>
</div>
<div id="facebook資料擷取" class="section level2">
<h2><span class="header-section-number">5.1</span> Facebook資料擷取</h2>
<p>Facebook提供<a href="https://developers.facebook.com/docs/graph-api?locale=zh_TW" target="_blank">Graph API</a>，讓應用程式可透過API讀取與寫入 Facebook相關資料，<strong>Graph API</strong>會根據篩選條件，回傳JSON格式的資料。除此之外，Facebook還提供<a href="https://developers.facebook.com/tools/explorer/" target="_blank">Graph API Explorer</a>，讓程式開發人員可以測試資料撈取方法和結果。
在開始使用<strong>Graph API</strong>之前，必須要取得自己的<strong>access token</strong> (存取權杖)，<a href="https://developers.facebook.com/tools/explorer/" target="_blank">Graph API Explorer</a>工具提供<strong>Get Token</strong>按鈕(通常在視窗右上角)，可以讓開發者在不用新增應用程式(Application)的情況下取得暫時的<strong>access token</strong>。</p>
<p>有關Facebook access token的詳細介紹，可參考<a href="https://developers.facebook.com/docs/facebook-login/access-tokens/?locale=zh_TW" target="_blank">官方文件</a></p>
<div id="graph-api-in-r" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Graph API in R</h3>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">library</span>(httr)</a>
<a class="sourceLine" id="cb230-2" title="2">token&lt;-<span class="st">&quot;your token&quot;</span> <span class="co">#將access token複製到此處 </span></a>
<a class="sourceLine" id="cb230-3" title="3">FBData =<span class="st"> </span><span class="kw">GET</span>(</a>
<a class="sourceLine" id="cb230-4" title="4">    <span class="kw">paste0</span>(<span class="st">&quot;https://graph.facebook.com/v2.8/tsaiingwen?fields=posts%7Bmessage%7D&amp;access_token=&quot;</span>,</a>
<a class="sourceLine" id="cb230-5" title="5">           token))</a>
<a class="sourceLine" id="cb230-6" title="6"><span class="kw">names</span>(FBData)</a></code></pre></div>
<pre><code>## [1] &quot;url&quot;         &quot;status_code&quot; &quot;headers&quot;     &quot;all_headers&quot; &quot;cookies&quot;     &quot;content&quot;     &quot;date&quot;       
## [8] &quot;times&quot;       &quot;request&quot;     &quot;handle&quot;    </code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1">json1 =<span class="st"> </span><span class="kw">content</span>(FBData)</a>
<a class="sourceLine" id="cb232-2" title="2"><span class="kw">names</span>(json1)</a></code></pre></div>
<pre><code>## [1] &quot;posts&quot; &quot;id&quot;</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="kw">names</span>(json1<span class="op">$</span>posts)</a></code></pre></div>
<pre><code>## [1] &quot;data&quot;   &quot;paging&quot;</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"><span class="kw">head</span>(json1<span class="op">$</span>posts<span class="op">$</span>data,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>[[1]]
[[1]]$message
[1] &quot;「國機國造」不是夢想，而是一個行動。今天啟動的高級教練機「自研自製」任務，是國防自主的重要里程碑。我們不只要讓戰機起飛，更要讓產業起飛。\n\n國防產業同樣是「5+2」關鍵產業之一，所以，除了要如期、如質完成新式高教機的「自研自製」外，也要重新厚植台灣的航太工業人才鏈，以及加強相關產業的連結、轉型和升級。\n\n國防自主沒有捷徑，只有努力再努力、堅持再堅持。今天，我們重新跨出歷史性的一步。&quot;

[[1]]$id
[1] &quot;46251501064_10154006497451065&quot;


[[2]]
[[2]]$message
[1] &quot;今天，智慧機械推動辦公室正式啟動。「落實產學合作」、「支持創新研發」、「強化行銷通路」是辦公室的三項重點任務。\n\n智慧機械是「5+2」關鍵產業的其中之一。政府有決心。我相信，所有的機械業者－無論做的是螺桿、刀庫、控制器或是工作母機，大家也都有很強的決心，要走向創新、走向智慧化、走向品牌。我們是一個團隊，我們一起加油！&quot;

[[2]]$id
[1] &quot;46251501064_10154006456601065&quot;


[[3]]
[[3]]$message
[1] &quot;今天來向台商拜個晚年。我也邀請台商朋友們，共同參與台灣經濟轉型升級的世紀工程。\n\n無論是擴大對國內的投資，或者配合新南向政策，前進海外深耕佈局，我期待跟台商朋友們一起努力，群策群力，克服困難和瓶頸，為台灣經濟發展打開全新的局面。&quot;

[[3]]$id
[1] &quot;46251501064_10154001652641065&quot;
</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">json1<span class="op">$</span>posts<span class="op">$</span>data[[<span class="dv">1</span>]]<span class="op">$</span>message</a></code></pre></div>
<pre><code>##[1] &quot;「國機國造」不是夢想，而是一個行動。今天啟動的高級教練機「自研自製」任務，是國防自主的重要里程碑。我們不只要讓戰機起飛，更要讓產業起飛。\n\n國防產業同樣是「5+2」關鍵產業之一，所以，除了要如期、如質完成新式高教機的「自研自製」外，也要重新厚植台灣的航太工業人才鏈，以及加強相關產業的連結、轉型和升級。\n\n國防自主沒有捷徑，只有努力再努力、堅持再堅持。今天，我們重新跨出歷史性的一步。&quot;</code></pre>
</div>
<div id="rfacebook-package" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Rfacebook package</h3>
<p>除了直接使用Graph API外，也可使用<code>Rfacebook</code><span class="citation">(Barbera et al. <a href="#ref-R-Rfacebook" role="doc-biblioref">2017</a>)</span> package來讀取Facebook資料。
以下為使用Rfacebook取得 <code>tsaiingwen</code> 粉絲頁的資料範例：</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1"><span class="kw">library</span>(Rfacebook)</a>
<a class="sourceLine" id="cb240-2" title="2">token&lt;-<span class="st">&quot;your token&quot;</span> <span class="co">#將token複製到此處 </span></a>
<a class="sourceLine" id="cb240-3" title="3"><span class="kw">getPage</span>(<span class="st">&quot;tsaiingwen&quot;</span>, token,<span class="dt">n =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>5 posts       from_id           from_name
1 46251501064 蔡英文 Tsai Ing-wen
2 46251501064 蔡英文 Tsai Ing-wen
3 46251501064 蔡英文 Tsai Ing-wen
4 46251501064 蔡英文 Tsai Ing-wen
5 46251501064 蔡英文 Tsai Ing-wen
                                                                                                                                                                                                                                                                                                                                                                                        message
1 「國機國造」不是夢想，而是一個行動。今天啟動的高級教練機「自研自製」任務，是國防自主的重要里程碑。我們不只要讓戰機起飛，更要讓產業起飛。\n\n國防產業同樣是「5+2」關鍵產業之一，所以，除了要如期、如質完成新式高教機的「自研自製」外，也要重新厚植台灣的航太工業人才鏈，以及加強相關產業的連結、轉型和升級。\n\n國防自主沒有捷徑，只有努力再努力、堅持再堅持。今天，我們重新跨出歷史性的一步。
2                                                                   今天，智慧機械推動辦公室正式啟動。「落實產學合作」、「支持創新研發」、「強化行銷通路」是辦公室的三項重點任務。\n\n智慧機械是「5+2」關鍵產業的其中之一。政府有決心。我相信，所有的機械業者－無論做的是螺桿、刀庫、控制器或是工作母機，大家也都有很強的決心，要走向創新、走向智慧化、走向品牌。我們是一個團隊，我們一起加油！
3                                                                                                                                                          今天來向台商拜個晚年。我也邀請台商朋友們，共同參與台灣經濟轉型升級的世紀工程。\n\n無論是擴大對國內的投資，或者配合新南向政策，前進海外深耕佈局，我期待跟台商朋友們一起努力，群策群力，克服困難和瓶頸，為台灣經濟發展打開全新的局面。
4                                                                                                                                                                                                                                                                                    「快了」！雞年通機捷，等待很值得。大年初四，我來看看機場捷運通車前的準備，也坐捷運到中壢，跟鄉親拜年問好。
5                                                                                                                                                                                                                                                                                                            雞年初三發福袋\n\n臺中豐原慈濟宮、彰化溪湖福安宮、雲林北港朝天宮、嘉義九華山地藏庵
              created_time  type
1 2017-02-07T08:02:45+0000 photo
2 2017-02-07T07:18:00+0000 photo
3 2017-02-05T07:12:52+0000 photo
4 2017-01-31T08:37:42+0000 photo
5 2017-01-30T11:41:07+0000 photo
                                                                                                    link
1 https://www.facebook.com/tsaiingwen/photos/a.390960786064.163647.46251501064/10154006497206065/?type=3
2 https://www.facebook.com/tsaiingwen/photos/a.390960786064.163647.46251501064/10154006455396065/?type=3
3 https://www.facebook.com/tsaiingwen/photos/a.390960786064.163647.46251501064/10154001652641065/?type=3
4 https://www.facebook.com/tsaiingwen/photos/a.390960786064.163647.46251501064/10153989357181065/?type=3
5 https://www.facebook.com/tsaiingwen/photos/a.390960786064.163647.46251501064/10153987089121065/?type=3
                             id likes_count comments_count shares_count
1 46251501064_10154006497451065        2013            125           43
2 46251501064_10154006456601065        2217            163           57
3 46251501064_10154001652641065        9416            920          163
4 46251501064_10153989358051065       34116           1574          373
5 46251501064_10153987095776065       20592            665          269</code></pre>
<p>由於每次擷取資料的比數有上限（大概是30筆左右），如果需要取得更多更長期的資料，就要使用迴圈協助，分批取得資料，透過設定 <strong>since</strong> 和 <strong>until</strong>參數，可設定資料擷取區間。</p>
<p>首先先取得日期向量，供後續迴圈做使用</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1">lastDate&lt;-<span class="kw">Sys.Date</span>()</a>
<a class="sourceLine" id="cb242-2" title="2">DateVector&lt;-<span class="kw">seq</span>(<span class="kw">as.Date</span>(<span class="st">&quot;2017-01-01&quot;</span>),lastDate,<span class="dt">by=</span><span class="st">&quot;5 days&quot;</span>)</a>
<a class="sourceLine" id="cb242-3" title="3">DateVectorStr&lt;-<span class="kw">as.character</span>(DateVector)</a>
<a class="sourceLine" id="cb242-4" title="4">DateVectorStr</a></code></pre></div>
<pre><code>## &quot;2017-01-01&quot; &quot;2017-01-06&quot; &quot;2017-01-11&quot; &quot;2017-01-16&quot; &quot;2017-01-21&quot; &quot;2017-01-26&quot; &quot;2017-01-31&quot; &quot;2017-02-05&quot;</code></pre>
<p>利用上述日期向量資料，搭配迴圈，依序設定<strong>since</strong> 和 <strong>until</strong>參數</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1">totalPage&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb244-2" title="2">token&lt;-<span class="st">&#39;your token&#39;</span></a>
<a class="sourceLine" id="cb244-3" title="3">numberOfPost&lt;-<span class="dv">30</span></a>
<a class="sourceLine" id="cb244-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(DateVectorStr)<span class="op">-</span><span class="dv">1</span>)){</a>
<a class="sourceLine" id="cb244-5" title="5">    tempPage&lt;-<span class="kw">getPage</span>(<span class="st">&quot;tsaiingwen&quot;</span>, token,</a>
<a class="sourceLine" id="cb244-6" title="6">                      <span class="dt">since =</span> DateVectorStr[i],<span class="dt">until =</span> DateVectorStr[i<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb244-7" title="7">    totalPage&lt;-<span class="kw">rbind</span>(totalPage,tempPage)</a>
<a class="sourceLine" id="cb244-8" title="8">}</a>
<a class="sourceLine" id="cb244-9" title="9"><span class="kw">nrow</span>(totalPage)</a></code></pre></div>
<pre><code>## 4 posts 8 posts 10 posts 3 posts 2 posts 14 posts 1 posts
## [1] 42</code></pre>
<p>Rfacebook Packages提供其他函數可供使用</p>
<ul>
<li>getUsers()</li>
<li>getPost()</li>
<li>searchFacebook()</li>
<li>Check <a href="https://github.com/pablobarbera/Rfacebook" class="uri">https://github.com/pablobarbera/Rfacebook</a></li>
<li>?Rfacebook</li>
</ul>
<p>##資料匯出
在R中完成資料處理後，有多種匯出選擇，如果是要匯出供他人在其他環境(如Excel)使用，建議匯出成tab分隔的文字檔(.txt)或是逗號分隔的文字檔(.csv)；但若是要在R的環境繼續使用，建議匯出成R物件 (.rds)，除了可保留欄位型別設定外，讀取速度與檔案大小皆優於文字檔案。</p>
<p>###文字檔 .txt
使用<code>write.table()</code>函數寫入檔案，需要參數有</p>
<ul>
<li><code>x</code> 要匯出的檔案，通常為matrix或是data.frame格式</li>
<li><code>file</code> 檔案名稱</li>
<li><code>append</code> T/F TRUE表示在檔案後端加入文字，F表示直接覆蓋原始檔案 (預設F)</li>
<li><code>quote</code> 是否需要用雙引號將字串包起 (預設T)</li>
<li><code>sep</code> 分隔符號 (預設空白)</li>
<li><code>eol</code> 換行符號</li>
<li><code>na</code> 表示空值的字串</li>
<li><code>dec</code> 小數點表示法</li>
<li><code>row.names</code> T/F 是否需要輸出row names</li>
<li><code>col.names</code> T/F 是否需要輸出column names</li>
<li><code>qmethod</code> 逃脫字串設定</li>
<li><code>fileEncoding</code> 編碼設定</li>
</ul>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1"><span class="kw">write.table</span>(iris,<span class="dt">file=</span><span class="st">&quot;iris.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>,<span class="dt">row.names =</span> F,<span class="dt">col.names =</span> T)</a></code></pre></div>
<p>###CSV檔 .csv
與<code>write.table()</code>類似，使用<code>write.csv()</code>函數寫入檔案</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1"><span class="kw">write.csv</span>(iris,<span class="dt">file=</span><span class="st">&quot;iris.csv&quot;</span>,<span class="dt">row.names =</span> F)</a></code></pre></div>
<p>###R物件 .rds
若是要在R的環境繼續使用，建議匯出成R物件檔案(.rds)</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1"><span class="kw">saveRDS</span>(iris,<span class="st">&quot;iris.rds&quot;</span>)</a></code></pre></div>
<!--chapter:end:05-io.Rmd-->
</div>
</div>
</div>
<div id="manipulation" class="section level1">
<h1><span class="header-section-number">6</span> 資料處理與清洗</h1>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">6.1</span> Tidy Data</h2>
<p>Each column is a variable. Each row is an observation.</p>
<ul>
<li>一個欄位（Column）內只有一個數值，最好要有凡人看得懂的Column Name</li>
<li>不同的觀察值應該要在不同行（Row）</li>
<li>一張表裡面，有所有分析需要的資料</li>
<li>如果一定要多張表，中間一定要有index可以把表串起來</li>
<li>One file, one table</li>
</ul>
</div>
<div id="資料型別轉換處理" class="section level2">
<h2><span class="header-section-number">6.2</span> 資料型別轉換處理</h2>
<p>在資料型態章節Chapter @ref(DataType)中，曾介紹<strong>數值 (numeric)</strong>、<strong>字串 (character)</strong>、<strong>布林變數 (logic)</strong>以及<strong>日期 (Date)</strong>等資料型態，在此章節中將介紹如何檢查變數型別與各型別的轉換。</p>
<p>###資料型別檢查
使用以下<code>is.</code>函數檢查資料型別，回傳布林變數，若為真，回傳TRUE</p>
<ul>
<li>是否為<strong>數字</strong> <code>is.numeric(變數名稱)</code></li>
<li>是否為<strong>文字</strong> <code>is.character(變數名稱)</code></li>
<li>是否為<strong>布林變數</strong> <code>is.logical(變數名稱)</code></li>
</ul>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1">num&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb249-2" title="2">cha&lt;-<span class="st">&#39;200&#39;</span></a>
<a class="sourceLine" id="cb249-3" title="3">boo&lt;-T</a>
<a class="sourceLine" id="cb249-4" title="4"><span class="kw">is.numeric</span>(num)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1"><span class="kw">is.numeric</span>(cha)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1"><span class="kw">is.character</span>(num)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1"><span class="kw">is.character</span>(cha)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1"><span class="kw">is.logical</span>(boo)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>或使用<code>class(變數名稱)</code>函數，直接回傳資料型別</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1"><span class="kw">class</span>(num)</a></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1"><span class="kw">class</span>(cha)</a></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1"><span class="kw">class</span>(boo)</a></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1"><span class="kw">class</span>(<span class="kw">Sys.Date</span>())</a></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>###資料型別轉換
使用以下<code>as.</code>函數轉換型別</p>
<ul>
<li>轉換為<strong>數字</strong> <code>as.numeric(變數名稱)</code></li>
<li>轉換為<strong>文字</strong> <code>as.character(變數名稱)</code></li>
<li>轉換為<strong>布林變數</strong> <code>as.logical(變數名稱)</code></li>
</ul>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">as.numeric</span>(cha)</a></code></pre></div>
<pre><code>## [1] 200</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1"><span class="kw">as.numeric</span>(boo)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1"><span class="kw">as.character</span>(num)</a></code></pre></div>
<pre><code>## [1] &quot;100&quot;</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1"><span class="kw">as.character</span>(boo)</a></code></pre></div>
<pre><code>## [1] &quot;TRUE&quot;</code></pre>
<p>若無法順利完成轉換，會回傳空值<code>NA</code>，並出現警告訊息<code>Warning: NAs introduced by coercion，Warning: 強制變更過程中產生了 NA</code></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1"><span class="kw">as.numeric</span>(<span class="st">&quot;abc&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<pre><code>## [1] NA</code></pre>
<p>日期的轉換則建議使用<code>lubridate</code><span class="citation">(Spinu, Grolemund, and Wickham <a href="#ref-R-lubridate" role="doc-biblioref">2018</a>)</span> package，如果想要將<code>年/月/日</code>格式的文字轉換為日期物件，可使用<code>ymd()</code>函數（y表年year，m表月month，d表日day），如果想要將<code>月/日/年</code>格式的文字轉換為日期物件，則使用<code>mdy()</code>函數，以此類推。</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb278-2" title="2"><span class="kw">ymd</span>(<span class="st">&#39;2012/3/3&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;2012-03-03&quot;</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1"><span class="kw">mdy</span>(<span class="st">&#39;3/3/2012&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;2012-03-03&quot;</code></pre>
</div>
<div id="文字字串處理" class="section level2">
<h2><span class="header-section-number">6.3</span> 文字字串處理</h2>
<div id="基本處理" class="section level3">
<h3><span class="header-section-number">6.3.1</span> 基本處理</h3>
<ul>
<li>切割 <code>strsplit()</code></li>
<li>子集 <code>substr()</code></li>
<li>大小寫轉換 <code>toupper()</code> <code>tolower()</code></li>
<li>兩文字連接 <code>paste()</code> <code>paste0()</code></li>
<li>文字取代 <code>gsub()</code></li>
<li>前後空白去除 <code>str_trim()</code> 需安裝<code>stringr</code><span class="citation">(Wickham <a href="#ref-R-stringr" role="doc-biblioref">2019</a><a href="#ref-R-stringr" role="doc-biblioref">b</a>)</span> package</li>
</ul>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" title="1"><span class="kw">strsplit</span> (<span class="st">&quot;Hello World&quot;</span>,<span class="st">&quot; &quot;</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Hello&quot; &quot;World&quot;</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1"><span class="kw">toupper</span>(<span class="st">&quot;Hello World&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;HELLO WORLD&quot;</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1"><span class="kw">tolower</span>(<span class="st">&quot;Hello World&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;hello world&quot;</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1"><span class="kw">paste</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;World&quot;</span>, <span class="dt">sep=</span><span class="st">&#39;&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;HelloWorld&quot;</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1"><span class="kw">substr</span>(<span class="st">&quot;Hello World&quot;</span>, <span class="dt">start=</span><span class="dv">2</span>,<span class="dt">stop=</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] &quot;ell&quot;</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1"><span class="kw">gsub</span>(<span class="st">&quot;o&quot;</span>,<span class="st">&quot;0&quot;</span>,<span class="st">&quot;Hello World&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;Hell0 W0rld&quot;</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb294-2" title="2"><span class="kw">str_trim</span>(<span class="st">&quot; Hello World &quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;Hello World&quot;</code></pre>
</div>
<div id="搜尋字串" class="section level3">
<h3><span class="header-section-number">6.3.2</span> 搜尋字串</h3>
<p>搜尋字串函數通常使用在<strong>比對文字向量</strong>，文字比對<strong>有分大小寫</strong>，依照回傳值的型態不同，有兩種常用函數，<code>grep()</code>與<code>grepl()</code>:</p>
<ul>
<li>回傳符合條件之向量位置(index) <code>grep(搜尋條件,要搜尋的向量)</code></li>
<li>回傳每個向量是否符合條件(TRUE or FALSE) <code>grepl(搜尋條件,要搜尋的向量)</code></li>
</ul>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;A&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;Alex&quot;</span>,<span class="st">&quot;Tom&quot;</span>,<span class="st">&quot;Amy&quot;</span>,<span class="st">&quot;Joy&quot;</span>,<span class="st">&quot;Emma&quot;</span>)) <span class="co">##在姓名文字向量中尋找A，回傳包含&quot;A&quot;之元素位置</span></a></code></pre></div>
<pre><code>## [1] 1 3</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1"><span class="kw">grepl</span>(<span class="st">&quot;A&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;Alex&quot;</span>,<span class="st">&quot;Tom&quot;</span>,<span class="st">&quot;Amy&quot;</span>,<span class="st">&quot;Joy&quot;</span>,<span class="st">&quot;Emma&quot;</span>)) <span class="co">##在姓名文字向量中尋找A，回傳各元素是否包含&quot;A&quot;</span></a></code></pre></div>
<pre><code>## [1]  TRUE FALSE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="kw">grepl</span>(<span class="st">&quot;a&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;Alex&quot;</span>,<span class="st">&quot;Tom&quot;</span>,<span class="st">&quot;Amy&quot;</span>,<span class="st">&quot;Joy&quot;</span>,<span class="st">&quot;Emma&quot;</span>)) <span class="co">##在姓名文字向量中尋找a，回傳各元素是否包含&quot;a&quot;</span></a></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE  TRUE</code></pre>
</div>
<div id="正規表示式-regular-expression" class="section level3">
<h3><span class="header-section-number">6.3.3</span> 正規表示式 (Regular Expression)</h3>
<p>字串處理通常會搭配正規表示式 (Regular Expression)</p>
<p>Regular Expression (正規表示式)是指一組能用來表示字串共同格式 (common structure)的樣式 (Pattern)，像是<code>@</code>符號會固定出現在email中，或是手機號碼固定是10碼，等等樣式。
在所有的程式語言中，只要用到<strong>字串比對</strong>與<strong>字串取代</strong>等字串相關功能，都會用到正規表示式。雖然正規表示式在不同程式語言中會有些許差異，但核心概念是相同的。</p>
<p>以下是常見的範例:</p>
<table>
<thead>
<tr class="header">
<th>語法</th>
<th>正則表達式</th>
<th>範例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>整數</td>
<td>[0-9]+</td>
<td>5815</td>
</tr>
<tr class="even">
<td>浮點數</td>
<td>[0-9]+.[0-9]+</td>
<td>58.15</td>
</tr>
<tr class="odd">
<td>純英文字串</td>
<td>[A-Za-z]+</td>
<td>CGUIM</td>
</tr>
<tr class="even">
<td>Email</td>
<td>[a-zA-Z0-9_]+@[a-zA-Z0-9._]+</td>
<td><code>im@mail.cgu.edu.tw</code></td>
</tr>
<tr class="odd">
<td>URL</td>
<td><code>http://[a-zA-Z0-9./_]+</code></td>
<td><code>http://www.is.cgu.edu.tw/</code></td>
</tr>
</tbody>
</table>
<p>可以用正規表示式的R函數如下：</p>
<ul>
<li>grep()</li>
<li>grepl()</li>
<li>gsub()</li>
<li>str_split()</li>
<li>stringr package中的諸多函數</li>
</ul>
<p>正規表示式的常用語法分類如下：</p>
<ul>
<li>逃脫字元</li>
<li>表示數量</li>
<li>表示位置</li>
<li>運算子</li>
<li>特殊符號</li>
</ul>
<div id="逃脫字元" class="section level4">
<h4><span class="header-section-number">6.3.3.1</span> 逃脫字元</h4>
<p>****</p>
</div>
<div id="表示數量的語法" class="section level4">
<h4><span class="header-section-number">6.3.3.2</span> 表示數量的語法</h4>
<ul>
<li><code>*</code>: 出現0~無限多次</li>
<li><code>+</code>: 出現1~無限多次</li>
<li><code>?</code>: 出現0~1次</li>
<li><code>{n}</code>: 出現n次</li>
<li><code>{n,}</code>: 出現n~無限多次</li>
<li><code>{n,m}</code>: 出現n~m次</li>
</ul>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1">stringVector&lt;-<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;abc&quot;</span>,<span class="st">&quot;ac&quot;</span>,<span class="st">&quot;abbc&quot;</span>,<span class="st">&quot;abbbc&quot;</span>,<span class="st">&quot;abbbbc&quot;</span>)</a>
<a class="sourceLine" id="cb302-2" title="2"><span class="kw">grep</span>(<span class="st">&quot;ab*&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;a&quot;      &quot;abc&quot;    &quot;ac&quot;     &quot;abbc&quot;   &quot;abbbc&quot;  &quot;abbbbc&quot;</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;ab+&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;abc&quot;    &quot;abbc&quot;   &quot;abbbc&quot;  &quot;abbbbc&quot;</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;ab?c&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;abc&quot; &quot;ac&quot;</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;ab{2}c&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;abbc&quot;</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;ab{2,}c&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;abbc&quot;   &quot;abbbc&quot;  &quot;abbbbc&quot;</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;ab{2,3}c&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;abbc&quot;  &quot;abbbc&quot;</code></pre>
</div>
<div id="表示位置的語法" class="section level4">
<h4><span class="header-section-number">6.3.3.3</span> 表示位置的語法</h4>
<ul>
<li><code>^</code>: 出現在字串開始的位置</li>
<li><code>$</code>: 出現在字串結束ˇ的位置</li>
<li><code>\b</code>: 出現空字串(空白)開始或結束的位置</li>
<li><code>\B</code>: 出現非字串開始或結束的位置</li>
</ul>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1">stringVector&lt;-<span class="kw">c</span>(<span class="st">&quot;abc&quot;</span>,<span class="st">&quot;bcd&quot;</span>,<span class="st">&quot;cde&quot;</span>,<span class="st">&quot;def&quot;</span>,<span class="st">&quot;abc def&quot;</span>,<span class="st">&quot;bcdefg abc&quot;</span>)</a>
<a class="sourceLine" id="cb314-2" title="2"><span class="kw">grep</span>(<span class="st">&quot;^bc&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;bcd&quot;        &quot;bcdefg abc&quot;</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;bc$&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;abc&quot;        &quot;bcdefg abc&quot;</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">bde&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;def&quot;     &quot;abc def&quot;</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">Bde&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;cde&quot;        &quot;bcdefg abc&quot;</code></pre>
</div>
<div id="運算子" class="section level4">
<h4><span class="header-section-number">6.3.3.4</span> 運算子</h4>
<ul>
<li><code>.</code>: 出現所有的字元一次，包括空字串</li>
<li><code>[...]</code>: 出現字元清單(…)中的字元一次，可用<code>-</code>表示範圍，如<code>[A-Z]</code>，<code>[a-z]</code>，<code>[0-9]</code></li>
<li><code>[^...]</code>: 不出現字元清單(…)中的字元</li>
<li><code>\</code>: 要搜尋字串中的特殊字元時，前方須加上<code>\</code></li>
<li><code>|</code>: 或</li>
</ul>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" title="1">stringVector&lt;-<span class="kw">c</span>(<span class="st">&quot;03-2118800&quot;</span>,<span class="st">&quot;02-23123456&quot;</span>,<span class="st">&quot;0988123456&quot;</span>,</a>
<a class="sourceLine" id="cb322-2" title="2">                <span class="st">&quot;07-118&quot;</span>,<span class="st">&quot;0-888&quot;</span>,<span class="st">&quot;csim@mail.cgu.edu.tw&quot;</span>,<span class="st">&quot;csim@.&quot;</span>,<span class="st">&quot;csim@&quot;</span>,</a>
<a class="sourceLine" id="cb322-3" title="3">                <span class="st">&quot;http://www.is.cgu.edu.tw/&quot;</span>)</a>
<a class="sourceLine" id="cb322-4" title="4"><span class="kw">grep</span>(<span class="st">&quot;[0-9]{2}-[0-9]{7,8}&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;03-2118800&quot;  &quot;02-23123456&quot;</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;[0-9]{10}&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;0988123456&quot;</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;02|03&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;03-2118800&quot;  &quot;02-23123456&quot;</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;[a-zA-Z0-9_]+@[a-zA-Z0-9._]+&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;csim@mail.cgu.edu.tw&quot; &quot;csim@.&quot;</code></pre>
</div>
<div id="特殊符號" class="section level4">
<h4><span class="header-section-number">6.3.3.5</span> 特殊符號</h4>
<ul>
<li><code>\d</code>: 數字，等於 [0-9]</li>
<li><code>\D</code>: 非數字，等於 [^0-9]</li>
<li><code>[:lower:]</code>: 小寫字，等於 [a-z]</li>
<li><code>[:upper:]</code>: 大寫字，等於 [A-Z]</li>
<li><code>[:alpha:]</code>: 所有英文字，等於 [[:lower:][:upper:]] or [A-z]</li>
<li><code>[:alnum:]</code>: 所有英文字和數字，等於 [[:alpha:][:digit:]] or [A-z0-9]</li>
<li><code>\w</code>: 文字數字與底線，等於 [[:alnum:]_] or [A-z0-9_]</li>
<li><code>\W</code>: 非文字數字與底線，等於 [^A-z0-9_]</li>
<li><code>[:blank:]</code>: 空白字元，包括空白和tab</li>
<li><code>\s</code>: 空白字元, <code></code></li>
<li><code>\S</code>: 非空白字元</li>
<li><code>[:punct:]</code>: 標點符號 ! " # $ % &amp; ’ ( ) * + , - . / : ; &lt; = &gt; ? @ <a href="#preface"></a> ^ _ ` { | } ~.</li>
</ul>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1">stringVector&lt;-<span class="kw">c</span>(<span class="st">&quot;03-2118800&quot;</span>,<span class="st">&quot;02-23123456&quot;</span>,<span class="st">&quot;0988123456&quot;</span>,</a>
<a class="sourceLine" id="cb330-2" title="2">                <span class="st">&quot;07-118&quot;</span>,<span class="st">&quot;0-888&quot;</span>,<span class="st">&quot;csim@mail.cgu.edu.tw&quot;</span>,<span class="st">&quot;http://www.is.cgu.edu.tw/&quot;</span>)</a>
<a class="sourceLine" id="cb330-3" title="3"><span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">d{2}-</span><span class="ch">\\</span><span class="st">d{7,8}&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;03-2118800&quot;  &quot;02-23123456&quot;</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">d{10}&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;0988123456&quot;</code></pre>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" title="1"><span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">w+@[a-zA-Z0-9._]+&quot;</span>,stringVector,<span class="dt">value=</span>T)</a></code></pre></div>
<pre><code>## [1] &quot;csim@mail.cgu.edu.tw&quot;</code></pre>
</div>
<div id="參考資料" class="section level4">
<h4><span class="header-section-number">6.3.3.6</span> 參考資料</h4>
<ul>
<li><a href="https://dotblogs.com.tw/johnny/archive/2010/01/25/13301.aspx">Regular Expression 詳論</a></li>
<li><a href="http://regexlib.com/">RegExLib.com</a></li>
<li><a href="http://stat545.com/block022_regular-expression.html">Regular Expression in R</a></li>
</ul>
<p>##子集Subset {#subset}</p>
<p>###一維資料 (向量)
在向量章節<code>{#vector}</code>有介紹使用<code>[]</code>取出單一或多個元素的方法</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" title="1">letters <span class="co">##R語言內建資料之一</span></a></code></pre></div>
<pre><code>##  [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot; &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot; &quot;r&quot; &quot;s&quot;
## [20] &quot;t&quot; &quot;u&quot; &quot;v&quot; &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" title="1">letters[<span class="dv">1</span>] <span class="co">##取出letters向量的第一個元素</span></a></code></pre></div>
<pre><code>## [1] &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" title="1">letters[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] <span class="co">##取出letters向量的前十個元素</span></a></code></pre></div>
<pre><code>##  [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot;</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" title="1">letters[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)] <span class="co">##取出letters向量的第1,3,5個元素</span></a></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;c&quot; &quot;e&quot;</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" title="1">letters[<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="dv">5</span>)] <span class="co">##取出letters向量除了第1,3,5個元素之外的所有元素</span></a></code></pre></div>
<pre><code>##  [1] &quot;b&quot; &quot;d&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot; &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot; &quot;r&quot; &quot;s&quot; &quot;t&quot; &quot;u&quot; &quot;v&quot;
## [20] &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</code></pre>
<p>若想要快速取得一向量的開頭與結尾元素，可使用<code>head()</code>和<code>tail()</code>函數</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1"><span class="kw">head</span>(letters,<span class="dv">5</span>) <span class="co">##取出letters向量的前五個元素</span></a></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1"><span class="kw">tail</span>(letters,<span class="dv">3</span>) <span class="co">##取出letters向量的後三個元素</span></a></code></pre></div>
<pre><code>## [1] &quot;x&quot; &quot;y&quot; &quot;z&quot;</code></pre>
<p>###二維資料
最常見的二維資料為data.frame資料框，二維資料可針對列(Row)和行(Column)做子集，子集選擇方式一樣是使用<code>[]</code>，但因應二維資料的需求，以<code>,</code>分隔列與行的篩選條件，資料篩選原則為<strong>前Row,後Column</strong>，<strong>前列,後行</strong>，若不想篩選列，則在<code>,</code>前方保持<strong>空白</strong>即可。</p>
<p>篩選方式可輸入位置(index)、欄位名稱或輸入布林變數(TRUE/FALSE)</p>
<ul>
<li>輸入位置: <code>dataFrame[row index,column index]</code></li>
<li>輸入布林變數: <code>dataFrame[c(T,F,T),c(T,F,T)]</code></li>
<li>輸入欄位名稱: <code>dataFrame[row name,column name]</code></li>
</ul>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb350-2" title="2">iris[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co">##第一列Row，第二行Column</span></a></code></pre></div>
<pre><code>## [1] 3.5</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" title="1">iris[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,] <span class="co">##第1~3列Row，所有的行Column</span></a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" title="1">iris[,<span class="st">&quot;Species&quot;</span>] <span class="co">##所有的列Row，名稱為Species的行Column</span></a></code></pre></div>
<pre><code>##   [1] setosa     setosa     setosa     setosa     setosa     setosa    
##   [7] setosa     setosa     setosa     setosa     setosa     setosa    
##  [13] setosa     setosa     setosa     setosa     setosa     setosa    
##  [19] setosa     setosa     setosa     setosa     setosa     setosa    
##  [25] setosa     setosa     setosa     setosa     setosa     setosa    
##  [31] setosa     setosa     setosa     setosa     setosa     setosa    
##  [37] setosa     setosa     setosa     setosa     setosa     setosa    
##  [43] setosa     setosa     setosa     setosa     setosa     setosa    
##  [49] setosa     setosa     versicolor versicolor versicolor versicolor
##  [55] versicolor versicolor versicolor versicolor versicolor versicolor
##  [61] versicolor versicolor versicolor versicolor versicolor versicolor
##  [67] versicolor versicolor versicolor versicolor versicolor versicolor
##  [73] versicolor versicolor versicolor versicolor versicolor versicolor
##  [79] versicolor versicolor versicolor versicolor versicolor versicolor
##  [85] versicolor versicolor versicolor versicolor versicolor versicolor
##  [91] versicolor versicolor versicolor versicolor versicolor versicolor
##  [97] versicolor versicolor versicolor versicolor virginica  virginica 
## [103] virginica  virginica  virginica  virginica  virginica  virginica 
## [109] virginica  virginica  virginica  virginica  virginica  virginica 
## [115] virginica  virginica  virginica  virginica  virginica  virginica 
## [121] virginica  virginica  virginica  virginica  virginica  virginica 
## [127] virginica  virginica  virginica  virginica  virginica  virginica 
## [133] virginica  virginica  virginica  virginica  virginica  virginica 
## [139] virginica  virginica  virginica  virginica  virginica  virginica 
## [145] virginica  virginica  virginica  virginica  virginica  virginica 
## Levels: setosa versicolor virginica</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb356-1" title="1">iris[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="kw">c</span>(T,F,T,F,T)] <span class="co">##第1~10列Row，第1,3,5行Column (TRUE)</span></a></code></pre></div>
<pre><code>##    Sepal.Length Petal.Length Species
## 1           5.1          1.4  setosa
## 2           4.9          1.4  setosa
## 3           4.7          1.3  setosa
## 4           4.6          1.5  setosa
## 5           5.0          1.4  setosa
## 6           5.4          1.7  setosa
## 7           4.6          1.4  setosa
## 8           5.0          1.5  setosa
## 9           4.4          1.4  setosa
## 10          4.9          1.5  setosa</code></pre>
<p>也可使用<code>$</code>符號做<strong>Column的篩選</strong></p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" title="1">iris<span class="op">$</span>Species <span class="co">##所有的列Row，名稱為Species的行Column</span></a></code></pre></div>
<pre><code>##   [1] setosa     setosa     setosa     setosa     setosa     setosa    
##   [7] setosa     setosa     setosa     setosa     setosa     setosa    
##  [13] setosa     setosa     setosa     setosa     setosa     setosa    
##  [19] setosa     setosa     setosa     setosa     setosa     setosa    
##  [25] setosa     setosa     setosa     setosa     setosa     setosa    
##  [31] setosa     setosa     setosa     setosa     setosa     setosa    
##  [37] setosa     setosa     setosa     setosa     setosa     setosa    
##  [43] setosa     setosa     setosa     setosa     setosa     setosa    
##  [49] setosa     setosa     versicolor versicolor versicolor versicolor
##  [55] versicolor versicolor versicolor versicolor versicolor versicolor
##  [61] versicolor versicolor versicolor versicolor versicolor versicolor
##  [67] versicolor versicolor versicolor versicolor versicolor versicolor
##  [73] versicolor versicolor versicolor versicolor versicolor versicolor
##  [79] versicolor versicolor versicolor versicolor versicolor versicolor
##  [85] versicolor versicolor versicolor versicolor versicolor versicolor
##  [91] versicolor versicolor versicolor versicolor versicolor versicolor
##  [97] versicolor versicolor versicolor versicolor virginica  virginica 
## [103] virginica  virginica  virginica  virginica  virginica  virginica 
## [109] virginica  virginica  virginica  virginica  virginica  virginica 
## [115] virginica  virginica  virginica  virginica  virginica  virginica 
## [121] virginica  virginica  virginica  virginica  virginica  virginica 
## [127] virginica  virginica  virginica  virginica  virginica  virginica 
## [133] virginica  virginica  virginica  virginica  virginica  virginica 
## [139] virginica  virginica  virginica  virginica  virginica  virginica 
## [145] virginica  virginica  virginica  virginica  virginica  virginica 
## Levels: setosa versicolor virginica</code></pre>
<p><strong>Row的篩選</strong>可使用<code>subset()</code>函數，使用方法為<code>subset(資料表,篩選邏輯)</code></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb360-1" title="1"><span class="kw">subset</span>(iris,Species<span class="op">==</span><span class="st">&quot;virginica&quot;</span>) <span class="co">##Species等於&quot;virginica&quot;的列Row，所有的行Column</span></a></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 101          6.3         3.3          6.0         2.5 virginica
## 102          5.8         2.7          5.1         1.9 virginica
## 103          7.1         3.0          5.9         2.1 virginica
## 104          6.3         2.9          5.6         1.8 virginica
## 105          6.5         3.0          5.8         2.2 virginica
## 106          7.6         3.0          6.6         2.1 virginica
## 107          4.9         2.5          4.5         1.7 virginica
## 108          7.3         2.9          6.3         1.8 virginica
## 109          6.7         2.5          5.8         1.8 virginica
## 110          7.2         3.6          6.1         2.5 virginica
## 111          6.5         3.2          5.1         2.0 virginica
## 112          6.4         2.7          5.3         1.9 virginica
## 113          6.8         3.0          5.5         2.1 virginica
## 114          5.7         2.5          5.0         2.0 virginica
## 115          5.8         2.8          5.1         2.4 virginica
## 116          6.4         3.2          5.3         2.3 virginica
## 117          6.5         3.0          5.5         1.8 virginica
## 118          7.7         3.8          6.7         2.2 virginica
## 119          7.7         2.6          6.9         2.3 virginica
## 120          6.0         2.2          5.0         1.5 virginica
## 121          6.9         3.2          5.7         2.3 virginica
## 122          5.6         2.8          4.9         2.0 virginica
## 123          7.7         2.8          6.7         2.0 virginica
## 124          6.3         2.7          4.9         1.8 virginica
## 125          6.7         3.3          5.7         2.1 virginica
## 126          7.2         3.2          6.0         1.8 virginica
## 127          6.2         2.8          4.8         1.8 virginica
## 128          6.1         3.0          4.9         1.8 virginica
## 129          6.4         2.8          5.6         2.1 virginica
## 130          7.2         3.0          5.8         1.6 virginica
## 131          7.4         2.8          6.1         1.9 virginica
## 132          7.9         3.8          6.4         2.0 virginica
## 133          6.4         2.8          5.6         2.2 virginica
## 134          6.3         2.8          5.1         1.5 virginica
## 135          6.1         2.6          5.6         1.4 virginica
## 136          7.7         3.0          6.1         2.3 virginica
## 137          6.3         3.4          5.6         2.4 virginica
## 138          6.4         3.1          5.5         1.8 virginica
## 139          6.0         3.0          4.8         1.8 virginica
## 140          6.9         3.1          5.4         2.1 virginica
## 141          6.7         3.1          5.6         2.4 virginica
## 142          6.9         3.1          5.1         2.3 virginica
## 143          5.8         2.7          5.1         1.9 virginica
## 144          6.8         3.2          5.9         2.3 virginica
## 145          6.7         3.3          5.7         2.5 virginica
## 146          6.7         3.0          5.2         2.3 virginica
## 147          6.3         2.5          5.0         1.9 virginica
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<p><strong>Row的篩選</strong>也可搭配字串搜尋函數<code>grepl()</code></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(iris[<span class="kw">grepl</span>(<span class="st">&quot;color&quot;</span>,iris<span class="op">$</span>Species),]) <span class="co">##Species包含&quot;color&quot;的列，所有的行</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>51</td>
<td align="right">7.0</td>
<td align="right">3.2</td>
<td align="right">4.7</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>52</td>
<td align="right">6.4</td>
<td align="right">3.2</td>
<td align="right">4.5</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>53</td>
<td align="right">6.9</td>
<td align="right">3.1</td>
<td align="right">4.9</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>54</td>
<td align="right">5.5</td>
<td align="right">2.3</td>
<td align="right">4.0</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>55</td>
<td align="right">6.5</td>
<td align="right">2.8</td>
<td align="right">4.6</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>56</td>
<td align="right">5.7</td>
<td align="right">2.8</td>
<td align="right">4.5</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>57</td>
<td align="right">6.3</td>
<td align="right">3.3</td>
<td align="right">4.7</td>
<td align="right">1.6</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>58</td>
<td align="right">4.9</td>
<td align="right">2.4</td>
<td align="right">3.3</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>59</td>
<td align="right">6.6</td>
<td align="right">2.9</td>
<td align="right">4.6</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>60</td>
<td align="right">5.2</td>
<td align="right">2.7</td>
<td align="right">3.9</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>61</td>
<td align="right">5.0</td>
<td align="right">2.0</td>
<td align="right">3.5</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>62</td>
<td align="right">5.9</td>
<td align="right">3.0</td>
<td align="right">4.2</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>63</td>
<td align="right">6.0</td>
<td align="right">2.2</td>
<td align="right">4.0</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>64</td>
<td align="right">6.1</td>
<td align="right">2.9</td>
<td align="right">4.7</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>65</td>
<td align="right">5.6</td>
<td align="right">2.9</td>
<td align="right">3.6</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>66</td>
<td align="right">6.7</td>
<td align="right">3.1</td>
<td align="right">4.4</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>67</td>
<td align="right">5.6</td>
<td align="right">3.0</td>
<td align="right">4.5</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>68</td>
<td align="right">5.8</td>
<td align="right">2.7</td>
<td align="right">4.1</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>69</td>
<td align="right">6.2</td>
<td align="right">2.2</td>
<td align="right">4.5</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>70</td>
<td align="right">5.6</td>
<td align="right">2.5</td>
<td align="right">3.9</td>
<td align="right">1.1</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>71</td>
<td align="right">5.9</td>
<td align="right">3.2</td>
<td align="right">4.8</td>
<td align="right">1.8</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>72</td>
<td align="right">6.1</td>
<td align="right">2.8</td>
<td align="right">4.0</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>73</td>
<td align="right">6.3</td>
<td align="right">2.5</td>
<td align="right">4.9</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>74</td>
<td align="right">6.1</td>
<td align="right">2.8</td>
<td align="right">4.7</td>
<td align="right">1.2</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>75</td>
<td align="right">6.4</td>
<td align="right">2.9</td>
<td align="right">4.3</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>76</td>
<td align="right">6.6</td>
<td align="right">3.0</td>
<td align="right">4.4</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>77</td>
<td align="right">6.8</td>
<td align="right">2.8</td>
<td align="right">4.8</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>78</td>
<td align="right">6.7</td>
<td align="right">3.0</td>
<td align="right">5.0</td>
<td align="right">1.7</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>79</td>
<td align="right">6.0</td>
<td align="right">2.9</td>
<td align="right">4.5</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>80</td>
<td align="right">5.7</td>
<td align="right">2.6</td>
<td align="right">3.5</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>81</td>
<td align="right">5.5</td>
<td align="right">2.4</td>
<td align="right">3.8</td>
<td align="right">1.1</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>82</td>
<td align="right">5.5</td>
<td align="right">2.4</td>
<td align="right">3.7</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>83</td>
<td align="right">5.8</td>
<td align="right">2.7</td>
<td align="right">3.9</td>
<td align="right">1.2</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>84</td>
<td align="right">6.0</td>
<td align="right">2.7</td>
<td align="right">5.1</td>
<td align="right">1.6</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>85</td>
<td align="right">5.4</td>
<td align="right">3.0</td>
<td align="right">4.5</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>86</td>
<td align="right">6.0</td>
<td align="right">3.4</td>
<td align="right">4.5</td>
<td align="right">1.6</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>87</td>
<td align="right">6.7</td>
<td align="right">3.1</td>
<td align="right">4.7</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>88</td>
<td align="right">6.3</td>
<td align="right">2.3</td>
<td align="right">4.4</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>89</td>
<td align="right">5.6</td>
<td align="right">3.0</td>
<td align="right">4.1</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>90</td>
<td align="right">5.5</td>
<td align="right">2.5</td>
<td align="right">4.0</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>91</td>
<td align="right">5.5</td>
<td align="right">2.6</td>
<td align="right">4.4</td>
<td align="right">1.2</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>92</td>
<td align="right">6.1</td>
<td align="right">3.0</td>
<td align="right">4.6</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>93</td>
<td align="right">5.8</td>
<td align="right">2.6</td>
<td align="right">4.0</td>
<td align="right">1.2</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>94</td>
<td align="right">5.0</td>
<td align="right">2.3</td>
<td align="right">3.3</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>95</td>
<td align="right">5.6</td>
<td align="right">2.7</td>
<td align="right">4.2</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>96</td>
<td align="right">5.7</td>
<td align="right">3.0</td>
<td align="right">4.2</td>
<td align="right">1.2</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>97</td>
<td align="right">5.7</td>
<td align="right">2.9</td>
<td align="right">4.2</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>98</td>
<td align="right">6.2</td>
<td align="right">2.9</td>
<td align="right">4.3</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>99</td>
<td align="right">5.1</td>
<td align="right">2.5</td>
<td align="right">3.0</td>
<td align="right">1.1</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>100</td>
<td align="right">5.7</td>
<td align="right">2.8</td>
<td align="right">4.1</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
</tbody>
</table>
<p>若想要快速取得資料框的前幾列(Row)或後幾列，也可使用<code>head()</code>和<code>tail()</code>函數</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb363-1" title="1"><span class="kw">head</span>(iris,<span class="dv">5</span>) <span class="co">##取出iris資料框的前五列</span></a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb365-1" title="1"><span class="kw">tail</span>(iris,<span class="dv">3</span>) <span class="co">##取出iris資料框的後三列</span></a></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<p>##排序</p>
<p>###sort 向量排序
<code>sort()</code>函數可直接對向量做<strong>由小到大</strong>的排序</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb367-1" title="1"><span class="kw">head</span>(islands) <span class="co">##排序前的前六筆資料</span></a></code></pre></div>
<pre><code>##       Africa   Antarctica         Asia    Australia Axel Heiberg       Baffin 
##        11506         5500        16988         2968           16          184</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb369-1" title="1"><span class="kw">head</span>(<span class="kw">sort</span>(islands)) <span class="co">##由小到大排序後的前六筆資料</span></a></code></pre></div>
<pre><code>##       Vancouver          Hainan Prince of Wales           Timor          Kyushu 
##              12              13              13              13              14 
##          Taiwan 
##              14</code></pre>
<p>如需<strong>由大到小</strong>排序，可將<code>decreasing</code>參數設為TRUE</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" title="1"><span class="kw">head</span>(<span class="kw">sort</span>(islands,<span class="dt">decreasing =</span> T)) <span class="co">##由大到小排序後的前六筆資料</span></a></code></pre></div>
<pre><code>##          Asia        Africa North America South America    Antarctica 
##         16988         11506          9390          6795          5500 
##        Europe 
##          3745</code></pre>
<p>###order
如需對資料框做排序，可使用<code>order()</code>函數，<code>order()</code>函數可回傳<strong>由小到大</strong>之<strong>元素位置</strong>，以<code>iris$Sepal.Length</code>為例，回傳的第一個位置為<code>14</code>，表示<code>iris$Sepal.Length</code>中，數值最小的元素為第14個元素。</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" title="1"><span class="kw">order</span>(iris<span class="op">$</span>Sepal.Length)</a></code></pre></div>
<pre><code>##   [1]  14   9  39  43  42   4   7  23  48   3  30  12  13  25  31  46   2  10
##  [19]  35  38  58 107   5   8  26  27  36  41  44  50  61  94   1  18  20  22
##  [37]  24  40  45  47  99  28  29  33  60  49   6  11  17  21  32  85  34  37
##  [55]  54  81  82  90  91  65  67  70  89  95 122  16  19  56  80  96  97 100
##  [73] 114  15  68  83  93 102 115 143  62  71 150  63  79  84  86 120 139  64
##  [91]  72  74  92 128 135  69  98 127 149  57  73  88 101 104 124 134 137 147
## [109]  52  75 112 116 129 133 138  55 105 111 117 148  59  76  66  78  87 109
## [127] 125 141 145 146  77 113 144  53 121 140 142  51 103 110 126 130 108 131
## [145] 106 118 119 123 136 132</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb375-1" title="1">iris<span class="op">$</span>Sepal.Length[<span class="dv">14</span>]</a></code></pre></div>
<pre><code>## [1] 4.3</code></pre>
<p>若將<code>decreasing</code>參數設定為TRUE，則會回傳<strong>由大到小</strong>的元素位置，以<code>iris$Sepal.Length</code>為例，回傳的第一個位置為<code>132</code>，表示<code>iris$Sepal.Length</code>中，數值最大的元素為第132個元素。</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" title="1"><span class="kw">order</span>(iris<span class="op">$</span>Sepal.Length,<span class="dt">decreasing =</span> T)</a></code></pre></div>
<pre><code>##   [1] 132 118 119 123 136 106 131 108 110 126 130 103  51  53 121 140 142  77
##  [19] 113 144  66  78  87 109 125 141 145 146  59  76  55 105 111 117 148  52
##  [37]  75 112 116 129 133 138  57  73  88 101 104 124 134 137 147  69  98 127
##  [55] 149  64  72  74  92 128 135  63  79  84  86 120 139  62  71 150  15  68
##  [73]  83  93 102 115 143  16  19  56  80  96  97 100 114  65  67  70  89  95
##  [91] 122  34  37  54  81  82  90  91   6  11  17  21  32  85  49  28  29  33
## [109]  60   1  18  20  22  24  40  45  47  99   5   8  26  27  36  41  44  50
## [127]  61  94   2  10  35  38  58 107  12  13  25  31  46   3  30   4   7  23
## [145]  48  42   9  39  43  14</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" title="1">iris<span class="op">$</span>Sepal.Length[<span class="dv">132</span>]</a></code></pre></div>
<pre><code>## [1] 7.9</code></pre>
<p>依照order回傳的元素位置，重新排序iris資料框</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" title="1"><span class="kw">head</span>(iris) <span class="co">##排序前的前六筆資料</span></a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" title="1"><span class="kw">head</span>(iris[<span class="kw">order</span>(iris<span class="op">$</span>Sepal.Length),]) <span class="co">##依照Sepal.Length欄位數值大小排序後的前六筆資料</span></a></code></pre></div>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 14          4.3         3.0          1.1         0.1  setosa
## 9           4.4         2.9          1.4         0.2  setosa
## 39          4.4         3.0          1.3         0.2  setosa
## 43          4.4         3.2          1.3         0.2  setosa
## 42          4.5         2.3          1.3         0.3  setosa
## 4           4.6         3.1          1.5         0.2  setosa</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" title="1"><span class="kw">head</span>(iris[<span class="kw">order</span>(iris<span class="op">$</span>Sepal.Length,<span class="dt">decreasing =</span> T),]) <span class="co">##改為由大到小排序的前六筆資料</span></a></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 132          7.9         3.8          6.4         2.0 virginica
## 118          7.7         3.8          6.7         2.2 virginica
## 119          7.7         2.6          6.9         2.3 virginica
## 123          7.7         2.8          6.7         2.0 virginica
## 136          7.7         3.0          6.1         2.3 virginica
## 106          7.6         3.0          6.6         2.1 virginica</code></pre>
<p>##資料組合
有時需要在資料框新增一列，或新增一行，可以利用資料組合函數完成</p>
<ul>
<li>Row 列的組合 <code>rbind()</code></li>
<li>Column 行的組合 <code>cbind()</code></li>
</ul>
<p><code>rbind()</code>和<code>cbind()</code>的參數可以是向量，也可以是資料框，使用向量做資料整合範例:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb387-1" title="1"><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="co">#第一列</span></a>
<a class="sourceLine" id="cb387-2" title="2">      <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)  <span class="co">#第二列</span></a>
<a class="sourceLine" id="cb387-3" title="3">      ) </a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6</code></pre>
<p>使用資料框與向量做資料整合範例:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb389-1" title="1">irisAdd&lt;-<span class="kw">rbind</span>(iris, <span class="co">#資料框</span></a>
<a class="sourceLine" id="cb389-2" title="2">      <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="st">&quot;versicolor&quot;</span>)  <span class="co">#新增一列</span></a>
<a class="sourceLine" id="cb389-3" title="3">      ) </a>
<a class="sourceLine" id="cb389-4" title="4"><span class="kw">tail</span>(irisAdd)</a></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 146          6.7           3          5.2         2.3  virginica
## 147          6.3         2.5            5         1.9  virginica
## 148          6.5           3          5.2           2  virginica
## 149          6.2         3.4          5.4         2.3  virginica
## 150          5.9           3          5.1         1.8  virginica
## 151            1           1            1           1 versicolor</code></pre>
<p>使用向量做資料整合範例:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb391-1" title="1"><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="co">#第一行</span></a>
<a class="sourceLine" id="cb391-2" title="2">      <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)  <span class="co">#第二行</span></a>
<a class="sourceLine" id="cb391-3" title="3">      ) </a></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>使用資料框與向量做資料整合範例:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb393-1" title="1">irisAdd&lt;-<span class="kw">cbind</span>(iris, <span class="co">#資料框</span></a>
<a class="sourceLine" id="cb393-2" title="2">      <span class="kw">rep</span>(<span class="st">&quot;Add&quot;</span>,<span class="kw">nrow</span>(iris))  <span class="co">#新增一行</span></a>
<a class="sourceLine" id="cb393-3" title="3">      ) </a>
<a class="sourceLine" id="cb393-4" title="4"><span class="kw">tail</span>(irisAdd)</a></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 145          6.7         3.3          5.7         2.5 virginica
## 146          6.7         3.0          5.2         2.3 virginica
## 147          6.3         2.5          5.0         1.9 virginica
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica
##     rep(&quot;Add&quot;, nrow(iris))
## 145                    Add
## 146                    Add
## 147                    Add
## 148                    Add
## 149                    Add
## 150                    Add</code></pre>
<p>##資料結合 (Join)</p>
<p>除了按照行列順序的組合外，更常有的情形是依照某個欄位的值作為結合依據，如：</p>
<ul>
<li>用學號把以下兩個資料框結合成一個資料框
<ul>
<li>學號與姓名資料框</li>
<li>學號與宿舍床位資料框</li>
</ul></li>
<li>用縣市名稱與年度將人口資料與醫療資源資料結合</li>
</ul>
<p>原生的R環境可以用<code>merge()</code>函數將資料框結合，使用方法為<code>merge(資料框1,資料框2,by="結合依據欄位")</code></p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb395-1" title="1">nameDF&lt;-<span class="kw">data.frame</span>(<span class="dt">ID=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb395-2" title="2">                  <span class="dt">Name=</span><span class="kw">c</span>(<span class="st">&quot;Amy&quot;</span>,<span class="st">&quot;Bob&quot;</span>,<span class="st">&quot;Chris&quot;</span>,<span class="st">&quot;David&quot;</span>,<span class="st">&quot;Emma&quot;</span>))</a>
<a class="sourceLine" id="cb395-3" title="3">scoreDF&lt;-<span class="kw">data.frame</span>(<span class="dt">ID=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),</a>
<a class="sourceLine" id="cb395-4" title="4">                  <span class="dt">Score=</span><span class="kw">c</span>(<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">50</span>))</a></code></pre></div>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb396-1" title="1">nameDF</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="left">Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Amy</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Bob</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Chris</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">David</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Emma</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" title="1">scoreDF</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb398-1" title="1"><span class="kw">merge</span>(nameDF,scoreDF,<span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="left">Name</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Amy</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Bob</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">David</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<p>按照上述輸出結果可知，merge函數預設只保留兩資料框都有對應到的資料，如果不想要merge函數將沒對應到的資料刪除，可以設定參數<code>all</code>，<code>all.x</code>或是<code>all.y</code>，來保留沒對應到的資料列。</p>
<p><code>merge(資料框1,資料框2,by="結合依據欄位",all=T)</code></p>
<p><code>merge(資料框1,資料框2,by="結合依據欄位",all.x=T)</code></p>
<p><code>merge(資料框1,資料框2,by="結合依據欄位",all.y=T)</code></p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" title="1"><span class="kw">merge</span>(nameDF,scoreDF,<span class="dt">by=</span><span class="st">&quot;ID&quot;</span>,<span class="dt">all=</span>T)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="left">Name</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Amy</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Bob</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Chris</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">David</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Emma</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p><code>dplyr</code>套件提供更有效率的資料結合方法，包括:</p>
<ul>
<li>inner_join()：保留有對應到的資料</li>
<li>left_join()：保留左邊資料框的所有資料</li>
<li>right_join()：保留右邊資料框的所有資料</li>
<li>full_join()：保留所有資料</li>
<li>semi_join()</li>
<li>anti_join()</li>
</ul>
<p>inner_join()：只保留兩張表都有的列，使用方法為 <code>inner_join(x, y, by = )</code></p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb400-1" title="1"><span class="kw">library</span>(dplyr) <span class="co">#使用前須先載入套件</span></a>
<a class="sourceLine" id="cb400-2" title="2"><span class="kw">inner_join</span>(nameDF,scoreDF,<span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</a></code></pre></div>
<pre><code>##   ID  Name Score
## 1  1   Amy    60
## 2  2   Bob    90
## 3  4 David    50</code></pre>
<p>left_join()：保留左邊的表所有的列，使用方法文為 <code>left_join(x, y, by = )</code></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb402-1" title="1"><span class="kw">left_join</span>(nameDF,scoreDF,<span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</a></code></pre></div>
<pre><code>##   ID  Name Score
## 1  1   Amy    60
## 2  2   Bob    90
## 3  3 Chris    NA
## 4  4 David    50
## 5  5  Emma    NA</code></pre>
<p>right_join()：保留右邊的表所有的列。使用方法為 <code>right_join(x, y, by = )</code></p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb404-1" title="1"><span class="kw">right_join</span>(nameDF,scoreDF,<span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</a></code></pre></div>
<pre><code>##   ID  Name Score
## 1  1   Amy    60
## 2  2   Bob    90
## 3  4 David    50</code></pre>
<p>full_join()：保留所有的列。使用方法為 <code>full_join(x, y, by = )</code></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb406-1" title="1"><span class="kw">full_join</span>(nameDF,scoreDF,<span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</a></code></pre></div>
<pre><code>##   ID  Name Score
## 1  1   Amy    60
## 2  2   Bob    90
## 3  3 Chris    NA
## 4  4 David    50
## 5  5  Emma    NA</code></pre>
<p>semi_join()：留下左邊的ID也有出現在右邊的表的列，右表資料不會輸出。使用方法為 <code>semi_join(x, y, by = )</code></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb408-1" title="1"><span class="kw">semi_join</span>(nameDF,scoreDF,<span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</a></code></pre></div>
<pre><code>##   ID  Name
## 1  1   Amy
## 2  2   Bob
## 3  4 David</code></pre>
<p>##長表與寬表{#reshape}
在資料處理的過程中，常因各種需求，需要執行長寬表互換的動作，在R中有很好用的套件reshape2<span class="citation">(Wickham <a href="#ref-R-reshape2" role="doc-biblioref">2017</a>)</span> package，提供完整的轉換功能，最常使用的是</p>
<ul>
<li>寬表轉長表 <code>melt(資料框/寬表,id.vars=需要保留的欄位)</code></li>
<li>長表轉寬表 <code>dcast(資料框/長表,寬表分列依據~分欄位依據)</code></li>
</ul>
<p>原來的<code>airquality</code>資料框中，有Ozone, Solar.R, Wind, Temp, Month, Day等六個欄位 (Column)，屬於寬表，以下範例將保留Month和Day兩個欄位，並將其他欄位的名稱整合至variable欄位，數值整合至value欄位，寬表轉長表範例如下:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb410-1" title="1"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb410-2" title="2"><span class="kw">head</span>(airquality)</a></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 5    NA      NA 14.3   56     5   5
## 6    28      NA 14.9   66     5   6</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb412-1" title="1">airqualityM&lt;-<span class="kw">melt</span>(airquality,<span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;Month&quot;</span>,<span class="st">&quot;Day&quot;</span>)) <span class="co">##欄位需要保留&quot;Month&quot;,&quot;Day&quot;</span></a>
<a class="sourceLine" id="cb412-2" title="2"><span class="kw">head</span>(airqualityM)</a></code></pre></div>
<pre><code>##   Month Day variable value
## 1     5   1    Ozone    41
## 2     5   2    Ozone    36
## 3     5   3    Ozone    12
## 4     5   4    Ozone    18
## 5     5   5    Ozone    NA
## 6     5   6    Ozone    28</code></pre>
<p>轉換過的長表<code>airqualityM</code>資料框中，剩下Month, Day, variable, value等四個欄位 (Column)，屬於長表，以下範例variable欄位的值轉換為新欄位，並將value欄位填回新增的欄位，長表轉寬表範例如下:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb414-1" title="1"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb414-2" title="2"><span class="co">##欄位保留&quot;Month&quot;,&quot;Day&quot;外，其他欄位數目由variable定義</span></a>
<a class="sourceLine" id="cb414-3" title="3">airqualityCast&lt;-<span class="kw">dcast</span>(airqualityM, Month <span class="op">+</span>Day<span class="op">~</span>variable) </a>
<a class="sourceLine" id="cb414-4" title="4"><span class="kw">head</span>(airqualityCast)</a></code></pre></div>
<pre><code>##   Month Day Ozone Solar.R Wind Temp
## 1     5   1    41     190  7.4   67
## 2     5   2    36     118  8.0   72
## 3     5   3    12     149 12.6   74
## 4     5   4    18     313 11.5   62
## 5     5   5    NA      NA 14.3   56
## 6     5   6    28      NA 14.9   66</code></pre>
<p>##遺漏值處理
遺漏值(Missing Value)常常出現在真實資料內，在數值運算時常會有問題，最簡單的方法是將有缺值的資料移除，如資料為向量，可使用<code>is.na()</code>來判斷資料是否為空值<code>NA</code>，若為真<code>TRUE</code>，則將資料移除。</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb416-1" title="1">naVec&lt;-<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>)</a>
<a class="sourceLine" id="cb416-2" title="2"><span class="kw">is.na</span>(naVec)</a></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb418-1" title="1">naVec[<span class="op">!</span><span class="kw">is.na</span>(naVec)] <span class="co">##保留所有在is.na()檢查回傳FALSE的元素</span></a></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;d&quot; &quot;e&quot;</code></pre>
<p>若資料型態為資料框，可使用<code>complete.cases</code>來選出完整的資料列，如果資料列是完整的，則會回傳真TRUE</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" title="1"><span class="kw">head</span>(airquality)</a></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 5    NA      NA 14.3   56     5   5
## 6    28      NA 14.9   66     5   6</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb422-1" title="1"><span class="kw">complete.cases</span>(airquality) </a></code></pre></div>
<pre><code>##   [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE
##  [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [25] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
##  [37] FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE
##  [49]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [61] FALSE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
##  [73]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
##  [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
##  [97] FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
## [109]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
## [121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [145]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" title="1"><span class="kw">head</span>(airquality[<span class="kw">complete.cases</span>(airquality),]) <span class="co">##保留所有在complete.cases()檢查回傳TRUE的元素</span></a></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 7    23     299  8.6   65     5   7
## 8    19      99 13.8   59     5   8</code></pre>
<p>利用演算法補值也是一種解決辦法，可參考_skydome20_的<a href="http://www.rpubs.com/skydome20/R-Note10-Missing_Value" target="_blank">R筆記–(10)遺漏值處理(Impute Missing Value)</a>教學。</p>
<p>##綜合練習範例Case study {#manCase}
在本範例中，介紹使用<code>SportsAnalytics</code> <span class="citation">(Eugster <a href="#ref-R-SportsAnalytics" role="doc-biblioref">2013</a>)</span> package 撈取NBA各球員的數據，並加以觀察分析。</p>
</div>
</div>
<div id="載入資料" class="section level3">
<h3><span class="header-section-number">6.3.4</span> 載入資料</h3>
<p>首先用<code>library()</code>函數將<code>SportsAnalytics</code>套件載入 (若尚未安裝此套件者，必須先安裝套件，可參考Chapter @ref(intro))，並利用套件內提供的<code>fetch_NBAPlayerStatistics()</code>函數，將對應年份之資料取出。</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" title="1"><span class="kw">library</span>(SportsAnalytics)</a>
<a class="sourceLine" id="cb426-2" title="2">NBA1516&lt;-<span class="kw">fetch_NBAPlayerStatistics</span>(<span class="st">&quot;15-16&quot;</span>)</a></code></pre></div>
<p>###資料總覽
資料取出後，可用<code>str()</code>函數總覽<code>NBA1516</code>這個資料框的欄位與欄位類別</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" title="1"><span class="kw">str</span>(NBA1516)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    476 obs. of  25 variables:
##  $ League             : Factor w/ 1 level &quot;NBA&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Name               : chr  &quot;Quincy Acy&quot; &quot;Jordan Adams&quot; &quot;Steven Adams&quot; &quot;Arron Afflalo&quot; ...
##  $ Team               : Factor w/ 31 levels &quot;ATL&quot;,&quot;BOS&quot;,&quot;BRO&quot;,..: 27 15 22 20 19 13 28 26 12 15 ...
##  $ Position           : Factor w/ 5 levels &quot;C&quot;,&quot;PF&quot;,&quot;PG&quot;,..: 4 5 1 5 1 1 2 2 2 5 ...
##  $ GamesPlayed        : int  59 2 80 71 59 60 74 9 79 64 ...
##  $ TotalMinutesPlayed : int  877 15 2019 2359 863 802 2260 37 1601 1622 ...
##  $ FieldGoalsMade     : int  119 2 261 354 150 134 536 5 191 215 ...
##  $ FieldGoalsAttempted: int  214 6 426 799 314 225 1045 10 370 469 ...
##  $ ThreesMade         : int  19 0 0 91 0 0 0 0 0 15 ...
##  $ ThreesAttempted    : int  49 1 0 238 1 0 16 0 0 42 ...
##  $ FreeThrowsMade     : int  50 3 114 110 52 60 259 0 46 90 ...
##  $ FreeThrowsAttempted: int  68 5 196 131 62 84 302 0 73 138 ...
##  $ OffensiveRebounds  : int  65 0 218 23 75 86 175 2 162 104 ...
##  $ TotalRebounds      : int  188 2 531 266 269 288 631 6 424 297 ...
##  $ Assists            : int  27 3 61 145 32 50 110 0 76 70 ...
##  $ Steals             : int  29 3 42 25 19 47 38 1 26 109 ...
##  $ Turnovers          : int  27 2 84 82 54 64 99 1 69 78 ...
##  $ Blocks             : int  24 0 89 10 36 68 81 2 42 18 ...
##  $ PersonalFouls      : int  103 2 223 142 134 139 151 1 147 175 ...
##  $ Disqualifications  : int  0 0 2 1 0 1 0 0 1 1 ...
##  $ TotalPoints        : int  307 7 636 909 352 328 1331 10 428 535 ...
##  $ Technicals         : int  3 0 2 1 2 0 0 0 0 1 ...
##  $ Ejections          : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ FlagrantFouls      : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ GamesStarted       : int  29 0 80 57 17 5 74 0 28 56 ...</code></pre>
<p>可以發現此<code>NBA1516</code>資料框內有476筆球員資料(觀察值, obs)，每筆資料有25個欄位 (variables)。
###資料預覽
如果想看資料框內容，可用<code>head()</code>和<code>tail()</code>快速瀏覽部分資料</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" title="1"><span class="kw">head</span>(NBA1516)</a></code></pre></div>
<pre><code>##   League          Name Team Position GamesPlayed TotalMinutesPlayed
## 1    NBA    Quincy Acy  SAC       SF          59                877
## 2    NBA  Jordan Adams  MEM       SG           2                 15
## 3    NBA  Steven Adams  OKL        C          80               2019
## 4    NBA Arron Afflalo  NYK       SG          71               2359
## 5    NBA Alexis Ajinca  NOR        C          59                863
## 6    NBA  Cole Aldrich  LAC        C          60                802
##   FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1            119                 214         19              49             50
## 2              2                   6          0               1              3
## 3            261                 426          0               0            114
## 4            354                 799         91             238            110
## 5            150                 314          0               1             52
## 6            134                 225          0               0             60
##   FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists Steals Turnovers
## 1                  68                65           188      27     29        27
## 2                   5                 0             2       3      3         2
## 3                 196               218           531      61     42        84
## 4                 131                23           266     145     25        82
## 5                  62                75           269      32     19        54
## 6                  84                86           288      50     47        64
##   Blocks PersonalFouls Disqualifications TotalPoints Technicals Ejections
## 1     24           103                 0         307          3         0
## 2      0             2                 0           7          0         0
## 3     89           223                 2         636          2         0
## 4     10           142                 1         909          1         0
## 5     36           134                 0         352          2         0
## 6     68           139                 1         328          0         0
##   FlagrantFouls GamesStarted
## 1             0           29
## 2             0            0
## 3             0           80
## 4             0           57
## 5             0           17
## 6             0            5</code></pre>
<p>###資料排序後篩選
觀察資料框的組成後，我們想要找出<strong>出場數</strong>最<strong>高</strong>的前五名選手的所有資料，此時可以利用<code>order()</code>函數先<strong>由大到小</strong>排序(<code>decreasing = T</code>)後，再用<code>[,]</code>取子集。</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb431-1" title="1">NBA1516Order&lt;-NBA1516[<span class="kw">order</span>(NBA1516<span class="op">$</span>GamesPlayed,<span class="dt">decreasing =</span> T),]</a>
<a class="sourceLine" id="cb431-2" title="2">NBA1516Order[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,] <span class="co">##逗號前方放1~5，表示取1~5列；逗號後方空白，表示要取所有欄位</span></a></code></pre></div>
<pre><code>##     League            Name Team Position GamesPlayed TotalMinutesPlayed
## 11     NBA Al-farouq Aminu  POR       SF          82               2342
## 37     NBA     Will Barton  DEN       SG          82               2355
## 48     NBA Bismack Biyombo  TOR       PF          82               1810
## 62     NBA    Corey Brewer  HOU       SG          82               1670
## 118    NBA    Gorgui Dieng  MIN        C          82               2222
##     FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted
## 11             299                 719        126             349
## 37             426                 984        112             324
## 48             156                 288          0               1
## 62             212                 552         61             225
## 118            308                 578          6              20
##     FreeThrowsMade FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists
## 11             115                 156                98           498     138
## 37             216                 268                60           477     204
## 48             142                 226               182           655      29
## 62             105                 140                42           199     109
## 118            205                 248               156           584     143
##     Steals Turnovers Blocks PersonalFouls Disqualifications TotalPoints
## 11      72       120     53           171                 0         839
## 37      71       139     39           147                 0        1180
## 48      19        71    133           225                 2         454
## 62      84        78     19           168                 1         590
## 118     94       140     96           219                 0         827
##     Technicals Ejections FlagrantFouls GamesStarted
## 11           3         0             0           82
## 37           2         0             0            1
## 48           3         0             0           22
## 62           0         0             0           12
## 118          1         0             0           39</code></pre>
<p>如果我們想要出<strong>出場分鐘數</strong>最<strong>高</strong>的前十名選手的<strong>名字</strong>，一樣可以用<code>order()</code>函數先<strong>由大到小</strong>排序(<code>decreasing = T</code>)後，再用<code>[,]</code>取子集。</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb433-1" title="1">NBA1516OrderM&lt;-NBA1516[<span class="kw">order</span>(NBA1516<span class="op">$</span>TotalMinutesPlayed,<span class="dt">decreasing =</span> T),]</a>
<a class="sourceLine" id="cb433-2" title="2">NBA1516OrderM[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="st">&quot;Name&quot;</span>] <span class="co">##逗號前方取1~10列；逗號後方放&quot;Name&quot;，表示取名稱為Name之欄位</span></a></code></pre></div>
<pre><code>##  [1] &quot;James Harden&quot;     &quot;Gordon Hayward&quot;   &quot;Kemba Walker&quot;     &quot;Trevor Ariza&quot;    
##  [5] &quot;Khris Middleton&quot;  &quot;Kyle Lowry&quot;       &quot;Marcus Morris&quot;    &quot;Andrew Wiggins&quot;  
##  [9] &quot;Paul George&quot;      &quot;Gi Antetokounmpo&quot;</code></pre>
<p>###欄位值篩選
除了排序取值外，也可用欄位條件搜尋，舉例來說，可以取出所有波士頓賽爾迪克隊的選手資料，使用<code>subset()</code>函數</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" title="1"><span class="kw">subset</span>(NBA1516,Team<span class="op">==</span><span class="st">&quot;BOS&quot;</span>)</a></code></pre></div>
<pre><code>##     League            Name Team Position GamesPlayed TotalMinutesPlayed
## 60     NBA   Avery Bradley  BOS       PG          76               2536
## 89     NBA     Coty Clarke  BOS     &lt;NA&gt;           4                  8
## 102    NBA     Jae Crowder  BOS       SF          73               2310
## 213    NBA     R.j. Hunter  BOS       SG          36                319
## 228    NBA   Jonas Jerebko  BOS       PF          78               1178
## 229    NBA    Amir Johnson  BOS       PF          79               1798
## 300    NBA   Jordan Mickey  BOS       PF          16                 59
## 340    NBA    Kelly Olynyk  BOS        C          69               1396
## 382    NBA    Terry Rozier  BOS       PG          39                310
## 400    NBA    Marcus Smart  BOS       PG          61               1666
## 416    NBA Jared Sullinger  BOS       PF          81               1917
## 422    NBA   Isaiah Thomas  BOS       PG          82               2647
## 433    NBA     Evan Turner  BOS       SG          81               2270
## 471    NBA     James Young  BOS       SG          29                200
## 476    NBA    Tyler Zeller  BOS        C          60                714
##     FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted
## 60             456                1018        147             406
## 89               2                   4          2               2
## 102            359                 812        122             363
## 213             36                  98         19              63
## 228            118                 286         43             108
## 229            250                 427         10              43
## 300              8                  22          0               0
## 340            253                 556         85             210
## 382             29                 106          6              27
## 400            184                 529         61             241
## 416            351                 807         29             104
## 422            591                1382        167             465
## 433            343                 753         20              83
## 471             11                  36          6              26
## 476            138                 290          0               0
##     FreeThrowsMade FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists
## 60              96                 123                48           220     158
## 89               0                   0                 0             1       0
## 102            196                 239                70           373     135
## 213              6                   7                 2            37      13
## 228             61                  78                77           288      62
## 229             69                 121               178           505     137
## 300              5                  10                 6            13       1
## 340             96                 128                72           281     105
## 382              8                  10                24            63      37
## 400            129                 166                76           255     186
## 416            103                 161               194           673     187
## 422            474                 544                46           243     509
## 433            148                 179                50           397     359
## 471              1                   4                 4            26       9
## 476             88                 108                62           178      29
##     Steals Turnovers Blocks PersonalFouls Disqualifications TotalPoints
## 60     117       109     19           164                 2        1155
## 89       0         1      0             0                 0           6
## 102    126        83     35           198                 4        1036
## 213     14        11      4            29                 0          97
## 228     20        52     24           137                 2         340
## 229     52        94     83           214                 1         579
## 300      0         1     11             5                 0          21
## 340     52        74     33           163                 3         687
## 382      6        19      1            23                 0          72
## 400     91        80     18           183                 1         558
## 416     75       102     47           209                 2         834
## 422     91       220      9           167                 1        1823
## 433     80       169     28           139                 0         854
## 471      6         5      1            17                 0          29
## 476     10        46     22            97                 1         364
##     Technicals Ejections FlagrantFouls GamesStarted
## 60           0         0             0           72
## 89           0         0             0            0
## 102          3         0             0           73
## 213          0         0             0            0
## 228          1         0             0            0
## 229          0         0             0           76
## 300          0         0             0            0
## 340          1         0             0            8
## 382          0         0             0            0
## 400          2         0             0           10
## 416          2         0             0           73
## 422          9         0             0           79
## 433          2         0             0           12
## 471          0         0             0            0
## 476          0         0             0            3</code></pre>
<p>###字串條件搜尋後篩選
當然也可以結合<strong>字串搜尋</strong>函數<code>grepl()</code>，將所有名字裡有“James”的選手資料取出</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" title="1">NBA1516[<span class="kw">grepl</span>(<span class="st">&quot;James&quot;</span>,NBA1516<span class="op">$</span>Name),]</a></code></pre></div>
<pre><code>##     League           Name Team Position GamesPlayed TotalMinutesPlayed
## 15     NBA James Anderson  SAC       SG          51                721
## 132    NBA    James Ennis  NOR       SF          22                329
## 178    NBA   James Harden  HOU       SG          82               3121
## 222    NBA   Lebron James  CLE       SF          76               2710
## 231    NBA  James Johnson  TOR       PF          57                924
## 239    NBA    James Jones  CLE       SG          48                466
## 286    NBA   James Mcadoo  GSW       SG          41                265
## 471    NBA    James Young  BOS       SG          29                200
##     FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted
## 15              67                 178         23              86
## 132             54                 113         26              58
## 178            710                1617        236             656
## 222            737                1416         87             282
## 231            114                 240         20              66
## 239             59                 143         41             104
## 286             45                  84          1               2
## 471             11                  36          6              26
##     FreeThrowsMade FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists
## 15              22                  29                13            86      41
## 132             25                  34                21            42      21
## 178            720                 837                63           502     612
## 222            359                 491               111           565     512
## 231             39                  68                28           126      67
## 239             21                  26                 8            50      14
## 286             26                  49                30            58      17
## 471              1                   4                 4            26       9
##     Steals Turnovers Blocks PersonalFouls Disqualifications TotalPoints
## 15      21        42     14            54                 0         179
## 132     16        19      5            28                 1         159
## 178    138       374     51           229                 1        2376
## 222    104       249     49           143                 0        1920
## 231     29        54     33            84                 0         287
## 239     11        13     10            50                 0         180
## 286     10        16      8            39                 0         117
## 471      6         5      1            17                 0          29
##     Technicals Ejections FlagrantFouls GamesStarted
## 15           0         0             0           15
## 132          0         0             0            5
## 178          2         0             0           82
## 222          3         0             0           76
## 231          0         0             0           32
## 239          1         0             0            0
## 286          0         0             0            1
## 471          0         0             0            0</code></pre>
<!--chapter:end:06-manipulation.Rmd-->
</div>
</div>
</div>
<div id="eda" class="section level1">
<h1><span class="header-section-number">7</span> 探索式資料分析</h1>
<div id="什麼是探索式資料分析" class="section level2">
<h2><span class="header-section-number">7.1</span> 什麼是探索式資料分析</h2>
<p>探索式資料分析 (<strong>E</strong>xploratory <strong>D</strong>ata <strong>A</strong>nalysis) 的主要精神是運用視覺化、基本的統計等工具，反覆的探索資料特性，獲取資料所包含的資訊、結構和特點，因為在進行複雜或嚴謹的分析之前，必須要對資料有更多認識，才能訂定對的資料分析方向。</p>
<p>探索式資料分析包括分析各變數間的關聯性，看是否有預料之外的有趣發現，或是觀察資料內容是否符合預期，若否，檢查資料是否有誤，最後檢查資料是否符合分析前的假設，由上述可知，探索式資料分析通常不需要嚴謹的假設和細節呈現，主要功能還是『觀察』資料的特性。在資料量大/雜的時候，探索式資料分析就非常重要，因為透過探索式資料分析，分析人員可以在複雜的統計計算與耗時的模型建立前，就先發現可能的錯誤，更重要的是，可以透過探索性分析來調整分析的方向，減少因分析方向錯誤所造成的時間浪費。</p>
<p>探索式資料分析分為:</p>
<ul>
<li>圖形化Graphical 或 量化Quantitative</li>
<li>單變量Univariate 或 雙變量Bivariate 或 多變量Multivariate</li>
</ul>
<p>圖形化的分析方式包括做圖與列表，量化的分析方式則是資料初步統計，本章節著重於量化的分析方式，圖形化的分析方式請參考Ch @ref(vis)。</p>
<p>以單變量分析來說，量化的分析方式可包含</p>
<ul>
<li>計算集中趨勢 (<a href="https://zh.wikipedia.org/wiki/%E9%9B%86%E4%B8%AD%E8%B6%8B%E5%8A%BF" target="_blank">維基百科</a>)
<ul>
<li>平均值 Mean <code>mean()</code></li>
<li>中位數 Median <code>median()</code></li>
<li>眾數 Mode，R無內建函數，可直接用<code>table()</code>找出現次數最多的資料</li>
</ul></li>
<li>計算資料分散程度
<ul>
<li>最小值 Min <code>min()</code></li>
<li>最大值 Max <code>max()</code></li>
<li>範圍 Range <code>range()</code></li>
<li>四分位差 Quartiles <code>quantile()</code></li>
<li>變異數 Variance <code>var()</code></li>
<li>標準差 Standard deviation <code>sd()</code></li>
</ul></li>
</ul>
<p>以雙變量分析來說，分析方式可包括:</p>
<ul>
<li>列聯表 Crosstabs <code>table()</code>, <code>ftable()</code>, <code>prop.table()</code></li>
<li>共變數 Covariance <code>cov()</code></li>
<li>相關性 Correlation <code>cor()</code></li>
</ul>
<p>量化分析方式的測量值大多可用R的內建函數完成計算，但是在探索式分析時，常常需要遇到資料分組的分析情形（如觀察男性和女性的血壓差異、A隊與B隊的三分球命中率差異、中鋒和後衛的助攻次數…等），若只用基本的內建函數計算，需要先完成資料分組或子集後，再作進一步的運算，相當耗時，為了使這類資料分組與分析的工作更容易被完成，本書在介紹探索式資料分析時會搭配介紹<code>data.table</code><span class="citation">(Dowle and Srinivasan <a href="#ref-R-data.table" role="doc-biblioref">2019</a>)</span>和<code>dplyr</code><span class="citation">(Wickham, François, et al. <a href="#ref-R-dplyr" role="doc-biblioref">2019</a>)</span> packages，這兩個packages各有優點，可依自己喜好選用。</p>
</div>
<div id="datatable" class="section level2">
<h2><span class="header-section-number">7.2</span> data.table</h2>
<p>data.table是data.frame資料框型別的延伸，如要使用必須安裝並載入data.table<span class="citation">(Dowle and Srinivasan <a href="#ref-R-data.table" role="doc-biblioref">2019</a>)</span> package</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;data.table&quot;</span>) <span class="co">##安裝</span></a></code></pre></div>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" title="1"><span class="kw">library</span>(data.table) <span class="co">##載入</span></a></code></pre></div>
<p>使用<code>data.table</code>讀取大型資料的速度比使用資料框快上數倍，效能比較可參考<a href="https://github.com/Rdatatable/data.table/wiki/Benchmarks-%3A-Grouping">Benchmarks : Grouping</a>，讀取資料的函數為<code>fread()</code>，使用方法與一般檔案讀取方法(Ch @ref(file))類似</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" title="1"><span class="kw">fread</span>(<span class="st">&quot;檔案名稱&quot;</span>)</a></code></pre></div>
<p>如果已經使用其他資料來源將檔案讀成資料框data.frame格式，可以使用<code>data.table()</code>函數將data.frame轉為data.table格式，以先前介紹過的NBA資料為例（Ch @ref(manCase)，需安裝與載入<code>SportsAnalytics</code>套件）</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" title="1"><span class="kw">library</span>(SportsAnalytics)</a>
<a class="sourceLine" id="cb442-2" title="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb442-3" title="3">NBA1516&lt;-<span class="kw">fetch_NBAPlayerStatistics</span>(<span class="st">&quot;15-16&quot;</span>)</a>
<a class="sourceLine" id="cb442-4" title="4">NBA1516DT&lt;-<span class="kw">data.table</span>(NBA1516)</a>
<a class="sourceLine" id="cb442-5" title="5"><span class="kw">class</span>(NBA1516DT)</a></code></pre></div>
<pre><code>## [1] &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
<p>可以發現轉換後的<code>NBA1516DT</code>資料型態為<code>data.table</code>以及<code>data.frame</code>，這是因為data.table是data.frame資料框型別的延伸，所以是data.table型態的資料，就一定會是data.frame型態。</p>
<p><code>data.table</code>資料型態的特殊結構和語法設計，便於後續資料分析處理，基本語法結構如下：</p>
<p><strong>DT[<strong><code>i</code></strong>,<strong><code>j</code></strong>,<strong><code>by</code></strong>=]</strong></p>
<ul>
<li><code>i</code> 觀察值 (Row) 篩選邏輯</li>
<li><code>j</code> 所需欄位 (Column)</li>
<li><code>by</code> 分組依據</li>
</ul>
<p>各參數間需要以逗號<code>,</code>區隔，但若只需使用前方參數，後方的<code>,</code>可省略，如只需使用i和j兩個參數，可以寫成DT[i,j]。
各參數的使用方法分述如下：</p>
<div id="i-觀察值篩選邏輯" class="section level3">
<h3><span class="header-section-number">7.2.1</span> i 觀察值篩選邏輯</h3>
<p>第一個參數<code>i</code>是用來篩選<strong>觀察值</strong>，也就是針對列(Row)做子集。篩選方式與Ch @ref(subset)雷同，可透過<strong>布林值</strong>的向量或是<strong>元素索引(index)</strong>向量指定篩選條件，透過觀察值的篩選，可保留需要的資料，進行後續分析。</p>
<p>以前述NBA球員資料為例，如需擷取球員姓名包含James字串的資料，可使用下列指令：</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" title="1">NBA1516DT[<span class="kw">grepl</span>(<span class="st">&#39;James&#39;</span>,Name)]</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">League</th>
<th align="left">Name</th>
<th align="left">Team</th>
<th align="left">Position</th>
<th align="right">GamesPlayed</th>
<th align="right">TotalMinutesPlayed</th>
<th align="right">FieldGoalsMade</th>
<th align="right">FieldGoalsAttempted</th>
<th align="right">ThreesMade</th>
<th align="right">ThreesAttempted</th>
<th align="right">FreeThrowsMade</th>
<th align="right">FreeThrowsAttempted</th>
<th align="right">OffensiveRebounds</th>
<th align="right">TotalRebounds</th>
<th align="right">Assists</th>
<th align="right">Steals</th>
<th align="right">Turnovers</th>
<th align="right">Blocks</th>
<th align="right">PersonalFouls</th>
<th align="right">Disqualifications</th>
<th align="right">TotalPoints</th>
<th align="right">Technicals</th>
<th align="right">Ejections</th>
<th align="right">FlagrantFouls</th>
<th align="right">GamesStarted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">James Anderson</td>
<td align="left">SAC</td>
<td align="left">SG</td>
<td align="right">51</td>
<td align="right">721</td>
<td align="right">67</td>
<td align="right">178</td>
<td align="right">23</td>
<td align="right">86</td>
<td align="right">22</td>
<td align="right">29</td>
<td align="right">13</td>
<td align="right">86</td>
<td align="right">41</td>
<td align="right">21</td>
<td align="right">42</td>
<td align="right">14</td>
<td align="right">54</td>
<td align="right">0</td>
<td align="right">179</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">James Ennis</td>
<td align="left">NOR</td>
<td align="left">SF</td>
<td align="right">22</td>
<td align="right">329</td>
<td align="right">54</td>
<td align="right">113</td>
<td align="right">26</td>
<td align="right">58</td>
<td align="right">25</td>
<td align="right">34</td>
<td align="right">21</td>
<td align="right">42</td>
<td align="right">21</td>
<td align="right">16</td>
<td align="right">19</td>
<td align="right">5</td>
<td align="right">28</td>
<td align="right">1</td>
<td align="right">159</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">James Harden</td>
<td align="left">HOU</td>
<td align="left">SG</td>
<td align="right">82</td>
<td align="right">3121</td>
<td align="right">710</td>
<td align="right">1617</td>
<td align="right">236</td>
<td align="right">656</td>
<td align="right">720</td>
<td align="right">837</td>
<td align="right">63</td>
<td align="right">502</td>
<td align="right">612</td>
<td align="right">138</td>
<td align="right">374</td>
<td align="right">51</td>
<td align="right">229</td>
<td align="right">1</td>
<td align="right">2376</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Lebron James</td>
<td align="left">CLE</td>
<td align="left">SF</td>
<td align="right">76</td>
<td align="right">2710</td>
<td align="right">737</td>
<td align="right">1416</td>
<td align="right">87</td>
<td align="right">282</td>
<td align="right">359</td>
<td align="right">491</td>
<td align="right">111</td>
<td align="right">565</td>
<td align="right">512</td>
<td align="right">104</td>
<td align="right">249</td>
<td align="right">49</td>
<td align="right">143</td>
<td align="right">0</td>
<td align="right">1920</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">76</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">James Johnson</td>
<td align="left">TOR</td>
<td align="left">PF</td>
<td align="right">57</td>
<td align="right">924</td>
<td align="right">114</td>
<td align="right">240</td>
<td align="right">20</td>
<td align="right">66</td>
<td align="right">39</td>
<td align="right">68</td>
<td align="right">28</td>
<td align="right">126</td>
<td align="right">67</td>
<td align="right">29</td>
<td align="right">54</td>
<td align="right">33</td>
<td align="right">84</td>
<td align="right">0</td>
<td align="right">287</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">James Jones</td>
<td align="left">CLE</td>
<td align="left">SG</td>
<td align="right">48</td>
<td align="right">466</td>
<td align="right">59</td>
<td align="right">143</td>
<td align="right">41</td>
<td align="right">104</td>
<td align="right">21</td>
<td align="right">26</td>
<td align="right">8</td>
<td align="right">50</td>
<td align="right">14</td>
<td align="right">11</td>
<td align="right">13</td>
<td align="right">10</td>
<td align="right">50</td>
<td align="right">0</td>
<td align="right">180</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">James Mcadoo</td>
<td align="left">GSW</td>
<td align="left">SG</td>
<td align="right">41</td>
<td align="right">265</td>
<td align="right">45</td>
<td align="right">84</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">26</td>
<td align="right">49</td>
<td align="right">30</td>
<td align="right">58</td>
<td align="right">17</td>
<td align="right">10</td>
<td align="right">16</td>
<td align="right">8</td>
<td align="right">39</td>
<td align="right">0</td>
<td align="right">117</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">James Young</td>
<td align="left">BOS</td>
<td align="left">SG</td>
<td align="right">29</td>
<td align="right">200</td>
<td align="right">11</td>
<td align="right">36</td>
<td align="right">6</td>
<td align="right">26</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">26</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">17</td>
<td align="right">0</td>
<td align="right">29</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>如需篩選所有中鋒，且姓名包含“A”字串的球員資料，可使用下列指令：</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" title="1">NBA1516DT[<span class="kw">grepl</span>(<span class="st">&#39;A&#39;</span>,Name)<span class="op">&amp;</span>Position<span class="op">==</span><span class="st">&quot;C&quot;</span>]</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">League</th>
<th align="left">Name</th>
<th align="left">Team</th>
<th align="left">Position</th>
<th align="right">GamesPlayed</th>
<th align="right">TotalMinutesPlayed</th>
<th align="right">FieldGoalsMade</th>
<th align="right">FieldGoalsAttempted</th>
<th align="right">ThreesMade</th>
<th align="right">ThreesAttempted</th>
<th align="right">FreeThrowsMade</th>
<th align="right">FreeThrowsAttempted</th>
<th align="right">OffensiveRebounds</th>
<th align="right">TotalRebounds</th>
<th align="right">Assists</th>
<th align="right">Steals</th>
<th align="right">Turnovers</th>
<th align="right">Blocks</th>
<th align="right">PersonalFouls</th>
<th align="right">Disqualifications</th>
<th align="right">TotalPoints</th>
<th align="right">Technicals</th>
<th align="right">Ejections</th>
<th align="right">FlagrantFouls</th>
<th align="right">GamesStarted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Steven Adams</td>
<td align="left">OKL</td>
<td align="left">C</td>
<td align="right">80</td>
<td align="right">2019</td>
<td align="right">261</td>
<td align="right">426</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">114</td>
<td align="right">196</td>
<td align="right">218</td>
<td align="right">531</td>
<td align="right">61</td>
<td align="right">42</td>
<td align="right">84</td>
<td align="right">89</td>
<td align="right">223</td>
<td align="right">2</td>
<td align="right">636</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">80</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Alexis Ajinca</td>
<td align="left">NOR</td>
<td align="left">C</td>
<td align="right">59</td>
<td align="right">863</td>
<td align="right">150</td>
<td align="right">314</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">52</td>
<td align="right">62</td>
<td align="right">75</td>
<td align="right">269</td>
<td align="right">32</td>
<td align="right">19</td>
<td align="right">54</td>
<td align="right">36</td>
<td align="right">134</td>
<td align="right">0</td>
<td align="right">352</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Cole Aldrich</td>
<td align="left">LAC</td>
<td align="left">C</td>
<td align="right">60</td>
<td align="right">802</td>
<td align="right">134</td>
<td align="right">225</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">60</td>
<td align="right">84</td>
<td align="right">86</td>
<td align="right">288</td>
<td align="right">50</td>
<td align="right">47</td>
<td align="right">64</td>
<td align="right">68</td>
<td align="right">139</td>
<td align="right">1</td>
<td align="right">328</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Joel Anthony</td>
<td align="left">DET</td>
<td align="left">C</td>
<td align="right">19</td>
<td align="right">95</td>
<td align="right">6</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">21</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">12</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">18</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Omer Asik</td>
<td align="left">NOR</td>
<td align="left">C</td>
<td align="right">68</td>
<td align="right">1181</td>
<td align="right">104</td>
<td align="right">196</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">61</td>
<td align="right">112</td>
<td align="right">119</td>
<td align="right">413</td>
<td align="right">26</td>
<td align="right">21</td>
<td align="right">60</td>
<td align="right">23</td>
<td align="right">124</td>
<td align="right">0</td>
<td align="right">269</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Andrea Bargnani</td>
<td align="left">BRO</td>
<td align="left">C</td>
<td align="right">46</td>
<td align="right">634</td>
<td align="right">127</td>
<td align="right">278</td>
<td align="right">3</td>
<td align="right">15</td>
<td align="right">47</td>
<td align="right">57</td>
<td align="right">28</td>
<td align="right">97</td>
<td align="right">18</td>
<td align="right">4</td>
<td align="right">26</td>
<td align="right">9</td>
<td align="right">61</td>
<td align="right">0</td>
<td align="right">304</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Andrew Bogut</td>
<td align="left">GSW</td>
<td align="left">C</td>
<td align="right">70</td>
<td align="right">1452</td>
<td align="right">175</td>
<td align="right">279</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">24</td>
<td align="right">50</td>
<td align="right">121</td>
<td align="right">491</td>
<td align="right">162</td>
<td align="right">32</td>
<td align="right">83</td>
<td align="right">113</td>
<td align="right">221</td>
<td align="right">4</td>
<td align="right">375</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">66</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Andre Drummond</td>
<td align="left">DET</td>
<td align="left">C</td>
<td align="right">81</td>
<td align="right">2664</td>
<td align="right">552</td>
<td align="right">1061</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">208</td>
<td align="right">586</td>
<td align="right">395</td>
<td align="right">1198</td>
<td align="right">67</td>
<td align="right">119</td>
<td align="right">154</td>
<td align="right">112</td>
<td align="right">245</td>
<td align="right">2</td>
<td align="right">1314</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Al Jefferson</td>
<td align="left">CHA</td>
<td align="left">C</td>
<td align="right">47</td>
<td align="right">1096</td>
<td align="right">245</td>
<td align="right">505</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">72</td>
<td align="right">111</td>
<td align="right">57</td>
<td align="right">301</td>
<td align="right">70</td>
<td align="right">30</td>
<td align="right">34</td>
<td align="right">41</td>
<td align="right">117</td>
<td align="right">1</td>
<td align="right">562</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Alex Len</td>
<td align="left">PHO</td>
<td align="left">C</td>
<td align="right">78</td>
<td align="right">1820</td>
<td align="right">264</td>
<td align="right">623</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">174</td>
<td align="right">239</td>
<td align="right">178</td>
<td align="right">594</td>
<td align="right">97</td>
<td align="right">38</td>
<td align="right">145</td>
<td align="right">62</td>
<td align="right">230</td>
<td align="right">3</td>
<td align="right">703</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Anderson Varejao</td>
<td align="left">GSW</td>
<td align="left">C</td>
<td align="right">53</td>
<td align="right">494</td>
<td align="right">53</td>
<td align="right">124</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">32</td>
<td align="right">50</td>
<td align="right">37</td>
<td align="right">141</td>
<td align="right">35</td>
<td align="right">16</td>
<td align="right">22</td>
<td align="right">10</td>
<td align="right">70</td>
<td align="right">0</td>
<td align="right">138</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Alan Williams</td>
<td align="left">PHO</td>
<td align="left">C</td>
<td align="right">10</td>
<td align="right">67</td>
<td align="right">10</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">38</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">29</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>如需篩選各隊出場數超過80場的球員資料，可使用下列指令：</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" title="1">NBA1516DT[GamesPlayed<span class="op">&gt;</span><span class="dv">80</span>]</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">League</th>
<th align="left">Name</th>
<th align="left">Team</th>
<th align="left">Position</th>
<th align="right">GamesPlayed</th>
<th align="right">TotalMinutesPlayed</th>
<th align="right">FieldGoalsMade</th>
<th align="right">FieldGoalsAttempted</th>
<th align="right">ThreesMade</th>
<th align="right">ThreesAttempted</th>
<th align="right">FreeThrowsMade</th>
<th align="right">FreeThrowsAttempted</th>
<th align="right">OffensiveRebounds</th>
<th align="right">TotalRebounds</th>
<th align="right">Assists</th>
<th align="right">Steals</th>
<th align="right">Turnovers</th>
<th align="right">Blocks</th>
<th align="right">PersonalFouls</th>
<th align="right">Disqualifications</th>
<th align="right">TotalPoints</th>
<th align="right">Technicals</th>
<th align="right">Ejections</th>
<th align="right">FlagrantFouls</th>
<th align="right">GamesStarted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Al-farouq Aminu</td>
<td align="left">POR</td>
<td align="left">SF</td>
<td align="right">82</td>
<td align="right">2342</td>
<td align="right">299</td>
<td align="right">719</td>
<td align="right">126</td>
<td align="right">349</td>
<td align="right">115</td>
<td align="right">156</td>
<td align="right">98</td>
<td align="right">498</td>
<td align="right">138</td>
<td align="right">72</td>
<td align="right">120</td>
<td align="right">53</td>
<td align="right">171</td>
<td align="right">0</td>
<td align="right">839</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Trevor Ariza</td>
<td align="left">HOU</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">2860</td>
<td align="right">357</td>
<td align="right">858</td>
<td align="right">185</td>
<td align="right">497</td>
<td align="right">126</td>
<td align="right">161</td>
<td align="right">67</td>
<td align="right">366</td>
<td align="right">188</td>
<td align="right">161</td>
<td align="right">113</td>
<td align="right">26</td>
<td align="right">177</td>
<td align="right">0</td>
<td align="right">1025</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Will Barton</td>
<td align="left">DEN</td>
<td align="left">SG</td>
<td align="right">82</td>
<td align="right">2355</td>
<td align="right">426</td>
<td align="right">984</td>
<td align="right">112</td>
<td align="right">324</td>
<td align="right">216</td>
<td align="right">268</td>
<td align="right">60</td>
<td align="right">477</td>
<td align="right">204</td>
<td align="right">71</td>
<td align="right">139</td>
<td align="right">39</td>
<td align="right">147</td>
<td align="right">0</td>
<td align="right">1180</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Aron Baynes</td>
<td align="left">DET</td>
<td align="left">PF</td>
<td align="right">81</td>
<td align="right">1241</td>
<td align="right">194</td>
<td align="right">384</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">126</td>
<td align="right">165</td>
<td align="right">140</td>
<td align="right">384</td>
<td align="right">51</td>
<td align="right">21</td>
<td align="right">67</td>
<td align="right">52</td>
<td align="right">151</td>
<td align="right">0</td>
<td align="right">514</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Bismack Biyombo</td>
<td align="left">TOR</td>
<td align="left">PF</td>
<td align="right">82</td>
<td align="right">1810</td>
<td align="right">156</td>
<td align="right">288</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">142</td>
<td align="right">226</td>
<td align="right">182</td>
<td align="right">655</td>
<td align="right">29</td>
<td align="right">19</td>
<td align="right">71</td>
<td align="right">133</td>
<td align="right">225</td>
<td align="right">2</td>
<td align="right">454</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Corey Brewer</td>
<td align="left">HOU</td>
<td align="left">SG</td>
<td align="right">82</td>
<td align="right">1670</td>
<td align="right">212</td>
<td align="right">552</td>
<td align="right">61</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">140</td>
<td align="right">42</td>
<td align="right">199</td>
<td align="right">109</td>
<td align="right">84</td>
<td align="right">78</td>
<td align="right">19</td>
<td align="right">168</td>
<td align="right">1</td>
<td align="right">590</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Allen Crabbe</td>
<td align="left">POR</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">2111</td>
<td align="right">312</td>
<td align="right">678</td>
<td align="right">112</td>
<td align="right">284</td>
<td align="right">98</td>
<td align="right">113</td>
<td align="right">27</td>
<td align="right">216</td>
<td align="right">99</td>
<td align="right">63</td>
<td align="right">64</td>
<td align="right">16</td>
<td align="right">192</td>
<td align="right">2</td>
<td align="right">834</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Ed Davis</td>
<td align="left">POR</td>
<td align="left">PF</td>
<td align="right">81</td>
<td align="right">1684</td>
<td align="right">206</td>
<td align="right">337</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">114</td>
<td align="right">204</td>
<td align="right">224</td>
<td align="right">599</td>
<td align="right">88</td>
<td align="right">57</td>
<td align="right">64</td>
<td align="right">72</td>
<td align="right">202</td>
<td align="right">2</td>
<td align="right">526</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Gorgui Dieng</td>
<td align="left">MIN</td>
<td align="left">C</td>
<td align="right">82</td>
<td align="right">2222</td>
<td align="right">308</td>
<td align="right">578</td>
<td align="right">6</td>
<td align="right">20</td>
<td align="right">205</td>
<td align="right">248</td>
<td align="right">156</td>
<td align="right">584</td>
<td align="right">143</td>
<td align="right">94</td>
<td align="right">140</td>
<td align="right">96</td>
<td align="right">219</td>
<td align="right">0</td>
<td align="right">827</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Andre Drummond</td>
<td align="left">DET</td>
<td align="left">C</td>
<td align="right">81</td>
<td align="right">2664</td>
<td align="right">552</td>
<td align="right">1061</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">208</td>
<td align="right">586</td>
<td align="right">395</td>
<td align="right">1198</td>
<td align="right">67</td>
<td align="right">119</td>
<td align="right">154</td>
<td align="right">112</td>
<td align="right">245</td>
<td align="right">2</td>
<td align="right">1314</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Jared Dudley</td>
<td align="left">WAS</td>
<td align="left">SG</td>
<td align="right">81</td>
<td align="right">2098</td>
<td align="right">233</td>
<td align="right">487</td>
<td align="right">100</td>
<td align="right">239</td>
<td align="right">72</td>
<td align="right">98</td>
<td align="right">54</td>
<td align="right">286</td>
<td align="right">170</td>
<td align="right">75</td>
<td align="right">80</td>
<td align="right">18</td>
<td align="right">190</td>
<td align="right">1</td>
<td align="right">638</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">41</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Monta Ellis</td>
<td align="left">IND</td>
<td align="left">PG</td>
<td align="right">81</td>
<td align="right">2733</td>
<td align="right">436</td>
<td align="right">1021</td>
<td align="right">87</td>
<td align="right">281</td>
<td align="right">162</td>
<td align="right">206</td>
<td align="right">42</td>
<td align="right">272</td>
<td align="right">382</td>
<td align="right">149</td>
<td align="right">203</td>
<td align="right">38</td>
<td align="right">174</td>
<td align="right">0</td>
<td align="right">1121</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Randy Foye</td>
<td align="left">OKC</td>
<td align="left">SG</td>
<td align="right">81</td>
<td align="right">1640</td>
<td align="right">168</td>
<td align="right">481</td>
<td align="right">75</td>
<td align="right">250</td>
<td align="right">61</td>
<td align="right">74</td>
<td align="right">24</td>
<td align="right">156</td>
<td align="right">160</td>
<td align="right">39</td>
<td align="right">86</td>
<td align="right">29</td>
<td align="right">131</td>
<td align="right">0</td>
<td align="right">472</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Langsto Galloway</td>
<td align="left">NYK</td>
<td align="left">PG</td>
<td align="right">82</td>
<td align="right">2032</td>
<td align="right">231</td>
<td align="right">588</td>
<td align="right">77</td>
<td align="right">224</td>
<td align="right">86</td>
<td align="right">114</td>
<td align="right">43</td>
<td align="right">288</td>
<td align="right">207</td>
<td align="right">77</td>
<td align="right">61</td>
<td align="right">22</td>
<td align="right">177</td>
<td align="right">2</td>
<td align="right">625</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Paul George</td>
<td align="left">IND</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">2828</td>
<td align="right">605</td>
<td align="right">1448</td>
<td align="right">210</td>
<td align="right">565</td>
<td align="right">454</td>
<td align="right">528</td>
<td align="right">79</td>
<td align="right">563</td>
<td align="right">329</td>
<td align="right">152</td>
<td align="right">265</td>
<td align="right">29</td>
<td align="right">230</td>
<td align="right">1</td>
<td align="right">1874</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Draymond Green</td>
<td align="left">GSW</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">2807</td>
<td align="right">401</td>
<td align="right">819</td>
<td align="right">100</td>
<td align="right">258</td>
<td align="right">229</td>
<td align="right">329</td>
<td align="right">130</td>
<td align="right">765</td>
<td align="right">597</td>
<td align="right">118</td>
<td align="right">259</td>
<td align="right">111</td>
<td align="right">240</td>
<td align="right">2</td>
<td align="right">1131</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">James Harden</td>
<td align="left">HOU</td>
<td align="left">SG</td>
<td align="right">82</td>
<td align="right">3121</td>
<td align="right">710</td>
<td align="right">1617</td>
<td align="right">236</td>
<td align="right">656</td>
<td align="right">720</td>
<td align="right">837</td>
<td align="right">63</td>
<td align="right">502</td>
<td align="right">612</td>
<td align="right">138</td>
<td align="right">374</td>
<td align="right">51</td>
<td align="right">229</td>
<td align="right">1</td>
<td align="right">2376</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Roy Hibbert</td>
<td align="left">LAL</td>
<td align="left">C</td>
<td align="right">81</td>
<td align="right">1881</td>
<td align="right">182</td>
<td align="right">411</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">117</td>
<td align="right">145</td>
<td align="right">131</td>
<td align="right">398</td>
<td align="right">95</td>
<td align="right">32</td>
<td align="right">76</td>
<td align="right">110</td>
<td align="right">252</td>
<td align="right">3</td>
<td align="right">481</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Al Horford</td>
<td align="left">ATL</td>
<td align="left">PF</td>
<td align="right">82</td>
<td align="right">2638</td>
<td align="right">529</td>
<td align="right">1049</td>
<td align="right">88</td>
<td align="right">257</td>
<td align="right">103</td>
<td align="right">129</td>
<td align="right">148</td>
<td align="right">597</td>
<td align="right">263</td>
<td align="right">67</td>
<td align="right">107</td>
<td align="right">122</td>
<td align="right">163</td>
<td align="right">0</td>
<td align="right">1249</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Joe Ingles</td>
<td align="left">UTA</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">1241</td>
<td align="right">124</td>
<td align="right">291</td>
<td align="right">81</td>
<td align="right">210</td>
<td align="right">13</td>
<td align="right">18</td>
<td align="right">19</td>
<td align="right">151</td>
<td align="right">96</td>
<td align="right">55</td>
<td align="right">65</td>
<td align="right">4</td>
<td align="right">98</td>
<td align="right">0</td>
<td align="right">342</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Joe Johnson</td>
<td align="left">MIA</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">2703</td>
<td align="right">377</td>
<td align="right">859</td>
<td align="right">120</td>
<td align="right">313</td>
<td align="right">118</td>
<td align="right">142</td>
<td align="right">49</td>
<td align="right">292</td>
<td align="right">318</td>
<td align="right">61</td>
<td align="right">160</td>
<td align="right">4</td>
<td align="right">146</td>
<td align="right">0</td>
<td align="right">992</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Frank Kaminsky</td>
<td align="left">CHA</td>
<td align="left">PF</td>
<td align="right">81</td>
<td align="right">1713</td>
<td align="right">215</td>
<td align="right">525</td>
<td align="right">68</td>
<td align="right">202</td>
<td align="right">108</td>
<td align="right">148</td>
<td align="right">69</td>
<td align="right">336</td>
<td align="right">97</td>
<td align="right">37</td>
<td align="right">58</td>
<td align="right">43</td>
<td align="right">126</td>
<td align="right">0</td>
<td align="right">606</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Enes Kanter</td>
<td align="left">OKL</td>
<td align="left">C</td>
<td align="right">82</td>
<td align="right">1721</td>
<td align="right">415</td>
<td align="right">720</td>
<td align="right">10</td>
<td align="right">21</td>
<td align="right">200</td>
<td align="right">251</td>
<td align="right">250</td>
<td align="right">665</td>
<td align="right">33</td>
<td align="right">26</td>
<td align="right">115</td>
<td align="right">33</td>
<td align="right">166</td>
<td align="right">1</td>
<td align="right">1040</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Zach Lavine</td>
<td align="left">MIN</td>
<td align="left">PG</td>
<td align="right">82</td>
<td align="right">2295</td>
<td align="right">433</td>
<td align="right">960</td>
<td align="right">123</td>
<td align="right">316</td>
<td align="right">161</td>
<td align="right">203</td>
<td align="right">28</td>
<td align="right">229</td>
<td align="right">252</td>
<td align="right">69</td>
<td align="right">155</td>
<td align="right">17</td>
<td align="right">193</td>
<td align="right">1</td>
<td align="right">1150</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">33</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Robin Lopez</td>
<td align="left">NYK</td>
<td align="left">C</td>
<td align="right">82</td>
<td align="right">2213</td>
<td align="right">357</td>
<td align="right">662</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">128</td>
<td align="right">161</td>
<td align="right">268</td>
<td align="right">602</td>
<td align="right">114</td>
<td align="right">16</td>
<td align="right">133</td>
<td align="right">129</td>
<td align="right">182</td>
<td align="right">2</td>
<td align="right">842</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">T.j. Mcconnell</td>
<td align="left">PHI</td>
<td align="left">PG</td>
<td align="right">81</td>
<td align="right">1609</td>
<td align="right">218</td>
<td align="right">464</td>
<td align="right">31</td>
<td align="right">89</td>
<td align="right">26</td>
<td align="right">41</td>
<td align="right">43</td>
<td align="right">250</td>
<td align="right">367</td>
<td align="right">95</td>
<td align="right">140</td>
<td align="right">10</td>
<td align="right">114</td>
<td align="right">0</td>
<td align="right">493</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Doug Mcdermott</td>
<td align="left">CHI</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">1860</td>
<td align="right">291</td>
<td align="right">644</td>
<td align="right">110</td>
<td align="right">259</td>
<td align="right">72</td>
<td align="right">84</td>
<td align="right">37</td>
<td align="right">195</td>
<td align="right">59</td>
<td align="right">14</td>
<td align="right">52</td>
<td align="right">6</td>
<td align="right">127</td>
<td align="right">0</td>
<td align="right">764</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Patty Mills</td>
<td align="left">SAN</td>
<td align="left">PG</td>
<td align="right">81</td>
<td align="right">1659</td>
<td align="right">260</td>
<td align="right">612</td>
<td align="right">123</td>
<td align="right">320</td>
<td align="right">47</td>
<td align="right">58</td>
<td align="right">27</td>
<td align="right">158</td>
<td align="right">226</td>
<td align="right">59</td>
<td align="right">76</td>
<td align="right">6</td>
<td align="right">102</td>
<td align="right">0</td>
<td align="right">690</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Paul Millsap</td>
<td align="left">ATL</td>
<td align="left">PF</td>
<td align="right">81</td>
<td align="right">2640</td>
<td align="right">501</td>
<td align="right">1067</td>
<td align="right">74</td>
<td align="right">232</td>
<td align="right">309</td>
<td align="right">408</td>
<td align="right">197</td>
<td align="right">733</td>
<td align="right">264</td>
<td align="right">148</td>
<td align="right">191</td>
<td align="right">140</td>
<td align="right">237</td>
<td align="right">2</td>
<td align="right">1385</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Shabazz Muhammad</td>
<td align="left">MIN</td>
<td align="left">SF</td>
<td align="right">82</td>
<td align="right">1678</td>
<td align="right">317</td>
<td align="right">681</td>
<td align="right">44</td>
<td align="right">152</td>
<td align="right">185</td>
<td align="right">242</td>
<td align="right">100</td>
<td align="right">267</td>
<td align="right">52</td>
<td align="right">24</td>
<td align="right">70</td>
<td align="right">7</td>
<td align="right">94</td>
<td align="right">0</td>
<td align="right">863</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Raul Neto</td>
<td align="left">UTA</td>
<td align="left">PG</td>
<td align="right">81</td>
<td align="right">1501</td>
<td align="right">180</td>
<td align="right">418</td>
<td align="right">64</td>
<td align="right">162</td>
<td align="right">52</td>
<td align="right">70</td>
<td align="right">17</td>
<td align="right">120</td>
<td align="right">173</td>
<td align="right">62</td>
<td align="right">109</td>
<td align="right">2</td>
<td align="right">122</td>
<td align="right">1</td>
<td align="right">476</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">53</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Mason Plumlee</td>
<td align="left">POR</td>
<td align="left">PF</td>
<td align="right">82</td>
<td align="right">2087</td>
<td align="right">267</td>
<td align="right">517</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">215</td>
<td align="right">335</td>
<td align="right">201</td>
<td align="right">628</td>
<td align="right">226</td>
<td align="right">68</td>
<td align="right">154</td>
<td align="right">82</td>
<td align="right">253</td>
<td align="right">4</td>
<td align="right">749</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Julius Randle</td>
<td align="left">LAL</td>
<td align="left">PF</td>
<td align="right">81</td>
<td align="right">2287</td>
<td align="right">358</td>
<td align="right">835</td>
<td align="right">10</td>
<td align="right">36</td>
<td align="right">193</td>
<td align="right">270</td>
<td align="right">172</td>
<td align="right">830</td>
<td align="right">144</td>
<td align="right">53</td>
<td align="right">149</td>
<td align="right">29</td>
<td align="right">242</td>
<td align="right">2</td>
<td align="right">919</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Ramon Sessions</td>
<td align="left">WAS</td>
<td align="left">PG</td>
<td align="right">82</td>
<td align="right">1667</td>
<td align="right">280</td>
<td align="right">592</td>
<td align="right">36</td>
<td align="right">111</td>
<td align="right">214</td>
<td align="right">283</td>
<td align="right">26</td>
<td align="right">204</td>
<td align="right">240</td>
<td align="right">47</td>
<td align="right">115</td>
<td align="right">5</td>
<td align="right">102</td>
<td align="right">0</td>
<td align="right">810</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Jared Sullinger</td>
<td align="left">BOS</td>
<td align="left">PF</td>
<td align="right">81</td>
<td align="right">1917</td>
<td align="right">351</td>
<td align="right">807</td>
<td align="right">29</td>
<td align="right">104</td>
<td align="right">103</td>
<td align="right">161</td>
<td align="right">194</td>
<td align="right">673</td>
<td align="right">187</td>
<td align="right">75</td>
<td align="right">102</td>
<td align="right">47</td>
<td align="right">209</td>
<td align="right">2</td>
<td align="right">834</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">73</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Isaiah Thomas</td>
<td align="left">BOS</td>
<td align="left">PG</td>
<td align="right">82</td>
<td align="right">2647</td>
<td align="right">591</td>
<td align="right">1382</td>
<td align="right">167</td>
<td align="right">465</td>
<td align="right">474</td>
<td align="right">544</td>
<td align="right">46</td>
<td align="right">243</td>
<td align="right">509</td>
<td align="right">91</td>
<td align="right">220</td>
<td align="right">9</td>
<td align="right">167</td>
<td align="right">1</td>
<td align="right">1823</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Tristan Thompson</td>
<td align="left">CLE</td>
<td align="left">C</td>
<td align="right">82</td>
<td align="right">2269</td>
<td align="right">247</td>
<td align="right">420</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">149</td>
<td align="right">242</td>
<td align="right">268</td>
<td align="right">738</td>
<td align="right">63</td>
<td align="right">38</td>
<td align="right">61</td>
<td align="right">51</td>
<td align="right">202</td>
<td align="right">0</td>
<td align="right">643</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">34</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Karl-antho Towns</td>
<td align="left">MIN</td>
<td align="left">C</td>
<td align="right">82</td>
<td align="right">2621</td>
<td align="right">625</td>
<td align="right">1152</td>
<td align="right">30</td>
<td align="right">88</td>
<td align="right">223</td>
<td align="right">275</td>
<td align="right">226</td>
<td align="right">854</td>
<td align="right">161</td>
<td align="right">58</td>
<td align="right">183</td>
<td align="right">138</td>
<td align="right">245</td>
<td align="right">1</td>
<td align="right">1503</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">82</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">P.j. Tucker</td>
<td align="left">PHO</td>
<td align="left">SF</td>
<td align="right">82</td>
<td align="right">2540</td>
<td align="right">239</td>
<td align="right">582</td>
<td align="right">68</td>
<td align="right">206</td>
<td align="right">106</td>
<td align="right">142</td>
<td align="right">165</td>
<td align="right">512</td>
<td align="right">177</td>
<td align="right">106</td>
<td align="right">111</td>
<td align="right">20</td>
<td align="right">202</td>
<td align="right">3</td>
<td align="right">652</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">80</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Evan Turner</td>
<td align="left">BOS</td>
<td align="left">SG</td>
<td align="right">81</td>
<td align="right">2270</td>
<td align="right">343</td>
<td align="right">753</td>
<td align="right">20</td>
<td align="right">83</td>
<td align="right">148</td>
<td align="right">179</td>
<td align="right">50</td>
<td align="right">397</td>
<td align="right">359</td>
<td align="right">80</td>
<td align="right">169</td>
<td align="right">28</td>
<td align="right">139</td>
<td align="right">0</td>
<td align="right">854</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Kemba Walker</td>
<td align="left">CHA</td>
<td align="left">PG</td>
<td align="right">81</td>
<td align="right">2885</td>
<td align="right">568</td>
<td align="right">1332</td>
<td align="right">182</td>
<td align="right">490</td>
<td align="right">371</td>
<td align="right">438</td>
<td align="right">56</td>
<td align="right">358</td>
<td align="right">421</td>
<td align="right">127</td>
<td align="right">171</td>
<td align="right">39</td>
<td align="right">111</td>
<td align="right">0</td>
<td align="right">1689</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">NBA</td>
<td align="left">Andrew Wiggins</td>
<td align="left">MIN</td>
<td align="left">SF</td>
<td align="right">81</td>
<td align="right">2844</td>
<td align="right">594</td>
<td align="right">1294</td>
<td align="right">57</td>
<td align="right">190</td>
<td align="right">430</td>
<td align="right">565</td>
<td align="right">107</td>
<td align="right">294</td>
<td align="right">164</td>
<td align="right">78</td>
<td align="right">182</td>
<td align="right">46</td>
<td align="right">165</td>
<td align="right">1</td>
<td align="right">1675</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">NBA</td>
<td align="left">Marvin Williams</td>
<td align="left">CHA</td>
<td align="left">PF</td>
<td align="right">81</td>
<td align="right">2339</td>
<td align="right">338</td>
<td align="right">747</td>
<td align="right">152</td>
<td align="right">379</td>
<td align="right">120</td>
<td align="right">144</td>
<td align="right">127</td>
<td align="right">520</td>
<td align="right">110</td>
<td align="right">58</td>
<td align="right">62</td>
<td align="right">77</td>
<td align="right">133</td>
<td align="right">1</td>
<td align="right">948</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">81</td>
</tr>
</tbody>
</table>
</div>
<div id="j-欄位選擇運算" class="section level3">
<h3><span class="header-section-number">7.2.2</span> j 欄位選擇運算</h3>
<p>第二個參數<code>j</code>是用來決定輸出欄位，輸出的欄位可以是原始欄位，也可以是計算後的欄位，以計算所有球員的平均出場數為例：</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" title="1">NBA1516DT[,<span class="kw">mean</span>(GamesPlayed)] <span class="co">##因沒有篩選需求，,前方留空</span></a></code></pre></div>
<pre><code>## [1] 55</code></pre>
<p>也可以一次計算多個數值，如同時計算平均出場數、平均犯規次數以及平均抄截次數，此時第二個欄位<code>j</code>需要使用<code>.()</code>包起來</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" title="1">NBA1516DT[,.(<span class="kw">mean</span>(GamesPlayed),<span class="kw">mean</span>(PersonalFouls),<span class="kw">mean</span>(Steals))] <span class="co">##因沒有篩選需求，,前方留空</span></a></code></pre></div>
<pre><code>##    V1  V2 V3
## 1: 55 105 41</code></pre>
<p>由上述輸出可以發現輸出的數字自動被加上欄位名稱V1, V2, V3，可能會造成數據判別錯誤，所以在計算新欄位時，可以在新欄位定義的前方加上<code>欄位名稱=</code>，同時替欄位取名字</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" title="1">NBA1516DT[,.(<span class="dt">GamesPlayedMean=</span><span class="kw">mean</span>(GamesPlayed),</a>
<a class="sourceLine" id="cb451-2" title="2">             <span class="dt">PersonalFoulsMean=</span><span class="kw">mean</span>(PersonalFouls),</a>
<a class="sourceLine" id="cb451-3" title="3">             <span class="dt">StealsMean=</span><span class="kw">mean</span>(Steals))]</a></code></pre></div>
<pre><code>##    GamesPlayedMean PersonalFoulsMean StealsMean
## 1:              55               105         41</code></pre>
<p>除了計算平均值以外，當然可以帶入其他函式做各式各樣的運算</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" title="1">NBA1516DT[,.(<span class="dt">GamesPlayedMax=</span><span class="kw">max</span>(GamesPlayed), <span class="co">#最大值</span></a>
<a class="sourceLine" id="cb453-2" title="2">             <span class="dt">ThreesMadeMin=</span><span class="kw">min</span>(ThreesMade), <span class="co">#最小值</span></a>
<a class="sourceLine" id="cb453-3" title="3">             <span class="dt">FieldGoalsMadeSD=</span><span class="kw">sd</span>(FieldGoalsMade))] <span class="co">#標準差</span></a></code></pre></div>
<pre><code>##    GamesPlayedMax ThreesMadeMin FieldGoalsMadeSD
## 1:             82             0              166</code></pre>
<p>若配合第一個參數一起使用，可以計算出所有<strong>出場數大於70</strong>的球員，<strong>平均投進幾顆三分球與兩分球</strong></p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" title="1">NBA1516DT[GamesPlayed<span class="op">&gt;</span><span class="dv">70</span>,</a>
<a class="sourceLine" id="cb455-2" title="2">          .(<span class="dt">ThreesMadeMean=</span><span class="kw">mean</span>(ThreesMade), <span class="dt">FieldGoalsMadeMean=</span><span class="kw">mean</span>(FieldGoalsMade))]</a></code></pre></div>
<pre><code>##    ThreesMadeMean FieldGoalsMadeMean
## 1:             76                335</code></pre>
</div>
<div id="by-分組依據" class="section level3">
<h3><span class="header-section-number">7.2.3</span> by 分組依據</h3>
<p>第三個參數<code>by</code>為分組計算的依據，舉例來說，我們可以計算NBA各隊的<strong>球員數</strong>與<strong>平均助攻數</strong>，球員個數的計算在<code>data.table</code>內可使用<code>.N</code>指令，平均使用<code>mean()</code>函數，此時只要在<code>by=</code>後方加上分組依據(各隊Team)，即可完成運算</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" title="1">NBA1516DT[,.(.N,<span class="dt">AssistsMean=</span><span class="kw">mean</span>(Assists)),</a>
<a class="sourceLine" id="cb457-2" title="2">          by=Team]</a></code></pre></div>
<pre><code>##     Team  N AssistsMean
##  1:  SAC 15         134
##  2:  MEM 22          74
##  3:  OKL 14         126
##  4:  NYK 16         105
##  5:  NOR 21          87
##  6:  LAC 15         124
##  7:  SAN 16         130
##  8:  POR 15         116
##  9:  IND 15         125
## 10:  WAS 17         127
## 11:  DAL 15         124
## 12:  MIL 17         113
## 13:  DET 15         105
## 14:  ORL 15         128
## 15:  HOU 16         101
## 16:  LAL 15          99
## 17:  DEN 15         122
## 18:  CHI 15         121
## 19:  GSW 15         158
## 20:  BRO 16         100
## 21:  CHA 14         118
## 22:  ATL 15         142
## 23:  TOR 16          97
## 24:  MIN 14         129
## 25:  PHO 17          97
## 26:  UTA 17          94
## 27:  MIA 15         131
## 28:  BOS 15         128
## 29:  PHI 16         118
## 30:  CLE 16         117
## 31:  OKC  1         160
##     Team  N AssistsMean</code></pre>
<p><code>.N</code>在<code>data.table</code>內是保留字，用來計算個數</p>
<p>三個參數結合使用，可以輕鬆計算出<strong>NBA各隊的中鋒球員數和他們的平均三分球出手次數</strong>，指令如下：</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" title="1">NBA1516DT[Position<span class="op">==</span><span class="st">&quot;C&quot;</span>,</a>
<a class="sourceLine" id="cb459-2" title="2">          .(.N,<span class="dt">ThreesAttemptedMean=</span><span class="kw">mean</span>(ThreesAttempted)),</a>
<a class="sourceLine" id="cb459-3" title="3">          by=Team]</a></code></pre></div>
<pre><code>##     Team N ThreesAttemptedMean
##  1:  OKL 3                7.00
##  2:  NOR 4                0.25
##  3:  LAC 2                0.50
##  4:  DET 2                3.00
##  5:  BRO 3               10.00
##  6:  LAL 3                0.67
##  7:  WAS 2                1.00
##  8:  GSW 4               16.00
##  9:  SAN 3               34.67
## 10:  HOU 2                3.50
## 11:  SAC 3               70.67
## 12:  PHO 3                2.67
## 13:  ORL 2                4.50
## 14:  MIN 3               36.00
## 15:  MEM 2                1.50
## 16:  UTA 3                1.33
## 17:  IND 2                0.50
## 18:  CHA 1                0.00
## 19:  DEN 2               43.50
## 20:  POR 2              116.00
## 21:  CLE 3                2.33
## 22:  NYK 1                1.00
## 23:  DAL 3                1.67
## 24:  MIL 2                0.50
## 25:  CHI 1                1.00
## 26:  PHI 2                4.00
## 27:  TOR 3                6.00
## 28:  BOS 2              105.00
## 29:  ATL 1                0.00
## 30:  MIA 1                0.00
##     Team N ThreesAttemptedMean</code></pre>
</div>
<div id="參考文件與資源" class="section level3">
<h3><span class="header-section-number">7.2.4</span> 參考文件與資源</h3>
<p><code>data.table</code>還有很多好用的功能，有興趣的話可以參考下列資料</p>
<ul>
<li><a href="https://github.com/Rdatatable/data.table/wiki" target="_blank">官網</a></li>
<li>指令全集<a href="https://s3.amazonaws.com/assets.datacamp.com/img/blog/data+table+cheat+sheet.pdf" target="_blank">The data.table R package cheat sheet</a></li>
<li><a href="https://www.datacamp.com/community/tutorials/data-table-r-tutorial#gs.vzMYa_k" target="_blank">A data.table R tutorial by DataCamp</a></li>
<li>DataCamp<a href="https://www.datacamp.com/courses/data-table-data-manipulation-r-tutorial" target="_blank">互動式教學課程</a></li>
</ul>
</div>
</div>
<div id="dplyr" class="section level2">
<h2><span class="header-section-number">7.3</span> dplyr</h2>
<p><code>dplyr</code><span class="citation">(Wickham, François, et al. <a href="#ref-R-dplyr" role="doc-biblioref">2019</a>)</span> package是<a href="http://hadley.nz/" target="_blank">Hadley Wickham</a>開發的資料處理分析套件，如要使用必須安裝並載入<code>dplyr</code> package</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>) <span class="co">##安裝</span></a></code></pre></div>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1"><span class="kw">library</span>(dplyr) <span class="co">##載入</span></a></code></pre></div>
<p><code>dplyr</code>使用以下函數分析整理資料：</p>
<ul>
<li><code>select()</code>: 選要分析的欄位，欄位子集 (Column)</li>
<li><code>filter()</code>: 選要分析的觀察值，觀察值子集 (Row)</li>
<li><code>mutate()</code>: 增加新欄位</li>
<li><code>summarise()</code>: 計算統計值</li>
<li><code>group_by()</code>: 分組依據</li>
<li><code>arrange()</code>: 觀察值排序</li>
<li><code>rename()</code>: 欄位重新命名</li>
<li><code>%&gt;%</code>: the “pipe” operator 連結上數函式，將所有函式計算串在一起執行</li>
</ul>
<p>以上述NBA資料為例，各函數功能分述如下：
首先先讀入資料</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" title="1"><span class="kw">library</span>(SportsAnalytics)</a>
<a class="sourceLine" id="cb463-2" title="2">NBA1516&lt;-<span class="kw">fetch_NBAPlayerStatistics</span>(<span class="st">&quot;15-16&quot;</span>)</a></code></pre></div>
<div id="select" class="section level3">
<h3><span class="header-section-number">7.3.1</span> select()</h3>
<p>使用<code>select()</code>函式可選要分析的欄位，也就是針對欄位 (Column)做子集，函式使用方式為<code>select(資料名稱,欄位條件1,欄位條件2,...)</code>，其中條件1與條件2是使用<strong>或</strong>的連結概念。另外<code>dplyr</code>提供幾個方便篩選名稱的函式：</p>
<ul>
<li><code>starts_with()</code></li>
<li><code>ends_with()</code></li>
<li><code>contains()</code></li>
<li><code>matches()</code></li>
<li><code>num_range()</code></li>
<li><code>one_of()</code></li>
<li><code>everything()</code></li>
</ul>
<p>詳細說明可在R執行視窗中輸入<code>?select_helpers</code>查看。</p>
<p>舉例來說，我們想要篩選欄位名稱為<code>Name</code>、<code>ThreesMade</code>、<code>ThreesAttempted</code>、<code>FieldGoalsMade</code>與<code>FieldGoalsAttempted</code>的五個欄位，指令範例如下</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1"><span class="co">##等同於</span></a>
<a class="sourceLine" id="cb464-2" title="2"><span class="co">##NBA1516[,c(&quot;Name&quot;,&quot;ThreesMade&quot;,&quot;ThreesAttempted&quot;,&quot;FieldGoalsMade&quot;,&quot;FieldGoalsAttempted&quot;)]</span></a>
<a class="sourceLine" id="cb464-3" title="3">select1&lt;-<span class="kw">select</span>(NBA1516,Name,<span class="kw">starts_with</span>(<span class="st">&quot;Threes&quot;</span>),<span class="kw">starts_with</span>(<span class="st">&quot;FieldGoals&quot;</span>))</a>
<a class="sourceLine" id="cb464-4" title="4"><span class="kw">head</span>(select1)</a></code></pre></div>
<pre><code>##            Name ThreesMade ThreesAttempted FieldGoalsMade FieldGoalsAttempted
## 1    Quincy Acy         19              49            119                 214
## 2  Jordan Adams          0               1              2                   6
## 3  Steven Adams          0               0            261                 426
## 4 Arron Afflalo         91             238            354                 799
## 5 Alexis Ajinca          0               1            150                 314
## 6  Cole Aldrich          0               0            134                 225</code></pre>
<p>若想篩選欄位<code>Name</code>到欄位<code>FreeThrowsAttempted</code>間的所有欄位，可用<code>:</code>串連欄位名稱</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" title="1"><span class="co">##等同於NBA1516[,2:12]</span></a>
<a class="sourceLine" id="cb466-2" title="2">select2&lt;-<span class="kw">select</span>(NBA1516,Name<span class="op">:</span>FreeThrowsAttempted)</a>
<a class="sourceLine" id="cb466-3" title="3"><span class="kw">head</span>(select2)</a></code></pre></div>
<pre><code>##            Name Team Position GamesPlayed TotalMinutesPlayed FieldGoalsMade
## 1    Quincy Acy  SAC       SF          59                877            119
## 2  Jordan Adams  MEM       SG           2                 15              2
## 3  Steven Adams  OKL        C          80               2019            261
## 4 Arron Afflalo  NYK       SG          71               2359            354
## 5 Alexis Ajinca  NOR        C          59                863            150
## 6  Cole Aldrich  LAC        C          60                802            134
##   FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1                 214         19              49             50
## 2                   6          0               1              3
## 3                 426          0               0            114
## 4                 799         91             238            110
## 5                 314          0               1             52
## 6                 225          0               0             60
##   FreeThrowsAttempted
## 1                  68
## 2                   5
## 3                 196
## 4                 131
## 5                  62
## 6                  84</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" title="1"><span class="co">##等同於NBA1516[,c(2:4,6:12)]</span></a>
<a class="sourceLine" id="cb468-2" title="2">select3&lt;-<span class="kw">select</span>(NBA1516,Name<span class="op">:</span>FreeThrowsAttempted,<span class="op">-</span>GamesPlayed)</a>
<a class="sourceLine" id="cb468-3" title="3"><span class="kw">head</span>(select3)</a></code></pre></div>
<pre><code>##            Name Team Position TotalMinutesPlayed FieldGoalsMade
## 1    Quincy Acy  SAC       SF                877            119
## 2  Jordan Adams  MEM       SG                 15              2
## 3  Steven Adams  OKL        C               2019            261
## 4 Arron Afflalo  NYK       SG               2359            354
## 5 Alexis Ajinca  NOR        C                863            150
## 6  Cole Aldrich  LAC        C                802            134
##   FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1                 214         19              49             50
## 2                   6          0               1              3
## 3                 426          0               0            114
## 4                 799         91             238            110
## 5                 314          0               1             52
## 6                 225          0               0             60
##   FreeThrowsAttempted
## 1                  68
## 2                   5
## 3                 196
## 4                 131
## 5                  62
## 6                  84</code></pre>
</div>
<div id="filter" class="section level3">
<h3><span class="header-section-number">7.3.2</span> filter()</h3>
<p>使用<code>filter()</code>函式可選要分析的觀察值，也就是針對列 (Row)做子集，使用方法為<code>filter(資料名稱,篩選條件)</code>，舉例來說，如果想要看出場分鐘數超過2850分鐘的球員資料，可用輸入下列指令</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" title="1"><span class="co">##等同於 NBA1516[NBA1516$TotalMinutesPlayed&gt;2850,]</span></a>
<a class="sourceLine" id="cb470-2" title="2">filter1&lt;-<span class="kw">filter</span>(NBA1516,TotalMinutesPlayed<span class="op">&gt;</span><span class="dv">2850</span>)</a>
<a class="sourceLine" id="cb470-3" title="3">filter1</a></code></pre></div>
<pre><code>##   League            Name Team Position GamesPlayed TotalMinutesPlayed
## 1    NBA    Trevor Ariza  HOU       SF          81               2860
## 2    NBA    James Harden  HOU       SG          82               3121
## 3    NBA  Gordon Hayward  UTA       SG          80               2889
## 4    NBA      Kyle Lowry  TOR       PG          77               2853
## 5    NBA Khris Middleton  MIL       SF          79               2855
## 6    NBA   Marcus Morris  DET       SF          80               2852
## 7    NBA    Kemba Walker  CHA       PG          81               2885
##   FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1            357                 858        185             497            126
## 2            710                1617        236             656            720
## 3            521                1202        143             410            393
## 4            512                1198        212             546            398
## 5            507                1144        143             362            277
## 6            410                 945        108             297            203
## 7            568                1332        182             490            371
##   FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists Steals Turnovers
## 1                 161                67           366     188    161       113
## 2                 837                63           502     612    138       374
## 3                 477                61           397     296     95       202
## 4                 491                55           365     494    158       225
## 5                 312                45           301     331    131       180
## 6                 271                91           404     201     67       140
## 7                 438                56           358     421    127       171
##   Blocks PersonalFouls Disqualifications TotalPoints Technicals Ejections
## 1     26           177                 0        1025          2         0
## 2     51           229                 1        2376          2         0
## 3     27           183                 0        1578          0         0
## 4     34           211                 1        1634          9         0
## 5     19           204                 1        1434          5         0
## 6     23           170                 1        1131         11         0
## 7     39           111                 0        1689          5         0
##   FlagrantFouls GamesStarted
## 1             0           81
## 2             0           82
## 3             0           80
## 4             0           77
## 5             0           79
## 6             0           80
## 7             0           81</code></pre>
<p>也可選擇隊伍名稱為“BOS”或“SAN”的球員資料</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" title="1"><span class="co">##等同於 NBA1516[NBA1516$Team %in% c(&quot;BOS&quot;,&quot;SAN&quot;),]</span></a>
<a class="sourceLine" id="cb472-2" title="2">filter2&lt;-<span class="kw">filter</span>(NBA1516,Team <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BOS&quot;</span>,<span class="st">&quot;SAN&quot;</span>))</a>
<a class="sourceLine" id="cb472-3" title="3"><span class="kw">head</span>(filter2)</a></code></pre></div>
<pre><code>##   League             Name Team Position GamesPlayed TotalMinutesPlayed
## 1    NBA Lamarcu Aldridge  SAN       PF          74               2260
## 2    NBA    Kyle Anderson  SAN       SF          78               1247
## 3    NBA      Matt Bonner  SAN        C          30                210
## 4    NBA    Avery Bradley  BOS       PG          76               2536
## 5    NBA    Rasual Butler  SAN       SF          46                432
## 6    NBA      Coty Clarke  BOS     &lt;NA&gt;           4                  8
##   FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1            536                1045          0              16            259
## 2            138                 296         12              37             62
## 3             29                  58         15              35              3
## 4            456                1018        147             406             96
## 5             49                 105         15              49             11
## 6              2                   4          2               2              0
##   FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists Steals Turnovers
## 1                 302               175           631     110     38        99
## 2                  83                25           245     123     60        59
## 3                   4                 3            27       9      6         3
## 4                 123                48           220     158    117       109
## 5                  16                 3            56      24     13         8
## 6                   0                 0             1       0      0         1
##   Blocks PersonalFouls Disqualifications TotalPoints Technicals Ejections
## 1     81           151                 0        1331          0         0
## 2     29            97                 0         350          0         0
## 3      1            16                 0          76          0         0
## 4     19           164                 2        1155          0         0
## 5     23            11                 0         124          0         0
## 6      0             0                 0           6          0         0
##   FlagrantFouls GamesStarted
## 1             0           74
## 2             0           11
## 3             0            2
## 4             0           72
## 5             0            0
## 6             0            0</code></pre>
<p>在<code>filter()</code>函式中可<strong>直接做變數計算</strong>後再篩選</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" title="1"><span class="co">##等同於</span></a>
<a class="sourceLine" id="cb474-2" title="2">filter3&lt;-<span class="kw">filter</span>(NBA1516,FieldGoalsMade<span class="op">/</span>FieldGoalsAttempted<span class="op">&gt;</span><span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb474-3" title="3">filter3</a></code></pre></div>
<pre><code>##   League             Name Team Position GamesPlayed TotalMinutesPlayed
## 1    NBA Th Antetokounmpo  NYK       SF           3                  7
## 2    NBA Rakeem Christmas  IND       PF           1                  6
## 3    NBA   Deandre Jordan  LAC        C          77               2600
##   FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1              3                   4          0               1              0
## 2              2                   2          0               0              0
## 3            357                 507          0               1            266
##   FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists Steals Turnovers
## 1                   0                 0             1       0      0         0
## 2                   0                 1             1       0      0         0
## 3                 619               267          1059      90     52       107
##   Blocks PersonalFouls Disqualifications TotalPoints Technicals Ejections
## 1      0             2                 0           6          0         0
## 2      0             1                 0           4          0         0
## 3    176           207                 1         980         10         0
##   FlagrantFouls GamesStarted
## 1             0            0
## 2             0            0
## 3             0           77</code></pre>
<p>也可使用 <code>&amp;</code> 和 <code>|</code>等符號串連邏輯</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb476-1" title="1"><span class="co">##等同於</span></a>
<a class="sourceLine" id="cb476-2" title="2">filter4&lt;-<span class="kw">filter</span>(NBA1516,FieldGoalsMade<span class="op">/</span>FieldGoalsAttempted<span class="op">&gt;</span><span class="fl">0.7</span> <span class="op">&amp;</span><span class="st"> </span>GamesPlayed<span class="op">&gt;</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb476-3" title="3">filter4</a></code></pre></div>
<pre><code>##   League           Name Team Position GamesPlayed TotalMinutesPlayed
## 1    NBA Deandre Jordan  LAC        C          77               2600
##   FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1            357                 507          0               1            266
##   FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists Steals Turnovers
## 1                 619               267          1059      90     52       107
##   Blocks PersonalFouls Disqualifications TotalPoints Technicals Ejections
## 1    176           207                 1         980         10         0
##   FlagrantFouls GamesStarted
## 1             0           77</code></pre>
</div>
<div id="mutate" class="section level3">
<h3><span class="header-section-number">7.3.3</span> mutate()</h3>
<p>使用<code>mutate()</code>增加新欄位，如需新增新欄位<code>FieldGoalsRate</code>，欄位值為<code>FieldGoalsMade/FieldGoalsAttempted</code>，指令如下</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb478-1" title="1">mutate1&lt;-<span class="kw">mutate</span>(NBA1516,<span class="dt">FieldGoalsRate=</span>FieldGoalsMade<span class="op">/</span>FieldGoalsAttempted)</a>
<a class="sourceLine" id="cb478-2" title="2">mutate1<span class="op">$</span>FieldGoalsRate[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<pre><code>##  [1] 0.56 0.33 0.61 0.44 0.48 0.60 0.51 0.50 0.52 0.46</code></pre>
</div>
<div id="summarise" class="section level3">
<h3><span class="header-section-number">7.3.4</span> summarise()</h3>
<p><code>summarise()</code>函式用來計算統計值，像是<strong>球員個數</strong>、<strong>不重複的隊伍數</strong>以及<strong>不重複的守備位置數</strong>等</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb480-1" title="1">sum1&lt;-<span class="kw">summarise</span>(NBA1516,</a>
<a class="sourceLine" id="cb480-2" title="2">                <span class="dt">nPlayer=</span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb480-3" title="3">                <span class="dt">nTeam=</span><span class="kw">n_distinct</span>(Team),</a>
<a class="sourceLine" id="cb480-4" title="4">                <span class="dt">nPosition=</span><span class="kw">n_distinct</span>(Position))</a>
<a class="sourceLine" id="cb480-5" title="5">sum1</a></code></pre></div>
<pre><code>##   nPlayer nTeam nPosition
## 1     476    31         6</code></pre>
<p>計算統計值的功能通常會與其他功能合併使用，像是與前述<code>filter()</code>功能 Ch @ref(filter)合併使用，可計算<strong>出場分鐘數大於2500分鐘</strong>的球員個數、平均投進的兩分球數以及平均投出的兩分球數</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb482-1" title="1">filter1&lt;-<span class="kw">filter</span>(NBA1516,TotalMinutesPlayed<span class="op">&gt;</span><span class="dv">2500</span>)</a>
<a class="sourceLine" id="cb482-2" title="2">sum2&lt;-<span class="kw">summarise</span>(filter1,</a>
<a class="sourceLine" id="cb482-3" title="3">                <span class="dt">nPlayer=</span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb482-4" title="4">                <span class="dt">meanFieldGoalsMade=</span><span class="kw">mean</span>(FieldGoalsMade),</a>
<a class="sourceLine" id="cb482-5" title="5">                <span class="dt">meanFieldGoalsAttempted=</span><span class="kw">mean</span>(FieldGoalsAttempted))</a>
<a class="sourceLine" id="cb482-6" title="6">sum2</a></code></pre></div>
<pre><code>##   nPlayer meanFieldGoalsMade meanFieldGoalsAttempted
## 1      40                512                    1121</code></pre>
<p>上述分析序列（先篩選再總和），可直接用<strong>pipe</strong>符號<code>%&gt;%</code>將指令串連，減少暫存物件（filter1）的生成，主要概念是先篩選後計算</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb484-1" title="1">sum3&lt;-<span class="kw">filter</span>(NBA1516,TotalMinutesPlayed<span class="op">&gt;</span><span class="dv">2500</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb484-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nPlayer=</span><span class="kw">n</span>(),<span class="dt">meanFieldGoalsMade=</span><span class="kw">mean</span>(FieldGoalsMade),</a>
<a class="sourceLine" id="cb484-3" title="3">                <span class="dt">meanFieldGoalsAttempted=</span><span class="kw">mean</span>(FieldGoalsAttempted))</a>
<a class="sourceLine" id="cb484-4" title="4">sum3</a></code></pre></div>
<pre><code>##   nPlayer meanFieldGoalsMade meanFieldGoalsAttempted
## 1      40                512                    1121</code></pre>
</div>
<div id="group_by" class="section level3">
<h3><span class="header-section-number">7.3.5</span> group_by()</h3>
<p><code>group_by()</code>函數的功能為設定分組依據，通常會與<code>summarise()</code>函式Ch @ref(summarise)合併使用，例如計算各<strong>隊</strong>（以Team作為分組依據）的球員數、平均投進的兩分球數以及平均投出的兩分球數</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb486-1" title="1">group1&lt;-<span class="kw">group_by</span>(NBA1516,Team)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb486-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nPlayer=</span><span class="kw">n</span>(),<span class="dt">meanFieldGoalsMade=</span><span class="kw">mean</span>(FieldGoalsMade),</a>
<a class="sourceLine" id="cb486-3" title="3">                <span class="dt">meanFieldGoalsAttempted=</span><span class="kw">mean</span>(FieldGoalsAttempted))</a>
<a class="sourceLine" id="cb486-4" title="4"><span class="kw">head</span>(group1)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Team  nPlayer meanFieldGoalsMade meanFieldGoalsAttempted
##   &lt;fct&gt;   &lt;int&gt;              &lt;dbl&gt;                   &lt;dbl&gt;
## 1 ATL        15               215                     471.
## 2 BOS        15               209.                    475.
## 3 BRO        16               181.                    396.
## 4 CHA        14               199.                    451.
## 5 CHI        15               209.                    475.
## 6 CLE        16               200.                    433.</code></pre>
<p>當然也可以設定<strong>多個</strong>分組依據，像是計算各<strong>隊</strong>各<strong>守備位置</strong>（以Team和Position作為分組依據）的球員數、平均投進的兩分球數以及平均投出的兩分球數</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" title="1">group2&lt;-<span class="kw">group_by</span>(NBA1516,Team,Position)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb488-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nPlayer=</span><span class="kw">n</span>(),<span class="dt">meanFieldGoalsMade=</span><span class="kw">mean</span>(FieldGoalsMade),</a>
<a class="sourceLine" id="cb488-3" title="3">                <span class="dt">meanFieldGoalsAttempted=</span><span class="kw">mean</span>(FieldGoalsAttempted))</a></code></pre></div>
<pre><code>## Warning: Factor `Position` contains implicit NA, consider using
## `forcats::fct_explicit_na`</code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb490-1" title="1"><span class="kw">head</span>(group2)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
## # Groups:   Team [2]
##   Team  Position nPlayer meanFieldGoalsMade meanFieldGoalsAttempted
##   &lt;fct&gt; &lt;fct&gt;      &lt;int&gt;              &lt;dbl&gt;                   &lt;dbl&gt;
## 1 ATL   C              1                11                      19 
## 2 ATL   PF             6               247.                    516.
## 3 ATL   PG             2               382.                    884 
## 4 ATL   SG             6               161.                    364.
## 5 BOS   C              2               196.                    423 
## 6 BOS   PF             4               182.                    386.</code></pre>
</div>
<div id="arrange" class="section level3">
<h3><span class="header-section-number">7.3.6</span> arrange()</h3>
<p>排序功能，預設為<strong>遞增排序</strong></p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" title="1">arrange1&lt;-<span class="kw">arrange</span>(NBA1516,TotalMinutesPlayed)</a>
<a class="sourceLine" id="cb492-2" title="2"><span class="kw">head</span>(arrange1)</a></code></pre></div>
<pre><code>##   League             Name Team Position GamesPlayed TotalMinutesPlayed
## 1    NBA     J.j. O&#39;brien  UTA       SF           1                  2
## 2    NBA Rakeem Christmas  IND       PF           1                  6
## 3    NBA Th Antetokounmpo  NYK       SF           3                  7
## 4    NBA       Sam Dekker  HOU       SF           3                  7
## 5    NBA      Coty Clarke  BOS     &lt;NA&gt;           4                  8
## 6    NBA     Jordan Adams  MEM       SG           2                 15
##   FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1              0                   1          0               0              0
## 2              2                   2          0               0              0
## 3              3                   4          0               1              0
## 4              0                   0          0               0              0
## 5              2                   4          2               2              0
## 6              2                   6          0               1              3
##   FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists Steals Turnovers
## 1                   0                 0             0       0      0         0
## 2                   0                 1             1       0      0         0
## 3                   0                 0             1       0      0         0
## 4                   0                 0             1       0      1         0
## 5                   0                 0             1       0      0         1
## 6                   5                 0             2       3      3         2
##   Blocks PersonalFouls Disqualifications TotalPoints Technicals Ejections
## 1      0             0                 0           0          0         0
## 2      0             1                 0           4          0         0
## 3      0             2                 0           6          0         0
## 4      0             0                 0           0          0         0
## 5      0             0                 0           6          0         0
## 6      0             2                 0           7          0         0
##   FlagrantFouls GamesStarted
## 1             0            0
## 2             0            0
## 3             0            0
## 4             0            0
## 5             0            0
## 6             0            0</code></pre>
<p>使用<code>desc()</code>將要<strong>遞減排序</strong>的變數包起來，就可以遞減排序</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb494-1" title="1">arrange2&lt;-<span class="kw">arrange</span>(NBA1516,<span class="kw">desc</span>(TotalMinutesPlayed),<span class="kw">desc</span>(GamesPlayed))</a>
<a class="sourceLine" id="cb494-2" title="2"><span class="kw">head</span>(arrange2)</a></code></pre></div>
<pre><code>##   League            Name Team Position GamesPlayed TotalMinutesPlayed
## 1    NBA    James Harden  HOU       SG          82               3121
## 2    NBA  Gordon Hayward  UTA       SG          80               2889
## 3    NBA    Kemba Walker  CHA       PG          81               2885
## 4    NBA    Trevor Ariza  HOU       SF          81               2860
## 5    NBA Khris Middleton  MIL       SF          79               2855
## 6    NBA      Kyle Lowry  TOR       PG          77               2853
##   FieldGoalsMade FieldGoalsAttempted ThreesMade ThreesAttempted FreeThrowsMade
## 1            710                1617        236             656            720
## 2            521                1202        143             410            393
## 3            568                1332        182             490            371
## 4            357                 858        185             497            126
## 5            507                1144        143             362            277
## 6            512                1198        212             546            398
##   FreeThrowsAttempted OffensiveRebounds TotalRebounds Assists Steals Turnovers
## 1                 837                63           502     612    138       374
## 2                 477                61           397     296     95       202
## 3                 438                56           358     421    127       171
## 4                 161                67           366     188    161       113
## 5                 312                45           301     331    131       180
## 6                 491                55           365     494    158       225
##   Blocks PersonalFouls Disqualifications TotalPoints Technicals Ejections
## 1     51           229                 1        2376          2         0
## 2     27           183                 0        1578          0         0
## 3     39           111                 0        1689          5         0
## 4     26           177                 0        1025          2         0
## 5     19           204                 1        1434          5         0
## 6     34           211                 1        1634          9         0
##   FlagrantFouls GamesStarted
## 1             0           82
## 2             0           80
## 3             0           81
## 4             0           81
## 5             0           79
## 6             0           77</code></pre>
<p>結合<code>group_by()</code>、<code>summarise()</code>、<code>arrange()</code>，可完成一連串的資料分析，例如計算各<strong>隊</strong>各<strong>守備</strong>位置（以Team和Position作為分組依據）的球員數、平均投進的兩分球數以及平均投出的兩分球數，並依平均投進的兩分球數<strong>由大到小排序</strong></p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb496-1" title="1">arrange3&lt;-<span class="kw">group_by</span>(NBA1516,Team,Position)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb496-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">nPlayer=</span><span class="kw">n</span>(),<span class="dt">meanFieldGoalsMade=</span><span class="kw">mean</span>(FieldGoalsMade),</a>
<a class="sourceLine" id="cb496-3" title="3">                <span class="dt">meanFieldGoalsAttempted=</span><span class="kw">mean</span>(FieldGoalsAttempted)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb496-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(meanFieldGoalsMade))</a></code></pre></div>
<pre><code>## Warning: Factor `Position` contains implicit NA, consider using
## `forcats::fct_explicit_na`</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb498-1" title="1"><span class="kw">head</span>(arrange3)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
## # Groups:   Team [6]
##   Team  Position nPlayer meanFieldGoalsMade meanFieldGoalsAttempted
##   &lt;fct&gt; &lt;fct&gt;      &lt;int&gt;              &lt;dbl&gt;                   &lt;dbl&gt;
## 1 GSW   PG             2               504                      988
## 2 CLE   SF             2               440                      864
## 3 ORL   SG             1               425                      969
## 4 MIA   C              1               412                      681
## 5 OKL   PG             2               385                      861
## 6 ATL   PG             2               382.                     884</code></pre>
</div>
<div id="rename" class="section level3">
<h3><span class="header-section-number">7.3.7</span> rename()</h3>
<p><code>新名稱=舊名稱</code></p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb500-1" title="1">rename1&lt;-<span class="kw">rename</span>(NBA1516,<span class="dt">Po=</span>Position)</a>
<a class="sourceLine" id="cb500-2" title="2">rename1[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>##   League          Name Team Po GamesPlayed
## 1    NBA    Quincy Acy  SAC SF          59
## 2    NBA  Jordan Adams  MEM SG           2
## 3    NBA  Steven Adams  OKL  C          80
## 4    NBA Arron Afflalo  NYK SG          71
## 5    NBA Alexis Ajinca  NOR  C          59</code></pre>
</div>
<div id="參考文件與資源-1" class="section level3">
<h3><span class="header-section-number">7.3.8</span> 參考文件與資源</h3>
<ul>
<li><a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html" target="_blank">Introduction to dplyr</a></li>
<li>DataCamp互動式教學課程 <a href="https://www.datacamp.com/courses/dplyr-data-manipulation-r-tutorial" target="_blank">Data Manipulation in R with dplyr</a></li>
</ul>
<!--chapter:end:07-eda.Rmd-->
</div>
</div>
</div>
<div id="vis" class="section level1">
<h1><span class="header-section-number">8</span> 資料視覺化</h1>
<div id="資料視覺化的目的" class="section level2">
<h2><span class="header-section-number">8.1</span> 資料視覺化的目的</h2>
<p>延續Ch @ref(eda)，探索式資料分析可分為圖形化Graphical 或 量化Quantitative分析，總括來說<strong>作圖</strong>的目的有:</p>
<ul>
<li>了解資料的特性</li>
<li>尋找資料的模式(patterns)</li>
<li>建議資料分析與建模的策略</li>
<li>結果呈現與溝通</li>
</ul>
<p>其中前三項屬於探索圖 (Exploratory graphs)，結果呈現與溝通屬於結果圖 (Final graphs)，探索圖屬探索式資料分析，目的是在『看』與『觀察』資料的樣子，所以探索圖有以下特性:</p>
<ul>
<li>很快就可以做一張圖</li>
<li>探索過程中，可能可以做圖</li>
<li>主要目的是了解資料的樣子</li>
<li>不用做圖形格式調整美化</li>
</ul>
<p>而在製作結果圖 (Final graphs)時，則須考慮以下事項:</p>
<ul>
<li>比較，呈現差異
<ul>
<li>比較什麼？誰跟誰比較？</li>
</ul></li>
<li>呈現因果關係（causality）,機制（mechanism）,結果解釋（explanation）,系統化的結構（systematic structure）
<ul>
<li>因果模型？為什麼你想要做這樣的比較</li>
</ul></li>
<li>呈現多變數（Multivariate）資料
<ul>
<li>多變數（Multivariate）：超過兩個變數就叫多變數</li>
<li>所有真實事件都是多變數的</li>
</ul></li>
<li>將證據整合呈現
<ul>
<li>在同一個畫面呈現文字、數字、影像、圖表</li>
<li>盡量用圖形呈現資料</li>
</ul></li>
<li>將圖表做適當的標記與說明，包括xy軸名稱、單位、資料來源等
<ul>
<li>資料圖表必須可以呈現你想說的故事</li>
</ul></li>
<li>內容才是最重要的
<ul>
<li>資料不好，分析不好，圖表再美也沒有用</li>
</ul></li>
</ul>
<p>在R中，有三個常用的畫圖套件，包括基本功能(Base)、<code>lattice</code>以及<code>ggplot2</code>，由於各套件繪圖邏輯不同，本書只介紹最推薦的<code>ggplot2</code>套件的使用方式。</p>
</div>
<div id="ggplot2簡介" class="section level2">
<h2><span class="header-section-number">8.2</span> ggplot2簡介</h2>
<p><code>ggplot2</code> <span class="citation">(Wickham, Chang, et al. <a href="#ref-R-ggplot2" role="doc-biblioref">2019</a>)</span>的開發靈感來自於Dr. Leland Wilkinson的<a href="http://www.springer.com/us/book/9780387245447" target="_blank">Grammar of Graphics</a></p>
<p>“In brief, the grammar tells us that a statistical graphic is a <code>mapping</code> from data to <code>aesthetic</code> attributes (colour, shape, size) of <code>geometric</code> objects (points, lines, bars). The plot may also contain statistical transformations of the data and is drawn on a specific coordinate system”</p>
<p>-from <code>ggplot2</code> book</p>
<p><code>ggplot2</code> Package是由<a href="http://hadley.nz/" target="_blank">Hadley Wickham</a>開發，是第三個R的畫圖Package。自發表以來一直是最熱門的R packages之一，目前還在持續發展更新中，對原始碼有興趣的人可以到<a href="https://github.com/tidyverse/ggplot2" target="_blank">GitHub</a>看一下最新動態。</p>
<p>簡單來說，做圖的文法包括兩個最主要元素：</p>
<ul>
<li><strong>Aesthetic attributes</strong>：包括顏色、形狀、點的大小與線的粗細等</li>
<li><strong>Geometric objects</strong>：包括點、線、盒狀圖、直條圖等</li>
</ul>
<p>其他元素包括：</p>
<ul>
<li><strong>Facets</strong>：提供在同一張圖內做多個子圖的方法，只要使用Faceting功能設定子圖分類的依據參數即可</li>
<li><strong>Stats</strong>：將資料做統計轉換</li>
<li><strong>Scales</strong>：修改點線的顏色、形狀、xy軸的範圍等</li>
</ul>
<p>在開始學ggplot2的核心功能之前，<code>qplot()</code>是ggplot2 Package提供最基本的畫圖方法，跟基本的plot() function很接近，提供一個簡單入門的方法。</p>
<div id="qplot" class="section level3">
<h3><span class="header-section-number">8.2.1</span> qplot()</h3>
<p><code>qplot()</code>為ggplot2 “Hello, world!”，簡單使用<code>qplot(x軸名稱,y軸名稱,data=使用資料)</code>就可畫散佈圖</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb502-1" title="1"><span class="kw">library</span>(SportsAnalytics)</a>
<a class="sourceLine" id="cb502-2" title="2">NBA1516&lt;-<span class="kw">fetch_NBAPlayerStatistics</span>(<span class="st">&quot;15-16&quot;</span>) <span class="co">## 讀入資料</span></a>
<a class="sourceLine" id="cb502-3" title="3"><span class="kw">library</span>(ggplot2) <span class="co">#記得將ggplot2 package讀入，如果沒安奘記得先安裝</span></a>
<a class="sourceLine" id="cb502-4" title="4"><span class="kw">qplot</span>(FieldGoalsAttempted, TotalPoints, <span class="dt">data =</span> NBA1516)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/qplot1-1.png" width="672" /></p>
<p>針對做圖的文法的第一個主要元素<strong>Aesthetics</strong>（包括顏色、形狀、點的大小與線的粗細等），可透過增加指令做修改，如加上<code>color=Position</code>，表示用守備位置Position著色</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb503-1" title="1"><span class="kw">qplot</span>(FieldGoalsAttempted, TotalPoints, <span class="dt">data =</span> NBA1516,<span class="dt">color=</span>Position)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/qplot2-1.png" width="672" />
針對做圖的文法的第二個主要元素<strong>Geometric</strong>（包括點、線、盒狀圖、直條圖等），也可透過增加指令修改，如使用<code>geom = c("point", "smooth")</code> 在圖上加點與漸進線</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" title="1"><span class="kw">qplot</span>(FieldGoalsAttempted, TotalPoints, <span class="dt">data =</span> NBA1516,</a>
<a class="sourceLine" id="cb504-2" title="2">      <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;smooth&quot;</span>))</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="DataAnalyticsWithR_files/figure-html/qplot3-1.png" width="672" /></p>
<p>如果輸入的變量並非<strong>雙</strong>變量，而是<strong>單</strong>變量時，預設圖形會從<strong>散佈圖</strong>變為<strong>Histograms直方圖</strong></p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb506-1" title="1"><span class="co">#畫TotalPoints的直方圖/ fill = Position 並用守備位置Position著色</span></a>
<a class="sourceLine" id="cb506-2" title="2"><span class="kw">qplot</span>(TotalPoints, <span class="dt">data =</span> NBA1516, <span class="dt">fill =</span> Position)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>作圖的<strong>Facets</strong>元素可提供在同一張圖內做多個子圖的方法，只要使用<code>facets =</code>來設定子圖分類的依據參數即可，以下圖為例，輸入的變量是<strong>雙</strong>變量，所以預設圖形為散佈圖，而設定子圖的語法為<code>直向分類~橫向分類</code>，直向分類意指以增加列（Row）的方式畫子圖，橫向分類意指以增加行（Column）的方式畫子圖，通常只會設定單一方向，如果選擇的是<code>直向</code>，<code>橫向分類</code>部分可用<code>.</code>表示，範例如下：</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb507-1" title="1"><span class="co">#facets = . ~ Position 用守備位置Position分群畫圖(橫向)</span></a>
<a class="sourceLine" id="cb507-2" title="2"><span class="kw">qplot</span>(FieldGoalsAttempted, TotalPoints, </a>
<a class="sourceLine" id="cb507-3" title="3">      <span class="dt">data =</span> NBA1516,</a>
<a class="sourceLine" id="cb507-4" title="4">      <span class="dt">facets =</span> . <span class="op">~</span><span class="st"> </span>Position)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb508-1" title="1"><span class="co">#facets = . ~ Position 用守備位置Position分群畫圖(直向)</span></a>
<a class="sourceLine" id="cb508-2" title="2"><span class="kw">qplot</span>(FieldGoalsAttempted, TotalPoints, </a>
<a class="sourceLine" id="cb508-3" title="3">      <span class="dt">data =</span> NBA1516,</a>
<a class="sourceLine" id="cb508-4" title="4">      <span class="dt">facets =</span> Position <span class="op">~</span><span class="st"> </span>.)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p><code>ggplot2</code>套件會自動幫使用者選擇顏色與圖形各項參數，但使用者也可依需求微調，如直方圖的分組間隔，可透過<code>binwidth</code>參數設定</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb509-1" title="1"><span class="co">#facets = . ~ Position 用守備位置Position分群畫圖(直向)</span></a>
<a class="sourceLine" id="cb509-2" title="2"><span class="co">##binwidth = 2 每2分一組</span></a>
<a class="sourceLine" id="cb509-3" title="3"><span class="kw">qplot</span>(TotalPoints, <span class="dt">data =</span> NBA1516, </a>
<a class="sourceLine" id="cb509-4" title="4">      <span class="dt">facets =</span> Position <span class="op">~</span><span class="st"> </span>., <span class="dt">binwidth =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" title="1"><span class="co">#facets = . ~ Position 用守備位置Position分群畫圖(直向)</span></a>
<a class="sourceLine" id="cb510-2" title="2"><span class="co">##binwidth = 100 每100分一組</span></a>
<a class="sourceLine" id="cb510-3" title="3"><span class="kw">qplot</span>(TotalPoints, <span class="dt">data =</span> NBA1516,</a>
<a class="sourceLine" id="cb510-4" title="4">      <span class="dt">facets =</span> Position <span class="op">~</span><span class="st"> </span>., <span class="dt">binwidth =</span> <span class="dv">100</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>總括來說<code>qplot()</code>提供快速方便的畫圖功能，並且保留部分參數設定的彈性，但若需要調整更多參數，仍須使用完整的<code>ggplot()</code>函式。</p>
</div>
<div id="ggplot" class="section level3">
<h3><span class="header-section-number">8.2.2</span> ggplot()</h3>
<p>使用ggplot2作圖有以下步驟：</p>
<ul>
<li>準備好資料。當然要有資料才能畫圖</li>
<li>設定<strong>Aesthetic attributes</strong>。使用<code>aes(x, y, ...)</code>指定</li>
<li>指定<strong>Geometric objects</strong>。常用的包括<code>geom_point()</code>、<code>geom_line()</code>、<code>geom_point()</code>、<code>geom_polygon()</code>、<code>geom_errorbar()</code></li>
</ul>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" title="1"><span class="kw">library</span>(ggplot2) <span class="co">##須先安裝 install.packages(&quot;ggplot2&quot;)</span></a></code></pre></div>
<p>首先先產生教學用畫圖資料</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gp =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="dv">10</span>)),<span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">30</span>))</a></code></pre></div>
<p>設定兩個畫圖的重要元素<strong>Aesthetic attributes</strong>和<strong>Geometric objects</strong></p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb513-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> gp, <span class="dt">y =</span> y)) <span class="op">+</span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-143-1.png" width="672" />
用<code>geom_boxpolt()</code>改畫盒狀圖</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb514-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> gp, <span class="dt">y =</span> y)) <span class="op">+</span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-144-1.png" width="672" />
使用Faceting功能</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" title="1">df<span class="op">$</span>z&lt;-df<span class="op">$</span>y<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">30</span>)</a>
<a class="sourceLine" id="cb515-2" title="2"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> y)) <span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_grid</span>(gp<span class="op">~</span>.)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-145-1.png" width="672" />
轉向</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> y)) <span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_grid</span>(.<span class="op">~</span>gp)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-146-1.png" width="672" />
用<code>geom_smooth()</code>替xy散佈圖加上趨勢線</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> y)) <span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_grid</span>(gp<span class="op">~</span>.)<span class="op">+</span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-147-1.png" width="672" />
用<code>geom_smooth()</code>替xy散佈圖加上趨勢線，使用linear regresion</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> y)) <span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_grid</span>(gp<span class="op">~</span>.)<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&#39;lm&#39;</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-148-1.png" width="672" />
改用<code>geom_line()</code>畫線</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb520-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> y)) <span class="op">+</span><span class="kw">geom_line</span>()<span class="op">+</span><span class="kw">facet_grid</span>(gp<span class="op">~</span>.)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-149-1.png" width="672" />
改用顏色分組，使用<code>aes(color='group name')</code></p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> y, <span class="dt">color=</span>gp)) <span class="op">+</span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<p>畫圖前需要注意的幾個小地方：</p>
<p>提供資料時，把資料修改為想要在圖片顯示的文字。從上面的範例可以發現，ggplot2會直接將資料分組（a/b/c）直接標在圖上，與其之後再來改圖，不如在資料處理時就將a/b/c改為有意義且可以直接使用的文字。
如果是離散性的資料，但卻又是數值時（像是1,2,3）可以用factor()轉換，ggplot會將factor視為離散資料。</p>
<p>除了基本的製圖外，<code>ggplot2</code>套件也提供完整的資料標示設定與其他參數設定功能，包括：</p>
<ul>
<li>標籤 <code>xlab()</code>, <code>ylab()</code>, <code>labs(x=,y=)</code>, <code>ggtitle()</code></li>
<li>每一個<code>geom_*()</code>都有參數可設定</li>
<li>圖形樣式設定 <code>theme()</code>，可使用內建樣式
<ul>
<li><code>theme_gray()</code>: 灰背景，預設樣式</li>
<li><code>theme_bw()</code>: 黑白樣式</li>
</ul></li>
<li>使用其他樣式套件
<ul>
<li><code>ggthemes</code> packages <a href="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html">Website</a></li>
<li><code>xkcd</code> packages <a href="http://xkcd.r-forge.r-project.org/">Website</a></li>
</ul></li>
</ul>
<p>在比較多組的平均值高低時，因為各組樣本數與資料分佈不同，平均數的誤差值也會不同，所以在資料視覺化時，建議加上誤差線(Error bar)，誤差線通常使用在bar chart和line chart，而誤差值的計算有下列三種選擇：</p>
<ul>
<li>Standard deviation (SD) 標準差：呈現資料本質時使用</li>
<li>Standard error (SE) 標準誤差：呈現預估平均值的可能誤差時使用</li>
<li>Confidence interval (CI) 信賴區間：呈現預估平均值的信心時使用</li>
</ul>
<p>以空氣污染料為例，若想比較各月臭氧濃度差異，可以使用bar chart來呈現，在ggplot2中，如果要畫bar chart，需要將<strong>Geometric objects</strong>設定為<code>geom_bar</code></p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb522-1" title="1"><span class="kw">library</span>(datasets) </a>
<a class="sourceLine" id="cb522-2" title="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb522-3" title="3">airquality<span class="op">$</span>Month&lt;-<span class="kw">as.factor</span>(airquality<span class="op">$</span>Month) <span class="co">#將Month轉為因子變項</span></a>
<a class="sourceLine" id="cb522-4" title="4">airquality.mean&lt;-<span class="kw">data.table</span>(airquality)[,.(<span class="dt">OzoneMean=</span><span class="kw">mean</span>(Ozone,<span class="dt">na.rm =</span> T)),by=Month] <span class="co">#計算每月Ozone平均</span></a>
<a class="sourceLine" id="cb522-5" title="5"><span class="kw">ggplot</span>()<span class="op">+</span><span class="kw">geom_bar</span>(<span class="dt">data=</span>airquality.mean,<span class="kw">aes</span>(<span class="dt">x=</span>Month,<span class="dt">y=</span>OzoneMean),</a>
<a class="sourceLine" id="cb522-6" title="6">                  <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="co">#stat = &quot;identity&quot; 直接畫數字</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p>在ggplot2套件中，只要加上<code>geom_errorbar()</code>函式，設定資料高低值，就能在原圖中加上誤差線</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" title="1"><span class="kw">library</span>(datasets) </a>
<a class="sourceLine" id="cb523-2" title="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb523-3" title="3">airquality<span class="op">$</span>Month&lt;-<span class="kw">as.factor</span>(airquality<span class="op">$</span>Month) <span class="co">#將Month轉為因子變項</span></a>
<a class="sourceLine" id="cb523-4" title="4">airquality.stat&lt;-<span class="kw">data.table</span>(airquality)[,.(<span class="dt">OzoneMean=</span><span class="kw">mean</span>(Ozone,<span class="dt">na.rm =</span> T),<span class="dt">OzoneSD=</span><span class="kw">sd</span>(Ozone,<span class="dt">na.rm =</span> T)),by=Month] <span class="co">#計算每月Ozone平均與標準差</span></a>
<a class="sourceLine" id="cb523-5" title="5"><span class="kw">ggplot</span>(<span class="dt">data=</span>airquality.stat)<span class="op">+</span><span class="st"> </span><span class="co">#資料airquality.eb</span></a>
<a class="sourceLine" id="cb523-6" title="6"><span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Month,<span class="dt">y=</span>OzoneMean),<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb523-7" title="7"><span class="st">    </span><span class="kw">geom_errorbar</span>( <span class="co">#ymin低點, ymax高點</span></a>
<a class="sourceLine" id="cb523-8" title="8">        <span class="kw">aes</span>(<span class="dt">x=</span>Month,<span class="dt">ymin=</span>OzoneMean<span class="op">-</span>OzoneSD,<span class="dt">ymax=</span>OzoneMean<span class="op">+</span>OzoneSD), <span class="dt">width=</span>.<span class="dv">1</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
</div>
</div>
<div id="ggplot2地圖" class="section level2">
<h2><span class="header-section-number">8.3</span> ggplot2+地圖</h2>
<div id="choropleth-map面量圖" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Choropleth map面量圖</h3>
<p>Choropleth map<a href="https://en.wikipedia.org/wiki/Choropleth_map" target="_blank">面量圖</a>是指<strong>把統計資料用顏色畫在對應的地圖上</strong>的一種資料視覺化方式，在R中可以使用<code>choroplethr</code><span class="citation">(Lamstein <a href="#ref-R-choroplethr" role="doc-biblioref">2018</a>)</span> package來畫面量圖，
<code>choroplethr</code> package是一個基於<code>ggplot2</code> package的<code>面量圖</code>做圖工具，使用前需要先安裝，建議同時安裝<code>choroplethrMaps</code> package</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" title="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;choroplethr&quot;</span>,<span class="st">&quot;choroplethrMaps&quot;</span>)) <span class="co">##第一次使用前先安裝</span></a></code></pre></div>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" title="1"><span class="kw">library</span>(choroplethr)</a></code></pre></div>
<p><code>choroplethr</code><span class="citation">(Lamstein <a href="#ref-R-choroplethr" role="doc-biblioref">2018</a>)</span> package內建美國各州地圖與人口學資料，所以可以輕鬆使用<code>state_choropleth()</code>函式畫出美國各州人口分布</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb526-1" title="1"><span class="kw">data</span>(df_pop_state) <span class="co">#記載各州人口數的資料</span></a>
<a class="sourceLine" id="cb526-2" title="2"><span class="kw">state_choropleth</span>(df_pop_state) <span class="co">#把各州人口畫在地圖上</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
<p>若將<code>reference_map</code>設定為<code>= TRUE</code>，可在面量圖的背景加上google地圖，因google地圖需要使用API key，因此須先使用ggmap套件的<code>register_google(key = "your key")</code>，帶入google金鑰設定授權金鑰。以下金鑰為示範金鑰，目前已失效，請自行至<a href="https://console.cloud.google.com/" target="_blank">Google Cloud Platform</a>，點選API及服務申請Maps Static API後，複製API key。</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb527-1" title="1"><span class="kw">data</span>(continental_us_states)</a>
<a class="sourceLine" id="cb527-2" title="2"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb527-3" title="3"><span class="kw">register_google</span>(<span class="dt">key =</span> <span class="st">&quot;AIzaSyC7JRppSZtZuzpy9SdsVbpK5Nhf_oh2xl0&quot;</span>)</a>
<a class="sourceLine" id="cb527-4" title="4"><span class="kw">state_choropleth</span>(df_pop_state,<span class="dt">reference_map =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb527-5" title="5">                 <span class="dt">zoom=</span> continental_us_states) <span class="co">#把各州人口畫在地圖上</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<p>除了美國地圖外，使用<code>choroplethr</code> package搭配<code>WDI</code>: <a href="http://beta.data.worldbank.org/" target="_blank">World Development Indicators</a> 的世界人口分布資料，可以針對世界人口分佈做<strong>面量圖</strong>。
世界人口資料的代碼為<code>SP.POP.TOTL</code>，代碼查詢可見<a href="http://beta.data.worldbank.org/" target="_blank">World Development Indicators</a></p>
<p>由於需要使用<code>WDI</code>的資料，所以需要安裝與載入<code>WDI</code><span class="citation">(Arel-Bundock <a href="#ref-R-WDI" role="doc-biblioref">2019</a>)</span> package</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;WDI&quot;</span>) <span class="co">##第一次使用前先安裝</span></a></code></pre></div>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb529-1" title="1"><span class="kw">library</span>(WDI)</a>
<a class="sourceLine" id="cb529-2" title="2"><span class="kw">choroplethr_wdi</span>(<span class="dt">code=</span><span class="st">&quot;SP.POP.TOTL&quot;</span>, <span class="dt">year=</span><span class="dv">2016</span>, </a>
<a class="sourceLine" id="cb529-3" title="3">                <span class="dt">title=</span><span class="st">&quot;2016 Population&quot;</span>, <span class="dt">num_colors=</span><span class="dv">1</span>)</a></code></pre></div>
<p>除了人口資料外，WDI也有世界平均壽命資料，平均壽命的代碼為<code>SP.DYN.LE00.IN</code>，代碼查詢可見<a href="http://beta.data.worldbank.org/" target="_blank">World Development Indicators</a></p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb530-1" title="1"><span class="kw">choroplethr_wdi</span>(<span class="dt">code=</span><span class="st">&quot;SP.DYN.LE00.IN&quot;</span>, <span class="dt">year=</span><span class="dv">2016</span>, </a>
<a class="sourceLine" id="cb530-2" title="2">                <span class="dt">title=</span><span class="st">&quot;2016 Life Expectancy&quot;</span>)</a></code></pre></div>
<p>如果只需亞洲太平洋人口分布，可使用<code>zoom</code>參數設定想畫的國家，國家的名稱設定必須要和<code>country.regions</code>資料完全吻合</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb531-1" title="1"><span class="kw">choroplethr_wdi</span>(<span class="dt">code=</span><span class="st">&quot;SP.POP.TOTL&quot;</span>, <span class="dt">year=</span><span class="dv">2015</span>, </a>
<a class="sourceLine" id="cb531-2" title="2">                <span class="dt">title=</span><span class="st">&quot;2015 Life Expectancy&quot;</span>,</a>
<a class="sourceLine" id="cb531-3" title="3">                <span class="dt">zoom=</span><span class="kw">c</span>(<span class="st">&#39;taiwan&#39;</span>,<span class="st">&#39;japan&#39;</span>,<span class="st">&#39;south korea&#39;</span>,<span class="st">&#39;philippines&#39;</span>))</a></code></pre></div>
</div>
<div id="ggmap" class="section level3">
<h3><span class="header-section-number">8.3.2</span> ggmap()</h3>
<p><code>ggmap</code><span class="citation">(Kahle, Wickham, and Jackson <a href="#ref-R-ggmap" role="doc-biblioref">2019</a>)</span> package是一個可以把google map載入並作圖的套件，一樣是基於<code>ggplot2</code>套件開發的。
依照往例，第一次使用前需要安裝</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb532-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;ggmap&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;source&quot;</span>) <span class="co">##第一次使用前先安裝</span></a></code></pre></div>
<p>載入<code>ggmap</code><span class="citation">(Kahle, Wickham, and Jackson <a href="#ref-R-ggmap" role="doc-biblioref">2019</a>)</span> package後，可以使用<code>get_googlemap()</code>函式取得google map圖層，並用<code>ggmap()</code>函式將取得的圖層畫出來，使用google map的資源時，必須先使用register_google(key = “your key”)帶入google金鑰。
投影片金鑰已失效，請自行至Google Cloud Platform，點選API及服務申請Maps Static API後，複製API key。</p>
<p><code>get_googlemap()</code>函式需要設定的參數如下：</p>
<ul>
<li>center 中心點經緯度座標</li>
<li>zoom 放大倍率</li>
<li>language 地圖語言</li>
</ul>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb533-1" title="1"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb533-2" title="2"><span class="kw">register_google</span>(<span class="dt">key =</span> <span class="st">&quot;AIzaSyC7JRppSZtZuzpy9SdsVbpK5Nhf_oh2xl0&quot;</span>)</a>
<a class="sourceLine" id="cb533-3" title="3">twmap &lt;-<span class="st"> </span><span class="kw">get_googlemap</span>(<span class="dt">center =</span> <span class="kw">c</span>(<span class="dt">lon=</span><span class="fl">120.58</span>,<span class="dt">lat=</span><span class="fl">23.58</span>), </a>
<a class="sourceLine" id="cb533-4" title="4">                  <span class="dt">zoom =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb533-5" title="5">                  <span class="dt">language =</span> <span class="st">&quot;zh-TW&quot;</span>)</a>
<a class="sourceLine" id="cb533-6" title="6"><span class="kw">ggmap</span>(twmap)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<p>只要資料有經緯度等資訊，就可以使用<code>ggmap</code> package與各式資料結合呈現，以台北市水質地圖開放資料為例，首先先將資料載入處理（參考Ch @ref(JSON)）。台北市水質資料的Open data API網址是http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&amp;rid=190796c8-7c56-42e0-8068-39242b8ec927</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" title="1"><span class="co">##資料載入</span></a>
<a class="sourceLine" id="cb534-2" title="2"><span class="kw">library</span>(jsonlite)</a>
<a class="sourceLine" id="cb534-3" title="3"><span class="kw">library</span>(RCurl)</a>
<a class="sourceLine" id="cb534-4" title="4">WaterData&lt;-<span class="kw">fromJSON</span>(<span class="kw">getURL</span>(<span class="st">&quot;http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&amp;rid=190796c8-7c56-42e0-8068-39242b8ec927&quot;</span>))</a>
<a class="sourceLine" id="cb534-5" title="5">WaterDataFrame&lt;-WaterData<span class="op">$</span>result<span class="op">$</span>results</a>
<a class="sourceLine" id="cb534-6" title="6">WaterDataFrame<span class="op">$</span>longitude&lt;-<span class="kw">as.numeric</span>(WaterDataFrame<span class="op">$</span>longitude)</a>
<a class="sourceLine" id="cb534-7" title="7">WaterDataFrame<span class="op">$</span>latitude&lt;-<span class="kw">as.numeric</span>(WaterDataFrame<span class="op">$</span>latitude)</a>
<a class="sourceLine" id="cb534-8" title="8">WaterDataFrame<span class="op">$</span>qua_cntu&lt;-<span class="kw">as.numeric</span>(WaterDataFrame<span class="op">$</span>qua_cntu)</a>
<a class="sourceLine" id="cb534-9" title="9"><span class="co">##結合ggmap</span></a>
<a class="sourceLine" id="cb534-10" title="10"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb534-11" title="11">TaipeiMap &lt;-<span class="st"> </span><span class="kw">get_googlemap</span>(</a>
<a class="sourceLine" id="cb534-12" title="12">    <span class="dt">center  =</span> <span class="kw">c</span>(<span class="dt">lon=</span><span class="fl">121.50</span>,<span class="dt">lat=</span><span class="fl">25.06</span>), </a>
<a class="sourceLine" id="cb534-13" title="13">    <span class="dt">zoom =</span> <span class="dv">11</span>, <span class="dt">maptype =</span> <span class="st">&#39;roadmap&#39;</span>)</a>
<a class="sourceLine" id="cb534-14" title="14">TaipeiMapO &lt;-<span class="st"> </span><span class="kw">ggmap</span>(TaipeiMap)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb534-15" title="15"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span>WaterDataClean, </a>
<a class="sourceLine" id="cb534-16" title="16">               <span class="kw">aes</span>(<span class="dt">x=</span>longitude, <span class="dt">y=</span>latitude,</a>
<a class="sourceLine" id="cb534-17" title="17">                   <span class="dt">color=</span>qua_cntu),<span class="dt">size=</span><span class="fl">3.5</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb534-18" title="18"><span class="st">    </span><span class="kw">scale_color_continuous</span>(</a>
<a class="sourceLine" id="cb534-19" title="19">        <span class="dt">low =</span> <span class="st">&quot;yellow&quot;</span>,<span class="dt">high =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb534-20" title="20"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">size=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb534-21" title="21">TaipeiMapO</a></code></pre></div>
<p><img src="figure/waterQ.png" width="590" /></p>
<p><code>ggmap</code>套件提供多種地圖型態，使用者可透過設定<code>maptype</code>自行選擇適合的地圖樣式，樣式有：</p>
<ul>
<li>terrain</li>
<li>terrain-background</li>
<li>satellite</li>
<li>roadmap</li>
<li>hybrid (google maps)</li>
<li>watercolor</li>
<li>toner (stamen maps)</li>
</ul>
<p>透過設定<code>extent</code>參數可將地圖輸出樣式改為滿版</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb535-1" title="1"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb535-2" title="2"><span class="kw">ggmap</span>(TaipeiMap,<span class="dt">extent =</span> <span class="st">&#39;device&#39;</span>) <span class="co">#extent = &#39;device&#39; 滿版</span></a></code></pre></div>
<p>###Density Map
除了面量圖外，密度圖Density Map也是常用來表示因地理位置不同的數值差異，以下是美國人口密度圖範例
<img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
<p>上述範例使用 <code>ggplot2</code> + <code>ggmap</code> 套件來畫人口密度圖，做圖的第一步是資料載入，包括取得美國各州中心座標資料以及美國各州人口資料</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb536-1" title="1"><span class="co">#取得美國各州中心座標資料</span></a>
<a class="sourceLine" id="cb536-2" title="2">StateCenter&lt;-<span class="kw">data.frame</span>( </a>
<a class="sourceLine" id="cb536-3" title="3">    <span class="dt">region=</span><span class="kw">tolower</span>(state.name),<span class="dt">lon=</span>state.center<span class="op">$</span>x,<span class="dt">lat=</span>state.center<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb536-4" title="4"><span class="kw">head</span>(StateCenter,<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##    region lon lat
## 1 alabama -87  33</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" title="1"><span class="co">#美國各州人口資料</span></a>
<a class="sourceLine" id="cb538-2" title="2">StatePop&lt;-<span class="kw">merge</span>(df_pop_state,StateCenter,<span class="dt">by=</span><span class="st">&quot;region&quot;</span>) </a>
<a class="sourceLine" id="cb538-3" title="3"><span class="kw">head</span>(StatePop,<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##    region   value lon lat
## 1 alabama 4777326 -87  33</code></pre>
<p>第二個步驟是將人口數字轉換為<strong>資料列數</strong>，需要這樣轉換的原因是密度圖是用資料列數來決定畫圖的密度，而不是透過單一數值，所以需要在此步驟做轉換</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" title="1"><span class="co">#將人口數值，轉為點！重要！</span></a>
<a class="sourceLine" id="cb540-2" title="2">PopPoint&lt;-<span class="ot">NULL</span> </a>
<a class="sourceLine" id="cb540-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(StatePop)){</a>
<a class="sourceLine" id="cb540-4" title="4">    <span class="co">#每100萬人轉為1點</span></a>
<a class="sourceLine" id="cb540-5" title="5">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(StatePop[i,<span class="st">&quot;value&quot;</span>]<span class="op">/</span><span class="dv">1000000</span>)){</a>
<a class="sourceLine" id="cb540-6" title="6">        PopPoint&lt;-<span class="kw">rbind</span>(PopPoint,StatePop[i,])   </a>
<a class="sourceLine" id="cb540-7" title="7">    }</a>
<a class="sourceLine" id="cb540-8" title="8">}</a>
<a class="sourceLine" id="cb540-9" title="9"><span class="kw">head</span>(PopPoint,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##    region   value lon lat
## 1 alabama 4777326 -87  33
## 2 alabama 4777326 -87  33
## 3 alabama 4777326 -87  33</code></pre>
<p>第三個步驟是作圖</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" title="1">USMap &lt;-<span class="st"> </span><span class="kw">get_googlemap</span>(<span class="dt">center =</span> <span class="kw">c</span>(<span class="dt">lon=</span><span class="op">-</span><span class="fl">99.582</span>,<span class="dt">lat=</span><span class="fl">40.091</span>), <span class="dt">zoom =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb542-2" title="2">densityMap&lt;-<span class="kw">ggmap</span>(USMap, <span class="dt">extent =</span> <span class="st">&quot;device&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb542-3" title="3"><span class="st">    </span><span class="kw">geom_density2d</span>(<span class="dt">data =</span> PopPoint, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb542-4" title="4"><span class="st">    </span><span class="kw">stat_density2d</span>(<span class="dt">data =</span> PopPoint, </a>
<a class="sourceLine" id="cb542-5" title="5">            <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">fill =</span> ..level.., <span class="dt">alpha =</span> ..level..), </a>
<a class="sourceLine" id="cb542-6" title="6">                <span class="dt">size =</span> <span class="fl">0.01</span>, <span class="dt">bins =</span> <span class="dv">16</span>, <span class="dt">geom =</span> <span class="st">&quot;polygon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb542-7" title="7"><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb542-8" title="8"><span class="st">    </span><span class="kw">scale_alpha</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">guide =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb542-9" title="9">densityMap</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<p>###參考資料
- <a href="https://github.com/dkahle/ggmap">ggmap package source code</a>
- <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/ggmap/ggmapCheatsheet.pdf">ggmap cheat sheet</a>
- <a href="https://dl.dropboxusercontent.com/u/24648660/ggmap%20useR%202012.pdf">ggmap doc</a></p>
</div>
</div>
<div id="taiwan的面量圖" class="section level2">
<h2><span class="header-section-number">8.4</span> Taiwan的面量圖</h2>
<p>因為畫台灣的面量圖尚無好的套件輔助，但因Open Data的關係，我們可以很容易地取得台灣鄉鎮市邊界的經緯度檔案，通常地圖/邊界經緯度檔案是用空間資料開放格式<code>shapefile</code> <code>.shp</code>儲存，透過<a href="http://data.gov.tw/" target="_blank">政府資料開放平台</a>可以下載台灣的地圖資料，資料集名稱為<a href="http://data.gov.tw/node/7441" target="_blank">鄉鎮市區界線</a>。使用<code>shapefile</code>與<code>ggplot2</code>畫圖的步驟如下：</p>
<ul>
<li>取得空間資料檔案</li>
<li>使用<code>rgdal</code>, <code>rgeos</code>,<code>maptools</code> package處理地圖檔shapefile</li>
<li>使用<code>ggplot2</code> &amp; <code>RColorBrewer</code> 畫圖</li>
</ul>
<p>上述套件在第一次使用前需要安裝與載入</p>
<p><img src="figure/Taiwan.png" width="566" /></p>
<p>以上各步驟詳述如下：
1. 處理shapefile-1</p>
<ul>
<li>需要<code>rgdal</code>, <code>rgeos</code>,<code>maptools</code></li>
<li>fortify: 將<code>shapefile</code>物件轉為<code>data.frame</code></li>
</ul>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" title="1"><span class="kw">library</span>(ggplot2) <span class="co">#for fortify(), ggplot(), ggmap()</span></a>
<a class="sourceLine" id="cb543-2" title="2"><span class="kw">head</span>(tw_new<span class="op">$</span>Town_ID)</a>
<a class="sourceLine" id="cb543-3" title="3">tw_new.df &lt;-<span class="st"> </span><span class="kw">fortify</span>(tw_new, <span class="dt">region =</span> <span class="st">&quot;T_UID&quot;</span>) <span class="co">#from ggplot2 package</span></a>
<a class="sourceLine" id="cb543-4" title="4"><span class="kw">head</span>(tw_new.df,<span class="dv">10</span>)</a></code></pre></div>
<pre><code>       long      lat order  hole piece id group
1  119.9170 26.17518     1 FALSE     1  1   1.1
2  119.9171 26.17517     2 FALSE     1  1   1.1
3  119.9171 26.17518     3 FALSE     1  1   1.1
4  119.9171 26.17518     4 FALSE     1  1   1.1
5  119.9171 26.17518     5 FALSE     1  1   1.1
6  119.9172 26.17518     6 FALSE     1  1   1.1
7  119.9172 26.17518     7 FALSE     1  1   1.1
8  119.9172 26.17518     8 FALSE     1  1   1.1
9  119.9173 26.17515     9 FALSE     1  1   1.1
10 119.9173 26.17515    10 FALSE     1  1   1.1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>做一個假資料來畫：著色基準檔</li>
</ol>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" title="1"><span class="co">#做一個假資料來畫</span></a>
<a class="sourceLine" id="cb545-2" title="2"><span class="co">#prevalence設為亂數rnorm(需要的亂數個數)</span></a>
<a class="sourceLine" id="cb545-3" title="3">mydata&lt;-<span class="kw">data.frame</span>(<span class="dt">NAME_2=</span>tw_new<span class="op">$</span>T_Name, <span class="dt">id=</span>tw_new<span class="op">$</span>T_UID,</a>
<a class="sourceLine" id="cb545-4" title="4">                   <span class="dt">prevalence=</span><span class="kw">rnorm</span>(<span class="kw">length</span>(tw_new<span class="op">$</span>T_UID)))</a>
<a class="sourceLine" id="cb545-5" title="5"><span class="kw">head</span>(mydata)</a></code></pre></div>
<pre><code>                  NAME_2  id prevalence
1 \xa6\xa8\xa5\\\xc2\xed 178  1.0551637
2            \xa8ΥV\xb6m 164 -0.6307466
3     \xb3\xc1\xbcd\xb6m 118 -1.2255327
4     \xba\xf1\xaeq\xb6m 376  0.1314583
5  \xc4\xf5\xc0\xac\xb6m 369  1.3665832
6      \xa5Ф\xa4\xc2\xed  78 -0.3132549</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>處理中文編碼
利用iconv將不知所以然的代碼（685\2）轉為看得懂的中文</li>
</ol>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" title="1"><span class="co">#from big5 to utf-8</span></a>
<a class="sourceLine" id="cb547-2" title="2">mydata<span class="op">$</span>NAME_<span class="dv">2</span>&lt;-<span class="kw">iconv</span>(<span class="kw">as.character</span>(mydata<span class="op">$</span>NAME_<span class="dv">2</span>), <span class="co">#NAME_2原本是factor</span></a>
<a class="sourceLine" id="cb547-3" title="3">                     <span class="dt">from=</span><span class="st">&quot;big5&quot;</span>, <span class="dt">to =</span> <span class="st">&quot;UTF-8&quot;</span>)</a>
<a class="sourceLine" id="cb547-4" title="4"><span class="kw">head</span>(mydata,<span class="dv">10</span>)</a></code></pre></div>
<pre><code>   NAME_2  id prevalence
1  成功鎮 178  1.0551637
2  佳冬鄉 164 -0.6307466
3  麥寮鄉 118 -1.2255327
4  綠島鄉 376  0.1314583
5  蘭嶼鄉 369  1.3665832
6  田中鎮  78 -0.3132549
7  社頭鄉  83  1.2072224
8  竹田鄉 157  0.7312959
9  萬丹鄉 148  1.4849184
10 三灣鄉  64  0.6094254</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>合併的圖檔與著色基準檔
最後將有prevalence的假數據mydata和經緯度資料tw_new.df合併, 用merge()</li>
</ol>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" title="1">final.plot&lt;-<span class="kw">merge</span>(tw_new.df,mydata,<span class="dt">by=</span><span class="st">&quot;id&quot;</span>,<span class="dt">all.x=</span>T)</a>
<a class="sourceLine" id="cb549-2" title="2"><span class="kw">head</span>(final.plot,<span class="dv">10</span>)</a></code></pre></div>
<pre><code>   id     long      lat order  hole piece group NAME_2 prevalence
1   1 119.9170 26.17518     1 FALSE     1   1.1 南竿鄉  0.9584632
2   1 119.9171 26.17517     2 FALSE     1   1.1 南竿鄉  0.9584632
3   1 119.9171 26.17518     3 FALSE     1   1.1 南竿鄉  0.9584632
4   1 119.9171 26.17518     4 FALSE     1   1.1 南竿鄉  0.9584632
5   1 119.9171 26.17518     5 FALSE     1   1.1 南竿鄉  0.9584632
6   1 119.9172 26.17518     6 FALSE     1   1.1 南竿鄉  0.9584632
7   1 119.9172 26.17518     7 FALSE     1   1.1 南竿鄉  0.9584632
8   1 119.9172 26.17518     8 FALSE     1   1.1 南竿鄉  0.9584632
9   1 119.9173 26.17515     9 FALSE     1   1.1 南竿鄉  0.9584632
10  1 119.9173 26.17515    10 FALSE     1   1.1 南竿鄉  0.9584632</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>畫台灣面量圖</li>
</ol>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" title="1"><span class="kw">library</span>(RColorBrewer) <span class="co">#配色用brewer.pal( 9 , &quot;Reds&quot; )</span></a>
<a class="sourceLine" id="cb551-2" title="2">twcmap&lt;-<span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb551-3" title="3"><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> final.plot, </a>
<a class="sourceLine" id="cb551-4" title="4">                 <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, </a>
<a class="sourceLine" id="cb551-5" title="5">                     <span class="dt">fill =</span> prevalence), </a>
<a class="sourceLine" id="cb551-6" title="6">                 <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb551-7" title="7"><span class="st">    </span><span class="kw">coord_map</span>()<span class="op">+</span><span class="co">#維持地圖比例</span></a>
<a class="sourceLine" id="cb551-8" title="8"><span class="st">    </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Reds&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb551-9" title="9"><span class="st">    </span><span class="kw">theme_void</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb551-10" title="10"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Prevalence of X in Taiwan&quot;</span>)</a>
<a class="sourceLine" id="cb551-11" title="11">twcmap</a></code></pre></div>
<p><img src="figure/Taiwan.png" width="566" /></p>
<div id="ggmap面量圖" class="section level3">
<h3><span class="header-section-number">8.4.1</span> ggmap+面量圖</h3>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb552-1" title="1"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb552-2" title="2">twmap &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="dt">location =</span> <span class="st">&#39;Taiwan&#39;</span>, <span class="dt">zoom =</span> <span class="dv">7</span>,<span class="dt">language =</span> <span class="st">&quot;zh-TW&quot;</span>)</a>
<a class="sourceLine" id="cb552-3" title="3"><span class="kw">ggmap</span>(twmap)<span class="op">+</span><span class="st"> </span><span class="co">#ggmap</span></a>
<a class="sourceLine" id="cb552-4" title="4"><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> final.plot,  <span class="co">#面量圖</span></a>
<a class="sourceLine" id="cb552-5" title="5">        <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill =</span> prevalence), </a>
<a class="sourceLine" id="cb552-6" title="6">        <span class="dt">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="dt">size =</span> <span class="fl">0.1</span>,<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb552-7" title="7"><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Reds&quot;</span>))</a></code></pre></div>
<p><img src="figure/ggmapTaiwan.png" width="336" /></p>
<p>##Heatmap
<code>Heatmap</code>熱度圖使用顏色的深淺來表示數值的大小，通常會搭配XY兩軸的變量，所以使用一張圖就能表示三個維度的資訊，在ggplot2套件中，可以使用<code>geom_tile()</code>來畫Heatmap，以下以NBA球員的資料作為範例，希望能透過Heatmap來呈現球員表現的差異。
首先先將檔案讀入</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb553-1" title="1"><span class="co">#讀.csv檔案</span></a>
<a class="sourceLine" id="cb553-2" title="2">nba &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://datasets.flowingdata.com/ppg2008.csv&quot;</span>)</a>
<a class="sourceLine" id="cb553-3" title="3"><span class="kw">head</span>(nba)</a></code></pre></div>
<pre><code>##             Name  G MIN PTS  FGM FGA  FGP FTM FTA  FTP X3PM X3PA X3PP ORB DRB
## 1   Dwyane Wade  79  39  30 10.8  22 0.49 7.5 9.8 0.76  1.1  3.5 0.32 1.1 3.9
## 2  LeBron James  81  38  28  9.7  20 0.49 7.3 9.4 0.78  1.6  4.7 0.34 1.3 6.3
## 3   Kobe Bryant  82  36  27  9.8  21 0.47 5.9 6.9 0.86  1.4  4.1 0.35 1.1 4.1
## 4 Dirk Nowitzki  81  38  26  9.6  20 0.48 6.0 6.7 0.89  0.8  2.1 0.36 1.1 7.3
## 5 Danny Granger  67  36  26  8.5  19 0.45 6.0 6.9 0.88  2.7  6.7 0.40 0.7 4.4
## 6  Kevin Durant  74  39  25  8.9  19 0.48 6.1 7.1 0.86  1.3  3.1 0.42 1.0 5.5
##   TRB AST STL BLK  TO  PF
## 1 5.0 7.5 2.2 1.3 3.4 2.3
## 2 7.6 7.2 1.7 1.1 3.0 1.7
## 3 5.2 4.9 1.5 0.5 2.6 2.3
## 4 8.4 2.4 0.8 0.8 1.9 2.2
## 5 5.1 2.7 1.0 1.4 2.5 3.1
## 6 6.5 2.8 1.3 0.7 3.0 1.8</code></pre>
<p>為了做圖，將寬表轉長表，寬表與長表的概念可參見@ref(reshape)</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb555-1" title="1"><span class="kw">library</span>(reshape2) <span class="co">#for melt()</span></a>
<a class="sourceLine" id="cb555-2" title="2">nba.m &lt;-<span class="st"> </span><span class="kw">melt</span>(nba,<span class="dt">id.vars =</span> <span class="st">&quot;Name&quot;</span>) <span class="co">#寬表轉長表,以名字作依據</span></a>
<a class="sourceLine" id="cb555-3" title="3"><span class="kw">head</span>(nba.m,<span class="dv">10</span>)</a></code></pre></div>
<pre><code>##                Name variable value
## 1      Dwyane Wade         G    79
## 2     LeBron James         G    81
## 3      Kobe Bryant         G    82
## 4    Dirk Nowitzki         G    81
## 5    Danny Granger         G    67
## 6     Kevin Durant         G    74
## 7     Kevin Martin         G    51
## 8     Al Jefferson         G    50
## 9       Chris Paul         G    78
## 10 Carmelo Anthony         G    66</code></pre>
<p>將Geometric objects指定為<code>geom_tile()</code>，完成Heatmap</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" title="1"><span class="kw">library</span>(ggplot2) <span class="co">#for ggplot()</span></a>
<a class="sourceLine" id="cb557-2" title="2"><span class="kw">ggplot</span>(nba.m, <span class="kw">aes</span>(variable, Name)) <span class="op">+</span><span class="st"> </span><span class="co">#aes(x,y)</span></a>
<a class="sourceLine" id="cb557-3" title="3"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> value),<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">#geom_tile: 區塊著色</span></a>
<a class="sourceLine" id="cb557-4" title="4"><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">high =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="co">#數值低：白色</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>看上圖可以發現，因為G欄資料明顯大於其他欄位，導致顏色差異不明顯，為了解決此問題，將個欄位的資料標準化處理，這邊使用到apply函式</p>
<p>apply()有類似for迴圈的功能</p>
<ul>
<li>apply(Data, MARGIN, FUN,…)
<ul>
<li>Data：矩陣（Matrix），Data Frame</li>
<li>MARGIN：1=row, 2=column</li>
<li>FUN：函數</li>
<li>…：函數要用的參數</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb558-1" title="1">nba[,<span class="dv">2</span><span class="op">:</span><span class="dv">21</span>]&lt;-<span class="kw">apply</span>(nba[,<span class="dv">2</span><span class="op">:</span><span class="dv">21</span>], <span class="dv">2</span>, scale) <span class="co">#scale處理，將數值轉為平均=0</span></a>
<a class="sourceLine" id="cb558-2" title="2"><span class="kw">head</span>(nba,<span class="dv">2</span>)</a></code></pre></div>
<pre><code>##            Name    G  MIN PTS FGM FGA  FGP FTM FTA   FTP  X3PM X3PA   X3PP
## 1  Dwyane Wade  0.62 1.00 3.2 2.9 2.6 0.51 1.9 2.1 -0.74 -0.11 0.13 -0.157
## 2 LeBron James  0.77 0.61 2.6 2.0 1.7 0.46 1.8 1.9 -0.52  0.49 0.70  0.027
##      ORB   DRB   TRB AST STL  BLK  TO   PF
## 1 -0.272 -0.35 -0.33 1.7 2.6 1.21 1.8 -0.3
## 2 -0.061  1.01  0.66 1.5 1.4 0.86 1.1 -1.4</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb560-1" title="1">nba.m &lt;-<span class="st"> </span><span class="kw">melt</span>(nba) <span class="co">##寬轉長</span></a>
<a class="sourceLine" id="cb560-2" title="2"><span class="kw">ggplot</span>(nba.m, <span class="kw">aes</span>(variable, Name)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb560-3" title="3"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> value),<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">#geom_tile: 區塊著色</span></a>
<a class="sourceLine" id="cb560-4" title="4"><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">high =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="co">#數值低：白色</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<p>以上範例之參考資料為<a href="http://flowingdata.com/2010/01/21/how-to-make-a-heatmap-a-quick-and-easy-solution/" target="_blank">How to Make a Heatmap – a Quick and Easy Solution</a></p>
</div>
</div>
<div id="treemap" class="section level2">
<h2><span class="header-section-number">8.5</span> Treemap</h2>
<p>Treemap(矩形式樹狀結構繪圖法)是以二維平面的方式展示包含階層結構（hierarchical）形式的統計資訊，在R中可以使用<code>treemapify</code><span class="citation">(Wilkins <a href="#ref-R-treemapify" role="doc-biblioref">2019</a>)</span> packages</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</a>
<a class="sourceLine" id="cb561-2" title="2"><span class="kw">library</span>(devtools)</a>
<a class="sourceLine" id="cb561-3" title="3"><span class="kw">install_github</span>(<span class="st">&quot;wilkox/ggfittext&quot;</span>)</a>
<a class="sourceLine" id="cb561-4" title="4"><span class="kw">install_github</span>(<span class="st">&quot;wilkox/treemapify&quot;</span>) </a></code></pre></div>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" title="1"><span class="kw">library</span>(treemapify)</a></code></pre></div>
<p>以G20 Dataset為例，二十國集團（英語：Group of Twenty，縮寫：G20）是一個國際經濟合作論壇，於1999年12月16日在德國柏林成立，屬於布雷頓森林體系框架內非正式對話的一種機制，由七國集團（美國、英國、法國、德國、義大利、日本、加拿大），金磚五國（中國、印度、巴西、俄羅斯、南非），七個重要經濟體（澳大利亞、墨西哥、韓國、土耳其、印尼、沙烏地阿拉伯、阿根廷），以及歐盟組成。按照慣例，國際貨幣基金組織與世界銀行列席該組織的會議。二十國集團的GDP總量約佔全球GDP的85％，貿易佔全球貿易總額的80%以上，人口約佔全球人口的2/3。（<a href="https://en.wikipedia.org/wiki/G-20_major_economies" target="_blank">維基百科</a>）</p>
<p>G20 Dataset包含20個國家的資訊，資料欄位有：</p>
<ul>
<li>Region 國家所在區域</li>
<li>Country 國家名稱</li>
<li>Trade.mil.USD 總貿易額，以百萬為單位</li>
<li>Nom.GDP.mil.USD 名義國內生產總值，以百萬為單位</li>
<li>HDI 人類發展指數（<a href="https://zh.wikipedia.org/zh-tw/%E4%BA%BA%E7%B1%BB%E5%8F%91%E5%B1%95%E6%8C%87%E6%95%B0" target="_blank">維基百科</a>）</li>
<li>Population 人口數</li>
<li>Economic.classification 經濟狀況分類</li>
</ul>
<p>首先將資料讀入，並用<code>str()</code>函式觀察資料型態</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" title="1"><span class="kw">data</span>(G20)<span class="co">#範例資料</span></a>
<a class="sourceLine" id="cb563-2" title="2"><span class="kw">str</span>(G20)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    20 obs. of  6 variables:
##  $ region             : Factor w/ 8 levels &quot;Africa&quot;,&quot;Asia&quot;,..: 1 6 6 6 8 8 2 2 2 2 ...
##  $ country            : Factor w/ 20 levels &quot;Argentina&quot;,&quot;Australia&quot;,..: 16 20 4 13 3 1 5 12 17 9 ...
##  $ gdp_mil_usd        : int  384315 15684750 1819081 1177116 2395968 474954 8227037 5963969 1155872 1824832 ...
##  $ hdi                : num  0.629 0.937 0.911 0.775 0.73 0.811 0.699 0.912 0.909 0.554 ...
##  $ econ_classification: Factor w/ 2 levels &quot;Advanced&quot;,&quot;Developing&quot;: 2 1 1 2 2 2 2 1 1 2 ...
##  $ hemisphere         : Factor w/ 2 levels &quot;Northern&quot;,&quot;Southern&quot;: 2 1 1 1 2 2 1 1 1 1 ...</code></pre>
<p>用搭配<code>ggplot()</code>函數，使用<code>geom_treemap()</code>做圖</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" title="1"><span class="kw">ggplot</span>(G20, <span class="kw">aes</span>(<span class="dt">area =</span> gdp_mil_usd, <span class="dt">fill =</span> hdi)) <span class="op">+</span></a>
<a class="sourceLine" id="cb565-2" title="2"><span class="st">  </span><span class="kw">geom_treemap</span>()</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/ggplotify1-1.png" width="672" /></p>
<p>看函式名稱不難了解<code>ggplotify()</code>也是基於<code>ggplot2</code>套件開發，所以可以使用ggplot2的圖形設定參數改變圖形樣式，由於數字越大顏色越深比較符合視覺化的常理，所以這邊使用<code>ggplot2</code>的<code>scale_fill_gradient()</code>函式指定數值高低所需的顏色</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb566-1" title="1"><span class="kw">ggplot</span>(G20, <span class="kw">aes</span>(<span class="dt">area =</span> gdp_mil_usd, <span class="dt">fill =</span> hdi, <span class="dt">label =</span> country)) <span class="op">+</span></a>
<a class="sourceLine" id="cb566-2" title="2"><span class="st">  </span><span class="kw">geom_treemap</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb566-3" title="3"><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">high =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="co">#指定高低顏色</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/ggplotify2-1.png" width="672" /></p>
<p>也可使用<code>geom_treemap_text()</code>加上文字標籤。</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" title="1"><span class="kw">ggplot</span>(G20, <span class="kw">aes</span>(<span class="dt">area =</span> gdp_mil_usd, <span class="dt">fill =</span> hdi, <span class="dt">label =</span> country)) <span class="op">+</span></a>
<a class="sourceLine" id="cb567-2" title="2"><span class="st">  </span><span class="kw">geom_treemap</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb567-3" title="3"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">high =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="co">#指定高低顏色+</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/ggplotify3-1.png" width="672" /></p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb568-1" title="1">  <span class="kw">geom_treemap_text</span>(<span class="dt">fontface =</span> <span class="st">&quot;italic&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">place =</span> <span class="st">&quot;centre&quot;</span>,</a>
<a class="sourceLine" id="cb568-2" title="2">                    <span class="dt">grow =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## geom_treemap_text: na.rm = FALSE, padding.x = 1, padding.y = 1, place = centre, min.size = 4, grow = TRUE, reflow = FALSE, fixed = NULL, layout = squarified, start = bottomleft
## stat_identity: na.rm = FALSE
## position_identity</code></pre>
<p>完整做圖程式碼如下：</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb570-1" title="1"><span class="co">## install.packages(&quot;devtools&quot;) 第一次使用前需要安裝</span></a>
<a class="sourceLine" id="cb570-2" title="2"><span class="co">## library(devtools)</span></a>
<a class="sourceLine" id="cb570-3" title="3"><span class="co">## install_github(&quot;wilkox/treemapify&quot;) </span></a>
<a class="sourceLine" id="cb570-4" title="4"><span class="kw">library</span>(treemapify)</a>
<a class="sourceLine" id="cb570-5" title="5"><span class="kw">data</span>(G20)<span class="co">#載入範例資料</span></a>
<a class="sourceLine" id="cb570-6" title="6"><span class="kw">ggplot</span>(G20, <span class="kw">aes</span>(<span class="dt">area =</span> gdp_mil_usd, <span class="dt">fill =</span> hdi, <span class="dt">label =</span> country)) <span class="op">+</span></a>
<a class="sourceLine" id="cb570-7" title="7"><span class="st">  </span><span class="kw">geom_treemap</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb570-8" title="8"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">high =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="co">#指定高低顏色+</span></a>
<a class="sourceLine" id="cb570-9" title="9">  <span class="kw">geom_treemap_text</span>(<span class="dt">fontface =</span> <span class="st">&quot;italic&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">place =</span> <span class="st">&quot;centre&quot;</span>,</a>
<a class="sourceLine" id="cb570-10" title="10">                    <span class="dt">grow =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><code>treemap</code><span class="citation">(Tennekes <a href="#ref-R-treemap" role="doc-biblioref">2017</a>)</span> package也提供相同的功能</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" title="1"><span class="kw">library</span>(treemap)</a>
<a class="sourceLine" id="cb571-2" title="2"><span class="kw">data</span>(GNI2014)</a>
<a class="sourceLine" id="cb571-3" title="3"><span class="kw">treemap</span>(GNI2014,</a>
<a class="sourceLine" id="cb571-4" title="4">       <span class="dt">index=</span><span class="kw">c</span>(<span class="st">&quot;continent&quot;</span>, <span class="st">&quot;iso3&quot;</span>), <span class="co">#分組依據</span></a>
<a class="sourceLine" id="cb571-5" title="5">       <span class="dt">vSize=</span><span class="st">&quot;population&quot;</span>, <span class="co">#區塊大小</span></a>
<a class="sourceLine" id="cb571-6" title="6">       <span class="dt">vColor=</span><span class="st">&quot;GNI&quot;</span>, <span class="co">#顏色深淺</span></a>
<a class="sourceLine" id="cb571-7" title="7">       <span class="dt">type=</span><span class="st">&quot;value&quot;</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/treemap1-1.png" width="672" /></p>
<p><a href="https://github.com/wilkox/treemapify" target="_blank">參考資料</a></p>
</div>
<div id="參考文件與資源-2" class="section level2">
<h2><span class="header-section-number">8.6</span> 參考文件與資源</h2>
<ul>
<li>官方網站<a href="http://docs.ggplot2.org/current/" target="_blank">文件</a></li>
<li>RStudio製作的<a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf" target="_blank">ggplot cheat sheet</a></li>
<li>DataCamp互動式課程1 <a href="https://www.datacamp.com/courses/data-visualization-with-ggplot2-1" target="_blank">Data Visualization with ggplot2 (Part 1)</a></li>
<li>DataCamp互動式課程2 <a href="https://www.datacamp.com/courses/data-visualization-with-ggplot2-2" target="_blank">Data Visualization with ggplot2 (Part 2)</a></li>
<li>DataCamp互動式課程3 <a href="https://www.datacamp.com/courses/data-visualization-with-ggplot2-3" target="_blank">Data Visualization with ggplot2 (Part 3)</a></li>
</ul>
<!--chapter:end:08-graphics.Rmd-->
</div>
</div>
<div id="InteractiveGraphics" class="section level1">
<h1><span class="header-section-number">9</span> 互動式資料呈現</h1>
<p>在R中有多種互動式資料呈現方式，除了傳統的<code>GGobi</code>、<code>iPlots</code>、<code>identify</code>等套件外，結合網頁呈現的互動畫呈現方式有更多的彈性，以下介紹幾種好用的互動式套件：</p>
<ul>
<li>ggvis</li>
<li>googleVis</li>
<li>Plot.ly</li>
</ul>
<p>使用者可依需求選擇使用。</p>
<p>最後再介紹Shiny，一個RStudio推出供R語言使用的網頁應用框架，使用者可以將做好的互動式圖表用Shiny部署網頁，並將分析結果以網頁的方式分享給別人。</p>
<div id="ggvis" class="section level2">
<h2><span class="header-section-number">9.1</span> ggvis</h2>
<p>ggvis<span class="citation">(Chang and Wickham <a href="#ref-R-ggvis" role="doc-biblioref">2018</a>)</span> 是RStudio開發的互動式繪圖套件，繪圖語法與ggplot2<span class="citation">(Wickham, Chang, et al. <a href="#ref-R-ggplot2" role="doc-biblioref">2019</a>)</span>套件類似，基本概念是使用R做資料處理與分析，然後利用網頁的方式做視覺化呈現。如果使用RStudio IDE，透過ggvis套件畫的圖會呈現在右下角的<strong>Viewer</strong>視窗中。</p>
<p>使用ggvis套件時，必須先安裝與載入</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb572-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;ggvis&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb573-1" title="1"><span class="kw">library</span>(ggvis)</a></code></pre></div>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb574-1" title="1">p &lt;-<span class="st"> </span><span class="kw">ggvis</span>(mtcars, <span class="dt">x =</span> <span class="op">~</span>wt, <span class="dt">y =</span> <span class="op">~</span>mpg)</a>
<a class="sourceLine" id="cb574-2" title="2"><span class="kw">layer_points</span>(p)</a></code></pre></div>
<div id="plot_id253285579-container" class="ggvis-output-container">
<div id="plot_id253285579" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id253285579_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id253285579" data-renderer="svg">SVG</a>
 | 
<a id="plot_id253285579_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id253285579" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id253285579_download" class="ggvis-download" data-plot-id="plot_id253285579">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id253285579_spec = {
  "data": [
    {
      "name": "mtcars0",
      "format": {
        "type": "csv",
        "parse": {
          "wt": "number",
          "mpg": "number"
        }
      },
      "values": "\"wt\",\"mpg\"\n2.62,21\n2.875,21\n2.32,22.8\n3.215,21.4\n3.44,18.7\n3.46,18.1\n3.57,14.3\n3.19,24.4\n3.15,22.8\n3.44,19.2\n3.44,17.8\n4.07,16.4\n3.73,17.3\n3.78,15.2\n5.25,10.4\n5.424,10.4\n5.345,14.7\n2.2,32.4\n1.615,30.4\n1.835,33.9\n2.465,21.5\n3.52,15.5\n3.435,15.2\n3.84,13.3\n3.845,19.2\n1.935,27.3\n2.14,26\n1.513,30.4\n3.17,15.8\n2.77,19.7\n3.57,15\n2.78,21.4"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n1.31745\n5.61955"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n9.225\n35.075"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "fill": {
            "value": "#000000"
          },
          "size": {
            "value": 50
          },
          "x": {
            "scale": "x",
            "field": "data.wt"
          },
          "y": {
            "scale": "y",
            "field": "data.mpg"
          }
        },
        "ggvis": {
          "data": {
            "value": "mtcars0"
          }
        }
      },
      "from": {
        "data": "mtcars0"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "wt"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "mpg"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 672,
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id253285579").parseSpec(plot_id253285579_spec);
</script>
<p>增加<code>input_slider</code>函數，讓使用者可以調整圖形畫圖方式（因書本輸出格式，不支援動態畫圖，請將程式碼複製貼上到RStudio中就能看到互動式畫圖的樣子）</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb575-1" title="1">p&lt;-<span class="kw">ggvis</span>(mtcars,<span class="op">~</span>wt)</a>
<a class="sourceLine" id="cb575-2" title="2"><span class="kw">layer_histograms</span>(p,<span class="dt">width =</span>  <span class="kw">input_slider</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dt">step =</span> <span class="fl">0.10</span>, <span class="dt">label =</span> <span class="st">&quot;width&quot;</span>),</a>
<a class="sourceLine" id="cb575-3" title="3">                   <span class="dt">center =</span> <span class="kw">input_slider</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dt">step =</span> <span class="fl">0.05</span>, <span class="dt">label =</span> <span class="st">&quot;center&quot;</span>))</a></code></pre></div>
<pre><code>## Warning: Can&#39;t output dynamic/interactive ggvis plots in a knitr document.
## Generating a static (non-dynamic, non-interactive) version of the plot.</code></pre>
<div id="plot_id213047457-container" class="ggvis-output-container">
<div id="plot_id213047457" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id213047457_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id213047457" data-renderer="svg">SVG</a>
 | 
<a id="plot_id213047457_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id213047457" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id213047457_download" class="ggvis-download" data-plot-id="plot_id213047457">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id213047457_spec = {
  "data": [
    {
      "name": "mtcars0/bin1/stack2",
      "format": {
        "type": "csv",
        "parse": {
          "xmin_": "number",
          "xmax_": "number",
          "stack_upr_": "number",
          "stack_lwr_": "number"
        }
      },
      "values": "\"xmin_\",\"xmax_\",\"stack_upr_\",\"stack_lwr_\"\n1.5,2.5,8,0\n2.5,3.5,13,0\n3.5,4.5,8,0\n4.5,5.5,3,0"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n1.3\n5.7"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n0\n13.65"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "rect",
      "properties": {
        "update": {
          "stroke": {
            "value": "#000000"
          },
          "fill": {
            "value": "#333333"
          },
          "x": {
            "scale": "x",
            "field": "data.xmin_"
          },
          "x2": {
            "scale": "x",
            "field": "data.xmax_"
          },
          "y": {
            "scale": "y",
            "field": "data.stack_upr_"
          },
          "y2": {
            "scale": "y",
            "field": "data.stack_lwr_"
          }
        },
        "ggvis": {
          "data": {
            "value": "mtcars0/bin1/stack2"
          }
        }
      },
      "from": {
        "data": "mtcars0/bin1/stack2"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "wt"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "count"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 672,
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id213047457").parseSpec(plot_id213047457_spec);
</script>
<p>除了<code>input_slider()</code>外，ggvis還提供以下互動式輸入介面：</p>
<ul>
<li>input_checkbox()</li>
<li>input_checkboxgroup()</li>
<li>input_numeric()</li>
<li>input_radiobuttons()</li>
<li>input_select()</li>
<li>input_text()</li>
</ul>
<p>其他詳細使用說明請參考<a href="http://ggvis.rstudio.com/" target="_blank">官網</a></p>
<p>##googleVis
googleVis<span class="citation">(Gesmann and de Castillo <a href="#ref-R-googleVis" role="doc-biblioref">2019</a>)</span> package是基於<a href="https://developers.google.com/chart/interactive/docs/" target="_blank">Google Chart API</a>開發的R套件，使用前需要先安裝與載入。</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb577-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;googleVis&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb578-1" title="1"><span class="kw">library</span>(googleVis)</a></code></pre></div>
<p>如果想要一次看完所有作圖範例，可用以下指令（執行完畢需要一點時間）</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb579-1" title="1"><span class="kw">demo</span>(googleVis)</a></code></pre></div>
<p>googleVis套件提供多種繪圖方式，包括：</p>
<ul>
<li>一維資料做圖
<ul>
<li>gvisHistogram</li>
</ul></li>
<li>類別-數值資料做圖
<ul>
<li>gvisPieChart</li>
<li>gvisGauge</li>
<li>gvisBarChart</li>
<li>gvisColumnChart</li>
<li>gvisCandlestickChart</li>
</ul></li>
<li>數值-數值資料做圖
<ul>
<li>gvisLineChart</li>
<li>gvisAreaChart</li>
<li>gvisSteppedAreaChart</li>
<li>gvisScatterChart</li>
<li>gvisAnnotationChart</li>
</ul></li>
<li>數值-數值-數值資料做圖
<ul>
<li>gvisBubbleChart</li>
</ul></li>
<li>地圖相關
<ul>
<li>gvisIntensityMap</li>
<li>gvisGeoChart</li>
<li>gvisMap</li>
</ul></li>
<li>其他圖形
<ul>
<li>gvisOrgChart</li>
<li>gvisTreeMap</li>
<li>gvisSankey</li>
<li>gvisComboChart</li>
<li>gvisCalendar</li>
<li>gvisTimeline</li>
</ul></li>
</ul>
<p>詳細使用說明請參考<a href="https://cran.r-project.org/web/packages/googleVis/vignettes/googleVis_examples.html" target="_blank">googleVis套件說明</a></p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb580-1" title="1">df=<span class="kw">data.frame</span>(<span class="dt">country=</span><span class="kw">c</span>(<span class="st">&quot;US&quot;</span>, <span class="st">&quot;GB&quot;</span>, <span class="st">&quot;BR&quot;</span>), </a>
<a class="sourceLine" id="cb580-2" title="2">              <span class="dt">val1=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>), </a>
<a class="sourceLine" id="cb580-3" title="3">              <span class="dt">val2=</span><span class="kw">c</span>(<span class="dv">23</span>,<span class="dv">12</span>,<span class="dv">32</span>))</a>
<a class="sourceLine" id="cb580-4" title="4">Line &lt;-<span class="st"> </span><span class="kw">gvisLineChart</span>(df)</a>
<a class="sourceLine" id="cb580-5" title="5"><span class="kw">plot</span>(Line)</a></code></pre></div>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb581-1" title="1"><span class="kw">require</span>(datasets)</a>
<a class="sourceLine" id="cb581-2" title="2">states &lt;-<span class="st"> </span><span class="kw">data.frame</span>(state.name, state.x77)</a>
<a class="sourceLine" id="cb581-3" title="3">GeoStates &lt;-<span class="st"> </span><span class="kw">gvisGeoChart</span>(states, <span class="st">&quot;state.name&quot;</span>, <span class="st">&quot;Illiteracy&quot;</span>,</a>
<a class="sourceLine" id="cb581-4" title="4">                          <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">region=</span><span class="st">&quot;US&quot;</span>, </a>
<a class="sourceLine" id="cb581-5" title="5">                                       <span class="dt">displayMode=</span><span class="st">&quot;regions&quot;</span>, </a>
<a class="sourceLine" id="cb581-6" title="6">                                       <span class="dt">resolution=</span><span class="st">&quot;provinces&quot;</span>,</a>
<a class="sourceLine" id="cb581-7" title="7">                                       <span class="dt">width=</span><span class="dv">600</span>, <span class="dt">height=</span><span class="dv">400</span>))</a>
<a class="sourceLine" id="cb581-8" title="8"><span class="kw">plot</span>(GeoStates)</a></code></pre></div>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb582-1" title="1">AndrewMap &lt;-<span class="st"> </span><span class="kw">gvisMap</span>(Andrew, <span class="st">&quot;LatLong&quot;</span> , <span class="st">&quot;Tip&quot;</span>, </a>
<a class="sourceLine" id="cb582-2" title="2">                     <span class="dt">options=</span><span class="kw">list</span>(<span class="dt">showTip=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb582-3" title="3">                                  <span class="dt">showLine=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb582-4" title="4">                                  <span class="dt">enableScrollWheel=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb582-5" title="5">                                  <span class="dt">mapType=</span><span class="st">&#39;terrain&#39;</span>, </a>
<a class="sourceLine" id="cb582-6" title="6">                                  <span class="dt">useMapTypeControl=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb582-7" title="7"><span class="kw">plot</span>(AndrewMap)</a></code></pre></div>
<p>其他Google Chart可以做的圖形種類，可以參考<a href="https://developers.google.com/chart/interactive/docs/gallery" target="_blank">Chart Gallery</a></p>
</div>
<div id="plot.ly" class="section level2">
<h2><span class="header-section-number">9.2</span> Plot.ly</h2>
<p><a href="https://plot.ly/" target="_blank">Plotly</a>是一個線上分析與視覺化的工具，如需線上作圖，可至https://plot.ly/create/ 建立帳號並開始作圖。Plotly也<strong>提供套件R使用</strong>，使用者可以透過安裝plotly<span class="citation">(Sievert et al. <a href="#ref-R-plotly" role="doc-biblioref">2019</a>)</span> package在R中畫基於<strong>Plotly.js</strong> (<strong>d3.js </strong> + <strong>stack.gl</strong>)的圖表和地圖。除了R的套件外，還有Python, MATLAB, Perl, Julia, Arduino等套件可供使用。</p>
<p>使用plotly套件時，必須先安裝與載入</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb583-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;plotly&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb584-1" title="1"><span class="kw">library</span>(plotly)</a></code></pre></div>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb585-1" title="1">d &lt;-<span class="st"> </span>diamonds[<span class="kw">sample</span>(<span class="kw">nrow</span>(diamonds), <span class="dv">1000</span>), ]</a>
<a class="sourceLine" id="cb585-2" title="2"><span class="kw">plot_ly</span>(d, <span class="dt">x =</span> <span class="op">~</span>carat, <span class="dt">y =</span> <span class="op">~</span>price, <span class="dt">color =</span> <span class="op">~</span>carat,</a>
<a class="sourceLine" id="cb585-3" title="3">        <span class="dt">size =</span> <span class="op">~</span>carat, <span class="dt">text =</span> <span class="op">~</span><span class="kw">paste</span>(<span class="st">&quot;Clarity: &quot;</span>, clarity))</a></code></pre></div>
<pre><code>## Warning: `line.width` does not currently support multiple values.</code></pre>
<div id="htmlwidget-3d6cb963d72b707d6b72" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3d6cb963d72b707d6b72">{"x":{"visdat":{"11441dda52dc":["function () ","plotlyVisDat"]},"cur_data":"11441dda52dc","attrs":{"11441dda52dc":{"x":{},"y":{},"text":{},"color":{},"size":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"carat"},"yaxis":{"domain":[0,1],"automargin":true,"title":"price"},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.5,0.56,0.28,1.07,0.73,0.3,2.11,0.41,0.36,0.35,1.5,1.13,0.7,1,1.14,0.71,0.41,0.3,0.23,1.08,0.3,1.64,0.8,0.96,0.71,0.53,0.47,1.15,0.96,1.53,1.02,0.4,0.5,0.58,1.14,1,0.51,1.21,1.53,0.51,2,1.51,0.71,0.95,1.51,0.52,0.59,1.01,1.51,0.31,0.43,1.01,0.41,0.72,0.32,0.41,0.3,0.3,0.35,1.04,0.4,0.33,0.52,0.34,0.9,1.01,0.72,0.32,0.27,1.01,1.21,2.03,0.95,1.07,1.01,1.11,0.55,0.33,0.72,1.07,0.42,0.28,0.31,1.01,0.5,1.18,0.91,1.5,0.54,0.43,0.26,1.23,0.31,0.3,0.34,0.54,0.3,1.18,0.3,0.3,0.32,0.33,1.2,1.1,0.52,0.39,0.55,1,2.02,0.91,0.3,0.81,1.52,1.11,0.31,1.12,1.02,0.9,1.16,0.7,0.41,0.82,1.15,0.61,0.55,0.41,0.4,1.01,0.53,1,1.21,1.29,2,0.39,0.53,1.09,0.33,0.5,0.38,0.31,0.28,0.71,1.51,1.5,0.35,0.32,0.75,0.55,1,1,1,1,0.3,1.01,0.7,0.31,0.91,0.8,0.77,0.3,0.43,1.31,0.44,0.32,0.56,0.41,0.24,0.42,0.82,0.71,1.03,0.35,2.13,1.22,0.33,0.71,1.04,1.31,1.21,0.31,1.01,0.53,0.39,0.32,0.3,0.7,0.52,1.07,0.26,0.74,1.12,1.1,1,0.29,1.68,0.32,0.31,1.01,0.7,0.55,0.71,1,1.32,0.79,0.52,0.61,0.3,1.07,0.36,0.3,1.7,0.3,0.35,0.73,0.44,0.74,0.9,2.03,1.2,2.25,0.72,0.71,0.77,1.03,1.39,1.31,0.7,0.41,1.06,0.42,1.55,0.33,1.3,1.03,0.41,0.31,0.4,1.5,1.54,0.25,1.06,1.19,1.01,0.7,0.52,0.52,0.55,0.7,1.16,1.51,0.3,1.22,1.2,1.52,0.4,0.56,0.51,1.01,1.02,0.3,1.02,0.31,0.35,0.5,0.54,1.53,0.37,0.84,0.3,1.1,1,1.01,0.41,2.05,0.72,0.7,2.06,0.3,0.32,0.3,1.6,0.38,0.51,0.31,0.31,0.4,0.51,0.51,0.47,0.41,0.55,0.91,0.38,0.34,0.32,0.76,0.34,0.9,1.23,1.5,2,1.25,1.07,0.46,0.32,1.51,1,1.02,0.58,0.67,1.8,2.02,0.32,0.54,1.01,1.7,0.3,1.2,1.14,0.27,1.01,0.5,1.52,0.96,1.18,0.27,0.4,1.51,1.01,0.45,0.74,0.27,1,1.16,0.32,0.9,0.76,1.49,0.3,2.32,0.7,1.58,1.08,0.72,0.35,1.23,0.76,0.57,0.86,0.41,1.03,1.14,1.01,1.21,2.02,0.32,0.8,0.96,2.07,1.47,0.72,1.54,0.3,0.43,0.53,1.2,0.51,1.08,0.55,0.38,0.38,2.01,1.09,0.31,1,0.52,1.01,1.01,0.38,1.11,0.51,0.3,0.53,1.2,1.23,0.9,0.33,2.03,0.9,0.7,1.01,1.7,0.39,0.54,1.03,1.01,1.14,1.51,1.13,0.32,0.32,1.5,0.31,0.23,0.44,0.33,0.6,1.21,2.1,1.02,1.01,0.7,0.32,1.29,0.3,2.01,2.05,1.58,0.57,0.9,1,1.06,0.3,1,1.02,0.5,1.21,1.04,0.71,0.31,0.7,0.65,0.91,0.56,0.27,1.42,1.21,1.28,0.38,1.02,0.72,0.32,0.71,1.52,1.18,0.32,1.58,1.24,0.39,0.3,1.01,0.4,1.04,0.56,1.61,0.71,1.68,0.24,0.9,1.21,1.23,2.03,0.33,0.77,2.01,0.32,1.5,0.57,1.06,0.38,1.05,1.26,0.27,0.98,0.71,2.02,0.42,0.9,0.35,0.41,1.32,0.81,0.75,0.3,2.02,0.38,0.76,0.9,0.31,0.56,0.31,0.31,1.52,0.33,1.5,0.33,1.01,1.12,0.27,1.19,1.2,0.33,1.23,0.3,1.01,0.41,0.4,1.09,1.28,0.39,0.33,0.3,0.31,0.41,0.33,0.34,0.5,2.3,1.01,0.7,0.42,0.55,0.42,1.41,1,0.9,0.74,1.54,0.71,0.39,0.74,0.9,0.41,0.46,0.42,0.3,0.59,0.3,0.37,0.54,1.95,1.02,0.31,1.25,0.74,1,1.01,1.02,0.42,0.5,0.31,0.54,0.4,0.31,1.01,1.03,2.01,0.42,0.39,0.51,2,0.41,0.48,0.93,0.52,0.56,1.53,0.31,2.28,0.39,0.9,1.21,1.71,0.46,1.05,0.4,1.74,2.01,0.34,0.6,1.35,0.42,1.2,0.81,0.33,1.32,1.02,0.82,1.02,0.34,0.9,1.13,0.72,0.53,0.39,0.3,0.24,1.93,0.9,1.93,0.57,1.2,0.68,0.33,0.4,1.03,1.17,0.5,0.54,1.1,0.4,1.01,1.08,1.12,1.05,0.7,0.56,0.93,0.41,1.2,1.27,0.3,1.01,1.25,1,1.01,1.28,0.27,0.71,0.34,1.05,1.19,0.5,0.36,0.33,0.3,0.9,0.5,0.43,0.9,0.72,1.12,0.81,1.5,0.73,0.5,0.56,1.07,0.5,0.9,0.41,0.52,0.41,0.61,0.71,0.92,2.01,0.7,0.35,0.73,0.32,0.31,0.4,0.72,0.51,0.72,1.07,0.27,1.01,0.91,1.03,1.03,1.01,0.4,1.06,0.41,0.5,0.73,0.5,0.76,0.32,0.61,0.54,0.71,0.4,0.33,0.4,1.12,0.25,0.53,0.52,2.2,0.51,0.37,0.92,1.16,2.29,1.5,0.35,0.32,1.03,2.03,0.3,0.3,0.7,0.7,0.9,0.31,1.04,1.5,0.97,0.54,0.5,2.04,1.03,0.71,0.23,0.39,0.42,1.52,0.37,0.91,0.78,1.02,0.33,0.37,1.22,0.71,0.3,0.31,0.3,0.28,2.02,0.7,1.22,1.14,0.56,1,0.41,1.12,0.3,1.01,0.31,0.7,0.3,0.86,0.56,0.3,0.23,0.31,1.01,0.35,1.15,0.35,0.51,0.38,0.64,0.3,0.54,0.53,2.01,1.75,0.51,0.3,1.08,1.01,0.32,0.7,0.33,0.51,0.36,0.8,0.72,0.34,0.72,0.38,0.88,0.31,0.41,0.42,0.5,1.29,0.4,1.2,1.15,0.41,0.41,0.82,0.32,0.38,0.7,0.54,1.01,0.72,0.7,0.31,1.01,1.57,1.11,1.03,0.31,0.3,1.04,0.73,0.55,0.73,0.71,1,0.53,1.02,0.24,0.35,1,0.3,0.43,0.7,1.51,0.7,2.01,1.36,1.01,0.9,0.3,2.32,0.32,1.03,0.3,1.6,0.77,1.18,1.21,1.4,0.32,1.58,0.46,0.56,1.51,0.5,0.55,1.58,0.32,1.01,0.33,0.54,0.31,0.9,1.21,0.9,0.31,1.08,1.03,1,0.79,0.3,1,0.73,1.2,1.51,0.41,1.07,0.36,0.36,1.01,0.42,0.82,1.06,1.97,1.21,2.23,0.32,0.74,0.78,1.01,0.83,0.4,0.58,1.01,2,0.9,0.81,0.55,1.01,1.23,1.31,0.71,0.41,0.43,0.3,0.31,0.32,0.41,0.7,1.76,0.33,0.28,1.22,0.7,0.33,0.57,0.42,1.04,1,0.31,0.57,1.55,1.54,0.61,1.19,0.33,1,0.33,0.41,1.01,0.91,1.01,1.01,0.46,0.31,0.45,1.57,0.26,0.4,0.33,1,0.44,1.02,1.01,0.78,0.91,1.02,0.42,0.51,1.09,0.42,0.5,0.32,0.58,1.06,0.54,1.05,1.71,1,1.27,2.22,0.33,0.43,0.33,0.31,0.31,1.2,0.3,0.24,0.43,0.32,0.4,0.54,0.71,1.05,0.77,1.13,1,0.32,0.3,0.33,0.9,0.7,0.52,1.5,0.71,0.37,0.93,1.51,0.2,0.62,0.58,0.57,0.54,1.59,0.3,1.81,1.21,0.34,1,0.37,1.53,1.11,1.53,0.37,0.41,1.02,0.88,0.8,0.31,0.6,0.28,0.41,1.12,1.11,1.01,0.51],"y":[1243,1686,586,5764,2496,709,17816,961,738,709,5846,3480,2373,6600,4785,2282,1439,737,530,4877,665,5624,4043,1739,3252,856,828,4701,3312,17223,7292,1059,1197,2395,5469,4737,1569,7810,10830,1662,14918,6976,2006,2195,12738,1720,1844,3224,14817,913,852,3563,755,3478,828,671,830,665,916,15671,1088,536,1656,819,4173,5538,2787,702,567,6540,5882,14239,3671,4105,5056,12725,1896,692,2177,5405,992,650,471,5662,1603,5696,4012,10618,1993,968,600,10580,802,747,686,1630,421,9095,886,638,524,984,5833,3872,1191,1011,1101,6382,13267,4128,554,3107,9527,5329,828,4064,6773,2753,9075,2329,863,3966,8114,1659,1263,1013,1125,4719,1654,5880,8305,7463,5914,746,1881,8204,984,1354,992,625,825,2863,11460,13232,945,561,4007,1588,4390,5197,4626,4172,956,5999,2407,1046,1945,2986,2677,789,754,4490,810,645,1723,1133,540,1031,3131,2226,4573,706,15454,5397,928,2590,4811,8818,9279,1319,3966,1578,1209,936,776,2138,1383,10453,394,3922,9461,8020,3080,607,5871,842,959,4588,2697,1134,3053,4077,5513,2394,1120,2161,911,7069,1013,710,9777,621,706,3980,1408,2779,4592,15826,4838,15397,2416,2327,3040,2942,7239,5582,2264,1427,6399,851,7502,702,5751,5814,969,755,909,9904,12522,436,3989,6078,5616,1848,1646,1721,1856,2028,7128,7915,684,8779,5376,8127,786,2066,1781,8849,4354,684,3811,878,906,1125,1389,9332,811,2628,911,4607,4704,3540,1431,18787,4094,2394,15691,658,730,694,8886,1400,1662,640,853,687,1567,1875,1178,683,1786,5167,847,885,900,4223,490,3484,6152,12389,13203,4199,4201,1035,602,11739,4150,5115,1979,2309,9979,12736,561,2113,5090,12622,473,8442,5367,470,5303,1679,7990,2672,8411,583,687,10947,5232,1736,2852,846,8467,10850,477,3770,1140,9132,742,10913,3053,13557,5419,2295,563,6909,2800,3313,3442,964,3634,12647,6533,10482,16789,1080,3273,2759,13879,6223,3352,11527,684,1053,1676,9424,1004,4407,1715,871,660,17514,7992,692,5122,1815,3871,6295,1160,3882,973,574,2297,4368,9547,3613,893,14646,2873,2398,4561,12992,718,1255,4932,4194,6070,10096,4959,1018,736,8044,698,505,1023,1141,1897,5720,13182,5084,4249,2604,867,10727,506,16901,16506,14451,1754,6124,15928,4602,526,4125,4037,1449,4946,4455,1748,1107,2239,2085,4430,1814,383,11861,7094,6308,641,4241,2333,645,2249,9898,5088,720,11526,5889,651,1071,4363,1168,4240,1723,10477,2573,5765,449,5102,6071,5386,13621,579,3251,17688,702,14242,2719,7641,891,5666,9243,470,3622,3856,18236,1031,3679,923,1431,6061,3053,2964,632,12798,929,3170,3387,872,2066,470,418,4345,608,16558,722,5784,8279,659,4332,5250,891,3835,608,6399,969,720,6546,4967,587,868,638,663,1085,780,775,2052,14215,11387,2966,953,2119,1210,14936,7403,4770,4383,10466,2029,788,2713,3387,1001,1166,847,776,1221,394,1033,1619,5045,6306,544,6661,3254,4427,8569,7916,722,1568,1009,2375,900,516,5294,3052,18574,1310,721,1665,16544,1057,1743,4793,1338,1698,12616,500,12907,1097,3574,7666,14731,1345,5104,687,10270,13849,714,2147,5610,1221,3011,2761,868,7209,7960,3439,4398,1033,3810,7066,2216,1428,911,477,678,17353,3919,13278,2682,7909,2224,743,868,4177,5831,1106,1346,7528,877,5184,5625,8408,5197,2400,2148,3114,876,8056,7023,684,3337,6300,4427,7355,6164,470,3238,760,3615,5504,1140,1013,434,731,4093,1118,941,3724,2891,5088,2562,10626,2164,1577,2032,6355,1187,4334,612,1237,1196,931,2735,3924,16956,2479,1044,2147,648,571,882,2514,1265,3145,4434,682,6480,4105,5624,7697,4480,622,4862,827,1710,4142,1020,2770,936,2659,1422,2704,667,752,1200,4811,633,1255,1743,17634,1899,1041,3920,4425,13200,10206,798,842,5330,13063,819,401,2273,2959,5335,502,3718,16948,3960,1551,1746,12799,4441,2771,505,895,847,10078,1087,4437,3267,5569,579,649,6237,2574,605,734,802,586,17936,2399,9002,7079,1712,4867,1197,3880,776,5497,698,2415,475,2647,1436,499,530,707,5823,798,10316,1024,1381,755,1969,710,1820,1561,17126,11113,2163,776,6411,4672,561,2218,434,2027,810,3066,3554,628,3179,993,2699,942,1076,1210,1323,6987,804,3965,4743,810,775,3364,972,1064,2942,1129,7982,2993,2167,511,4690,9912,8508,5491,1046,911,6206,1902,1682,2196,2629,3977,1928,7077,608,706,4200,658,669,2625,14482,2822,11156,8977,7847,4022,776,17676,756,4843,545,12210,2457,5182,7928,7345,692,7654,758,1949,11263,1147,1692,9775,721,3920,743,1662,698,3519,5232,4021,544,5049,8454,4469,3210,590,3769,1905,4637,12545,1367,5281,832,1094,6108,737,2974,3932,14410,6125,12770,979,2761,2401,6533,2201,898,1307,4150,15708,4637,3146,1755,5226,9257,10071,2137,945,1433,648,816,648,923,2362,18014,868,429,8950,2719,614,1847,675,3786,4919,628,1981,11869,8848,1303,6335,666,4724,1042,1439,7805,3812,6626,6770,746,814,1063,12417,733,772,723,3740,1003,7129,10197,3171,4502,4824,1031,1760,5428,773,1433,432,1876,4568,1583,6146,8690,4368,5547,18531,621,1207,579,802,802,5765,789,485,704,867,890,1310,3710,7010,2846,4025,4730,639,684,804,5201,2167,1227,13553,1932,894,5992,13068,367,2469,1809,1944,1726,9707,605,11854,5387,645,6073,684,11127,6088,12907,666,1187,5367,3619,4193,942,1250,642,1076,3838,6065,5251,1875],"text":["Clarity:  SI2","Clarity:  VS1","Clarity:  VVS2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  I1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  IF","Clarity:  VVS2","Clarity:  VVS1","Clarity:  VS1","Clarity:  VVS1","Clarity:  SI2","Clarity:  VS2","Clarity:  I1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS2","Clarity:  VVS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  I1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  IF","Clarity:  VVS1","Clarity:  VVS1","Clarity:  IF","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  VS1","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  IF","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS1","Clarity:  IF","Clarity:  VVS1","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS2","Clarity:  I1","Clarity:  SI2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  VVS2","Clarity:  VS1","Clarity:  SI1","Clarity:  IF","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  I1","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS1","Clarity:  IF","Clarity:  VS2","Clarity:  VVS2","Clarity:  VVS2","Clarity:  IF","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS2","Clarity:  IF","Clarity:  VS2","Clarity:  SI1","Clarity:  IF","Clarity:  I1","Clarity:  VS1","Clarity:  SI2","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI2","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI2","Clarity:  VS2","Clarity:  VS1","Clarity:  IF","Clarity:  SI2","Clarity:  VS2","Clarity:  IF","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VVS2","Clarity:  VVS2","Clarity:  VVS1","Clarity:  SI2","Clarity:  IF","Clarity:  I1","Clarity:  VVS1","Clarity:  VVS1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  VS1","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS1","Clarity:  VS2","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI2","Clarity:  VS2","Clarity:  SI1","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VS2","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VVS2","Clarity:  SI2","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI2","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  VVS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI2","Clarity:  VS2","Clarity:  VS1","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  IF","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI2","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS1","Clarity:  SI1","Clarity:  VVS1","Clarity:  VVS2","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI2","Clarity:  I1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  VVS1","Clarity:  SI2","Clarity:  VS1","Clarity:  SI2","Clarity:  IF","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  VVS2","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  VVS2","Clarity:  SI2","Clarity:  VS2","Clarity:  SI2","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  IF","Clarity:  VS1","Clarity:  VS1","Clarity:  VS2","Clarity:  VVS2","Clarity:  SI1","Clarity:  VVS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  VVS1","Clarity:  IF","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VVS2","Clarity:  SI1","Clarity:  VVS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  VS1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI2","Clarity:  VS2","Clarity:  IF","Clarity:  SI2","Clarity:  VVS2","Clarity:  SI2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  I1","Clarity:  VVS2","Clarity:  VS1","Clarity:  SI2","Clarity:  VS2","Clarity:  SI2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  VVS1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  I1","Clarity:  SI1","Clarity:  VS1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI2","Clarity:  SI2","Clarity:  IF","Clarity:  I1","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI2","Clarity:  VVS1","Clarity:  VVS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VVS2","Clarity:  VVS2","Clarity:  SI2","Clarity:  IF","Clarity:  VVS1","Clarity:  SI1","Clarity:  VS1","Clarity:  VVS2","Clarity:  VVS1","Clarity:  VVS2","Clarity:  VS1","Clarity:  IF","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  SI2","Clarity:  VS1","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI2","Clarity:  VS1","Clarity:  IF","Clarity:  VS2","Clarity:  I1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS2","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS1","Clarity:  SI2","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  VVS2","Clarity:  I1","Clarity:  SI2","Clarity:  VVS1","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VVS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS2","Clarity:  SI2","Clarity:  SI2","Clarity:  VS1","Clarity:  SI2","Clarity:  VVS1","Clarity:  SI2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI2","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VVS1","Clarity:  I1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI2","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  VS2","Clarity:  SI2","Clarity:  VVS1","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS1","Clarity:  IF","Clarity:  SI2","Clarity:  SI2","Clarity:  VVS2","Clarity:  IF","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  IF","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  VVS1","Clarity:  IF","Clarity:  SI1","Clarity:  SI2","Clarity:  VVS2","Clarity:  SI2","Clarity:  SI2","Clarity:  VS1","Clarity:  VS1","Clarity:  VS1","Clarity:  I1","Clarity:  VVS2","Clarity:  SI2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VVS2","Clarity:  IF","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS2","Clarity:  VS1","Clarity:  VS1","Clarity:  VVS1","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI2","Clarity:  IF","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS1","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  IF","Clarity:  VS2","Clarity:  VS2","Clarity:  SI2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI2","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS2","Clarity:  IF","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VS2","Clarity:  VVS1","Clarity:  SI2","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS1","Clarity:  VVS2","Clarity:  VS1","Clarity:  SI2","Clarity:  VS2","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  SI1","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS1","Clarity:  VS1","Clarity:  SI2","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS1","Clarity:  SI2","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  VVS1","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  IF","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  SI2","Clarity:  IF","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  SI2","Clarity:  VS1","Clarity:  SI2","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VVS1","Clarity:  IF","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS1","Clarity:  VS1","Clarity:  VS2","Clarity:  VS2","Clarity:  VVS2","Clarity:  SI1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS2","Clarity:  VVS1","Clarity:  VS1","Clarity:  SI2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  IF","Clarity:  IF","Clarity:  VVS1","Clarity:  SI2","Clarity:  VS1","Clarity:  VS2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS1","Clarity:  VS2","Clarity:  VS1","Clarity:  SI2","Clarity:  VVS2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS1","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  VVS2","Clarity:  VVS1","Clarity:  SI1","Clarity:  VVS2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  VS1","Clarity:  SI1","Clarity:  SI2","Clarity:  SI2","Clarity:  VS2","Clarity:  VVS2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS2","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  VS2","Clarity:  VS2","Clarity:  IF","Clarity:  VS2","Clarity:  VS2","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  SI2","Clarity:  VS2","Clarity:  VS2","Clarity:  SI1","Clarity:  VS1","Clarity:  SI1","Clarity:  VS2","Clarity:  SI1","Clarity:  IF","Clarity:  SI1","Clarity:  SI2","Clarity:  IF","Clarity:  VS2","Clarity:  SI2","Clarity:  VVS2","Clarity:  VVS2","Clarity:  SI2","Clarity:  SI1","Clarity:  SI1","Clarity:  VVS2"],"type":"scatter","mode":"markers","marker":{"colorbar":{"title":"carat","ticklen":2},"cmin":0.2,"cmax":2.32,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[0.5,0.56,0.28,1.07,0.73,0.3,2.11,0.41,0.36,0.35,1.5,1.13,0.7,1,1.14,0.71,0.41,0.3,0.23,1.08,0.3,1.64,0.8,0.96,0.71,0.53,0.47,1.15,0.96,1.53,1.02,0.4,0.5,0.58,1.14,1,0.51,1.21,1.53,0.51,2,1.51,0.71,0.95,1.51,0.52,0.59,1.01,1.51,0.31,0.43,1.01,0.41,0.72,0.32,0.41,0.3,0.3,0.35,1.04,0.4,0.33,0.52,0.34,0.9,1.01,0.72,0.32,0.27,1.01,1.21,2.03,0.95,1.07,1.01,1.11,0.55,0.33,0.72,1.07,0.42,0.28,0.31,1.01,0.5,1.18,0.91,1.5,0.54,0.43,0.26,1.23,0.31,0.3,0.34,0.54,0.3,1.18,0.3,0.3,0.32,0.33,1.2,1.1,0.52,0.39,0.55,1,2.02,0.91,0.3,0.81,1.52,1.11,0.31,1.12,1.02,0.9,1.16,0.7,0.41,0.82,1.15,0.61,0.55,0.41,0.4,1.01,0.53,1,1.21,1.29,2,0.39,0.53,1.09,0.33,0.5,0.38,0.31,0.28,0.71,1.51,1.5,0.35,0.32,0.75,0.55,1,1,1,1,0.3,1.01,0.7,0.31,0.91,0.8,0.77,0.3,0.43,1.31,0.44,0.32,0.56,0.41,0.24,0.42,0.82,0.71,1.03,0.35,2.13,1.22,0.33,0.71,1.04,1.31,1.21,0.31,1.01,0.53,0.39,0.32,0.3,0.7,0.52,1.07,0.26,0.74,1.12,1.1,1,0.29,1.68,0.32,0.31,1.01,0.7,0.55,0.71,1,1.32,0.79,0.52,0.61,0.3,1.07,0.36,0.3,1.7,0.3,0.35,0.73,0.44,0.74,0.9,2.03,1.2,2.25,0.72,0.71,0.77,1.03,1.39,1.31,0.7,0.41,1.06,0.42,1.55,0.33,1.3,1.03,0.41,0.31,0.4,1.5,1.54,0.25,1.06,1.19,1.01,0.7,0.52,0.52,0.55,0.7,1.16,1.51,0.3,1.22,1.2,1.52,0.4,0.56,0.51,1.01,1.02,0.3,1.02,0.31,0.35,0.5,0.54,1.53,0.37,0.84,0.3,1.1,1,1.01,0.41,2.05,0.72,0.7,2.06,0.3,0.32,0.3,1.6,0.38,0.51,0.31,0.31,0.4,0.51,0.51,0.47,0.41,0.55,0.91,0.38,0.34,0.32,0.76,0.34,0.9,1.23,1.5,2,1.25,1.07,0.46,0.32,1.51,1,1.02,0.58,0.67,1.8,2.02,0.32,0.54,1.01,1.7,0.3,1.2,1.14,0.27,1.01,0.5,1.52,0.96,1.18,0.27,0.4,1.51,1.01,0.45,0.74,0.27,1,1.16,0.32,0.9,0.76,1.49,0.3,2.32,0.7,1.58,1.08,0.72,0.35,1.23,0.76,0.57,0.86,0.41,1.03,1.14,1.01,1.21,2.02,0.32,0.8,0.96,2.07,1.47,0.72,1.54,0.3,0.43,0.53,1.2,0.51,1.08,0.55,0.38,0.38,2.01,1.09,0.31,1,0.52,1.01,1.01,0.38,1.11,0.51,0.3,0.53,1.2,1.23,0.9,0.33,2.03,0.9,0.7,1.01,1.7,0.39,0.54,1.03,1.01,1.14,1.51,1.13,0.32,0.32,1.5,0.31,0.23,0.44,0.33,0.6,1.21,2.1,1.02,1.01,0.7,0.32,1.29,0.3,2.01,2.05,1.58,0.57,0.9,1,1.06,0.3,1,1.02,0.5,1.21,1.04,0.71,0.31,0.7,0.65,0.91,0.56,0.27,1.42,1.21,1.28,0.38,1.02,0.72,0.32,0.71,1.52,1.18,0.32,1.58,1.24,0.39,0.3,1.01,0.4,1.04,0.56,1.61,0.71,1.68,0.24,0.9,1.21,1.23,2.03,0.33,0.77,2.01,0.32,1.5,0.57,1.06,0.38,1.05,1.26,0.27,0.98,0.71,2.02,0.42,0.9,0.35,0.41,1.32,0.81,0.75,0.3,2.02,0.38,0.76,0.9,0.31,0.56,0.31,0.31,1.52,0.33,1.5,0.33,1.01,1.12,0.27,1.19,1.2,0.33,1.23,0.3,1.01,0.41,0.4,1.09,1.28,0.39,0.33,0.3,0.31,0.41,0.33,0.34,0.5,2.3,1.01,0.7,0.42,0.55,0.42,1.41,1,0.9,0.74,1.54,0.71,0.39,0.74,0.9,0.41,0.46,0.42,0.3,0.59,0.3,0.37,0.54,1.95,1.02,0.31,1.25,0.74,1,1.01,1.02,0.42,0.5,0.31,0.54,0.4,0.31,1.01,1.03,2.01,0.42,0.39,0.51,2,0.41,0.48,0.93,0.52,0.56,1.53,0.31,2.28,0.39,0.9,1.21,1.71,0.46,1.05,0.4,1.74,2.01,0.34,0.6,1.35,0.42,1.2,0.81,0.33,1.32,1.02,0.82,1.02,0.34,0.9,1.13,0.72,0.53,0.39,0.3,0.24,1.93,0.9,1.93,0.57,1.2,0.68,0.33,0.4,1.03,1.17,0.5,0.54,1.1,0.4,1.01,1.08,1.12,1.05,0.7,0.56,0.93,0.41,1.2,1.27,0.3,1.01,1.25,1,1.01,1.28,0.27,0.71,0.34,1.05,1.19,0.5,0.36,0.33,0.3,0.9,0.5,0.43,0.9,0.72,1.12,0.81,1.5,0.73,0.5,0.56,1.07,0.5,0.9,0.41,0.52,0.41,0.61,0.71,0.92,2.01,0.7,0.35,0.73,0.32,0.31,0.4,0.72,0.51,0.72,1.07,0.27,1.01,0.91,1.03,1.03,1.01,0.4,1.06,0.41,0.5,0.73,0.5,0.76,0.32,0.61,0.54,0.71,0.4,0.33,0.4,1.12,0.25,0.53,0.52,2.2,0.51,0.37,0.92,1.16,2.29,1.5,0.35,0.32,1.03,2.03,0.3,0.3,0.7,0.7,0.9,0.31,1.04,1.5,0.97,0.54,0.5,2.04,1.03,0.71,0.23,0.39,0.42,1.52,0.37,0.91,0.78,1.02,0.33,0.37,1.22,0.71,0.3,0.31,0.3,0.28,2.02,0.7,1.22,1.14,0.56,1,0.41,1.12,0.3,1.01,0.31,0.7,0.3,0.86,0.56,0.3,0.23,0.31,1.01,0.35,1.15,0.35,0.51,0.38,0.64,0.3,0.54,0.53,2.01,1.75,0.51,0.3,1.08,1.01,0.32,0.7,0.33,0.51,0.36,0.8,0.72,0.34,0.72,0.38,0.88,0.31,0.41,0.42,0.5,1.29,0.4,1.2,1.15,0.41,0.41,0.82,0.32,0.38,0.7,0.54,1.01,0.72,0.7,0.31,1.01,1.57,1.11,1.03,0.31,0.3,1.04,0.73,0.55,0.73,0.71,1,0.53,1.02,0.24,0.35,1,0.3,0.43,0.7,1.51,0.7,2.01,1.36,1.01,0.9,0.3,2.32,0.32,1.03,0.3,1.6,0.77,1.18,1.21,1.4,0.32,1.58,0.46,0.56,1.51,0.5,0.55,1.58,0.32,1.01,0.33,0.54,0.31,0.9,1.21,0.9,0.31,1.08,1.03,1,0.79,0.3,1,0.73,1.2,1.51,0.41,1.07,0.36,0.36,1.01,0.42,0.82,1.06,1.97,1.21,2.23,0.32,0.74,0.78,1.01,0.83,0.4,0.58,1.01,2,0.9,0.81,0.55,1.01,1.23,1.31,0.71,0.41,0.43,0.3,0.31,0.32,0.41,0.7,1.76,0.33,0.28,1.22,0.7,0.33,0.57,0.42,1.04,1,0.31,0.57,1.55,1.54,0.61,1.19,0.33,1,0.33,0.41,1.01,0.91,1.01,1.01,0.46,0.31,0.45,1.57,0.26,0.4,0.33,1,0.44,1.02,1.01,0.78,0.91,1.02,0.42,0.51,1.09,0.42,0.5,0.32,0.58,1.06,0.54,1.05,1.71,1,1.27,2.22,0.33,0.43,0.33,0.31,0.31,1.2,0.3,0.24,0.43,0.32,0.4,0.54,0.71,1.05,0.77,1.13,1,0.32,0.3,0.33,0.9,0.7,0.52,1.5,0.71,0.37,0.93,1.51,0.2,0.62,0.58,0.57,0.54,1.59,0.3,1.81,1.21,0.34,1,0.37,1.53,1.11,1.53,0.37,0.41,1.02,0.88,0.8,0.31,0.6,0.28,0.41,1.12,1.11,1.01,0.51],"size":[22.7358490566038,25.2830188679245,13.3962264150943,46.933962264151,32.5,14.2452830188679,91.0849056603774,18.9150943396226,16.7924528301887,16.3679245283019,65.188679245283,49.4811320754717,31.2264150943396,43.9622641509434,49.9056603773585,31.6509433962264,18.9150943396226,14.2452830188679,11.2735849056604,47.3584905660377,14.2452830188679,71.1320754716981,35.4716981132076,42.2641509433962,31.6509433962264,24.0094339622642,21.4622641509434,50.3301886792453,42.2641509433962,66.4622641509434,44.811320754717,18.4905660377359,22.7358490566038,26.1320754716981,49.9056603773585,43.9622641509434,23.1603773584906,52.877358490566,66.4622641509434,23.1603773584906,86.4150943396227,65.6132075471698,31.6509433962264,41.8396226415094,65.6132075471698,23.5849056603774,26.5566037735849,44.3867924528302,65.6132075471698,14.6698113207547,19.7641509433962,44.3867924528302,18.9150943396226,32.0754716981132,15.0943396226415,18.9150943396226,14.2452830188679,14.2452830188679,16.3679245283019,45.6603773584906,18.4905660377359,15.5188679245283,23.5849056603774,15.9433962264151,39.7169811320755,44.3867924528302,32.0754716981132,15.0943396226415,12.9716981132075,44.3867924528302,52.877358490566,87.688679245283,41.8396226415094,46.933962264151,44.3867924528302,48.6320754716981,24.8584905660377,15.5188679245283,32.0754716981132,46.933962264151,19.3396226415094,13.3962264150943,14.6698113207547,44.3867924528302,22.7358490566038,51.6037735849057,40.1415094339623,65.188679245283,24.4339622641509,19.7641509433962,12.5471698113208,53.7264150943396,14.6698113207547,14.2452830188679,15.9433962264151,24.4339622641509,14.2452830188679,51.6037735849057,14.2452830188679,14.2452830188679,15.0943396226415,15.5188679245283,52.4528301886793,48.2075471698113,23.5849056603774,18.0660377358491,24.8584905660377,43.9622641509434,87.2641509433962,40.1415094339623,14.2452830188679,35.8962264150943,66.0377358490566,48.6320754716981,14.6698113207547,49.0566037735849,44.811320754717,39.7169811320755,50.7547169811321,31.2264150943396,18.9150943396226,36.3207547169811,50.3301886792453,27.4056603773585,24.8584905660377,18.9150943396226,18.4905660377359,44.3867924528302,24.0094339622642,43.9622641509434,52.877358490566,56.2735849056604,86.4150943396227,18.0660377358491,24.0094339622642,47.7830188679245,15.5188679245283,22.7358490566038,17.6415094339623,14.6698113207547,13.3962264150943,31.6509433962264,65.6132075471698,65.188679245283,16.3679245283019,15.0943396226415,33.3490566037736,24.8584905660377,43.9622641509434,43.9622641509434,43.9622641509434,43.9622641509434,14.2452830188679,44.3867924528302,31.2264150943396,14.6698113207547,40.1415094339623,35.4716981132076,34.1981132075472,14.2452830188679,19.7641509433962,57.122641509434,20.188679245283,15.0943396226415,25.2830188679245,18.9150943396226,11.6981132075472,19.3396226415094,36.3207547169811,31.6509433962264,45.2358490566038,16.3679245283019,91.9339622641509,53.3018867924528,15.5188679245283,31.6509433962264,45.6603773584906,57.122641509434,52.877358490566,14.6698113207547,44.3867924528302,24.0094339622642,18.0660377358491,15.0943396226415,14.2452830188679,31.2264150943396,23.5849056603774,46.933962264151,12.5471698113208,32.9245283018868,49.0566037735849,48.2075471698113,43.9622641509434,13.8207547169811,72.8301886792453,15.0943396226415,14.6698113207547,44.3867924528302,31.2264150943396,24.8584905660377,31.6509433962264,43.9622641509434,57.5471698113208,35.0471698113208,23.5849056603774,27.4056603773585,14.2452830188679,46.933962264151,16.7924528301887,14.2452830188679,73.6792452830189,14.2452830188679,16.3679245283019,32.5,20.188679245283,32.9245283018868,39.7169811320755,87.688679245283,52.4528301886793,97.0283018867925,32.0754716981132,31.6509433962264,34.1981132075472,45.2358490566038,60.5188679245283,57.122641509434,31.2264150943396,18.9150943396226,46.5094339622642,19.3396226415094,67.311320754717,15.5188679245283,56.6981132075472,45.2358490566038,18.9150943396226,14.6698113207547,18.4905660377359,65.188679245283,66.8867924528302,12.122641509434,46.5094339622642,52.0283018867925,44.3867924528302,31.2264150943396,23.5849056603774,23.5849056603774,24.8584905660377,31.2264150943396,50.7547169811321,65.6132075471698,14.2452830188679,53.3018867924528,52.4528301886793,66.0377358490566,18.4905660377359,25.2830188679245,23.1603773584906,44.3867924528302,44.811320754717,14.2452830188679,44.811320754717,14.6698113207547,16.3679245283019,22.7358490566038,24.4339622641509,66.4622641509434,17.2169811320755,37.1698113207547,14.2452830188679,48.2075471698113,43.9622641509434,44.3867924528302,18.9150943396226,88.5377358490566,32.0754716981132,31.2264150943396,88.9622641509434,14.2452830188679,15.0943396226415,14.2452830188679,69.433962264151,17.6415094339623,23.1603773584906,14.6698113207547,14.6698113207547,18.4905660377359,23.1603773584906,23.1603773584906,21.4622641509434,18.9150943396226,24.8584905660377,40.1415094339623,17.6415094339623,15.9433962264151,15.0943396226415,33.7735849056604,15.9433962264151,39.7169811320755,53.7264150943396,65.188679245283,86.4150943396227,54.5754716981132,46.933962264151,21.0377358490566,15.0943396226415,65.6132075471698,43.9622641509434,44.811320754717,26.1320754716981,29.9528301886793,77.9245283018868,87.2641509433962,15.0943396226415,24.4339622641509,44.3867924528302,73.6792452830189,14.2452830188679,52.4528301886793,49.9056603773585,12.9716981132075,44.3867924528302,22.7358490566038,66.0377358490566,42.2641509433962,51.6037735849057,12.9716981132075,18.4905660377359,65.6132075471698,44.3867924528302,20.6132075471698,32.9245283018868,12.9716981132075,43.9622641509434,50.7547169811321,15.0943396226415,39.7169811320755,33.7735849056604,64.7641509433962,14.2452830188679,100,31.2264150943396,68.5849056603774,47.3584905660377,32.0754716981132,16.3679245283019,53.7264150943396,33.7735849056604,25.7075471698113,38.0188679245283,18.9150943396226,45.2358490566038,49.9056603773585,44.3867924528302,52.877358490566,87.2641509433962,15.0943396226415,35.4716981132076,42.2641509433962,89.3867924528302,63.9150943396227,32.0754716981132,66.8867924528302,14.2452830188679,19.7641509433962,24.0094339622642,52.4528301886793,23.1603773584906,47.3584905660377,24.8584905660377,17.6415094339623,17.6415094339623,86.8396226415094,47.7830188679245,14.6698113207547,43.9622641509434,23.5849056603774,44.3867924528302,44.3867924528302,17.6415094339623,48.6320754716981,23.1603773584906,14.2452830188679,24.0094339622642,52.4528301886793,53.7264150943396,39.7169811320755,15.5188679245283,87.688679245283,39.7169811320755,31.2264150943396,44.3867924528302,73.6792452830189,18.0660377358491,24.4339622641509,45.2358490566038,44.3867924528302,49.9056603773585,65.6132075471698,49.4811320754717,15.0943396226415,15.0943396226415,65.188679245283,14.6698113207547,11.2735849056604,20.188679245283,15.5188679245283,26.9811320754717,52.877358490566,90.6603773584906,44.811320754717,44.3867924528302,31.2264150943396,15.0943396226415,56.2735849056604,14.2452830188679,86.8396226415094,88.5377358490566,68.5849056603774,25.7075471698113,39.7169811320755,43.9622641509434,46.5094339622642,14.2452830188679,43.9622641509434,44.811320754717,22.7358490566038,52.877358490566,45.6603773584906,31.6509433962264,14.6698113207547,31.2264150943396,29.1037735849057,40.1415094339623,25.2830188679245,12.9716981132075,61.7924528301887,52.877358490566,55.8490566037736,17.6415094339623,44.811320754717,32.0754716981132,15.0943396226415,31.6509433962264,66.0377358490566,51.6037735849057,15.0943396226415,68.5849056603774,54.1509433962264,18.0660377358491,14.2452830188679,44.3867924528302,18.4905660377359,45.6603773584906,25.2830188679245,69.8584905660377,31.6509433962264,72.8301886792453,11.6981132075472,39.7169811320755,52.877358490566,53.7264150943396,87.688679245283,15.5188679245283,34.1981132075472,86.8396226415094,15.0943396226415,65.188679245283,25.7075471698113,46.5094339622642,17.6415094339623,46.0849056603774,55,12.9716981132075,43.1132075471698,31.6509433962264,87.2641509433962,19.3396226415094,39.7169811320755,16.3679245283019,18.9150943396226,57.5471698113208,35.8962264150943,33.3490566037736,14.2452830188679,87.2641509433962,17.6415094339623,33.7735849056604,39.7169811320755,14.6698113207547,25.2830188679245,14.6698113207547,14.6698113207547,66.0377358490566,15.5188679245283,65.188679245283,15.5188679245283,44.3867924528302,49.0566037735849,12.9716981132075,52.0283018867925,52.4528301886793,15.5188679245283,53.7264150943396,14.2452830188679,44.3867924528302,18.9150943396226,18.4905660377359,47.7830188679245,55.8490566037736,18.0660377358491,15.5188679245283,14.2452830188679,14.6698113207547,18.9150943396226,15.5188679245283,15.9433962264151,22.7358490566038,99.1509433962264,44.3867924528302,31.2264150943396,19.3396226415094,24.8584905660377,19.3396226415094,61.3679245283019,43.9622641509434,39.7169811320755,32.9245283018868,66.8867924528302,31.6509433962264,18.0660377358491,32.9245283018868,39.7169811320755,18.9150943396226,21.0377358490566,19.3396226415094,14.2452830188679,26.5566037735849,14.2452830188679,17.2169811320755,24.4339622641509,84.2924528301887,44.811320754717,14.6698113207547,54.5754716981132,32.9245283018868,43.9622641509434,44.3867924528302,44.811320754717,19.3396226415094,22.7358490566038,14.6698113207547,24.4339622641509,18.4905660377359,14.6698113207547,44.3867924528302,45.2358490566038,86.8396226415094,19.3396226415094,18.0660377358491,23.1603773584906,86.4150943396227,18.9150943396226,21.8867924528302,40.9905660377359,23.5849056603774,25.2830188679245,66.4622641509434,14.6698113207547,98.3018867924528,18.0660377358491,39.7169811320755,52.877358490566,74.1037735849057,21.0377358490566,46.0849056603774,18.4905660377359,75.3773584905661,86.8396226415094,15.9433962264151,26.9811320754717,58.8207547169811,19.3396226415094,52.4528301886793,35.8962264150943,15.5188679245283,57.5471698113208,44.811320754717,36.3207547169811,44.811320754717,15.9433962264151,39.7169811320755,49.4811320754717,32.0754716981132,24.0094339622642,18.0660377358491,14.2452830188679,11.6981132075472,83.4433962264151,39.7169811320755,83.4433962264151,25.7075471698113,52.4528301886793,30.377358490566,15.5188679245283,18.4905660377359,45.2358490566038,51.1792452830189,22.7358490566038,24.4339622641509,48.2075471698113,18.4905660377359,44.3867924528302,47.3584905660377,49.0566037735849,46.0849056603774,31.2264150943396,25.2830188679245,40.9905660377359,18.9150943396226,52.4528301886793,55.4245283018868,14.2452830188679,44.3867924528302,54.5754716981132,43.9622641509434,44.3867924528302,55.8490566037736,12.9716981132075,31.6509433962264,15.9433962264151,46.0849056603774,52.0283018867925,22.7358490566038,16.7924528301887,15.5188679245283,14.2452830188679,39.7169811320755,22.7358490566038,19.7641509433962,39.7169811320755,32.0754716981132,49.0566037735849,35.8962264150943,65.188679245283,32.5,22.7358490566038,25.2830188679245,46.933962264151,22.7358490566038,39.7169811320755,18.9150943396226,23.5849056603774,18.9150943396226,27.4056603773585,31.6509433962264,40.5660377358491,86.8396226415094,31.2264150943396,16.3679245283019,32.5,15.0943396226415,14.6698113207547,18.4905660377359,32.0754716981132,23.1603773584906,32.0754716981132,46.933962264151,12.9716981132075,44.3867924528302,40.1415094339623,45.2358490566038,45.2358490566038,44.3867924528302,18.4905660377359,46.5094339622642,18.9150943396226,22.7358490566038,32.5,22.7358490566038,33.7735849056604,15.0943396226415,27.4056603773585,24.4339622641509,31.6509433962264,18.4905660377359,15.5188679245283,18.4905660377359,49.0566037735849,12.122641509434,24.0094339622642,23.5849056603774,94.9056603773585,23.1603773584906,17.2169811320755,40.5660377358491,50.7547169811321,98.7264150943396,65.188679245283,16.3679245283019,15.0943396226415,45.2358490566038,87.688679245283,14.2452830188679,14.2452830188679,31.2264150943396,31.2264150943396,39.7169811320755,14.6698113207547,45.6603773584906,65.188679245283,42.688679245283,24.4339622641509,22.7358490566038,88.1132075471698,45.2358490566038,31.6509433962264,11.2735849056604,18.0660377358491,19.3396226415094,66.0377358490566,17.2169811320755,40.1415094339623,34.622641509434,44.811320754717,15.5188679245283,17.2169811320755,53.3018867924528,31.6509433962264,14.2452830188679,14.6698113207547,14.2452830188679,13.3962264150943,87.2641509433962,31.2264150943396,53.3018867924528,49.9056603773585,25.2830188679245,43.9622641509434,18.9150943396226,49.0566037735849,14.2452830188679,44.3867924528302,14.6698113207547,31.2264150943396,14.2452830188679,38.0188679245283,25.2830188679245,14.2452830188679,11.2735849056604,14.6698113207547,44.3867924528302,16.3679245283019,50.3301886792453,16.3679245283019,23.1603773584906,17.6415094339623,28.6792452830189,14.2452830188679,24.4339622641509,24.0094339622642,86.8396226415094,75.8018867924528,23.1603773584906,14.2452830188679,47.3584905660377,44.3867924528302,15.0943396226415,31.2264150943396,15.5188679245283,23.1603773584906,16.7924528301887,35.4716981132076,32.0754716981132,15.9433962264151,32.0754716981132,17.6415094339623,38.8679245283019,14.6698113207547,18.9150943396226,19.3396226415094,22.7358490566038,56.2735849056604,18.4905660377359,52.4528301886793,50.3301886792453,18.9150943396226,18.9150943396226,36.3207547169811,15.0943396226415,17.6415094339623,31.2264150943396,24.4339622641509,44.3867924528302,32.0754716981132,31.2264150943396,14.6698113207547,44.3867924528302,68.1603773584906,48.6320754716981,45.2358490566038,14.6698113207547,14.2452830188679,45.6603773584906,32.5,24.8584905660377,32.5,31.6509433962264,43.9622641509434,24.0094339622642,44.811320754717,11.6981132075472,16.3679245283019,43.9622641509434,14.2452830188679,19.7641509433962,31.2264150943396,65.6132075471698,31.2264150943396,86.8396226415094,59.2452830188679,44.3867924528302,39.7169811320755,14.2452830188679,100,15.0943396226415,45.2358490566038,14.2452830188679,69.433962264151,34.1981132075472,51.6037735849057,52.877358490566,60.9433962264151,15.0943396226415,68.5849056603774,21.0377358490566,25.2830188679245,65.6132075471698,22.7358490566038,24.8584905660377,68.5849056603774,15.0943396226415,44.3867924528302,15.5188679245283,24.4339622641509,14.6698113207547,39.7169811320755,52.877358490566,39.7169811320755,14.6698113207547,47.3584905660377,45.2358490566038,43.9622641509434,35.0471698113208,14.2452830188679,43.9622641509434,32.5,52.4528301886793,65.6132075471698,18.9150943396226,46.933962264151,16.7924528301887,16.7924528301887,44.3867924528302,19.3396226415094,36.3207547169811,46.5094339622642,85.1415094339623,52.877358490566,96.1792452830189,15.0943396226415,32.9245283018868,34.622641509434,44.3867924528302,36.7452830188679,18.4905660377359,26.1320754716981,44.3867924528302,86.4150943396227,39.7169811320755,35.8962264150943,24.8584905660377,44.3867924528302,53.7264150943396,57.122641509434,31.6509433962264,18.9150943396226,19.7641509433962,14.2452830188679,14.6698113207547,15.0943396226415,18.9150943396226,31.2264150943396,76.2264150943396,15.5188679245283,13.3962264150943,53.3018867924528,31.2264150943396,15.5188679245283,25.7075471698113,19.3396226415094,45.6603773584906,43.9622641509434,14.6698113207547,25.7075471698113,67.311320754717,66.8867924528302,27.4056603773585,52.0283018867925,15.5188679245283,43.9622641509434,15.5188679245283,18.9150943396226,44.3867924528302,40.1415094339623,44.3867924528302,44.3867924528302,21.0377358490566,14.6698113207547,20.6132075471698,68.1603773584906,12.5471698113208,18.4905660377359,15.5188679245283,43.9622641509434,20.188679245283,44.811320754717,44.3867924528302,34.622641509434,40.1415094339623,44.811320754717,19.3396226415094,23.1603773584906,47.7830188679245,19.3396226415094,22.7358490566038,15.0943396226415,26.1320754716981,46.5094339622642,24.4339622641509,46.0849056603774,74.1037735849057,43.9622641509434,55.4245283018868,95.7547169811321,15.5188679245283,19.7641509433962,15.5188679245283,14.6698113207547,14.6698113207547,52.4528301886793,14.2452830188679,11.6981132075472,19.7641509433962,15.0943396226415,18.4905660377359,24.4339622641509,31.6509433962264,46.0849056603774,34.1981132075472,49.4811320754717,43.9622641509434,15.0943396226415,14.2452830188679,15.5188679245283,39.7169811320755,31.2264150943396,23.5849056603774,65.188679245283,31.6509433962264,17.2169811320755,40.9905660377359,65.6132075471698,10,27.8301886792453,26.1320754716981,25.7075471698113,24.4339622641509,69.0094339622642,14.2452830188679,78.3490566037736,52.877358490566,15.9433962264151,43.9622641509434,17.2169811320755,66.4622641509434,48.6320754716981,66.4622641509434,17.2169811320755,18.9150943396226,44.811320754717,38.8679245283019,35.4716981132076,14.6698113207547,26.9811320754717,13.3962264150943,18.9150943396226,49.0566037735849,48.6320754716981,44.3867924528302,23.1603773584906],"sizemode":"area","line":{"colorbar":{"title":"","ticklen":2},"cmin":0.2,"cmax":2.32,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[0.5,0.56,0.28,1.07,0.73,0.3,2.11,0.41,0.36,0.35,1.5,1.13,0.7,1,1.14,0.71,0.41,0.3,0.23,1.08,0.3,1.64,0.8,0.96,0.71,0.53,0.47,1.15,0.96,1.53,1.02,0.4,0.5,0.58,1.14,1,0.51,1.21,1.53,0.51,2,1.51,0.71,0.95,1.51,0.52,0.59,1.01,1.51,0.31,0.43,1.01,0.41,0.72,0.32,0.41,0.3,0.3,0.35,1.04,0.4,0.33,0.52,0.34,0.9,1.01,0.72,0.32,0.27,1.01,1.21,2.03,0.95,1.07,1.01,1.11,0.55,0.33,0.72,1.07,0.42,0.28,0.31,1.01,0.5,1.18,0.91,1.5,0.54,0.43,0.26,1.23,0.31,0.3,0.34,0.54,0.3,1.18,0.3,0.3,0.32,0.33,1.2,1.1,0.52,0.39,0.55,1,2.02,0.91,0.3,0.81,1.52,1.11,0.31,1.12,1.02,0.9,1.16,0.7,0.41,0.82,1.15,0.61,0.55,0.41,0.4,1.01,0.53,1,1.21,1.29,2,0.39,0.53,1.09,0.33,0.5,0.38,0.31,0.28,0.71,1.51,1.5,0.35,0.32,0.75,0.55,1,1,1,1,0.3,1.01,0.7,0.31,0.91,0.8,0.77,0.3,0.43,1.31,0.44,0.32,0.56,0.41,0.24,0.42,0.82,0.71,1.03,0.35,2.13,1.22,0.33,0.71,1.04,1.31,1.21,0.31,1.01,0.53,0.39,0.32,0.3,0.7,0.52,1.07,0.26,0.74,1.12,1.1,1,0.29,1.68,0.32,0.31,1.01,0.7,0.55,0.71,1,1.32,0.79,0.52,0.61,0.3,1.07,0.36,0.3,1.7,0.3,0.35,0.73,0.44,0.74,0.9,2.03,1.2,2.25,0.72,0.71,0.77,1.03,1.39,1.31,0.7,0.41,1.06,0.42,1.55,0.33,1.3,1.03,0.41,0.31,0.4,1.5,1.54,0.25,1.06,1.19,1.01,0.7,0.52,0.52,0.55,0.7,1.16,1.51,0.3,1.22,1.2,1.52,0.4,0.56,0.51,1.01,1.02,0.3,1.02,0.31,0.35,0.5,0.54,1.53,0.37,0.84,0.3,1.1,1,1.01,0.41,2.05,0.72,0.7,2.06,0.3,0.32,0.3,1.6,0.38,0.51,0.31,0.31,0.4,0.51,0.51,0.47,0.41,0.55,0.91,0.38,0.34,0.32,0.76,0.34,0.9,1.23,1.5,2,1.25,1.07,0.46,0.32,1.51,1,1.02,0.58,0.67,1.8,2.02,0.32,0.54,1.01,1.7,0.3,1.2,1.14,0.27,1.01,0.5,1.52,0.96,1.18,0.27,0.4,1.51,1.01,0.45,0.74,0.27,1,1.16,0.32,0.9,0.76,1.49,0.3,2.32,0.7,1.58,1.08,0.72,0.35,1.23,0.76,0.57,0.86,0.41,1.03,1.14,1.01,1.21,2.02,0.32,0.8,0.96,2.07,1.47,0.72,1.54,0.3,0.43,0.53,1.2,0.51,1.08,0.55,0.38,0.38,2.01,1.09,0.31,1,0.52,1.01,1.01,0.38,1.11,0.51,0.3,0.53,1.2,1.23,0.9,0.33,2.03,0.9,0.7,1.01,1.7,0.39,0.54,1.03,1.01,1.14,1.51,1.13,0.32,0.32,1.5,0.31,0.23,0.44,0.33,0.6,1.21,2.1,1.02,1.01,0.7,0.32,1.29,0.3,2.01,2.05,1.58,0.57,0.9,1,1.06,0.3,1,1.02,0.5,1.21,1.04,0.71,0.31,0.7,0.65,0.91,0.56,0.27,1.42,1.21,1.28,0.38,1.02,0.72,0.32,0.71,1.52,1.18,0.32,1.58,1.24,0.39,0.3,1.01,0.4,1.04,0.56,1.61,0.71,1.68,0.24,0.9,1.21,1.23,2.03,0.33,0.77,2.01,0.32,1.5,0.57,1.06,0.38,1.05,1.26,0.27,0.98,0.71,2.02,0.42,0.9,0.35,0.41,1.32,0.81,0.75,0.3,2.02,0.38,0.76,0.9,0.31,0.56,0.31,0.31,1.52,0.33,1.5,0.33,1.01,1.12,0.27,1.19,1.2,0.33,1.23,0.3,1.01,0.41,0.4,1.09,1.28,0.39,0.33,0.3,0.31,0.41,0.33,0.34,0.5,2.3,1.01,0.7,0.42,0.55,0.42,1.41,1,0.9,0.74,1.54,0.71,0.39,0.74,0.9,0.41,0.46,0.42,0.3,0.59,0.3,0.37,0.54,1.95,1.02,0.31,1.25,0.74,1,1.01,1.02,0.42,0.5,0.31,0.54,0.4,0.31,1.01,1.03,2.01,0.42,0.39,0.51,2,0.41,0.48,0.93,0.52,0.56,1.53,0.31,2.28,0.39,0.9,1.21,1.71,0.46,1.05,0.4,1.74,2.01,0.34,0.6,1.35,0.42,1.2,0.81,0.33,1.32,1.02,0.82,1.02,0.34,0.9,1.13,0.72,0.53,0.39,0.3,0.24,1.93,0.9,1.93,0.57,1.2,0.68,0.33,0.4,1.03,1.17,0.5,0.54,1.1,0.4,1.01,1.08,1.12,1.05,0.7,0.56,0.93,0.41,1.2,1.27,0.3,1.01,1.25,1,1.01,1.28,0.27,0.71,0.34,1.05,1.19,0.5,0.36,0.33,0.3,0.9,0.5,0.43,0.9,0.72,1.12,0.81,1.5,0.73,0.5,0.56,1.07,0.5,0.9,0.41,0.52,0.41,0.61,0.71,0.92,2.01,0.7,0.35,0.73,0.32,0.31,0.4,0.72,0.51,0.72,1.07,0.27,1.01,0.91,1.03,1.03,1.01,0.4,1.06,0.41,0.5,0.73,0.5,0.76,0.32,0.61,0.54,0.71,0.4,0.33,0.4,1.12,0.25,0.53,0.52,2.2,0.51,0.37,0.92,1.16,2.29,1.5,0.35,0.32,1.03,2.03,0.3,0.3,0.7,0.7,0.9,0.31,1.04,1.5,0.97,0.54,0.5,2.04,1.03,0.71,0.23,0.39,0.42,1.52,0.37,0.91,0.78,1.02,0.33,0.37,1.22,0.71,0.3,0.31,0.3,0.28,2.02,0.7,1.22,1.14,0.56,1,0.41,1.12,0.3,1.01,0.31,0.7,0.3,0.86,0.56,0.3,0.23,0.31,1.01,0.35,1.15,0.35,0.51,0.38,0.64,0.3,0.54,0.53,2.01,1.75,0.51,0.3,1.08,1.01,0.32,0.7,0.33,0.51,0.36,0.8,0.72,0.34,0.72,0.38,0.88,0.31,0.41,0.42,0.5,1.29,0.4,1.2,1.15,0.41,0.41,0.82,0.32,0.38,0.7,0.54,1.01,0.72,0.7,0.31,1.01,1.57,1.11,1.03,0.31,0.3,1.04,0.73,0.55,0.73,0.71,1,0.53,1.02,0.24,0.35,1,0.3,0.43,0.7,1.51,0.7,2.01,1.36,1.01,0.9,0.3,2.32,0.32,1.03,0.3,1.6,0.77,1.18,1.21,1.4,0.32,1.58,0.46,0.56,1.51,0.5,0.55,1.58,0.32,1.01,0.33,0.54,0.31,0.9,1.21,0.9,0.31,1.08,1.03,1,0.79,0.3,1,0.73,1.2,1.51,0.41,1.07,0.36,0.36,1.01,0.42,0.82,1.06,1.97,1.21,2.23,0.32,0.74,0.78,1.01,0.83,0.4,0.58,1.01,2,0.9,0.81,0.55,1.01,1.23,1.31,0.71,0.41,0.43,0.3,0.31,0.32,0.41,0.7,1.76,0.33,0.28,1.22,0.7,0.33,0.57,0.42,1.04,1,0.31,0.57,1.55,1.54,0.61,1.19,0.33,1,0.33,0.41,1.01,0.91,1.01,1.01,0.46,0.31,0.45,1.57,0.26,0.4,0.33,1,0.44,1.02,1.01,0.78,0.91,1.02,0.42,0.51,1.09,0.42,0.5,0.32,0.58,1.06,0.54,1.05,1.71,1,1.27,2.22,0.33,0.43,0.33,0.31,0.31,1.2,0.3,0.24,0.43,0.32,0.4,0.54,0.71,1.05,0.77,1.13,1,0.32,0.3,0.33,0.9,0.7,0.52,1.5,0.71,0.37,0.93,1.51,0.2,0.62,0.58,0.57,0.54,1.59,0.3,1.81,1.21,0.34,1,0.37,1.53,1.11,1.53,0.37,0.41,1.02,0.88,0.8,0.31,0.6,0.28,0.41,1.12,1.11,1.01,0.51]}},"textfont":{"size":[22.7358490566038,25.2830188679245,13.3962264150943,46.933962264151,32.5,14.2452830188679,91.0849056603774,18.9150943396226,16.7924528301887,16.3679245283019,65.188679245283,49.4811320754717,31.2264150943396,43.9622641509434,49.9056603773585,31.6509433962264,18.9150943396226,14.2452830188679,11.2735849056604,47.3584905660377,14.2452830188679,71.1320754716981,35.4716981132076,42.2641509433962,31.6509433962264,24.0094339622642,21.4622641509434,50.3301886792453,42.2641509433962,66.4622641509434,44.811320754717,18.4905660377359,22.7358490566038,26.1320754716981,49.9056603773585,43.9622641509434,23.1603773584906,52.877358490566,66.4622641509434,23.1603773584906,86.4150943396227,65.6132075471698,31.6509433962264,41.8396226415094,65.6132075471698,23.5849056603774,26.5566037735849,44.3867924528302,65.6132075471698,14.6698113207547,19.7641509433962,44.3867924528302,18.9150943396226,32.0754716981132,15.0943396226415,18.9150943396226,14.2452830188679,14.2452830188679,16.3679245283019,45.6603773584906,18.4905660377359,15.5188679245283,23.5849056603774,15.9433962264151,39.7169811320755,44.3867924528302,32.0754716981132,15.0943396226415,12.9716981132075,44.3867924528302,52.877358490566,87.688679245283,41.8396226415094,46.933962264151,44.3867924528302,48.6320754716981,24.8584905660377,15.5188679245283,32.0754716981132,46.933962264151,19.3396226415094,13.3962264150943,14.6698113207547,44.3867924528302,22.7358490566038,51.6037735849057,40.1415094339623,65.188679245283,24.4339622641509,19.7641509433962,12.5471698113208,53.7264150943396,14.6698113207547,14.2452830188679,15.9433962264151,24.4339622641509,14.2452830188679,51.6037735849057,14.2452830188679,14.2452830188679,15.0943396226415,15.5188679245283,52.4528301886793,48.2075471698113,23.5849056603774,18.0660377358491,24.8584905660377,43.9622641509434,87.2641509433962,40.1415094339623,14.2452830188679,35.8962264150943,66.0377358490566,48.6320754716981,14.6698113207547,49.0566037735849,44.811320754717,39.7169811320755,50.7547169811321,31.2264150943396,18.9150943396226,36.3207547169811,50.3301886792453,27.4056603773585,24.8584905660377,18.9150943396226,18.4905660377359,44.3867924528302,24.0094339622642,43.9622641509434,52.877358490566,56.2735849056604,86.4150943396227,18.0660377358491,24.0094339622642,47.7830188679245,15.5188679245283,22.7358490566038,17.6415094339623,14.6698113207547,13.3962264150943,31.6509433962264,65.6132075471698,65.188679245283,16.3679245283019,15.0943396226415,33.3490566037736,24.8584905660377,43.9622641509434,43.9622641509434,43.9622641509434,43.9622641509434,14.2452830188679,44.3867924528302,31.2264150943396,14.6698113207547,40.1415094339623,35.4716981132076,34.1981132075472,14.2452830188679,19.7641509433962,57.122641509434,20.188679245283,15.0943396226415,25.2830188679245,18.9150943396226,11.6981132075472,19.3396226415094,36.3207547169811,31.6509433962264,45.2358490566038,16.3679245283019,91.9339622641509,53.3018867924528,15.5188679245283,31.6509433962264,45.6603773584906,57.122641509434,52.877358490566,14.6698113207547,44.3867924528302,24.0094339622642,18.0660377358491,15.0943396226415,14.2452830188679,31.2264150943396,23.5849056603774,46.933962264151,12.5471698113208,32.9245283018868,49.0566037735849,48.2075471698113,43.9622641509434,13.8207547169811,72.8301886792453,15.0943396226415,14.6698113207547,44.3867924528302,31.2264150943396,24.8584905660377,31.6509433962264,43.9622641509434,57.5471698113208,35.0471698113208,23.5849056603774,27.4056603773585,14.2452830188679,46.933962264151,16.7924528301887,14.2452830188679,73.6792452830189,14.2452830188679,16.3679245283019,32.5,20.188679245283,32.9245283018868,39.7169811320755,87.688679245283,52.4528301886793,97.0283018867925,32.0754716981132,31.6509433962264,34.1981132075472,45.2358490566038,60.5188679245283,57.122641509434,31.2264150943396,18.9150943396226,46.5094339622642,19.3396226415094,67.311320754717,15.5188679245283,56.6981132075472,45.2358490566038,18.9150943396226,14.6698113207547,18.4905660377359,65.188679245283,66.8867924528302,12.122641509434,46.5094339622642,52.0283018867925,44.3867924528302,31.2264150943396,23.5849056603774,23.5849056603774,24.8584905660377,31.2264150943396,50.7547169811321,65.6132075471698,14.2452830188679,53.3018867924528,52.4528301886793,66.0377358490566,18.4905660377359,25.2830188679245,23.1603773584906,44.3867924528302,44.811320754717,14.2452830188679,44.811320754717,14.6698113207547,16.3679245283019,22.7358490566038,24.4339622641509,66.4622641509434,17.2169811320755,37.1698113207547,14.2452830188679,48.2075471698113,43.9622641509434,44.3867924528302,18.9150943396226,88.5377358490566,32.0754716981132,31.2264150943396,88.9622641509434,14.2452830188679,15.0943396226415,14.2452830188679,69.433962264151,17.6415094339623,23.1603773584906,14.6698113207547,14.6698113207547,18.4905660377359,23.1603773584906,23.1603773584906,21.4622641509434,18.9150943396226,24.8584905660377,40.1415094339623,17.6415094339623,15.9433962264151,15.0943396226415,33.7735849056604,15.9433962264151,39.7169811320755,53.7264150943396,65.188679245283,86.4150943396227,54.5754716981132,46.933962264151,21.0377358490566,15.0943396226415,65.6132075471698,43.9622641509434,44.811320754717,26.1320754716981,29.9528301886793,77.9245283018868,87.2641509433962,15.0943396226415,24.4339622641509,44.3867924528302,73.6792452830189,14.2452830188679,52.4528301886793,49.9056603773585,12.9716981132075,44.3867924528302,22.7358490566038,66.0377358490566,42.2641509433962,51.6037735849057,12.9716981132075,18.4905660377359,65.6132075471698,44.3867924528302,20.6132075471698,32.9245283018868,12.9716981132075,43.9622641509434,50.7547169811321,15.0943396226415,39.7169811320755,33.7735849056604,64.7641509433962,14.2452830188679,100,31.2264150943396,68.5849056603774,47.3584905660377,32.0754716981132,16.3679245283019,53.7264150943396,33.7735849056604,25.7075471698113,38.0188679245283,18.9150943396226,45.2358490566038,49.9056603773585,44.3867924528302,52.877358490566,87.2641509433962,15.0943396226415,35.4716981132076,42.2641509433962,89.3867924528302,63.9150943396227,32.0754716981132,66.8867924528302,14.2452830188679,19.7641509433962,24.0094339622642,52.4528301886793,23.1603773584906,47.3584905660377,24.8584905660377,17.6415094339623,17.6415094339623,86.8396226415094,47.7830188679245,14.6698113207547,43.9622641509434,23.5849056603774,44.3867924528302,44.3867924528302,17.6415094339623,48.6320754716981,23.1603773584906,14.2452830188679,24.0094339622642,52.4528301886793,53.7264150943396,39.7169811320755,15.5188679245283,87.688679245283,39.7169811320755,31.2264150943396,44.3867924528302,73.6792452830189,18.0660377358491,24.4339622641509,45.2358490566038,44.3867924528302,49.9056603773585,65.6132075471698,49.4811320754717,15.0943396226415,15.0943396226415,65.188679245283,14.6698113207547,11.2735849056604,20.188679245283,15.5188679245283,26.9811320754717,52.877358490566,90.6603773584906,44.811320754717,44.3867924528302,31.2264150943396,15.0943396226415,56.2735849056604,14.2452830188679,86.8396226415094,88.5377358490566,68.5849056603774,25.7075471698113,39.7169811320755,43.9622641509434,46.5094339622642,14.2452830188679,43.9622641509434,44.811320754717,22.7358490566038,52.877358490566,45.6603773584906,31.6509433962264,14.6698113207547,31.2264150943396,29.1037735849057,40.1415094339623,25.2830188679245,12.9716981132075,61.7924528301887,52.877358490566,55.8490566037736,17.6415094339623,44.811320754717,32.0754716981132,15.0943396226415,31.6509433962264,66.0377358490566,51.6037735849057,15.0943396226415,68.5849056603774,54.1509433962264,18.0660377358491,14.2452830188679,44.3867924528302,18.4905660377359,45.6603773584906,25.2830188679245,69.8584905660377,31.6509433962264,72.8301886792453,11.6981132075472,39.7169811320755,52.877358490566,53.7264150943396,87.688679245283,15.5188679245283,34.1981132075472,86.8396226415094,15.0943396226415,65.188679245283,25.7075471698113,46.5094339622642,17.6415094339623,46.0849056603774,55,12.9716981132075,43.1132075471698,31.6509433962264,87.2641509433962,19.3396226415094,39.7169811320755,16.3679245283019,18.9150943396226,57.5471698113208,35.8962264150943,33.3490566037736,14.2452830188679,87.2641509433962,17.6415094339623,33.7735849056604,39.7169811320755,14.6698113207547,25.2830188679245,14.6698113207547,14.6698113207547,66.0377358490566,15.5188679245283,65.188679245283,15.5188679245283,44.3867924528302,49.0566037735849,12.9716981132075,52.0283018867925,52.4528301886793,15.5188679245283,53.7264150943396,14.2452830188679,44.3867924528302,18.9150943396226,18.4905660377359,47.7830188679245,55.8490566037736,18.0660377358491,15.5188679245283,14.2452830188679,14.6698113207547,18.9150943396226,15.5188679245283,15.9433962264151,22.7358490566038,99.1509433962264,44.3867924528302,31.2264150943396,19.3396226415094,24.8584905660377,19.3396226415094,61.3679245283019,43.9622641509434,39.7169811320755,32.9245283018868,66.8867924528302,31.6509433962264,18.0660377358491,32.9245283018868,39.7169811320755,18.9150943396226,21.0377358490566,19.3396226415094,14.2452830188679,26.5566037735849,14.2452830188679,17.2169811320755,24.4339622641509,84.2924528301887,44.811320754717,14.6698113207547,54.5754716981132,32.9245283018868,43.9622641509434,44.3867924528302,44.811320754717,19.3396226415094,22.7358490566038,14.6698113207547,24.4339622641509,18.4905660377359,14.6698113207547,44.3867924528302,45.2358490566038,86.8396226415094,19.3396226415094,18.0660377358491,23.1603773584906,86.4150943396227,18.9150943396226,21.8867924528302,40.9905660377359,23.5849056603774,25.2830188679245,66.4622641509434,14.6698113207547,98.3018867924528,18.0660377358491,39.7169811320755,52.877358490566,74.1037735849057,21.0377358490566,46.0849056603774,18.4905660377359,75.3773584905661,86.8396226415094,15.9433962264151,26.9811320754717,58.8207547169811,19.3396226415094,52.4528301886793,35.8962264150943,15.5188679245283,57.5471698113208,44.811320754717,36.3207547169811,44.811320754717,15.9433962264151,39.7169811320755,49.4811320754717,32.0754716981132,24.0094339622642,18.0660377358491,14.2452830188679,11.6981132075472,83.4433962264151,39.7169811320755,83.4433962264151,25.7075471698113,52.4528301886793,30.377358490566,15.5188679245283,18.4905660377359,45.2358490566038,51.1792452830189,22.7358490566038,24.4339622641509,48.2075471698113,18.4905660377359,44.3867924528302,47.3584905660377,49.0566037735849,46.0849056603774,31.2264150943396,25.2830188679245,40.9905660377359,18.9150943396226,52.4528301886793,55.4245283018868,14.2452830188679,44.3867924528302,54.5754716981132,43.9622641509434,44.3867924528302,55.8490566037736,12.9716981132075,31.6509433962264,15.9433962264151,46.0849056603774,52.0283018867925,22.7358490566038,16.7924528301887,15.5188679245283,14.2452830188679,39.7169811320755,22.7358490566038,19.7641509433962,39.7169811320755,32.0754716981132,49.0566037735849,35.8962264150943,65.188679245283,32.5,22.7358490566038,25.2830188679245,46.933962264151,22.7358490566038,39.7169811320755,18.9150943396226,23.5849056603774,18.9150943396226,27.4056603773585,31.6509433962264,40.5660377358491,86.8396226415094,31.2264150943396,16.3679245283019,32.5,15.0943396226415,14.6698113207547,18.4905660377359,32.0754716981132,23.1603773584906,32.0754716981132,46.933962264151,12.9716981132075,44.3867924528302,40.1415094339623,45.2358490566038,45.2358490566038,44.3867924528302,18.4905660377359,46.5094339622642,18.9150943396226,22.7358490566038,32.5,22.7358490566038,33.7735849056604,15.0943396226415,27.4056603773585,24.4339622641509,31.6509433962264,18.4905660377359,15.5188679245283,18.4905660377359,49.0566037735849,12.122641509434,24.0094339622642,23.5849056603774,94.9056603773585,23.1603773584906,17.2169811320755,40.5660377358491,50.7547169811321,98.7264150943396,65.188679245283,16.3679245283019,15.0943396226415,45.2358490566038,87.688679245283,14.2452830188679,14.2452830188679,31.2264150943396,31.2264150943396,39.7169811320755,14.6698113207547,45.6603773584906,65.188679245283,42.688679245283,24.4339622641509,22.7358490566038,88.1132075471698,45.2358490566038,31.6509433962264,11.2735849056604,18.0660377358491,19.3396226415094,66.0377358490566,17.2169811320755,40.1415094339623,34.622641509434,44.811320754717,15.5188679245283,17.2169811320755,53.3018867924528,31.6509433962264,14.2452830188679,14.6698113207547,14.2452830188679,13.3962264150943,87.2641509433962,31.2264150943396,53.3018867924528,49.9056603773585,25.2830188679245,43.9622641509434,18.9150943396226,49.0566037735849,14.2452830188679,44.3867924528302,14.6698113207547,31.2264150943396,14.2452830188679,38.0188679245283,25.2830188679245,14.2452830188679,11.2735849056604,14.6698113207547,44.3867924528302,16.3679245283019,50.3301886792453,16.3679245283019,23.1603773584906,17.6415094339623,28.6792452830189,14.2452830188679,24.4339622641509,24.0094339622642,86.8396226415094,75.8018867924528,23.1603773584906,14.2452830188679,47.3584905660377,44.3867924528302,15.0943396226415,31.2264150943396,15.5188679245283,23.1603773584906,16.7924528301887,35.4716981132076,32.0754716981132,15.9433962264151,32.0754716981132,17.6415094339623,38.8679245283019,14.6698113207547,18.9150943396226,19.3396226415094,22.7358490566038,56.2735849056604,18.4905660377359,52.4528301886793,50.3301886792453,18.9150943396226,18.9150943396226,36.3207547169811,15.0943396226415,17.6415094339623,31.2264150943396,24.4339622641509,44.3867924528302,32.0754716981132,31.2264150943396,14.6698113207547,44.3867924528302,68.1603773584906,48.6320754716981,45.2358490566038,14.6698113207547,14.2452830188679,45.6603773584906,32.5,24.8584905660377,32.5,31.6509433962264,43.9622641509434,24.0094339622642,44.811320754717,11.6981132075472,16.3679245283019,43.9622641509434,14.2452830188679,19.7641509433962,31.2264150943396,65.6132075471698,31.2264150943396,86.8396226415094,59.2452830188679,44.3867924528302,39.7169811320755,14.2452830188679,100,15.0943396226415,45.2358490566038,14.2452830188679,69.433962264151,34.1981132075472,51.6037735849057,52.877358490566,60.9433962264151,15.0943396226415,68.5849056603774,21.0377358490566,25.2830188679245,65.6132075471698,22.7358490566038,24.8584905660377,68.5849056603774,15.0943396226415,44.3867924528302,15.5188679245283,24.4339622641509,14.6698113207547,39.7169811320755,52.877358490566,39.7169811320755,14.6698113207547,47.3584905660377,45.2358490566038,43.9622641509434,35.0471698113208,14.2452830188679,43.9622641509434,32.5,52.4528301886793,65.6132075471698,18.9150943396226,46.933962264151,16.7924528301887,16.7924528301887,44.3867924528302,19.3396226415094,36.3207547169811,46.5094339622642,85.1415094339623,52.877358490566,96.1792452830189,15.0943396226415,32.9245283018868,34.622641509434,44.3867924528302,36.7452830188679,18.4905660377359,26.1320754716981,44.3867924528302,86.4150943396227,39.7169811320755,35.8962264150943,24.8584905660377,44.3867924528302,53.7264150943396,57.122641509434,31.6509433962264,18.9150943396226,19.7641509433962,14.2452830188679,14.6698113207547,15.0943396226415,18.9150943396226,31.2264150943396,76.2264150943396,15.5188679245283,13.3962264150943,53.3018867924528,31.2264150943396,15.5188679245283,25.7075471698113,19.3396226415094,45.6603773584906,43.9622641509434,14.6698113207547,25.7075471698113,67.311320754717,66.8867924528302,27.4056603773585,52.0283018867925,15.5188679245283,43.9622641509434,15.5188679245283,18.9150943396226,44.3867924528302,40.1415094339623,44.3867924528302,44.3867924528302,21.0377358490566,14.6698113207547,20.6132075471698,68.1603773584906,12.5471698113208,18.4905660377359,15.5188679245283,43.9622641509434,20.188679245283,44.811320754717,44.3867924528302,34.622641509434,40.1415094339623,44.811320754717,19.3396226415094,23.1603773584906,47.7830188679245,19.3396226415094,22.7358490566038,15.0943396226415,26.1320754716981,46.5094339622642,24.4339622641509,46.0849056603774,74.1037735849057,43.9622641509434,55.4245283018868,95.7547169811321,15.5188679245283,19.7641509433962,15.5188679245283,14.6698113207547,14.6698113207547,52.4528301886793,14.2452830188679,11.6981132075472,19.7641509433962,15.0943396226415,18.4905660377359,24.4339622641509,31.6509433962264,46.0849056603774,34.1981132075472,49.4811320754717,43.9622641509434,15.0943396226415,14.2452830188679,15.5188679245283,39.7169811320755,31.2264150943396,23.5849056603774,65.188679245283,31.6509433962264,17.2169811320755,40.9905660377359,65.6132075471698,10,27.8301886792453,26.1320754716981,25.7075471698113,24.4339622641509,69.0094339622642,14.2452830188679,78.3490566037736,52.877358490566,15.9433962264151,43.9622641509434,17.2169811320755,66.4622641509434,48.6320754716981,66.4622641509434,17.2169811320755,18.9150943396226,44.811320754717,38.8679245283019,35.4716981132076,14.6698113207547,26.9811320754717,13.3962264150943,18.9150943396226,49.0566037735849,48.6320754716981,44.3867924528302,23.1603773584906]},"error_y":{"width":[]},"error_x":{"width":[]},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.2,2.32],"y":[367,18787],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"carat","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":0.2,"cmax":2.32,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[0.2,2.32],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb587-1" title="1">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> d, <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price)) <span class="op">+</span></a>
<a class="sourceLine" id="cb587-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">text =</span> <span class="kw">paste</span>(<span class="st">&quot;Clarity:&quot;</span>, clarity))) <span class="op">+</span></a>
<a class="sourceLine" id="cb587-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> cut, <span class="dt">fill =</span> cut)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>cut)</a>
<a class="sourceLine" id="cb587-4" title="4"><span class="kw">ggplotly</span>(p)</a></code></pre></div>
<div id="htmlwidget-f186d1ac9ad1bba0f9d6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f186d1ac9ad1bba0f9d6">{"x":{"data":[{"x":[1.5,0.96,0.47,1.01,2,0.71,1.03,1.01,0.46,1.51,1,1.01,0.96,0.76,0.76,0.96,0.9,2.03,0.9,1.5,0.98,1.32,1.01,0.9,0.46,1.03,2.01,1.2,1.02,1.02,1.05,0.73,0.5,0.92,0.73,1.03,2.04,0.7,0.7,0.7,2.01,0.42,0.31,1,1.5],"y":[5846,1739,828,5538,5914,2327,2942,3540,1035,11739,4150,5090,2672,1140,2800,2759,3613,14646,2873,8044,3622,6061,5784,3387,1166,3052,18574,3011,7960,4398,3615,2164,1577,3924,2147,5624,12799,2399,2415,2167,11156,675,814,4368,13553],"text":["Clarity: VS2<br />carat: 1.50<br />price:  5846","Clarity: I1<br />carat: 0.96<br />price:  1739","Clarity: SI1<br />carat: 0.47<br />price:   828","Clarity: VS2<br />carat: 1.01<br />price:  5538","Clarity: I1<br />carat: 2.00<br />price:  5914","Clarity: SI2<br />carat: 0.71<br />price:  2327","Clarity: SI2<br />carat: 1.03<br />price:  2942","Clarity: SI2<br />carat: 1.01<br />price:  3540","Clarity: VS1<br />carat: 0.46<br />price:  1035","Clarity: VS1<br />carat: 1.51<br />price: 11739","Clarity: SI1<br />carat: 1.00<br />price:  4150","Clarity: VS2<br />carat: 1.01<br />price:  5090","Clarity: SI2<br />carat: 0.96<br />price:  2672","Clarity: I1<br />carat: 0.76<br />price:  1140","Clarity: VS1<br />carat: 0.76<br />price:  2800","Clarity: SI2<br />carat: 0.96<br />price:  2759","Clarity: SI2<br />carat: 0.90<br />price:  3613","Clarity: SI1<br />carat: 2.03<br />price: 14646","Clarity: SI1<br />carat: 0.90<br />price:  2873","Clarity: VS1<br />carat: 1.50<br />price:  8044","Clarity: SI1<br />carat: 0.98<br />price:  3622","Clarity: SI1<br />carat: 1.32<br />price:  6061","Clarity: VS2<br />carat: 1.01<br />price:  5784","Clarity: VS1<br />carat: 0.90<br />price:  3387","Clarity: VS1<br />carat: 0.46<br />price:  1166","Clarity: SI1<br />carat: 1.03<br />price:  3052","Clarity: SI1<br />carat: 2.01<br />price: 18574","Clarity: I1<br />carat: 1.20<br />price:  3011","Clarity: VVS1<br />carat: 1.02<br />price:  7960","Clarity: SI1<br />carat: 1.02<br />price:  4398","Clarity: SI2<br />carat: 1.05<br />price:  3615","Clarity: SI2<br />carat: 0.73<br />price:  2164","Clarity: VS1<br />carat: 0.50<br />price:  1577","Clarity: VS1<br />carat: 0.92<br />price:  3924","Clarity: SI2<br />carat: 0.73<br />price:  2147","Clarity: SI1<br />carat: 1.03<br />price:  5624","Clarity: SI2<br />carat: 2.04<br />price: 12799","Clarity: VS1<br />carat: 0.70<br />price:  2399","Clarity: VS1<br />carat: 0.70<br />price:  2415","Clarity: SI1<br />carat: 0.70<br />price:  2167","Clarity: SI2<br />carat: 2.01<br />price: 11156","Clarity: SI1<br />carat: 0.42<br />price:   675","Clarity: VS2<br />carat: 0.31<br />price:   814","Clarity: VS1<br />carat: 1.00<br />price:  4368","Clarity: VVS2<br />carat: 1.50<br />price: 13553"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.35,0.71,0.96,0.41,0.33,1.01,1.5,0.34,0.3,1.51,1.5,0.91,1.68,1.01,1.01,0.7,0.4,1.02,0.7,0.4,0.34,0.9,1.8,0.3,0.4,2.02,0.8,0.3,1.01,0.3,0.9,1,0.3,0.71,1.52,0.71,1.68,1.23,2.03,2.02,0.3,2.02,0.31,1.01,0.3,0.9,0.71,0.39,0.31,1,1.01,0.51,2,0.48,0.9,0.4,2.01,1.35,1.03,0.9,0.61,0.4,0.41,0.54,1.52,0.56,1.12,0.86,1.01,0.53,0.7,0.55,0.43,0.7,1.58,1,1.2,0.4,1.01,2,0.3,0.31,1.01,0.45,1,0.91,0.51,0.5,0.43,0.54,1.13,0.9,0.7,1,1.11,1.12,1.01,0.51],"y":[709,2282,3312,671,536,5056,10618,686,421,11460,13232,1945,5871,4588,5616,2028,786,3811,2394,687,490,3484,9979,473,687,16789,3273,684,3871,506,6124,15928,526,1748,9898,2573,5765,5386,13621,18236,632,12798,470,6399,638,4770,2029,788,544,4427,8569,1665,16544,1743,3574,687,13849,5610,4177,4093,931,622,827,1551,10078,1712,3880,2647,5823,1561,2218,1682,669,2625,9775,3769,4637,898,4150,15708,648,628,6626,1063,3740,4502,1760,1433,704,1310,4025,5201,2167,6073,6088,3838,5251,1875],"text":["Clarity: VS2<br />carat: 0.35<br />price:   709","Clarity: SI1<br />carat: 0.71<br />price:  2282","Clarity: VS2<br />carat: 0.96<br />price:  3312","Clarity: SI1<br />carat: 0.41<br />price:   671","Clarity: SI1<br />carat: 0.33<br />price:   536","Clarity: VS1<br />carat: 1.01<br />price:  5056","Clarity: SI1<br />carat: 1.50<br />price: 10618","Clarity: VS1<br />carat: 0.34<br />price:   686","Clarity: SI1<br />carat: 0.30<br />price:   421","Clarity: SI1<br />carat: 1.51<br />price: 11460","Clarity: VS2<br />carat: 1.50<br />price: 13232","Clarity: I1<br />carat: 0.91<br />price:  1945","Clarity: I1<br />carat: 1.68<br />price:  5871","Clarity: SI1<br />carat: 1.01<br />price:  4588","Clarity: VS2<br />carat: 1.01<br />price:  5616","Clarity: SI1<br />carat: 0.70<br />price:  2028","Clarity: VS2<br />carat: 0.40<br />price:   786","Clarity: SI2<br />carat: 1.02<br />price:  3811","Clarity: VS2<br />carat: 0.70<br />price:  2394","Clarity: SI1<br />carat: 0.40<br />price:   687","Clarity: SI1<br />carat: 0.34<br />price:   490","Clarity: SI1<br />carat: 0.90<br />price:  3484","Clarity: SI2<br />carat: 1.80<br />price:  9979","Clarity: VS2<br />carat: 0.30<br />price:   473","Clarity: SI1<br />carat: 0.40<br />price:   687","Clarity: VS2<br />carat: 2.02<br />price: 16789","Clarity: VS2<br />carat: 0.80<br />price:  3273","Clarity: VVS2<br />carat: 0.30<br />price:   684","Clarity: SI1<br />carat: 1.01<br />price:  3871","Clarity: SI1<br />carat: 0.30<br />price:   506","Clarity: VVS1<br />carat: 0.90<br />price:  6124","Clarity: IF<br />carat: 1.00<br />price: 15928","Clarity: VS2<br />carat: 0.30<br />price:   526","Clarity: VS2<br />carat: 0.71<br />price:  1748","Clarity: SI1<br />carat: 1.52<br />price:  9898","Clarity: SI1<br />carat: 0.71<br />price:  2573","Clarity: I1<br />carat: 1.68<br />price:  5765","Clarity: VS2<br />carat: 1.23<br />price:  5386","Clarity: SI2<br />carat: 2.03<br />price: 13621","Clarity: SI2<br />carat: 2.02<br />price: 18236","Clarity: VS1<br />carat: 0.30<br />price:   632","Clarity: SI1<br />carat: 2.02<br />price: 12798","Clarity: VS2<br />carat: 0.31<br />price:   470","Clarity: VS2<br />carat: 1.01<br />price:  6399","Clarity: VVS1<br />carat: 0.30<br />price:   638","Clarity: VS1<br />carat: 0.90<br />price:  4770","Clarity: VS2<br />carat: 0.71<br />price:  2029","Clarity: VS2<br />carat: 0.39<br />price:   788","Clarity: VS1<br />carat: 0.31<br />price:   544","Clarity: SI1<br />carat: 1.00<br />price:  4427","Clarity: VVS2<br />carat: 1.01<br />price:  8569","Clarity: VS2<br />carat: 0.51<br />price:  1665","Clarity: VS2<br />carat: 2.00<br />price: 16544","Clarity: VS1<br />carat: 0.48<br />price:  1743","Clarity: SI1<br />carat: 0.90<br />price:  3574","Clarity: SI1<br />carat: 0.40<br />price:   687","Clarity: SI2<br />carat: 2.01<br />price: 13849","Clarity: VS2<br />carat: 1.35<br />price:  5610","Clarity: SI2<br />carat: 1.03<br />price:  4177","Clarity: VS2<br />carat: 0.90<br />price:  4093","Clarity: I1<br />carat: 0.61<br />price:   931","Clarity: SI2<br />carat: 0.40<br />price:   622","Clarity: VVS2<br />carat: 0.41<br />price:   827","Clarity: SI1<br />carat: 0.54<br />price:  1551","Clarity: SI1<br />carat: 1.52<br />price: 10078","Clarity: VS1<br />carat: 0.56<br />price:  1712","Clarity: SI1<br />carat: 1.12<br />price:  3880","Clarity: SI2<br />carat: 0.86<br />price:  2647","Clarity: SI1<br />carat: 1.01<br />price:  5823","Clarity: VS2<br />carat: 0.53<br />price:  1561","Clarity: SI1<br />carat: 0.70<br />price:  2218","Clarity: VS1<br />carat: 0.55<br />price:  1682","Clarity: SI2<br />carat: 0.43<br />price:   669","Clarity: VS1<br />carat: 0.70<br />price:  2625","Clarity: VS1<br />carat: 1.58<br />price:  9775","Clarity: VS2<br />carat: 1.00<br />price:  3769","Clarity: VS2<br />carat: 1.20<br />price:  4637","Clarity: VS1<br />carat: 0.40<br />price:   898","Clarity: SI2<br />carat: 1.01<br />price:  4150","Clarity: VS1<br />carat: 2.00<br />price: 15708","Clarity: VS2<br />carat: 0.30<br />price:   648","Clarity: VS1<br />carat: 0.31<br />price:   628","Clarity: VS1<br />carat: 1.01<br />price:  6626","Clarity: SI1<br />carat: 0.45<br />price:  1063","Clarity: SI2<br />carat: 1.00<br />price:  3740","Clarity: VS1<br />carat: 0.91<br />price:  4502","Clarity: VS1<br />carat: 0.51<br />price:  1760","Clarity: SI1<br />carat: 0.50<br />price:  1433","Clarity: SI1<br />carat: 0.43<br />price:   704","Clarity: SI1<br />carat: 0.54<br />price:  1310","Clarity: SI2<br />carat: 1.13<br />price:  4025","Clarity: VS1<br />carat: 0.90<br />price:  5201","Clarity: SI1<br />carat: 0.70<br />price:  2167","Clarity: VS2<br />carat: 1.00<br />price:  6073","Clarity: SI1<br />carat: 1.11<br />price:  6088","Clarity: SI2<br />carat: 1.12<br />price:  3838","Clarity: SI1<br />carat: 1.01<br />price:  5251","Clarity: VVS2<br />carat: 0.51<br />price:  1875"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.56,0.3,0.7,1.14,0.23,1.02,0.5,0.51,0.43,1.01,0.41,0.34,0.9,0.72,0.27,1.01,2.03,1.01,0.91,0.3,0.32,0.39,1,0.9,0.41,0.39,0.5,1.01,0.3,0.43,0.41,1.03,0.35,2.13,1.22,1.01,0.53,1.1,0.32,0.71,1.32,0.79,0.52,0.9,0.77,1.31,0.31,0.4,1.5,0.25,1.51,0.3,1.01,1.02,0.3,1.53,1.1,0.32,0.31,0.47,0.55,0.38,2,1.25,1.07,0.67,0.54,1.7,1.2,1.14,1.18,1.51,1,0.3,0.7,1.14,1.54,1.08,2.01,1,1.11,0.3,0.53,1.01,0.39,0.54,0.23,0.7,2.01,1,0.65,0.91,1.02,0.72,0.32,1.01,0.4,0.24,0.9,0.33,1.05,0.27,0.9,0.76,1.2,1.23,0.4,1.09,1.28,0.33,1.41,0.74,0.3,0.5,0.31,0.41,0.52,0.31,2.28,0.46,0.9,1.93,1.2,0.4,0.5,1.12,1.05,0.7,0.27,1.12,0.81,1.5,1.07,0.5,0.52,2.01,0.31,0.27,1.01,0.91,0.5,0.25,0.92,2.03,0.7,0.97,0.23,0.91,0.33,0.71,0.28,1,0.41,0.3,0.23,0.35,0.38,0.64,0.33,0.88,0.41,0.54,1.01,0.73,0.24,0.35,1.01,1.4,0.5,0.32,0.9,0.9,1,0.36,1.21,0.78,0.9,1.01,0.71,0.7,1.76,0.28,0.33,1,1.01,0.42,0.32,0.54,0.33,0.33,0.3,0.24,1.05,0.52,0.71,1.51,0.37,0.6,0.28],"y":[1686,709,2373,4785,530,7292,1197,1662,852,3563,755,819,4173,2787,567,6540,14239,5662,4012,638,524,1011,6382,2753,863,746,1354,5999,789,754,1133,4573,706,15454,5397,3966,1578,8020,842,3053,5513,2394,1120,4592,3040,5582,755,909,9904,436,7915,684,8849,4354,684,9332,4607,730,640,1178,1786,847,13203,4199,4201,2309,2113,12622,8442,5367,8411,10947,8467,742,3053,12647,11527,4407,17514,5122,3882,574,2297,4561,718,1255,505,2604,16901,4125,2085,4430,4241,2333,645,4363,1168,449,5102,579,5666,470,3679,3170,5250,3835,720,6546,4967,868,14936,2713,394,1568,1009,1057,1338,500,12907,1345,3919,13278,7909,868,1106,8408,5197,2400,470,5088,2562,10626,6355,1187,1237,16956,571,682,6480,4105,1020,633,3920,13063,2959,3960,505,4437,579,2574,586,4867,1197,499,530,798,755,1969,434,2699,775,1129,4690,2196,608,706,7847,7345,1147,721,3519,4021,4469,832,6125,2401,4637,5226,2137,2362,18014,429,614,4919,6770,1031,432,1583,621,579,789,485,7010,1227,1932,13068,684,1250,642],"text":["Clarity: VS1<br />carat: 0.56<br />price:  1686","Clarity: SI1<br />carat: 0.30<br />price:   709","Clarity: SI1<br />carat: 0.70<br />price:  2373","Clarity: VS2<br />carat: 1.14<br />price:  4785","Clarity: VVS1<br />carat: 0.23<br />price:   530","Clarity: VVS2<br />carat: 1.02<br />price:  7292","Clarity: SI1<br />carat: 0.50<br />price:  1197","Clarity: VS2<br />carat: 0.51<br />price:  1662","Clarity: VS2<br />carat: 0.43<br />price:   852","Clarity: SI2<br />carat: 1.01<br />price:  3563","Clarity: SI1<br />carat: 0.41<br />price:   755","Clarity: VVS2<br />carat: 0.34<br />price:   819","Clarity: VS2<br />carat: 0.90<br />price:  4173","Clarity: VS2<br />carat: 0.72<br />price:  2787","Clarity: VVS2<br />carat: 0.27<br />price:   567","Clarity: VS2<br />carat: 1.01<br />price:  6540","Clarity: SI2<br />carat: 2.03<br />price: 14239","Clarity: VS2<br />carat: 1.01<br />price:  5662","Clarity: VS2<br />carat: 0.91<br />price:  4012","Clarity: VVS1<br />carat: 0.30<br />price:   638","Clarity: VS2<br />carat: 0.32<br />price:   524","Clarity: VS2<br />carat: 0.39<br />price:  1011","Clarity: VS2<br />carat: 1.00<br />price:  6382","Clarity: SI1<br />carat: 0.90<br />price:  2753","Clarity: VS2<br />carat: 0.41<br />price:   863","Clarity: VS2<br />carat: 0.39<br />price:   746","Clarity: VS2<br />carat: 0.50<br />price:  1354","Clarity: VS2<br />carat: 1.01<br />price:  5999","Clarity: VVS2<br />carat: 0.30<br />price:   789","Clarity: SI1<br />carat: 0.43<br />price:   754","Clarity: VVS2<br />carat: 0.41<br />price:  1133","Clarity: SI1<br />carat: 1.03<br />price:  4573","Clarity: VS1<br />carat: 0.35<br />price:   706","Clarity: SI2<br />carat: 2.13<br />price: 15454","Clarity: SI1<br />carat: 1.22<br />price:  5397","Clarity: SI2<br />carat: 1.01<br />price:  3966","Clarity: VS2<br />carat: 0.53<br />price:  1578","Clarity: VVS1<br />carat: 1.10<br />price:  8020","Clarity: VVS1<br />carat: 0.32<br />price:   842","Clarity: VS2<br />carat: 0.71<br />price:  3053","Clarity: SI2<br />carat: 1.32<br />price:  5513","Clarity: SI1<br />carat: 0.79<br />price:  2394","Clarity: SI2<br />carat: 0.52<br />price:  1120","Clarity: VS1<br />carat: 0.90<br />price:  4592","Clarity: SI1<br />carat: 0.77<br />price:  3040","Clarity: SI2<br />carat: 1.31<br />price:  5582","Clarity: VVS1<br />carat: 0.31<br />price:   755","Clarity: VS1<br />carat: 0.40<br />price:   909","Clarity: SI1<br />carat: 1.50<br />price:  9904","Clarity: VS1<br />carat: 0.25<br />price:   436","Clarity: SI2<br />carat: 1.51<br />price:  7915","Clarity: VVS1<br />carat: 0.30<br />price:   684","Clarity: VVS2<br />carat: 1.01<br />price:  8849","Clarity: VS2<br />carat: 1.02<br />price:  4354","Clarity: VVS2<br />carat: 0.30<br />price:   684","Clarity: SI1<br />carat: 1.53<br />price:  9332","Clarity: SI2<br />carat: 1.10<br />price:  4607","Clarity: VVS1<br />carat: 0.32<br />price:   730","Clarity: VS1<br />carat: 0.31<br />price:   640","Clarity: VS2<br />carat: 0.47<br />price:  1178","Clarity: VS2<br />carat: 0.55<br />price:  1786","Clarity: VS2<br />carat: 0.38<br />price:   847","Clarity: VS1<br />carat: 2.00<br />price: 13203","Clarity: SI2<br />carat: 1.25<br />price:  4199","Clarity: SI2<br />carat: 1.07<br />price:  4201","Clarity: VS2<br />carat: 0.67<br />price:  2309","Clarity: VS2<br />carat: 0.54<br />price:  2113","Clarity: VS1<br />carat: 1.70<br />price: 12622","Clarity: VS1<br />carat: 1.20<br />price:  8442","Clarity: SI1<br />carat: 1.14<br />price:  5367","Clarity: VS2<br />carat: 1.18<br />price:  8411","Clarity: SI1<br />carat: 1.51<br />price: 10947","Clarity: VVS2<br />carat: 1.00<br />price:  8467","Clarity: VS1<br />carat: 0.30<br />price:   742","Clarity: VS1<br />carat: 0.70<br />price:  3053","Clarity: IF<br />carat: 1.14<br />price: 12647","Clarity: VS2<br />carat: 1.54<br />price: 11527","Clarity: SI2<br />carat: 1.08<br />price:  4407","Clarity: SI2<br />carat: 2.01<br />price: 17514","Clarity: SI1<br />carat: 1.00<br />price:  5122","Clarity: SI2<br />carat: 1.11<br />price:  3882","Clarity: SI2<br />carat: 0.30<br />price:   574","Clarity: VVS2<br />carat: 0.53<br />price:  2297","Clarity: SI2<br />carat: 1.01<br />price:  4561","Clarity: VVS1<br />carat: 0.39<br />price:   718","Clarity: SI1<br />carat: 0.54<br />price:  1255","Clarity: VVS2<br />carat: 0.23<br />price:   505","Clarity: SI1<br />carat: 0.70<br />price:  2604","Clarity: SI1<br />carat: 2.01<br />price: 16901","Clarity: SI1<br />carat: 1.00<br />price:  4125","Clarity: VVS1<br />carat: 0.65<br />price:  2085","Clarity: VS2<br />carat: 0.91<br />price:  4430","Clarity: SI2<br />carat: 1.02<br />price:  4241","Clarity: SI1<br />carat: 0.72<br />price:  2333","Clarity: VS1<br />carat: 0.32<br />price:   645","Clarity: SI2<br />carat: 1.01<br />price:  4363","Clarity: VVS2<br />carat: 0.40<br />price:  1168","Clarity: VVS2<br />carat: 0.24<br />price:   449","Clarity: VS1<br />carat: 0.90<br />price:  5102","Clarity: VS1<br />carat: 0.33<br />price:   579","Clarity: SI1<br />carat: 1.05<br />price:  5666","Clarity: VS1<br />carat: 0.27<br />price:   470","Clarity: SI1<br />carat: 0.90<br />price:  3679","Clarity: VS2<br />carat: 0.76<br />price:  3170","Clarity: SI2<br />carat: 1.20<br />price:  5250","Clarity: I1<br />carat: 1.23<br />price:  3835","Clarity: SI1<br />carat: 0.40<br />price:   720","Clarity: VS1<br />carat: 1.09<br />price:  6546","Clarity: SI1<br />carat: 1.28<br />price:  4967","Clarity: VVS1<br />carat: 0.33<br />price:   868","Clarity: VVS1<br />carat: 1.41<br />price: 14936","Clarity: SI2<br />carat: 0.74<br />price:  2713","Clarity: VS1<br />carat: 0.30<br />price:   394","Clarity: VS2<br />carat: 0.50<br />price:  1568","Clarity: VVS2<br />carat: 0.31<br />price:  1009","Clarity: VVS1<br />carat: 0.41<br />price:  1057","Clarity: SI1<br />carat: 0.52<br />price:  1338","Clarity: VS2<br />carat: 0.31<br />price:   500","Clarity: SI2<br />carat: 2.28<br />price: 12907","Clarity: VS2<br />carat: 0.46<br />price:  1345","Clarity: SI1<br />carat: 0.90<br />price:  3919","Clarity: SI1<br />carat: 1.93<br />price: 13278","Clarity: SI1<br />carat: 1.20<br />price:  7909","Clarity: VS1<br />carat: 0.40<br />price:   868","Clarity: SI1<br />carat: 0.50<br />price:  1106","Clarity: VVS1<br />carat: 1.12<br />price:  8408","Clarity: SI1<br />carat: 1.05<br />price:  5197","Clarity: VS2<br />carat: 0.70<br />price:  2400","Clarity: VS2<br />carat: 0.27<br />price:   470","Clarity: SI1<br />carat: 1.12<br />price:  5088","Clarity: SI1<br />carat: 0.81<br />price:  2562","Clarity: SI1<br />carat: 1.50<br />price: 10626","Clarity: VS2<br />carat: 1.07<br />price:  6355","Clarity: SI1<br />carat: 0.50<br />price:  1187","Clarity: SI1<br />carat: 0.52<br />price:  1237","Clarity: SI1<br />carat: 2.01<br />price: 16956","Clarity: VVS1<br />carat: 0.31<br />price:   571","Clarity: VVS1<br />carat: 0.27<br />price:   682","Clarity: VS2<br />carat: 1.01<br />price:  6480","Clarity: VS2<br />carat: 0.91<br />price:  4105","Clarity: SI2<br />carat: 0.50<br />price:  1020","Clarity: VVS2<br />carat: 0.25<br />price:   633","Clarity: SI1<br />carat: 0.92<br />price:  3920","Clarity: SI2<br />carat: 2.03<br />price: 13063","Clarity: VS1<br />carat: 0.70<br />price:  2959","Clarity: SI2<br />carat: 0.97<br />price:  3960","Clarity: VVS2<br />carat: 0.23<br />price:   505","Clarity: SI1<br />carat: 0.91<br />price:  4437","Clarity: VS2<br />carat: 0.33<br />price:   579","Clarity: VS2<br />carat: 0.71<br />price:  2574","Clarity: VVS1<br />carat: 0.28<br />price:   586","Clarity: SI2<br />carat: 1.00<br />price:  4867","Clarity: IF<br />carat: 0.41<br />price:  1197","Clarity: SI1<br />carat: 0.30<br />price:   499","Clarity: VVS1<br />carat: 0.23<br />price:   530","Clarity: VVS2<br />carat: 0.35<br />price:   798","Clarity: SI1<br />carat: 0.38<br />price:   755","Clarity: SI1<br />carat: 0.64<br />price:  1969","Clarity: SI2<br />carat: 0.33<br />price:   434","Clarity: SI1<br />carat: 0.88<br />price:  2699","Clarity: VVS1<br />carat: 0.41<br />price:   775","Clarity: VS2<br />carat: 0.54<br />price:  1129","Clarity: SI2<br />carat: 1.01<br />price:  4690","Clarity: SI1<br />carat: 0.73<br />price:  2196","Clarity: VVS2<br />carat: 0.24<br />price:   608","Clarity: VS1<br />carat: 0.35<br />price:   706","Clarity: VVS2<br />carat: 1.01<br />price:  7847","Clarity: SI2<br />carat: 1.40<br />price:  7345","Clarity: SI2<br />carat: 0.50<br />price:  1147","Clarity: VVS2<br />carat: 0.32<br />price:   721","Clarity: SI2<br />carat: 0.90<br />price:  3519","Clarity: VS1<br />carat: 0.90<br />price:  4021","Clarity: SI1<br />carat: 1.00<br />price:  4469","Clarity: VS1<br />carat: 0.36<br />price:   832","Clarity: SI2<br />carat: 1.21<br />price:  6125","Clarity: SI2<br />carat: 0.78<br />price:  2401","Clarity: VS2<br />carat: 0.90<br />price:  4637","Clarity: SI1<br />carat: 1.01<br />price:  5226","Clarity: SI1<br />carat: 0.71<br />price:  2137","Clarity: VS2<br />carat: 0.70<br />price:  2362","Clarity: VS1<br />carat: 1.76<br />price: 18014","Clarity: VS1<br />carat: 0.28<br />price:   429","Clarity: VVS2<br />carat: 0.33<br />price:   614","Clarity: SI1<br />carat: 1.00<br />price:  4919","Clarity: VS2<br />carat: 1.01<br />price:  6770","Clarity: VVS2<br />carat: 0.42<br />price:  1031","Clarity: SI1<br />carat: 0.32<br />price:   432","Clarity: VS2<br />carat: 0.54<br />price:  1583","Clarity: VS1<br />carat: 0.33<br />price:   621","Clarity: SI1<br />carat: 0.33<br />price:   579","Clarity: VVS2<br />carat: 0.30<br />price:   789","Clarity: VVS1<br />carat: 0.24<br />price:   485","Clarity: VS1<br />carat: 1.05<br />price:  7010","Clarity: SI1<br />carat: 0.52<br />price:  1227","Clarity: SI1<br />carat: 0.71<br />price:  1932","Clarity: VS2<br />carat: 1.51<br />price: 13068","Clarity: SI1<br />carat: 0.37<br />price:   684","Clarity: SI2<br />carat: 0.60<br />price:  1250","Clarity: VVS2<br />carat: 0.28<br />price:   642"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x3","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.07,0.73,2.11,1.13,1,0.3,1.08,1.64,1.15,0.51,1.53,2,1.51,0.95,1.51,1.01,1.51,1.04,0.95,1.07,0.42,0.31,1.18,0.54,0.43,0.26,2.02,0.91,0.3,0.81,1.52,1.12,1.02,0.7,1.01,1,1.21,1.09,0.31,0.71,1,1,1,0.7,1.31,0.32,1.04,1.31,1.21,0.32,0.3,1,0.31,1,1.7,1.2,2.25,1.39,1.55,1.3,1.03,1.54,1.06,1.19,0.7,1.22,1.2,1.52,0.51,0.5,0.54,0.84,1,0.3,0.38,0.51,0.51,0.91,0.76,0.32,1.01,1.01,0.45,0.32,0.9,2.32,1.08,1.23,0.41,1.01,0.32,1.47,0.51,0.52,1.7,1.03,0.44,1.21,1.02,1.01,2.05,1.58,0.57,1.02,1.21,0.31,0.7,0.56,1.42,1.21,0.38,0.71,0.32,0.3,1.04,1.61,1.21,2.01,0.41,0.9,0.31,0.31,1.52,1.5,0.33,1.19,0.33,0.3,0.31,0.33,1.01,0.42,1.54,0.42,1.95,0.42,0.4,0.31,1.01,0.39,0.93,0.39,1.71,1.74,0.9,0.72,0.53,1.93,0.68,1.17,1.2,1.01,1.25,1,1.28,0.36,0.33,0.56,0.9,0.71,0.7,0.32,0.4,1.01,1.06,0.5,0.54,0.52,2.2,1.5,0.32,0.3,0.7,0.5,1.22,0.3,0.3,0.56,0.31,0.35,0.51,1.01,0.51,0.36,0.31,0.5,1.29,1.2,1.15,1.01,1.04,0.71,1,1,0.9,1.03,1.6,0.77,1.58,1.51,1.01,0.31,0.31,0.73,0.36,1.01,0.42,1.97,2.23,0.32,1.01,0.58,0.55,1.23,0.43,0.31,0.32,0.41,0.33,1.22,0.61,0.33,1,1.57,0.42,1.05,1.71,1.27,0.31,0.77,1,0.3,0.33,0.37,0.57,1.59,0.3,1.81,1.21,0.34,1.53,0.37,0.8],"y":[5764,2496,17816,3480,6600,737,4877,5624,4701,1569,10830,14918,6976,2195,12738,3224,14817,15671,3671,4105,992,471,5696,1993,968,600,13267,4128,554,3107,9527,4064,6773,2329,4719,5880,8305,8204,625,2863,4390,5197,4626,2407,4490,645,4811,8818,9279,936,776,3080,959,4077,9777,4838,15397,7239,7502,5751,5814,12522,3989,6078,1848,8779,5376,8127,1781,1125,1389,2628,4704,658,1400,1662,1567,5167,4223,561,5303,5232,1736,477,3770,10913,5419,6909,964,6533,1080,6223,1004,1815,12992,4932,1023,5720,5084,4249,16506,14451,1754,4037,4946,1107,2239,1814,11861,7094,641,2249,720,1071,4240,10477,6071,17688,1431,3387,872,418,4345,16558,722,4332,891,608,663,780,11387,953,10466,847,5045,722,900,516,5294,721,4793,1097,14731,10270,3810,2216,1428,17353,2224,5831,8056,3337,6300,4427,6164,1013,434,2032,4334,2735,2479,648,882,4480,4862,1710,1422,1743,17634,10206,842,819,2273,1746,6237,605,776,1436,707,1024,1381,4672,2027,810,942,1323,6987,3965,4743,7982,6206,2629,3977,4200,4022,4843,12210,2457,7654,11263,3920,698,544,1905,1094,6108,737,14410,12770,979,6533,1307,1755,9257,1433,816,648,923,868,8950,1303,666,4724,12417,773,6146,8690,5547,802,2846,4730,684,804,894,1944,9707,605,11854,5387,645,11127,666,4193],"text":["Clarity: VS1<br />carat: 1.07<br />price:  5764","Clarity: VS2<br />carat: 0.73<br />price:  2496","Clarity: SI1<br />carat: 2.11<br />price: 17816","Clarity: I1<br />carat: 1.13<br />price:  3480","Clarity: VS2<br />carat: 1.00<br />price:  6600","Clarity: VVS2<br />carat: 0.30<br />price:   737","Clarity: VS1<br />carat: 1.08<br />price:  4877","Clarity: SI2<br />carat: 1.64<br />price:  5624","Clarity: SI2<br />carat: 1.15<br />price:  4701","Clarity: SI1<br />carat: 0.51<br />price:  1569","Clarity: SI1<br />carat: 1.53<br />price: 10830","Clarity: SI1<br />carat: 2.00<br />price: 14918","Clarity: SI1<br />carat: 1.51<br />price:  6976","Clarity: I1<br />carat: 0.95<br />price:  2195","Clarity: SI1<br />carat: 1.51<br />price: 12738","Clarity: SI1<br />carat: 1.01<br />price:  3224","Clarity: VS2<br />carat: 1.51<br />price: 14817","Clarity: IF<br />carat: 1.04<br />price: 15671","Clarity: SI2<br />carat: 0.95<br />price:  3671","Clarity: SI2<br />carat: 1.07<br />price:  4105","Clarity: SI1<br />carat: 0.42<br />price:   992","Clarity: VS2<br />carat: 0.31<br />price:   471","Clarity: SI1<br />carat: 1.18<br />price:  5696","Clarity: VS2<br />carat: 0.54<br />price:  1993","Clarity: VS2<br />carat: 0.43<br />price:   968","Clarity: VVS1<br />carat: 0.26<br />price:   600","Clarity: SI2<br />carat: 2.02<br />price: 13267","Clarity: VS2<br />carat: 0.91<br />price:  4128","Clarity: SI1<br />carat: 0.30<br />price:   554","Clarity: VS1<br />carat: 0.81<br />price:  3107","Clarity: SI1<br />carat: 1.52<br />price:  9527","Clarity: SI1<br />carat: 1.12<br />price:  4064","Clarity: VS2<br />carat: 1.02<br />price:  6773","Clarity: VS1<br />carat: 0.70<br />price:  2329","Clarity: SI1<br />carat: 1.01<br />price:  4719","Clarity: SI1<br />carat: 1.00<br />price:  5880","Clarity: VS1<br />carat: 1.21<br />price:  8305","Clarity: VS1<br />carat: 1.09<br />price:  8204","Clarity: VVS2<br />carat: 0.31<br />price:   625","Clarity: SI1<br />carat: 0.71<br />price:  2863","Clarity: SI2<br />carat: 1.00<br />price:  4390","Clarity: SI1<br />carat: 1.00<br />price:  5197","Clarity: SI2<br />carat: 1.00<br />price:  4626","Clarity: SI1<br />carat: 0.70<br />price:  2407","Clarity: SI1<br />carat: 1.31<br />price:  4490","Clarity: VS2<br />carat: 0.32<br />price:   645","Clarity: SI2<br />carat: 1.04<br />price:  4811","Clarity: VS2<br />carat: 1.31<br />price:  8818","Clarity: VS1<br />carat: 1.21<br />price:  9279","Clarity: VVS1<br />carat: 0.32<br />price:   936","Clarity: VS1<br />carat: 0.30<br />price:   776","Clarity: SI2<br />carat: 1.00<br />price:  3080","Clarity: VVS1<br />carat: 0.31<br />price:   959","Clarity: SI2<br />carat: 1.00<br />price:  4077","Clarity: SI1<br />carat: 1.70<br />price:  9777","Clarity: VS1<br />carat: 1.20<br />price:  4838","Clarity: SI1<br />carat: 2.25<br />price: 15397","Clarity: VS1<br />carat: 1.39<br />price:  7239","Clarity: SI1<br />carat: 1.55<br />price:  7502","Clarity: SI2<br />carat: 1.30<br />price:  5751","Clarity: VS2<br />carat: 1.03<br />price:  5814","Clarity: VS2<br />carat: 1.54<br />price: 12522","Clarity: SI2<br />carat: 1.06<br />price:  3989","Clarity: SI1<br />carat: 1.19<br />price:  6078","Clarity: SI2<br />carat: 0.70<br />price:  1848","Clarity: VS1<br />carat: 1.22<br />price:  8779","Clarity: SI2<br />carat: 1.20<br />price:  5376","Clarity: SI2<br />carat: 1.52<br />price:  8127","Clarity: VS1<br />carat: 0.51<br />price:  1781","Clarity: SI1<br />carat: 0.50<br />price:  1125","Clarity: SI1<br />carat: 0.54<br />price:  1389","Clarity: SI2<br />carat: 0.84<br />price:  2628","Clarity: SI2<br />carat: 1.00<br />price:  4704","Clarity: VS2<br />carat: 0.30<br />price:   658","Clarity: VVS1<br />carat: 0.38<br />price:  1400","Clarity: VS2<br />carat: 0.51<br />price:  1662","Clarity: VS2<br />carat: 0.51<br />price:  1567","Clarity: VS1<br />carat: 0.91<br />price:  5167","Clarity: IF<br />carat: 0.76<br />price:  4223","Clarity: VS2<br />carat: 0.32<br />price:   561","Clarity: VS2<br />carat: 1.01<br />price:  5303","Clarity: SI1<br />carat: 1.01<br />price:  5232","Clarity: VVS1<br />carat: 0.45<br />price:  1736","Clarity: SI1<br />carat: 0.32<br />price:   477","Clarity: SI2<br />carat: 0.90<br />price:  3770","Clarity: SI2<br />carat: 2.32<br />price: 10913","Clarity: SI1<br />carat: 1.08<br />price:  5419","Clarity: SI1<br />carat: 1.23<br />price:  6909","Clarity: VS1<br />carat: 0.41<br />price:   964","Clarity: VS2<br />carat: 1.01<br />price:  6533","Clarity: VVS2<br />carat: 0.32<br />price:  1080","Clarity: SI2<br />carat: 1.47<br />price:  6223","Clarity: SI2<br />carat: 0.51<br />price:  1004","Clarity: VS2<br />carat: 0.52<br />price:  1815","Clarity: VS2<br />carat: 1.70<br />price: 12992","Clarity: SI1<br />carat: 1.03<br />price:  4932","Clarity: SI1<br />carat: 0.44<br />price:  1023","Clarity: SI1<br />carat: 1.21<br />price:  5720","Clarity: SI1<br />carat: 1.02<br />price:  5084","Clarity: SI2<br />carat: 1.01<br />price:  4249","Clarity: SI2<br />carat: 2.05<br />price: 16506","Clarity: VS1<br />carat: 1.58<br />price: 14451","Clarity: VS2<br />carat: 0.57<br />price:  1754","Clarity: SI1<br />carat: 1.02<br />price:  4037","Clarity: SI2<br />carat: 1.21<br />price:  4946","Clarity: VVS2<br />carat: 0.31<br />price:  1107","Clarity: SI1<br />carat: 0.70<br />price:  2239","Clarity: SI1<br />carat: 0.56<br />price:  1814","Clarity: VS1<br />carat: 1.42<br />price: 11861","Clarity: VS1<br />carat: 1.21<br />price:  7094","Clarity: SI2<br />carat: 0.38<br />price:   641","Clarity: SI1<br />carat: 0.71<br />price:  2249","Clarity: VS2<br />carat: 0.32<br />price:   720","Clarity: IF<br />carat: 0.30<br />price:  1071","Clarity: SI2<br />carat: 1.04<br />price:  4240","Clarity: SI1<br />carat: 1.61<br />price: 10477","Clarity: SI2<br />carat: 1.21<br />price:  6071","Clarity: SI1<br />carat: 2.01<br />price: 17688","Clarity: VVS1<br />carat: 0.41<br />price:  1431","Clarity: SI1<br />carat: 0.90<br />price:  3387","Clarity: VS2<br />carat: 0.31<br />price:   872","Clarity: SI1<br />carat: 0.31<br />price:   418","Clarity: I1<br />carat: 1.52<br />price:  4345","Clarity: VS1<br />carat: 1.50<br />price: 16558","Clarity: VVS2<br />carat: 0.33<br />price:   722","Clarity: SI2<br />carat: 1.19<br />price:  4332","Clarity: IF<br />carat: 0.33<br />price:   891","Clarity: VS1<br />carat: 0.30<br />price:   608","Clarity: SI1<br />carat: 0.31<br />price:   663","Clarity: SI1<br />carat: 0.33<br />price:   780","Clarity: IF<br />carat: 1.01<br />price: 11387","Clarity: SI1<br />carat: 0.42<br />price:   953","Clarity: SI1<br />carat: 1.54<br />price: 10466","Clarity: VS2<br />carat: 0.42<br />price:   847","Clarity: I1<br />carat: 1.95<br />price:  5045","Clarity: SI1<br />carat: 0.42<br />price:   722","Clarity: SI1<br />carat: 0.40<br />price:   900","Clarity: SI1<br />carat: 0.31<br />price:   516","Clarity: VS1<br />carat: 1.01<br />price:  5294","Clarity: SI2<br />carat: 0.39<br />price:   721","Clarity: VS1<br />carat: 0.93<br />price:  4793","Clarity: VS1<br />carat: 0.39<br />price:  1097","Clarity: VVS2<br />carat: 1.71<br />price: 14731","Clarity: SI2<br />carat: 1.74<br />price: 10270","Clarity: VS2<br />carat: 0.90<br />price:  3810","Clarity: VS2<br />carat: 0.72<br />price:  2216","Clarity: SI1<br />carat: 0.53<br />price:  1428","Clarity: VS2<br />carat: 1.93<br />price: 17353","Clarity: SI1<br />carat: 0.68<br />price:  2224","Clarity: SI1<br />carat: 1.17<br />price:  5831","Clarity: VS1<br />carat: 1.20<br />price:  8056","Clarity: SI2<br />carat: 1.01<br />price:  3337","Clarity: VS2<br />carat: 1.25<br />price:  6300","Clarity: SI1<br />carat: 1.00<br />price:  4427","Clarity: SI1<br />carat: 1.28<br />price:  6164","Clarity: VS2<br />carat: 0.36<br />price:  1013","Clarity: SI2<br />carat: 0.33<br />price:   434","Clarity: VS1<br />carat: 0.56<br />price:  2032","Clarity: SI1<br />carat: 0.90<br />price:  4334","Clarity: VS2<br />carat: 0.71<br />price:  2735","Clarity: VS2<br />carat: 0.70<br />price:  2479","Clarity: VS2<br />carat: 0.32<br />price:   648","Clarity: SI1<br />carat: 0.40<br />price:   882","Clarity: SI1<br />carat: 1.01<br />price:  4480","Clarity: SI1<br />carat: 1.06<br />price:  4862","Clarity: VS1<br />carat: 0.50<br />price:  1710","Clarity: SI1<br />carat: 0.54<br />price:  1422","Clarity: VS2<br />carat: 0.52<br />price:  1743","Clarity: SI2<br />carat: 2.20<br />price: 17634","Clarity: SI2<br />carat: 1.50<br />price: 10206","Clarity: IF<br />carat: 0.32<br />price:   842","Clarity: VVS2<br />carat: 0.30<br />price:   819","Clarity: SI2<br />carat: 0.70<br />price:  2273","Clarity: VS2<br />carat: 0.50<br />price:  1746","Clarity: SI2<br />carat: 1.22<br />price:  6237","Clarity: VS1<br />carat: 0.30<br />price:   605","Clarity: VS1<br />carat: 0.30<br />price:   776","Clarity: SI1<br />carat: 0.56<br />price:  1436","Clarity: VVS2<br />carat: 0.31<br />price:   707","Clarity: VVS2<br />carat: 0.35<br />price:  1024","Clarity: VS2<br />carat: 0.51<br />price:  1381","Clarity: SI2<br />carat: 1.01<br />price:  4672","Clarity: VVS1<br />carat: 0.51<br />price:  2027","Clarity: VS1<br />carat: 0.36<br />price:   810","Clarity: VS2<br />carat: 0.31<br />price:   942","Clarity: VS2<br />carat: 0.50<br />price:  1323","Clarity: VS2<br />carat: 1.29<br />price:  6987","Clarity: SI2<br />carat: 1.20<br />price:  3965","Clarity: SI2<br />carat: 1.15<br />price:  4743","Clarity: VS1<br />carat: 1.01<br />price:  7982","Clarity: VS2<br />carat: 1.04<br />price:  6206","Clarity: SI1<br />carat: 0.71<br />price:  2629","Clarity: SI2<br />carat: 1.00<br />price:  3977","Clarity: SI2<br />carat: 1.00<br />price:  4200","Clarity: VS2<br />carat: 0.90<br />price:  4022","Clarity: SI1<br />carat: 1.03<br />price:  4843","Clarity: VS1<br />carat: 1.60<br />price: 12210","Clarity: SI1<br />carat: 0.77<br />price:  2457","Clarity: SI1<br />carat: 1.58<br />price:  7654","Clarity: VS1<br />carat: 1.51<br />price: 11263","Clarity: SI1<br />carat: 1.01<br />price:  3920","Clarity: SI1<br />carat: 0.31<br />price:   698","Clarity: VS2<br />carat: 0.31<br />price:   544","Clarity: SI1<br />carat: 0.73<br />price:  1905","Clarity: VS2<br />carat: 0.36<br />price:  1094","Clarity: VS2<br />carat: 1.01<br />price:  6108","Clarity: SI1<br />carat: 0.42<br />price:   737","Clarity: SI2<br />carat: 1.97<br />price: 14410","Clarity: SI2<br />carat: 2.23<br />price: 12770","Clarity: IF<br />carat: 0.32<br />price:   979","Clarity: VS2<br />carat: 1.01<br />price:  6533","Clarity: SI2<br />carat: 0.58<br />price:  1307","Clarity: VS1<br />carat: 0.55<br />price:  1755","Clarity: VS2<br />carat: 1.23<br />price:  9257","Clarity: IF<br />carat: 0.43<br />price:  1433","Clarity: VVS1<br />carat: 0.31<br />price:   816","Clarity: VS1<br />carat: 0.32<br />price:   648","Clarity: SI1<br />carat: 0.41<br />price:   923","Clarity: VVS1<br />carat: 0.33<br />price:   868","Clarity: VS2<br />carat: 1.22<br />price:  8950","Clarity: SI2<br />carat: 0.61<br />price:  1303","Clarity: VS1<br />carat: 0.33<br />price:   666","Clarity: SI1<br />carat: 1.00<br />price:  4724","Clarity: SI1<br />carat: 1.57<br />price: 12417","Clarity: SI1<br />carat: 0.42<br />price:   773","Clarity: VS1<br />carat: 1.05<br />price:  6146","Clarity: SI1<br />carat: 1.71<br />price:  8690","Clarity: SI1<br />carat: 1.27<br />price:  5547","Clarity: VS2<br />carat: 0.31<br />price:   802","Clarity: SI1<br />carat: 0.77<br />price:  2846","Clarity: SI2<br />carat: 1.00<br />price:  4730","Clarity: VVS2<br />carat: 0.30<br />price:   684","Clarity: VS2<br />carat: 0.33<br />price:   804","Clarity: VS2<br />carat: 0.37<br />price:   894","Clarity: VS2<br />carat: 0.57<br />price:  1944","Clarity: SI1<br />carat: 1.59<br />price:  9707","Clarity: VS2<br />carat: 0.30<br />price:   605","Clarity: SI1<br />carat: 1.81<br />price: 11854","Clarity: SI2<br />carat: 1.21<br />price:  5387","Clarity: VS2<br />carat: 0.34<br />price:   645","Clarity: VS1<br />carat: 1.53<br />price: 11127","Clarity: SI1<br />carat: 0.37<br />price:   666","Clarity: IF<br />carat: 0.80<br />price:  4193"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.5,0.28,0.41,0.36,0.41,0.3,0.8,0.71,0.53,1.53,0.4,0.58,1.14,1,1.21,0.71,0.52,0.59,0.31,0.72,0.32,0.3,0.3,0.35,0.4,0.52,0.32,1.21,1.11,0.55,0.33,0.72,1.07,0.28,0.5,1.23,0.31,0.3,0.54,1.18,0.3,0.33,1.2,1.1,0.52,0.55,1.11,0.31,1.16,0.82,1.15,0.61,0.55,0.41,0.4,0.53,1.29,0.53,0.33,0.38,0.28,0.35,0.32,0.75,0.55,1,0.3,0.31,0.8,0.77,0.44,0.56,0.24,0.42,0.82,0.71,0.33,0.71,0.31,0.39,0.7,0.52,1.07,0.26,0.74,1.12,0.29,0.7,0.55,0.61,0.3,1.07,0.36,0.3,0.3,0.35,0.73,0.44,0.74,2.03,0.72,0.7,0.41,1.06,0.42,0.33,0.41,0.52,0.52,0.55,1.16,0.56,0.31,0.35,0.37,0.3,0.41,2.05,0.72,2.06,0.3,1.6,0.31,0.51,0.41,0.34,0.32,1.23,1.5,0.32,1.02,0.58,2.02,0.27,0.5,1.52,0.27,0.74,0.27,1.16,1.49,1.58,0.72,0.35,0.57,0.86,1.03,1.21,2.07,0.72,0.43,0.53,1.2,0.55,0.38,0.38,1.09,0.31,1.01,0.38,0.51,1.2,1.23,0.33,0.7,1.01,1.14,1.51,1.13,0.32,0.32,0.31,0.33,0.6,2.1,0.32,1.29,1.06,0.5,1.04,0.27,1.28,1.18,1.58,1.24,0.39,0.56,0.77,0.32,1.5,0.57,1.06,0.38,1.26,0.71,0.42,0.35,0.81,0.75,0.38,0.56,0.33,1.12,0.27,0.41,0.39,0.41,0.34,0.5,2.3,0.7,0.55,0.42,1,0.74,0.41,0.3,0.59,0.37,0.54,1.02,1.25,0.74,1.02,0.54,0.42,0.56,1.53,1.21,1.05,0.34,0.6,0.42,0.81,0.33,1.32,0.82,0.34,1.13,0.39,0.3,0.24,0.57,0.33,0.54,1.1,0.4,1.01,1.08,0.56,0.93,0.41,1.27,0.3,1.01,0.71,0.34,1.19,0.5,0.3,0.5,0.43,0.9,0.72,0.41,0.41,0.35,0.72,0.51,0.72,1.07,1.03,0.73,0.76,0.32,0.61,0.71,0.4,0.33,0.4,1.12,0.53,0.51,0.37,1.16,2.29,0.35,1.03,0.3,0.9,0.31,1.04,1.5,1.03,0.71,0.39,0.42,0.37,0.78,1.02,0.37,0.31,0.3,2.02,1.22,1.14,1.01,0.31,0.3,1.15,0.3,0.54,2.01,1.75,0.51,0.3,1.08,0.32,0.8,0.72,0.34,0.72,0.38,0.41,0.42,0.4,0.41,0.82,0.32,0.38,0.7,0.72,0.31,1.57,1.11,1.03,0.31,0.3,0.73,0.53,1.02,0.3,1.51,0.7,1.36,0.3,2.32,0.32,0.3,1.18,1.21,0.32,0.46,0.56,0.55,0.33,0.54,1.21,1.08,1.03,0.79,0.3,1.51,0.41,1.07,0.82,1.06,0.74,0.83,0.81,1.31,0.41,0.7,0.57,1.04,0.57,1.55,1.54,1.19,0.33,0.41,1.01,0.91,0.46,0.26,0.4,0.33,0.44,1.02,1.01,0.78,1.02,1.09,0.58,1.06,2.22,0.43,0.31,1.2,0.32,0.4,0.71,0.32,0.93,0.2,0.62,0.58,0.54,1.53,0.41,1.02,0.88,0.31,0.41,1.11],"y":[1243,586,961,738,1439,665,4043,3252,856,17223,1059,2395,5469,4737,7810,2006,1720,1844,913,3478,828,830,665,916,1088,1656,702,5882,12725,1896,692,2177,5405,650,1603,10580,802,747,1630,9095,886,984,5833,3872,1191,1101,5329,828,9075,3966,8114,1659,1263,1013,1125,1654,7463,1881,984,992,825,945,561,4007,1588,4172,956,1046,2986,2677,810,1723,540,1031,3131,2226,928,2590,1319,1209,2138,1383,10453,394,3922,9461,607,2697,1134,2161,911,7069,1013,710,621,706,3980,1408,2779,15826,2416,2264,1427,6399,851,702,969,1646,1721,1856,7128,2066,878,906,811,911,1431,18787,4094,15691,694,8886,853,1875,683,885,900,6152,12389,602,5115,1979,12736,470,1679,7990,583,2852,846,10850,9132,13557,2295,563,3313,3442,3634,10482,13879,3352,1053,1676,9424,1715,871,660,7992,692,6295,1160,973,4368,9547,893,2398,4194,6070,10096,4959,1018,736,698,1141,1897,13182,867,10727,4602,1449,4455,383,6308,5088,11526,5889,651,1723,3251,702,14242,2719,7641,891,9243,3856,1031,923,3053,2964,929,2066,608,8279,659,969,587,1085,775,2052,14215,2966,2119,1210,7403,4383,1001,776,1221,1033,1619,6306,6661,3254,7916,2375,1310,1698,12616,7666,5104,714,2147,1221,2761,868,7209,3439,1033,7066,911,477,678,2682,743,1346,7528,877,5184,5625,2148,3114,876,7023,684,7355,3238,760,5504,1140,731,1118,941,3724,2891,612,1196,1044,2514,1265,3145,4434,7697,4142,2770,936,2659,2704,667,752,1200,4811,1255,1899,1041,4425,13200,798,5330,401,5335,502,3718,16948,4441,2771,895,847,1087,3267,5569,649,734,802,17936,9002,7079,5497,698,475,10316,710,1820,17126,11113,2163,776,6411,561,3066,3554,628,3179,993,1076,1210,804,810,3364,972,1064,2942,2993,511,9912,8508,5491,1046,911,1902,1928,7077,658,14482,2822,8977,776,17676,756,545,5182,7928,692,758,1949,1692,743,1662,5232,5049,8454,3210,590,12545,1367,5281,2974,3932,2761,2201,3146,10071,945,2719,1847,3786,1981,11869,8848,6335,1042,1439,7805,3812,746,733,772,723,1003,7129,10197,3171,4824,5428,1876,4568,18531,1207,802,5765,867,890,3710,639,5992,367,2469,1809,1726,12907,1187,5367,3619,942,1076,6065],"text":["Clarity: SI2<br />carat: 0.50<br />price:  1243","Clarity: VVS2<br />carat: 0.28<br />price:   586","Clarity: VS1<br />carat: 0.41<br />price:   961","Clarity: VS2<br />carat: 0.36<br />price:   738","Clarity: IF<br />carat: 0.41<br />price:  1439","Clarity: VVS1<br />carat: 0.30<br />price:   665","Clarity: VS2<br />carat: 0.80<br />price:  4043","Clarity: SI1<br />carat: 0.71<br />price:  3252","Clarity: SI2<br />carat: 0.53<br />price:   856","Clarity: VS2<br />carat: 1.53<br />price: 17223","Clarity: VVS1<br />carat: 0.40<br />price:  1059","Clarity: VVS2<br />carat: 0.58<br />price:  2395","Clarity: SI1<br />carat: 1.14<br />price:  5469","Clarity: SI1<br />carat: 1.00<br />price:  4737","Clarity: SI1<br />carat: 1.21<br />price:  7810","Clarity: SI1<br />carat: 0.71<br />price:  2006","Clarity: SI1<br />carat: 0.52<br />price:  1720","Clarity: VS2<br />carat: 0.59<br />price:  1844","Clarity: VS1<br />carat: 0.31<br />price:   913","Clarity: VS1<br />carat: 0.72<br />price:  3478","Clarity: VS2<br />carat: 0.32<br />price:   828","Clarity: IF<br />carat: 0.30<br />price:   830","Clarity: VVS1<br />carat: 0.30<br />price:   665","Clarity: VVS1<br />carat: 0.35<br />price:   916","Clarity: VVS2<br />carat: 0.40<br />price:  1088","Clarity: SI1<br />carat: 0.52<br />price:  1656","Clarity: VS2<br />carat: 0.32<br />price:   702","Clarity: VS2<br />carat: 1.21<br />price:  5882","Clarity: VVS1<br />carat: 1.11<br />price: 12725","Clarity: VS1<br />carat: 0.55<br />price:  1896","Clarity: VS2<br />carat: 0.33<br />price:   692","Clarity: VS1<br />carat: 0.72<br />price:  2177","Clarity: SI2<br />carat: 1.07<br />price:  5405","Clarity: IF<br />carat: 0.28<br />price:   650","Clarity: VS1<br />carat: 0.50<br />price:  1603","Clarity: VVS2<br />carat: 1.23<br />price: 10580","Clarity: VS2<br />carat: 0.31<br />price:   802","Clarity: VVS1<br />carat: 0.30<br />price:   747","Clarity: VS1<br />carat: 0.54<br />price:  1630","Clarity: VVS1<br />carat: 1.18<br />price:  9095","Clarity: IF<br />carat: 0.30<br />price:   886","Clarity: VVS1<br />carat: 0.33<br />price:   984","Clarity: VS2<br />carat: 1.20<br />price:  5833","Clarity: I1<br />carat: 1.10<br />price:  3872","Clarity: SI2<br />carat: 0.52<br />price:  1191","Clarity: SI1<br />carat: 0.55<br />price:  1101","Clarity: SI1<br />carat: 1.11<br />price:  5329","Clarity: VVS2<br />carat: 0.31<br />price:   828","Clarity: VVS1<br />carat: 1.16<br />price:  9075","Clarity: SI1<br />carat: 0.82<br />price:  3966","Clarity: VS2<br />carat: 1.15<br />price:  8114","Clarity: SI1<br />carat: 0.61<br />price:  1659","Clarity: SI2<br />carat: 0.55<br />price:  1263","Clarity: VVS2<br />carat: 0.41<br />price:  1013","Clarity: VS1<br />carat: 0.40<br />price:  1125","Clarity: IF<br />carat: 0.53<br />price:  1654","Clarity: SI1<br />carat: 1.29<br />price:  7463","Clarity: VVS2<br />carat: 0.53<br />price:  1881","Clarity: IF<br />carat: 0.33<br />price:   984","Clarity: VVS2<br />carat: 0.38<br />price:   992","Clarity: IF<br />carat: 0.28<br />price:   825","Clarity: VS2<br />carat: 0.35<br />price:   945","Clarity: VS2<br />carat: 0.32<br />price:   561","Clarity: VS1<br />carat: 0.75<br />price:  4007","Clarity: VS2<br />carat: 0.55<br />price:  1588","Clarity: VS2<br />carat: 1.00<br />price:  4172","Clarity: IF<br />carat: 0.30<br />price:   956","Clarity: IF<br />carat: 0.31<br />price:  1046","Clarity: VS1<br />carat: 0.80<br />price:  2986","Clarity: SI2<br />carat: 0.77<br />price:  2677","Clarity: SI1<br />carat: 0.44<br />price:   810","Clarity: VS2<br />carat: 0.56<br />price:  1723","Clarity: VVS2<br />carat: 0.24<br />price:   540","Clarity: VS2<br />carat: 0.42<br />price:  1031","Clarity: SI2<br />carat: 0.82<br />price:  3131","Clarity: VVS2<br />carat: 0.71<br />price:  2226","Clarity: VS2<br />carat: 0.33<br />price:   928","Clarity: VS1<br />carat: 0.71<br />price:  2590","Clarity: IF<br />carat: 0.31<br />price:  1319","Clarity: IF<br />carat: 0.39<br />price:  1209","Clarity: SI2<br />carat: 0.70<br />price:  2138","Clarity: SI1<br />carat: 0.52<br />price:  1383","Clarity: VVS2<br />carat: 1.07<br />price: 10453","Clarity: SI1<br />carat: 0.26<br />price:   394","Clarity: VVS2<br />carat: 0.74<br />price:  3922","Clarity: VVS2<br />carat: 1.12<br />price:  9461","Clarity: IF<br />carat: 0.29<br />price:   607","Clarity: VS2<br />carat: 0.70<br />price:  2697","Clarity: SI1<br />carat: 0.55<br />price:  1134","Clarity: VS1<br />carat: 0.61<br />price:  2161","Clarity: VS2<br />carat: 0.30<br />price:   911","Clarity: VS1<br />carat: 1.07<br />price:  7069","Clarity: VS2<br />carat: 0.36<br />price:  1013","Clarity: VS2<br />carat: 0.30<br />price:   710","Clarity: VS1<br />carat: 0.30<br />price:   621","Clarity: VS1<br />carat: 0.35<br />price:   706","Clarity: VS2<br />carat: 0.73<br />price:  3980","Clarity: VVS2<br />carat: 0.44<br />price:  1408","Clarity: SI1<br />carat: 0.74<br />price:  2779","Clarity: VS2<br />carat: 2.03<br />price: 15826","Clarity: SI1<br />carat: 0.72<br />price:  2416","Clarity: SI1<br />carat: 0.70<br />price:  2264","Clarity: VS1<br />carat: 0.41<br />price:  1427","Clarity: VS2<br />carat: 1.06<br />price:  6399","Clarity: VS1<br />carat: 0.42<br />price:   851","Clarity: VVS2<br />carat: 0.33<br />price:   702","Clarity: SI1<br />carat: 0.41<br />price:   969","Clarity: VS2<br />carat: 0.52<br />price:  1646","Clarity: VS1<br />carat: 0.52<br />price:  1721","Clarity: VS1<br />carat: 0.55<br />price:  1856","Clarity: VS2<br />carat: 1.16<br />price:  7128","Clarity: VS2<br />carat: 0.56<br />price:  2066","Clarity: VVS1<br />carat: 0.31<br />price:   878","Clarity: VS1<br />carat: 0.35<br />price:   906","Clarity: VS1<br />carat: 0.37<br />price:   811","Clarity: VS2<br />carat: 0.30<br />price:   911","Clarity: VVS1<br />carat: 0.41<br />price:  1431","Clarity: SI1<br />carat: 2.05<br />price: 18787","Clarity: VVS2<br />carat: 0.72<br />price:  4094","Clarity: VS2<br />carat: 2.06<br />price: 15691","Clarity: VVS2<br />carat: 0.30<br />price:   694","Clarity: VS2<br />carat: 1.60<br />price:  8886","Clarity: VVS2<br />carat: 0.31<br />price:   853","Clarity: VVS2<br />carat: 0.51<br />price:  1875","Clarity: SI2<br />carat: 0.41<br />price:   683","Clarity: VVS2<br />carat: 0.34<br />price:   885","Clarity: VS2<br />carat: 0.32<br />price:   900","Clarity: SI2<br />carat: 1.23<br />price:  6152","Clarity: SI1<br />carat: 1.50<br />price: 12389","Clarity: VS2<br />carat: 0.32<br />price:   602","Clarity: SI2<br />carat: 1.02<br />price:  5115","Clarity: VS1<br />carat: 0.58<br />price:  1979","Clarity: SI2<br />carat: 2.02<br />price: 12736","Clarity: VS2<br />carat: 0.27<br />price:   470","Clarity: VS1<br />carat: 0.50<br />price:  1679","Clarity: SI2<br />carat: 1.52<br />price:  7990","Clarity: VVS2<br />carat: 0.27<br />price:   583","Clarity: SI1<br />carat: 0.74<br />price:  2852","Clarity: VVS1<br />carat: 0.27<br />price:   846","Clarity: VVS2<br />carat: 1.16<br />price: 10850","Clarity: SI1<br />carat: 1.49<br />price:  9132","Clarity: SI1<br />carat: 1.58<br />price: 13557","Clarity: SI2<br />carat: 0.72<br />price:  2295","Clarity: VS2<br />carat: 0.35<br />price:   563","Clarity: VVS1<br />carat: 0.57<br />price:  3313","Clarity: SI2<br />carat: 0.86<br />price:  3442","Clarity: SI2<br />carat: 1.03<br />price:  3634","Clarity: VVS1<br />carat: 1.21<br />price: 10482","Clarity: SI2<br />carat: 2.07<br />price: 13879","Clarity: VVS2<br />carat: 0.72<br />price:  3352","Clarity: VS2<br />carat: 0.43<br />price:  1053","Clarity: VS2<br />carat: 0.53<br />price:  1676","Clarity: VS2<br />carat: 1.20<br />price:  9424","Clarity: VS2<br />carat: 0.55<br />price:  1715","Clarity: VS2<br />carat: 0.38<br />price:   871","Clarity: SI1<br />carat: 0.38<br />price:   660","Clarity: VS1<br />carat: 1.09<br />price:  7992","Clarity: VS2<br />carat: 0.31<br />price:   692","Clarity: VS2<br />carat: 1.01<br />price:  6295","Clarity: VVS1<br />carat: 0.38<br />price:  1160","Clarity: SI2<br />carat: 0.51<br />price:   973","Clarity: SI2<br />carat: 1.20<br />price:  4368","Clarity: VS2<br />carat: 1.23<br />price:  9547","Clarity: VVS2<br />carat: 0.33<br />price:   893","Clarity: SI2<br />carat: 0.70<br />price:  2398","Clarity: SI1<br />carat: 1.01<br />price:  4194","Clarity: SI1<br />carat: 1.14<br />price:  6070","Clarity: SI1<br />carat: 1.51<br />price: 10096","Clarity: SI1<br />carat: 1.13<br />price:  4959","Clarity: IF<br />carat: 0.32<br />price:  1018","Clarity: VS1<br />carat: 0.32<br />price:   736","Clarity: VS2<br />carat: 0.31<br />price:   698","Clarity: VVS1<br />carat: 0.33<br />price:  1141","Clarity: VS2<br />carat: 0.60<br />price:  1897","Clarity: SI1<br />carat: 2.10<br />price: 13182","Clarity: VVS1<br />carat: 0.32<br />price:   867","Clarity: VS1<br />carat: 1.29<br />price: 10727","Clarity: SI1<br />carat: 1.06<br />price:  4602","Clarity: VS2<br />carat: 0.50<br />price:  1449","Clarity: SI2<br />carat: 1.04<br />price:  4455","Clarity: SI1<br />carat: 0.27<br />price:   383","Clarity: VS2<br />carat: 1.28<br />price:  6308","Clarity: SI1<br />carat: 1.18<br />price:  5088","Clarity: VVS1<br />carat: 1.58<br />price: 11526","Clarity: SI2<br />carat: 1.24<br />price:  5889","Clarity: VS2<br />carat: 0.39<br />price:   651","Clarity: VS2<br />carat: 0.56<br />price:  1723","Clarity: SI1<br />carat: 0.77<br />price:  3251","Clarity: VS2<br />carat: 0.32<br />price:   702","Clarity: VS2<br />carat: 1.50<br />price: 14242","Clarity: VVS2<br />carat: 0.57<br />price:  2719","Clarity: VS2<br />carat: 1.06<br />price:  7641","Clarity: VS1<br />carat: 0.38<br />price:   891","Clarity: VS1<br />carat: 1.26<br />price:  9243","Clarity: VVS2<br />carat: 0.71<br />price:  3856","Clarity: VS2<br />carat: 0.42<br />price:  1031","Clarity: VS1<br />carat: 0.35<br />price:   923","Clarity: SI2<br />carat: 0.81<br />price:  3053","Clarity: SI1<br />carat: 0.75<br />price:  2964","Clarity: VVS2<br />carat: 0.38<br />price:   929","Clarity: VS2<br />carat: 0.56<br />price:  2066","Clarity: SI1<br />carat: 0.33<br />price:   608","Clarity: VS2<br />carat: 1.12<br />price:  8279","Clarity: VVS1<br />carat: 0.27<br />price:   659","Clarity: SI1<br />carat: 0.41<br />price:   969","Clarity: SI2<br />carat: 0.39<br />price:   587","Clarity: VVS2<br />carat: 0.41<br />price:  1085","Clarity: VVS2<br />carat: 0.34<br />price:   775","Clarity: VVS2<br />carat: 0.50<br />price:  2052","Clarity: SI2<br />carat: 2.30<br />price: 14215","Clarity: VVS1<br />carat: 0.70<br />price:  2966","Clarity: VS1<br />carat: 0.55<br />price:  2119","Clarity: VVS2<br />carat: 0.42<br />price:  1210","Clarity: VVS2<br />carat: 1.00<br />price:  7403","Clarity: IF<br />carat: 0.74<br />price:  4383","Clarity: VVS1<br />carat: 0.41<br />price:  1001","Clarity: VS1<br />carat: 0.30<br />price:   776","Clarity: SI2<br />carat: 0.59<br />price:  1221","Clarity: IF<br />carat: 0.37<br />price:  1033","Clarity: VS2<br />carat: 0.54<br />price:  1619","Clarity: VS2<br />carat: 1.02<br />price:  6306","Clarity: SI1<br />carat: 1.25<br />price:  6661","Clarity: VS1<br />carat: 0.74<br />price:  3254","Clarity: VS1<br />carat: 1.02<br />price:  7916","Clarity: VVS2<br />carat: 0.54<br />price:  2375","Clarity: VVS1<br />carat: 0.42<br />price:  1310","Clarity: VS2<br />carat: 0.56<br />price:  1698","Clarity: SI1<br />carat: 1.53<br />price: 12616","Clarity: VS2<br />carat: 1.21<br />price:  7666","Clarity: SI1<br />carat: 1.05<br />price:  5104","Clarity: SI1<br />carat: 0.34<br />price:   714","Clarity: VS1<br />carat: 0.60<br />price:  2147","Clarity: VVS2<br />carat: 0.42<br />price:  1221","Clarity: SI2<br />carat: 0.81<br />price:  2761","Clarity: VVS1<br />carat: 0.33<br />price:   868","Clarity: VS2<br />carat: 1.32<br />price:  7209","Clarity: SI1<br />carat: 0.82<br />price:  3439","Clarity: VS1<br />carat: 0.34<br />price:  1033","Clarity: SI1<br />carat: 1.13<br />price:  7066","Clarity: VVS2<br />carat: 0.39<br />price:   911","Clarity: SI1<br />carat: 0.30<br />price:   477","Clarity: VVS1<br />carat: 0.24<br />price:   678","Clarity: VVS1<br />carat: 0.57<br />price:  2682","Clarity: SI1<br />carat: 0.33<br />price:   743","Clarity: VVS2<br />carat: 0.54<br />price:  1346","Clarity: VS1<br />carat: 1.10<br />price:  7528","Clarity: VVS2<br />carat: 0.40<br />price:   877","Clarity: SI1<br />carat: 1.01<br />price:  5184","Clarity: VS2<br />carat: 1.08<br />price:  5625","Clarity: VVS2<br />carat: 0.56<br />price:  2148","Clarity: SI2<br />carat: 0.93<br />price:  3114","Clarity: SI2<br />carat: 0.41<br />price:   876","Clarity: SI2<br />carat: 1.27<br />price:  7023","Clarity: VVS1<br />carat: 0.30<br />price:   684","Clarity: VS2<br />carat: 1.01<br />price:  7355","Clarity: VS1<br />carat: 0.71<br />price:  3238","Clarity: VS2<br />carat: 0.34<br />price:   760","Clarity: SI2<br />carat: 1.19<br />price:  5504","Clarity: SI1<br />carat: 0.50<br />price:  1140","Clarity: VVS2<br />carat: 0.30<br />price:   731","Clarity: SI2<br />carat: 0.50<br />price:  1118","Clarity: VS1<br />carat: 0.43<br />price:   941","Clarity: VS1<br />carat: 0.90<br />price:  3724","Clarity: SI1<br />carat: 0.72<br />price:  2891","Clarity: SI2<br />carat: 0.41<br />price:   612","Clarity: VVS1<br />carat: 0.41<br />price:  1196","Clarity: VVS1<br />carat: 0.35<br />price:  1044","Clarity: SI1<br />carat: 0.72<br />price:  2514","Clarity: SI2<br />carat: 0.51<br />price:  1265","Clarity: VS2<br />carat: 0.72<br />price:  3145","Clarity: SI2<br />carat: 1.07<br />price:  4434","Clarity: VS2<br />carat: 1.03<br />price:  7697","Clarity: IF<br />carat: 0.73<br />price:  4142","Clarity: SI2<br />carat: 0.76<br />price:  2770","Clarity: VVS2<br />carat: 0.32<br />price:   936","Clarity: IF<br />carat: 0.61<br />price:  2659","Clarity: SI1<br />carat: 0.71<br />price:  2704","Clarity: VS2<br />carat: 0.40<br />price:   667","Clarity: VVS1<br />carat: 0.33<br />price:   752","Clarity: VS1<br />carat: 0.40<br />price:  1200","Clarity: SI1<br />carat: 1.12<br />price:  4811","Clarity: SI1<br />carat: 0.53<br />price:  1255","Clarity: IF<br />carat: 0.51<br />price:  1899","Clarity: VS2<br />carat: 0.37<br />price:  1041","Clarity: SI2<br />carat: 1.16<br />price:  4425","Clarity: SI2<br />carat: 2.29<br />price: 13200","Clarity: VVS1<br />carat: 0.35<br />price:   798","Clarity: SI1<br />carat: 1.03<br />price:  5330","Clarity: SI2<br />carat: 0.30<br />price:   401","Clarity: VS1<br />carat: 0.90<br />price:  5335","Clarity: VS1<br />carat: 0.31<br />price:   502","Clarity: I1<br />carat: 1.04<br />price:  3718","Clarity: VVS2<br />carat: 1.50<br />price: 16948","Clarity: SI2<br />carat: 1.03<br />price:  4441","Clarity: VS2<br />carat: 0.71<br />price:  2771","Clarity: IF<br />carat: 0.39<br />price:   895","Clarity: VS2<br />carat: 0.42<br />price:   847","Clarity: VS1<br />carat: 0.37<br />price:  1087","Clarity: VVS2<br />carat: 0.78<br />price:  3267","Clarity: VS1<br />carat: 1.02<br />price:  5569","Clarity: SI1<br />carat: 0.37<br />price:   649","Clarity: VS1<br />carat: 0.31<br />price:   734","Clarity: VVS1<br />carat: 0.30<br />price:   802","Clarity: VS1<br />carat: 2.02<br />price: 17936","Clarity: VS1<br />carat: 1.22<br />price:  9002","Clarity: SI1<br />carat: 1.14<br />price:  7079","Clarity: SI1<br />carat: 1.01<br />price:  5497","Clarity: VS2<br />carat: 0.31<br />price:   698","Clarity: SI1<br />carat: 0.30<br />price:   475","Clarity: VS1<br />carat: 1.15<br />price: 10316","Clarity: VS2<br />carat: 0.30<br />price:   710","Clarity: VS2<br />carat: 0.54<br />price:  1820","Clarity: SI1<br />carat: 2.01<br />price: 17126","Clarity: SI2<br />carat: 1.75<br />price: 11113","Clarity: IF<br />carat: 0.51<br />price:  2163","Clarity: VS2<br />carat: 0.30<br />price:   776","Clarity: VS2<br />carat: 1.08<br />price:  6411","Clarity: VS1<br />carat: 0.32<br />price:   561","Clarity: SI2<br />carat: 0.80<br />price:  3066","Clarity: VS1<br />carat: 0.72<br />price:  3554","Clarity: SI1<br />carat: 0.34<br />price:   628","Clarity: VS2<br />carat: 0.72<br />price:  3179","Clarity: VVS1<br />carat: 0.38<br />price:   993","Clarity: VS1<br />carat: 0.41<br />price:  1076","Clarity: VVS2<br />carat: 0.42<br />price:  1210","Clarity: VS2<br />carat: 0.40<br />price:   804","Clarity: SI2<br />carat: 0.41<br />price:   810","Clarity: VS1<br />carat: 0.82<br />price:  3364","Clarity: VS2<br />carat: 0.32<br />price:   972","Clarity: IF<br />carat: 0.38<br />price:  1064","Clarity: VS2<br />carat: 0.70<br />price:  2942","Clarity: SI1<br />carat: 0.72<br />price:  2993","Clarity: VS2<br />carat: 0.31<br />price:   511","Clarity: VS2<br />carat: 1.57<br />price:  9912","Clarity: VVS1<br />carat: 1.11<br />price:  8508","Clarity: SI2<br />carat: 1.03<br />price:  5491","Clarity: VVS2<br />carat: 0.31<br />price:  1046","Clarity: VS2<br />carat: 0.30<br />price:   911","Clarity: SI1<br />carat: 0.73<br />price:  1902","Clarity: VS1<br />carat: 0.53<br />price:  1928","Clarity: VS1<br />carat: 1.02<br />price:  7077","Clarity: VS2<br />carat: 0.30<br />price:   658","Clarity: VS2<br />carat: 1.51<br />price: 14482","Clarity: SI1<br />carat: 0.70<br />price:  2822","Clarity: SI1<br />carat: 1.36<br />price:  8977","Clarity: VS1<br />carat: 0.30<br />price:   776","Clarity: SI2<br />carat: 2.32<br />price: 17676","Clarity: SI1<br />carat: 0.32<br />price:   756","Clarity: VS1<br />carat: 0.30<br />price:   545","Clarity: VS1<br />carat: 1.18<br />price:  5182","Clarity: VS1<br />carat: 1.21<br />price:  7928","Clarity: VVS2<br />carat: 0.32<br />price:   692","Clarity: SI2<br />carat: 0.46<br />price:   758","Clarity: VS1<br />carat: 0.56<br />price:  1949","Clarity: VS2<br />carat: 0.55<br />price:  1692","Clarity: VS2<br />carat: 0.33<br />price:   743","Clarity: VS2<br />carat: 0.54<br />price:  1662","Clarity: SI1<br />carat: 1.21<br />price:  5232","Clarity: SI1<br />carat: 1.08<br />price:  5049","Clarity: VVS1<br />carat: 1.03<br />price:  8454","Clarity: SI1<br />carat: 0.79<br />price:  3210","Clarity: VVS2<br />carat: 0.30<br />price:   590","Clarity: SI1<br />carat: 1.51<br />price: 12545","Clarity: IF<br />carat: 0.41<br />price:  1367","Clarity: SI1<br />carat: 1.07<br />price:  5281","Clarity: SI1<br />carat: 0.82<br />price:  2974","Clarity: SI2<br />carat: 1.06<br />price:  3932","Clarity: SI2<br />carat: 0.74<br />price:  2761","Clarity: SI2<br />carat: 0.83<br />price:  2201","Clarity: SI1<br />carat: 0.81<br />price:  3146","Clarity: VS1<br />carat: 1.31<br />price: 10071","Clarity: VVS1<br />carat: 0.41<br />price:   945","Clarity: VS2<br />carat: 0.70<br />price:  2719","Clarity: SI1<br />carat: 0.57<br />price:  1847","Clarity: SI2<br />carat: 1.04<br />price:  3786","Clarity: VS2<br />carat: 0.57<br />price:  1981","Clarity: VVS1<br />carat: 1.55<br />price: 11869","Clarity: VS1<br />carat: 1.54<br />price:  8848","Clarity: SI1<br />carat: 1.19<br />price:  6335","Clarity: IF<br />carat: 0.33<br />price:  1042","Clarity: IF<br />carat: 0.41<br />price:  1439","Clarity: VVS1<br />carat: 1.01<br />price:  7805","Clarity: SI2<br />carat: 0.91<br />price:  3812","Clarity: VS2<br />carat: 0.46<br />price:   746","Clarity: VVS1<br />carat: 0.26<br />price:   733","Clarity: SI1<br />carat: 0.40<br />price:   772","Clarity: VS2<br />carat: 0.33<br />price:   723","Clarity: VS2<br />carat: 0.44<br />price:  1003","Clarity: VS1<br />carat: 1.02<br />price:  7129","Clarity: VVS1<br />carat: 1.01<br />price: 10197","Clarity: VS2<br />carat: 0.78<br />price:  3171","Clarity: SI2<br />carat: 1.02<br />price:  4824","Clarity: SI1<br />carat: 1.09<br />price:  5428","Clarity: VS2<br />carat: 0.58<br />price:  1876","Clarity: SI2<br />carat: 1.06<br />price:  4568","Clarity: VS2<br />carat: 2.22<br />price: 18531","Clarity: VVS1<br />carat: 0.43<br />price:  1207","Clarity: VS2<br />carat: 0.31<br />price:   802","Clarity: VS1<br />carat: 1.20<br />price:  5765","Clarity: VVS2<br />carat: 0.32<br />price:   867","Clarity: VS2<br />carat: 0.40<br />price:   890","Clarity: VS1<br />carat: 0.71<br />price:  3710","Clarity: VS2<br />carat: 0.32<br />price:   639","Clarity: SI1<br />carat: 0.93<br />price:  5992","Clarity: VS2<br />carat: 0.20<br />price:   367","Clarity: IF<br />carat: 0.62<br />price:  2469","Clarity: VS2<br />carat: 0.58<br />price:  1809","Clarity: VS1<br />carat: 0.54<br />price:  1726","Clarity: VS2<br />carat: 1.53<br />price: 12907","Clarity: IF<br />carat: 0.41<br />price:  1187","Clarity: SI1<br />carat: 1.02<br />price:  5367","Clarity: SI2<br />carat: 0.88<br />price:  3619","Clarity: VS2<br />carat: 0.31<br />price:   942","Clarity: VVS2<br />carat: 0.41<br />price:  1076","Clarity: SI1<br />carat: 1.11<br />price:  6065"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.31,0.331898734177215,0.35379746835443,0.375696202531646,0.397594936708861,0.419493670886076,0.441392405063291,0.463291139240506,0.485189873417722,0.507088607594937,0.528987341772152,0.550886075949367,0.572784810126582,0.594683544303797,0.616582278481013,0.638481012658228,0.660379746835443,0.682278481012658,0.704177215189873,0.726075949367089,0.747974683544304,0.769873417721519,0.791772151898734,0.813670886075949,0.835569620253165,0.85746835443038,0.879367088607595,0.90126582278481,0.923164556962025,0.94506329113924,0.966962025316456,0.988860759493671,1.01075949367089,1.0326582278481,1.05455696202532,1.07645569620253,1.09835443037975,1.12025316455696,1.14215189873418,1.16405063291139,1.18594936708861,1.20784810126582,1.22974683544304,1.25164556962025,1.27354430379747,1.29544303797468,1.3173417721519,1.33924050632911,1.36113924050633,1.38303797468354,1.40493670886076,1.42683544303797,1.44873417721519,1.47063291139241,1.49253164556962,1.51443037974684,1.53632911392405,1.55822784810127,1.58012658227848,1.6020253164557,1.62392405063291,1.64582278481013,1.66772151898734,1.68962025316456,1.71151898734177,1.73341772151899,1.7553164556962,1.77721518987342,1.79911392405063,1.82101265822785,1.84291139240506,1.86481012658228,1.88670886075949,1.90860759493671,1.93050632911392,1.95240506329114,1.97430379746835,1.99620253164557,2.01810126582278,2.04],"y":[629.473189288419,692.318001836931,757.715476580763,825.670615454333,896.18842039206,969.273893328363,1044.93203619766,1123.16785093437,1203.98633947292,1287.41442879644,1373.64821473479,1462.44118114579,1553.42245329974,1646.22115646693,1740.46641591765,1835.78735692218,1931.81310475081,2028.17278467384,2124.49552196154,2220.41044188422,2326.78726149874,2461.3171548076,2617.8107004671,2789.50857143308,2969.65144066141,3151.47998110793,3328.23486572848,3493.15676747892,3639.65628939095,3772.87679954182,3899.06613686927,4019.49635066309,4137.5579723647,4249.22137946651,4353.4638211773,4456.75183686504,4563.96935722696,4680.00031296031,4809.72863476231,4958.0382533302,5129.81309936121,5329.91158264363,5559.98081787329,5815.89854047437,6092.96685496654,6386.48786586945,6691.76367770275,7004.09639498608,7318.7881222391,7631.14096398146,7936.45702473282,8230.03840901281,8507.1872213411,8763.20556623733,8993.39554822117,9193.72240376467,9382.02234710701,9568.00041405749,9751.53816579318,9932.51716349113,10110.8189683284,10286.325141482,10458.917244129,10628.4768374465,10794.8854826116,10958.0247408012,11117.7761731924,11274.0213409623,11426.6418052879,11575.5191273463,11720.5348683146,11861.5705893697,11998.5078516888,12131.2282164489,12259.6132448271,12383.5444980003,12502.9035371457,12617.5719234403,12727.4312180612,12832.3629821853],"text":["cut: Fair<br />cut: Fair<br />carat: 0.31<br />price:   629","cut: Fair<br />cut: Fair<br />carat: 0.33<br />price:   692","cut: Fair<br />cut: Fair<br />carat: 0.35<br />price:   758","cut: Fair<br />cut: Fair<br />carat: 0.38<br />price:   826","cut: Fair<br />cut: Fair<br />carat: 0.40<br />price:   896","cut: Fair<br />cut: Fair<br />carat: 0.42<br />price:   969","cut: Fair<br />cut: Fair<br />carat: 0.44<br />price:  1045","cut: Fair<br />cut: Fair<br />carat: 0.46<br />price:  1123","cut: Fair<br />cut: Fair<br />carat: 0.49<br />price:  1204","cut: Fair<br />cut: Fair<br />carat: 0.51<br />price:  1287","cut: Fair<br />cut: Fair<br />carat: 0.53<br />price:  1374","cut: Fair<br />cut: Fair<br />carat: 0.55<br />price:  1462","cut: Fair<br />cut: Fair<br />carat: 0.57<br />price:  1553","cut: Fair<br />cut: Fair<br />carat: 0.59<br />price:  1646","cut: Fair<br />cut: Fair<br />carat: 0.62<br />price:  1740","cut: Fair<br />cut: Fair<br />carat: 0.64<br />price:  1836","cut: Fair<br />cut: Fair<br />carat: 0.66<br />price:  1932","cut: Fair<br />cut: Fair<br />carat: 0.68<br />price:  2028","cut: Fair<br />cut: Fair<br />carat: 0.70<br />price:  2124","cut: Fair<br />cut: Fair<br />carat: 0.73<br />price:  2220","cut: Fair<br />cut: Fair<br />carat: 0.75<br />price:  2327","cut: Fair<br />cut: Fair<br />carat: 0.77<br />price:  2461","cut: Fair<br />cut: Fair<br />carat: 0.79<br />price:  2618","cut: Fair<br />cut: Fair<br />carat: 0.81<br />price:  2790","cut: Fair<br />cut: Fair<br />carat: 0.84<br />price:  2970","cut: Fair<br />cut: Fair<br />carat: 0.86<br />price:  3151","cut: Fair<br />cut: Fair<br />carat: 0.88<br />price:  3328","cut: Fair<br />cut: Fair<br />carat: 0.90<br />price:  3493","cut: Fair<br />cut: Fair<br />carat: 0.92<br />price:  3640","cut: Fair<br />cut: Fair<br />carat: 0.95<br />price:  3773","cut: Fair<br />cut: Fair<br />carat: 0.97<br />price:  3899","cut: Fair<br />cut: Fair<br />carat: 0.99<br />price:  4019","cut: Fair<br />cut: Fair<br />carat: 1.01<br />price:  4138","cut: Fair<br />cut: Fair<br />carat: 1.03<br />price:  4249","cut: Fair<br />cut: Fair<br />carat: 1.05<br />price:  4353","cut: Fair<br />cut: Fair<br />carat: 1.08<br />price:  4457","cut: Fair<br />cut: Fair<br />carat: 1.10<br />price:  4564","cut: Fair<br />cut: Fair<br />carat: 1.12<br />price:  4680","cut: Fair<br />cut: Fair<br />carat: 1.14<br />price:  4810","cut: Fair<br />cut: Fair<br />carat: 1.16<br />price:  4958","cut: Fair<br />cut: Fair<br />carat: 1.19<br />price:  5130","cut: Fair<br />cut: Fair<br />carat: 1.21<br />price:  5330","cut: Fair<br />cut: Fair<br />carat: 1.23<br />price:  5560","cut: Fair<br />cut: Fair<br />carat: 1.25<br />price:  5816","cut: Fair<br />cut: Fair<br />carat: 1.27<br />price:  6093","cut: Fair<br />cut: Fair<br />carat: 1.30<br />price:  6386","cut: Fair<br />cut: Fair<br />carat: 1.32<br />price:  6692","cut: Fair<br />cut: Fair<br />carat: 1.34<br />price:  7004","cut: Fair<br />cut: Fair<br />carat: 1.36<br />price:  7319","cut: Fair<br />cut: Fair<br />carat: 1.38<br />price:  7631","cut: Fair<br />cut: Fair<br />carat: 1.40<br />price:  7936","cut: Fair<br />cut: Fair<br />carat: 1.43<br />price:  8230","cut: Fair<br />cut: Fair<br />carat: 1.45<br />price:  8507","cut: Fair<br />cut: Fair<br />carat: 1.47<br />price:  8763","cut: Fair<br />cut: Fair<br />carat: 1.49<br />price:  8993","cut: Fair<br />cut: Fair<br />carat: 1.51<br />price:  9194","cut: Fair<br />cut: Fair<br />carat: 1.54<br />price:  9382","cut: Fair<br />cut: Fair<br />carat: 1.56<br />price:  9568","cut: Fair<br />cut: Fair<br />carat: 1.58<br />price:  9752","cut: Fair<br />cut: Fair<br />carat: 1.60<br />price:  9933","cut: Fair<br />cut: Fair<br />carat: 1.62<br />price: 10111","cut: Fair<br />cut: Fair<br />carat: 1.65<br />price: 10286","cut: Fair<br />cut: Fair<br />carat: 1.67<br />price: 10459","cut: Fair<br />cut: Fair<br />carat: 1.69<br />price: 10628","cut: Fair<br />cut: Fair<br />carat: 1.71<br />price: 10795","cut: Fair<br />cut: Fair<br />carat: 1.73<br />price: 10958","cut: Fair<br />cut: Fair<br />carat: 1.76<br />price: 11118","cut: Fair<br />cut: Fair<br />carat: 1.78<br />price: 11274","cut: Fair<br />cut: Fair<br />carat: 1.80<br />price: 11427","cut: Fair<br />cut: Fair<br />carat: 1.82<br />price: 11576","cut: Fair<br />cut: Fair<br />carat: 1.84<br />price: 11721","cut: Fair<br />cut: Fair<br />carat: 1.86<br />price: 11862","cut: Fair<br />cut: Fair<br />carat: 1.89<br />price: 11999","cut: Fair<br />cut: Fair<br />carat: 1.91<br />price: 12131","cut: Fair<br />cut: Fair<br />carat: 1.93<br />price: 12260","cut: Fair<br />cut: Fair<br />carat: 1.95<br />price: 12384","cut: Fair<br />cut: Fair<br />carat: 1.97<br />price: 12503","cut: Fair<br />cut: Fair<br />carat: 2.00<br />price: 12618","cut: Fair<br />cut: Fair<br />carat: 2.02<br />price: 12727","cut: Fair<br />cut: Fair<br />carat: 2.04<br />price: 12832"],"type":"scatter","mode":"lines","name":"Fair","line":{"width":3.77952755905512,"color":"rgba(68,1,84,1)","dash":"solid"},"hoveron":"points","legendgroup":"Fair","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.3,0.321898734177215,0.34379746835443,0.365696202531646,0.387594936708861,0.409493670886076,0.431392405063291,0.453291139240506,0.475189873417721,0.497088607594937,0.518987341772152,0.540886075949367,0.562784810126582,0.584683544303797,0.606582278481013,0.628481012658228,0.650379746835443,0.672278481012658,0.694177215189873,0.716075949367089,0.737974683544304,0.759873417721519,0.781772151898734,0.803670886075949,0.825569620253164,0.84746835443038,0.869367088607595,0.89126582278481,0.913164556962025,0.93506329113924,0.956962025316456,0.978860759493671,1.00075949367089,1.0226582278481,1.04455696202532,1.06645569620253,1.08835443037975,1.11025316455696,1.13215189873418,1.15405063291139,1.17594936708861,1.19784810126582,1.21974683544304,1.24164556962025,1.26354430379747,1.28544303797468,1.3073417721519,1.32924050632911,1.35113924050633,1.37303797468354,1.39493670886076,1.41683544303797,1.43873417721519,1.46063291139241,1.48253164556962,1.50443037974684,1.52632911392405,1.54822784810127,1.57012658227848,1.5920253164557,1.61392405063291,1.63582278481013,1.65772151898734,1.67962025316456,1.70151898734177,1.72341772151899,1.7453164556962,1.76721518987342,1.78911392405063,1.81101265822785,1.83291139240506,1.85481012658228,1.87670886075949,1.89860759493671,1.92050632911392,1.94240506329114,1.96430379746835,1.98620253164557,2.00810126582278,2.03],"y":[518.035638865981,585.064831612091,654.918332044871,727.055067035451,802.246487976638,881.10940603673,964.255298378002,1050.81079986363,1140.17370345662,1232.88807725099,1329.49798934078,1430.54750782002,1536.58070078275,1648.14163632299,1765.77438253479,1897.82482683882,2055.75312432553,2235.23165196542,2431.64502177544,2640.37784577257,2856.81473597376,3076.34030439598,3294.3391630562,3506.19592397137,3707.29519915846,3893.02160063443,4060.58764207757,4221.97048911731,4380.58850732853,4536.8633849074,4691.21681005015,4844.07047095294,4995.7775287591,5137.40245070818,5302.71140233712,5465.83248254942,5627.1782684359,5787.16133708736,5946.19426559461,6104.68963104848,6263.06001053977,6421.71798115929,6581.07611999785,6741.54700414627,6903.54321069535,7067.47731673592,7233.76189935878,7402.80953565473,7575.03280271461,7750.84427762921,7930.65653748934,8114.88215938583,8303.93372040948,8498.2237976511,8698.16496820151,8904.16980915151,9116.50476873213,9333.02379092927,9552.95659000036,9776.38972695468,10003.4097628015,10234.1032585502,10468.55677521,10706.8568737901,10949.0901153,11195.3430607488,11445.7022711459,11700.2543075006,11959.0857308221,12222.2831021198,12489.9329824029,12762.1219326808,13038.9365139626,13320.4632872578,13606.7888135756,13897.9996539253,14194.1823693161,14495.4235207575,14801.8096692586,15113.4273758287],"text":["cut: Good<br />cut: Good<br />carat: 0.30<br />price:   518","cut: Good<br />cut: Good<br />carat: 0.32<br />price:   585","cut: Good<br />cut: Good<br />carat: 0.34<br />price:   655","cut: Good<br />cut: Good<br />carat: 0.37<br />price:   727","cut: Good<br />cut: Good<br />carat: 0.39<br />price:   802","cut: Good<br />cut: Good<br />carat: 0.41<br />price:   881","cut: Good<br />cut: Good<br />carat: 0.43<br />price:   964","cut: Good<br />cut: Good<br />carat: 0.45<br />price:  1051","cut: Good<br />cut: Good<br />carat: 0.48<br />price:  1140","cut: Good<br />cut: Good<br />carat: 0.50<br />price:  1233","cut: Good<br />cut: Good<br />carat: 0.52<br />price:  1329","cut: Good<br />cut: Good<br />carat: 0.54<br />price:  1431","cut: Good<br />cut: Good<br />carat: 0.56<br />price:  1537","cut: Good<br />cut: Good<br />carat: 0.58<br />price:  1648","cut: Good<br />cut: Good<br />carat: 0.61<br />price:  1766","cut: Good<br />cut: Good<br />carat: 0.63<br />price:  1898","cut: Good<br />cut: Good<br />carat: 0.65<br />price:  2056","cut: Good<br />cut: Good<br />carat: 0.67<br />price:  2235","cut: Good<br />cut: Good<br />carat: 0.69<br />price:  2432","cut: Good<br />cut: Good<br />carat: 0.72<br />price:  2640","cut: Good<br />cut: Good<br />carat: 0.74<br />price:  2857","cut: Good<br />cut: Good<br />carat: 0.76<br />price:  3076","cut: Good<br />cut: Good<br />carat: 0.78<br />price:  3294","cut: Good<br />cut: Good<br />carat: 0.80<br />price:  3506","cut: Good<br />cut: Good<br />carat: 0.83<br />price:  3707","cut: Good<br />cut: Good<br />carat: 0.85<br />price:  3893","cut: Good<br />cut: Good<br />carat: 0.87<br />price:  4061","cut: Good<br />cut: Good<br />carat: 0.89<br />price:  4222","cut: Good<br />cut: Good<br />carat: 0.91<br />price:  4381","cut: Good<br />cut: Good<br />carat: 0.94<br />price:  4537","cut: Good<br />cut: Good<br />carat: 0.96<br />price:  4691","cut: Good<br />cut: Good<br />carat: 0.98<br />price:  4844","cut: Good<br />cut: Good<br />carat: 1.00<br />price:  4996","cut: Good<br />cut: Good<br />carat: 1.02<br />price:  5137","cut: Good<br />cut: Good<br />carat: 1.04<br />price:  5303","cut: Good<br />cut: Good<br />carat: 1.07<br />price:  5466","cut: Good<br />cut: Good<br />carat: 1.09<br />price:  5627","cut: Good<br />cut: Good<br />carat: 1.11<br />price:  5787","cut: Good<br />cut: Good<br />carat: 1.13<br />price:  5946","cut: Good<br />cut: Good<br />carat: 1.15<br />price:  6105","cut: Good<br />cut: Good<br />carat: 1.18<br />price:  6263","cut: Good<br />cut: Good<br />carat: 1.20<br />price:  6422","cut: Good<br />cut: Good<br />carat: 1.22<br />price:  6581","cut: Good<br />cut: Good<br />carat: 1.24<br />price:  6742","cut: Good<br />cut: Good<br />carat: 1.26<br />price:  6904","cut: Good<br />cut: Good<br />carat: 1.29<br />price:  7067","cut: Good<br />cut: Good<br />carat: 1.31<br />price:  7234","cut: Good<br />cut: Good<br />carat: 1.33<br />price:  7403","cut: Good<br />cut: Good<br />carat: 1.35<br />price:  7575","cut: Good<br />cut: Good<br />carat: 1.37<br />price:  7751","cut: Good<br />cut: Good<br />carat: 1.39<br />price:  7931","cut: Good<br />cut: Good<br />carat: 1.42<br />price:  8115","cut: Good<br />cut: Good<br />carat: 1.44<br />price:  8304","cut: Good<br />cut: Good<br />carat: 1.46<br />price:  8498","cut: Good<br />cut: Good<br />carat: 1.48<br />price:  8698","cut: Good<br />cut: Good<br />carat: 1.50<br />price:  8904","cut: Good<br />cut: Good<br />carat: 1.53<br />price:  9117","cut: Good<br />cut: Good<br />carat: 1.55<br />price:  9333","cut: Good<br />cut: Good<br />carat: 1.57<br />price:  9553","cut: Good<br />cut: Good<br />carat: 1.59<br />price:  9776","cut: Good<br />cut: Good<br />carat: 1.61<br />price: 10003","cut: Good<br />cut: Good<br />carat: 1.64<br />price: 10234","cut: Good<br />cut: Good<br />carat: 1.66<br />price: 10469","cut: Good<br />cut: Good<br />carat: 1.68<br />price: 10707","cut: Good<br />cut: Good<br />carat: 1.70<br />price: 10949","cut: Good<br />cut: Good<br />carat: 1.72<br />price: 11195","cut: Good<br />cut: Good<br />carat: 1.75<br />price: 11446","cut: Good<br />cut: Good<br />carat: 1.77<br />price: 11700","cut: Good<br />cut: Good<br />carat: 1.79<br />price: 11959","cut: Good<br />cut: Good<br />carat: 1.81<br />price: 12222","cut: Good<br />cut: Good<br />carat: 1.83<br />price: 12490","cut: Good<br />cut: Good<br />carat: 1.85<br />price: 12762","cut: Good<br />cut: Good<br />carat: 1.88<br />price: 13039","cut: Good<br />cut: Good<br />carat: 1.90<br />price: 13320","cut: Good<br />cut: Good<br />carat: 1.92<br />price: 13607","cut: Good<br />cut: Good<br />carat: 1.94<br />price: 13898","cut: Good<br />cut: Good<br />carat: 1.96<br />price: 14194","cut: Good<br />cut: Good<br />carat: 1.99<br />price: 14495","cut: Good<br />cut: Good<br />carat: 2.01<br />price: 14802","cut: Good<br />cut: Good<br />carat: 2.03<br />price: 15113"],"type":"scatter","mode":"lines","name":"Good","line":{"width":3.77952755905512,"color":"rgba(59,82,139,1)","dash":"solid"},"hoveron":"points","legendgroup":"Good","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.23,0.255949367088608,0.281898734177215,0.307848101265823,0.33379746835443,0.359746835443038,0.385696202531646,0.411645569620253,0.437594936708861,0.463544303797468,0.489493670886076,0.515443037974683,0.541392405063291,0.567341772151899,0.593291139240506,0.619240506329114,0.645189873417721,0.671139240506329,0.697088607594937,0.723037974683544,0.748987341772152,0.774936708860759,0.800886075949367,0.826835443037975,0.852784810126582,0.87873417721519,0.904683544303797,0.930632911392405,0.956582278481013,0.98253164556962,1.00848101265823,1.03443037974684,1.06037974683544,1.08632911392405,1.11227848101266,1.13822784810127,1.16417721518987,1.19012658227848,1.21607594936709,1.2420253164557,1.2679746835443,1.29392405063291,1.31987341772152,1.34582278481013,1.37177215189873,1.39772151898734,1.42367088607595,1.44962025316456,1.47556962025316,1.50151898734177,1.52746835443038,1.55341772151899,1.57936708860759,1.6053164556962,1.63126582278481,1.65721518987342,1.68316455696203,1.70911392405063,1.73506329113924,1.76101265822785,1.78696202531646,1.81291139240506,1.83886075949367,1.86481012658228,1.89075949367089,1.91670886075949,1.9426582278481,1.96860759493671,1.99455696202532,2.02050632911392,2.04645569620253,2.07240506329114,2.09835443037975,2.12430379746835,2.15025316455696,2.17620253164557,2.20215189873418,2.22810126582278,2.25405063291139,2.28],"y":[480.078637451253,525.6503075204,578.371609515668,638.644665195793,706.321345676229,781.087949160534,862.872515829118,952.069417751453,1048.45039914771,1151.7161504183,1261.56736196364,1376.54206846365,1492.65599170763,1611.77769827624,1736.38989283068,1868.97528003215,2012.01656454185,2167.99645102096,2339.39764413069,2536.41251788364,2766.24403434379,3019.72124722415,3287.52532543466,3560.33743788521,3828.83875348575,4083.71044114618,4315.63366977643,4521.91888017138,4718.13803870661,4915.72962334646,5125.8351106665,5349.62174910343,5578.86768583202,5813.74645961726,6054.46392313878,6301.22592907616,6554.238330109,6813.7069789169,7079.83772817945,7349.98414186891,7619.21758473384,7887.37532929531,8154.38411971881,8420.17070016983,8684.66181481386,8947.78420781638,9209.46462334288,9469.62980555886,9728.20649862981,9985.12144672121,10240.3013939985,10493.6730846273,10745.163262773,10994.6986726011,11242.2060582771,11487.6121639665,11730.8437338348,11971.8275120474,12210.4902427699,12446.7586701677,12680.5595384063,12911.8195916513,13140.4655740681,13366.4242298222,13589.6223030791,13809.9865380042,14027.4436787632,14241.9204695214,14453.3436544443,14661.6399776974,14866.7361834463,15068.5590158564,15267.0352190932,15462.0915373222,15653.6547147089,15841.6514954187,16026.0086236172,16206.6528434699,16383.5108991422,16556.5095347996],"text":["cut: Very Good<br />cut: Very Good<br />carat: 0.23<br />price:   480","cut: Very Good<br />cut: Very Good<br />carat: 0.26<br />price:   526","cut: Very Good<br />cut: Very Good<br />carat: 0.28<br />price:   578","cut: Very Good<br />cut: Very Good<br />carat: 0.31<br />price:   639","cut: Very Good<br />cut: Very Good<br />carat: 0.33<br />price:   706","cut: Very Good<br />cut: Very Good<br />carat: 0.36<br />price:   781","cut: Very Good<br />cut: Very Good<br />carat: 0.39<br />price:   863","cut: Very Good<br />cut: Very Good<br />carat: 0.41<br />price:   952","cut: Very Good<br />cut: Very Good<br />carat: 0.44<br />price:  1048","cut: Very Good<br />cut: Very Good<br />carat: 0.46<br />price:  1152","cut: Very Good<br />cut: Very Good<br />carat: 0.49<br />price:  1262","cut: Very Good<br />cut: Very Good<br />carat: 0.52<br />price:  1377","cut: Very Good<br />cut: Very Good<br />carat: 0.54<br />price:  1493","cut: Very Good<br />cut: Very Good<br />carat: 0.57<br />price:  1612","cut: Very Good<br />cut: Very Good<br />carat: 0.59<br />price:  1736","cut: Very Good<br />cut: Very Good<br />carat: 0.62<br />price:  1869","cut: Very Good<br />cut: Very Good<br />carat: 0.65<br />price:  2012","cut: Very Good<br />cut: Very Good<br />carat: 0.67<br />price:  2168","cut: Very Good<br />cut: Very Good<br />carat: 0.70<br />price:  2339","cut: Very Good<br />cut: Very Good<br />carat: 0.72<br />price:  2536","cut: Very Good<br />cut: Very Good<br />carat: 0.75<br />price:  2766","cut: Very Good<br />cut: Very Good<br />carat: 0.77<br />price:  3020","cut: Very Good<br />cut: Very Good<br />carat: 0.80<br />price:  3288","cut: Very Good<br />cut: Very Good<br />carat: 0.83<br />price:  3560","cut: Very Good<br />cut: Very Good<br />carat: 0.85<br />price:  3829","cut: Very Good<br />cut: Very Good<br />carat: 0.88<br />price:  4084","cut: Very Good<br />cut: Very Good<br />carat: 0.90<br />price:  4316","cut: Very Good<br />cut: Very Good<br />carat: 0.93<br />price:  4522","cut: Very Good<br />cut: Very Good<br />carat: 0.96<br />price:  4718","cut: Very Good<br />cut: Very Good<br />carat: 0.98<br />price:  4916","cut: Very Good<br />cut: Very Good<br />carat: 1.01<br />price:  5126","cut: Very Good<br />cut: Very Good<br />carat: 1.03<br />price:  5350","cut: Very Good<br />cut: Very Good<br />carat: 1.06<br />price:  5579","cut: Very Good<br />cut: Very Good<br />carat: 1.09<br />price:  5814","cut: Very Good<br />cut: Very Good<br />carat: 1.11<br />price:  6054","cut: Very Good<br />cut: Very Good<br />carat: 1.14<br />price:  6301","cut: Very Good<br />cut: Very Good<br />carat: 1.16<br />price:  6554","cut: Very Good<br />cut: Very Good<br />carat: 1.19<br />price:  6814","cut: Very Good<br />cut: Very Good<br />carat: 1.22<br />price:  7080","cut: Very Good<br />cut: Very Good<br />carat: 1.24<br />price:  7350","cut: Very Good<br />cut: Very Good<br />carat: 1.27<br />price:  7619","cut: Very Good<br />cut: Very Good<br />carat: 1.29<br />price:  7887","cut: Very Good<br />cut: Very Good<br />carat: 1.32<br />price:  8154","cut: Very Good<br />cut: Very Good<br />carat: 1.35<br />price:  8420","cut: Very Good<br />cut: Very Good<br />carat: 1.37<br />price:  8685","cut: Very Good<br />cut: Very Good<br />carat: 1.40<br />price:  8948","cut: Very Good<br />cut: Very Good<br />carat: 1.42<br />price:  9209","cut: Very Good<br />cut: Very Good<br />carat: 1.45<br />price:  9470","cut: Very Good<br />cut: Very Good<br />carat: 1.48<br />price:  9728","cut: Very Good<br />cut: Very Good<br />carat: 1.50<br />price:  9985","cut: Very Good<br />cut: Very Good<br />carat: 1.53<br />price: 10240","cut: Very Good<br />cut: Very Good<br />carat: 1.55<br />price: 10494","cut: Very Good<br />cut: Very Good<br />carat: 1.58<br />price: 10745","cut: Very Good<br />cut: Very Good<br />carat: 1.61<br />price: 10995","cut: Very Good<br />cut: Very Good<br />carat: 1.63<br />price: 11242","cut: Very Good<br />cut: Very Good<br />carat: 1.66<br />price: 11488","cut: Very Good<br />cut: Very Good<br />carat: 1.68<br />price: 11731","cut: Very Good<br />cut: Very Good<br />carat: 1.71<br />price: 11972","cut: Very Good<br />cut: Very Good<br />carat: 1.74<br />price: 12210","cut: Very Good<br />cut: Very Good<br />carat: 1.76<br />price: 12447","cut: Very Good<br />cut: Very Good<br />carat: 1.79<br />price: 12681","cut: Very Good<br />cut: Very Good<br />carat: 1.81<br />price: 12912","cut: Very Good<br />cut: Very Good<br />carat: 1.84<br />price: 13140","cut: Very Good<br />cut: Very Good<br />carat: 1.86<br />price: 13366","cut: Very Good<br />cut: Very Good<br />carat: 1.89<br />price: 13590","cut: Very Good<br />cut: Very Good<br />carat: 1.92<br />price: 13810","cut: Very Good<br />cut: Very Good<br />carat: 1.94<br />price: 14027","cut: Very Good<br />cut: Very Good<br />carat: 1.97<br />price: 14242","cut: Very Good<br />cut: Very Good<br />carat: 1.99<br />price: 14453","cut: Very Good<br />cut: Very Good<br />carat: 2.02<br />price: 14662","cut: Very Good<br />cut: Very Good<br />carat: 2.05<br />price: 14867","cut: Very Good<br />cut: Very Good<br />carat: 2.07<br />price: 15069","cut: Very Good<br />cut: Very Good<br />carat: 2.10<br />price: 15267","cut: Very Good<br />cut: Very Good<br />carat: 2.12<br />price: 15462","cut: Very Good<br />cut: Very Good<br />carat: 2.15<br />price: 15654","cut: Very Good<br />cut: Very Good<br />carat: 2.18<br />price: 15842","cut: Very Good<br />cut: Very Good<br />carat: 2.20<br />price: 16026","cut: Very Good<br />cut: Very Good<br />carat: 2.23<br />price: 16207","cut: Very Good<br />cut: Very Good<br />carat: 2.25<br />price: 16384","cut: Very Good<br />cut: Very Good<br />carat: 2.28<br />price: 16557"],"type":"scatter","mode":"lines","name":"Very Good","line":{"width":3.77952755905512,"color":"rgba(33,144,140,1)","dash":"solid"},"hoveron":"points","legendgroup":"Very Good","showlegend":true,"xaxis":"x3","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.26,0.286075949367089,0.312151898734177,0.338227848101266,0.364303797468354,0.390379746835443,0.416455696202532,0.44253164556962,0.468607594936709,0.494683544303797,0.520759493670886,0.546835443037975,0.572911392405063,0.598987341772152,0.62506329113924,0.651139240506329,0.677215189873418,0.703291139240506,0.729367088607595,0.755443037974683,0.781518987341772,0.807594936708861,0.833670886075949,0.859746835443038,0.885822784810127,0.911898734177215,0.937974683544304,0.964050632911392,0.990126582278481,1.01620253164557,1.04227848101266,1.06835443037975,1.09443037974684,1.12050632911392,1.14658227848101,1.1726582278481,1.19873417721519,1.22481012658228,1.25088607594937,1.27696202531646,1.30303797468354,1.32911392405063,1.35518987341772,1.38126582278481,1.4073417721519,1.43341772151899,1.45949367088608,1.48556962025316,1.51164556962025,1.53772151898734,1.56379746835443,1.58987341772152,1.61594936708861,1.6420253164557,1.66810126582278,1.69417721518987,1.72025316455696,1.74632911392405,1.77240506329114,1.79848101265823,1.82455696202532,1.8506329113924,1.87670886075949,1.90278481012658,1.92886075949367,1.95493670886076,1.98101265822785,2.00708860759494,2.03316455696203,2.05924050632911,2.0853164556962,2.11139240506329,2.13746835443038,2.16354430379747,2.18962025316456,2.21569620253165,2.24177215189873,2.26784810126582,2.29392405063291,2.32],"y":[642.423440578926,689.993204482753,744.549836561906,805.855291560251,874.722355261214,951.22738678844,1035.41118922259,1126.64729357526,1225.00972357379,1330.93490304615,1444.85925582033,1567.21920572433,1698.50727259322,1844.04588715896,2005.68639168818,2181.40536390939,2369.17938155111,2566.98502234183,2772.79886401006,2984.59748428431,3200.35746089309,3418.05537156491,3635.66779402826,3851.17130601166,4062.54248524361,4267.75790945262,4463.0878233558,4631.4329664162,4797.29811820734,4995.46448375438,5214.18262083838,5439.40635466104,5669.86234436389,5904.27724908846,6141.37772797628,6379.89044016889,6618.54204480782,6858.43684594243,7101.58453944068,7347.36994837486,7595.17196277503,7844.36947267125,8094.34136809359,8344.46653907212,8594.12387563689,8842.69226781797,9089.55060564543,9334.07777914933,9575.65267835974,9813.99129890401,10049.8064575186,10283.1502842868,10514.0104035904,10742.3744398112,10968.2300173313,11191.5647605324,11412.3662937964,11630.6222415052,11846.3202280407,12059.4478777848,12269.9928151193,12477.9426644261,12683.2850500871,12886.0075964841,13086.0979279991,13283.5436690139,13478.3324439104,13670.4518770704,13859.8895928759,14046.6332157087,14230.6703699507,14411.9886799838,14590.5757701899,14766.4192649507,14939.5067886483,15109.8259656644,15277.3644203811,15442.10977718,15604.0496604431,15763.1716945524],"text":["cut: Premium<br />cut: Premium<br />carat: 0.26<br />price:   642","cut: Premium<br />cut: Premium<br />carat: 0.29<br />price:   690","cut: Premium<br />cut: Premium<br />carat: 0.31<br />price:   745","cut: Premium<br />cut: Premium<br />carat: 0.34<br />price:   806","cut: Premium<br />cut: Premium<br />carat: 0.36<br />price:   875","cut: Premium<br />cut: Premium<br />carat: 0.39<br />price:   951","cut: Premium<br />cut: Premium<br />carat: 0.42<br />price:  1035","cut: Premium<br />cut: Premium<br />carat: 0.44<br />price:  1127","cut: Premium<br />cut: Premium<br />carat: 0.47<br />price:  1225","cut: Premium<br />cut: Premium<br />carat: 0.49<br />price:  1331","cut: Premium<br />cut: Premium<br />carat: 0.52<br />price:  1445","cut: Premium<br />cut: Premium<br />carat: 0.55<br />price:  1567","cut: Premium<br />cut: Premium<br />carat: 0.57<br />price:  1699","cut: Premium<br />cut: Premium<br />carat: 0.60<br />price:  1844","cut: Premium<br />cut: Premium<br />carat: 0.63<br />price:  2006","cut: Premium<br />cut: Premium<br />carat: 0.65<br />price:  2181","cut: Premium<br />cut: Premium<br />carat: 0.68<br />price:  2369","cut: Premium<br />cut: Premium<br />carat: 0.70<br />price:  2567","cut: Premium<br />cut: Premium<br />carat: 0.73<br />price:  2773","cut: Premium<br />cut: Premium<br />carat: 0.76<br />price:  2985","cut: Premium<br />cut: Premium<br />carat: 0.78<br />price:  3200","cut: Premium<br />cut: Premium<br />carat: 0.81<br />price:  3418","cut: Premium<br />cut: Premium<br />carat: 0.83<br />price:  3636","cut: Premium<br />cut: Premium<br />carat: 0.86<br />price:  3851","cut: Premium<br />cut: Premium<br />carat: 0.89<br />price:  4063","cut: Premium<br />cut: Premium<br />carat: 0.91<br />price:  4268","cut: Premium<br />cut: Premium<br />carat: 0.94<br />price:  4463","cut: Premium<br />cut: Premium<br />carat: 0.96<br />price:  4631","cut: Premium<br />cut: Premium<br />carat: 0.99<br />price:  4797","cut: Premium<br />cut: Premium<br />carat: 1.02<br />price:  4995","cut: Premium<br />cut: Premium<br />carat: 1.04<br />price:  5214","cut: Premium<br />cut: Premium<br />carat: 1.07<br />price:  5439","cut: Premium<br />cut: Premium<br />carat: 1.09<br />price:  5670","cut: Premium<br />cut: Premium<br />carat: 1.12<br />price:  5904","cut: Premium<br />cut: Premium<br />carat: 1.15<br />price:  6141","cut: Premium<br />cut: Premium<br />carat: 1.17<br />price:  6380","cut: Premium<br />cut: Premium<br />carat: 1.20<br />price:  6619","cut: Premium<br />cut: Premium<br />carat: 1.22<br />price:  6858","cut: Premium<br />cut: Premium<br />carat: 1.25<br />price:  7102","cut: Premium<br />cut: Premium<br />carat: 1.28<br />price:  7347","cut: Premium<br />cut: Premium<br />carat: 1.30<br />price:  7595","cut: Premium<br />cut: Premium<br />carat: 1.33<br />price:  7844","cut: Premium<br />cut: Premium<br />carat: 1.36<br />price:  8094","cut: Premium<br />cut: Premium<br />carat: 1.38<br />price:  8344","cut: Premium<br />cut: Premium<br />carat: 1.41<br />price:  8594","cut: Premium<br />cut: Premium<br />carat: 1.43<br />price:  8843","cut: Premium<br />cut: Premium<br />carat: 1.46<br />price:  9090","cut: Premium<br />cut: Premium<br />carat: 1.49<br />price:  9334","cut: Premium<br />cut: Premium<br />carat: 1.51<br />price:  9576","cut: Premium<br />cut: Premium<br />carat: 1.54<br />price:  9814","cut: Premium<br />cut: Premium<br />carat: 1.56<br />price: 10050","cut: Premium<br />cut: Premium<br />carat: 1.59<br />price: 10283","cut: Premium<br />cut: Premium<br />carat: 1.62<br />price: 10514","cut: Premium<br />cut: Premium<br />carat: 1.64<br />price: 10742","cut: Premium<br />cut: Premium<br />carat: 1.67<br />price: 10968","cut: Premium<br />cut: Premium<br />carat: 1.69<br />price: 11192","cut: Premium<br />cut: Premium<br />carat: 1.72<br />price: 11412","cut: Premium<br />cut: Premium<br />carat: 1.75<br />price: 11631","cut: Premium<br />cut: Premium<br />carat: 1.77<br />price: 11846","cut: Premium<br />cut: Premium<br />carat: 1.80<br />price: 12059","cut: Premium<br />cut: Premium<br />carat: 1.82<br />price: 12270","cut: Premium<br />cut: Premium<br />carat: 1.85<br />price: 12478","cut: Premium<br />cut: Premium<br />carat: 1.88<br />price: 12683","cut: Premium<br />cut: Premium<br />carat: 1.90<br />price: 12886","cut: Premium<br />cut: Premium<br />carat: 1.93<br />price: 13086","cut: Premium<br />cut: Premium<br />carat: 1.95<br />price: 13284","cut: Premium<br />cut: Premium<br />carat: 1.98<br />price: 13478","cut: Premium<br />cut: Premium<br />carat: 2.01<br />price: 13670","cut: Premium<br />cut: Premium<br />carat: 2.03<br />price: 13860","cut: Premium<br />cut: Premium<br />carat: 2.06<br />price: 14047","cut: Premium<br />cut: Premium<br />carat: 2.09<br />price: 14231","cut: Premium<br />cut: Premium<br />carat: 2.11<br />price: 14412","cut: Premium<br />cut: Premium<br />carat: 2.14<br />price: 14591","cut: Premium<br />cut: Premium<br />carat: 2.16<br />price: 14766","cut: Premium<br />cut: Premium<br />carat: 2.19<br />price: 14940","cut: Premium<br />cut: Premium<br />carat: 2.22<br />price: 15110","cut: Premium<br />cut: Premium<br />carat: 2.24<br />price: 15277","cut: Premium<br />cut: Premium<br />carat: 2.27<br />price: 15442","cut: Premium<br />cut: Premium<br />carat: 2.29<br />price: 15604","cut: Premium<br />cut: Premium<br />carat: 2.32<br />price: 15763"],"type":"scatter","mode":"lines","name":"Premium","line":{"width":3.77952755905512,"color":"rgba(93,200,99,1)","dash":"solid"},"hoveron":"points","legendgroup":"Premium","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.2,0.226835443037975,0.253670886075949,0.280506329113924,0.307341772151899,0.334177215189873,0.361012658227848,0.387848101265823,0.414683544303797,0.441518987341772,0.468354430379747,0.495189873417721,0.522025316455696,0.548860759493671,0.575696202531645,0.60253164556962,0.629367088607595,0.65620253164557,0.683037974683544,0.709873417721519,0.736708860759494,0.763544303797468,0.790379746835443,0.817215189873418,0.844050632911392,0.870886075949367,0.897721518987342,0.924556962025316,0.951392405063291,0.978227848101266,1.00506329113924,1.03189873417722,1.05873417721519,1.08556962025316,1.11240506329114,1.13924050632911,1.16607594936709,1.19291139240506,1.21974683544304,1.24658227848101,1.27341772151899,1.30025316455696,1.32708860759494,1.35392405063291,1.38075949367089,1.40759493670886,1.43443037974684,1.46126582278481,1.48810126582278,1.51493670886076,1.54177215189873,1.56860759493671,1.59544303797468,1.62227848101266,1.64911392405063,1.67594936708861,1.70278481012658,1.72962025316456,1.75645569620253,1.78329113924051,1.81012658227848,1.83696202531646,1.86379746835443,1.8906329113924,1.91746835443038,1.94430379746835,1.97113924050633,1.9979746835443,2.02481012658228,2.05164556962025,2.07848101265823,2.1053164556962,2.13215189873418,2.15898734177215,2.18582278481013,2.2126582278481,2.23949367088608,2.26632911392405,2.29316455696203,2.32],"y":[485.165079201572,531.943552163238,586.629829136053,650.258774310336,723.865251876407,807.352155120954,899.280137264267,999.917329585717,1109.70388703194,1226.46335780312,1352.99496513398,1488.56499478015,1631.31320612979,1779.37935857107,1931.4405179772,2089.1658665057,2253.74108499483,2426.16329977973,2607.4296371955,2798.53722357727,3000.42237773148,3212.31629439203,3433.17881455919,3662.36290724197,3899.2215414494,4143.10768619052,4393.37431047435,4649.37438330992,4910.46087370624,5175.98675067236,5445.30498321731,5718.46529145926,5999.77635488904,6288.76709968621,6583.81829418242,6883.31070670928,7185.62510559843,7489.1422591815,7791.48948125594,8089.93316570115,8384.36700416359,8674.80072402472,8961.24405266605,9243.70671746903,9522.19844581515,9796.72896508588,10067.3080026627,10333.9452859271,10596.6505422605,10855.4334990445,11110.3038836605,11361.2714234899,11608.3458459144,11851.5368783152,12090.854248074,12326.3076825721,12557.9069091911,12785.6616553125,13009.5816483177,13229.6766155882,13445.9562845055,13658.430382451,13867.1086368063,14072.0007749528,14273.116524272,14470.4656121454,14664.0577659544,14853.9027130805,15040.0101809052,15222.38989681,15401.0515881764,15576.0049823858,15747.2598068197,15914.8257888596,16078.712655887,16238.9301352833,16395.4879544301,16548.3958407087,16697.6635215008,16843.3007241877],"text":["cut: Ideal<br />cut: Ideal<br />carat: 0.20<br />price:   485","cut: Ideal<br />cut: Ideal<br />carat: 0.23<br />price:   532","cut: Ideal<br />cut: Ideal<br />carat: 0.25<br />price:   587","cut: Ideal<br />cut: Ideal<br />carat: 0.28<br />price:   650","cut: Ideal<br />cut: Ideal<br />carat: 0.31<br />price:   724","cut: Ideal<br />cut: Ideal<br />carat: 0.33<br />price:   807","cut: Ideal<br />cut: Ideal<br />carat: 0.36<br />price:   899","cut: Ideal<br />cut: Ideal<br />carat: 0.39<br />price:  1000","cut: Ideal<br />cut: Ideal<br />carat: 0.41<br />price:  1110","cut: Ideal<br />cut: Ideal<br />carat: 0.44<br />price:  1226","cut: Ideal<br />cut: Ideal<br />carat: 0.47<br />price:  1353","cut: Ideal<br />cut: Ideal<br />carat: 0.50<br />price:  1489","cut: Ideal<br />cut: Ideal<br />carat: 0.52<br />price:  1631","cut: Ideal<br />cut: Ideal<br />carat: 0.55<br />price:  1779","cut: Ideal<br />cut: Ideal<br />carat: 0.58<br />price:  1931","cut: Ideal<br />cut: Ideal<br />carat: 0.60<br />price:  2089","cut: Ideal<br />cut: Ideal<br />carat: 0.63<br />price:  2254","cut: Ideal<br />cut: Ideal<br />carat: 0.66<br />price:  2426","cut: Ideal<br />cut: Ideal<br />carat: 0.68<br />price:  2607","cut: Ideal<br />cut: Ideal<br />carat: 0.71<br />price:  2799","cut: Ideal<br />cut: Ideal<br />carat: 0.74<br />price:  3000","cut: Ideal<br />cut: Ideal<br />carat: 0.76<br />price:  3212","cut: Ideal<br />cut: Ideal<br />carat: 0.79<br />price:  3433","cut: Ideal<br />cut: Ideal<br />carat: 0.82<br />price:  3662","cut: Ideal<br />cut: Ideal<br />carat: 0.84<br />price:  3899","cut: Ideal<br />cut: Ideal<br />carat: 0.87<br />price:  4143","cut: Ideal<br />cut: Ideal<br />carat: 0.90<br />price:  4393","cut: Ideal<br />cut: Ideal<br />carat: 0.92<br />price:  4649","cut: Ideal<br />cut: Ideal<br />carat: 0.95<br />price:  4910","cut: Ideal<br />cut: Ideal<br />carat: 0.98<br />price:  5176","cut: Ideal<br />cut: Ideal<br />carat: 1.01<br />price:  5445","cut: Ideal<br />cut: Ideal<br />carat: 1.03<br />price:  5718","cut: Ideal<br />cut: Ideal<br />carat: 1.06<br />price:  6000","cut: Ideal<br />cut: Ideal<br />carat: 1.09<br />price:  6289","cut: Ideal<br />cut: Ideal<br />carat: 1.11<br />price:  6584","cut: Ideal<br />cut: Ideal<br />carat: 1.14<br />price:  6883","cut: Ideal<br />cut: Ideal<br />carat: 1.17<br />price:  7186","cut: Ideal<br />cut: Ideal<br />carat: 1.19<br />price:  7489","cut: Ideal<br />cut: Ideal<br />carat: 1.22<br />price:  7791","cut: Ideal<br />cut: Ideal<br />carat: 1.25<br />price:  8090","cut: Ideal<br />cut: Ideal<br />carat: 1.27<br />price:  8384","cut: Ideal<br />cut: Ideal<br />carat: 1.30<br />price:  8675","cut: Ideal<br />cut: Ideal<br />carat: 1.33<br />price:  8961","cut: Ideal<br />cut: Ideal<br />carat: 1.35<br />price:  9244","cut: Ideal<br />cut: Ideal<br />carat: 1.38<br />price:  9522","cut: Ideal<br />cut: Ideal<br />carat: 1.41<br />price:  9797","cut: Ideal<br />cut: Ideal<br />carat: 1.43<br />price: 10067","cut: Ideal<br />cut: Ideal<br />carat: 1.46<br />price: 10334","cut: Ideal<br />cut: Ideal<br />carat: 1.49<br />price: 10597","cut: Ideal<br />cut: Ideal<br />carat: 1.51<br />price: 10855","cut: Ideal<br />cut: Ideal<br />carat: 1.54<br />price: 11110","cut: Ideal<br />cut: Ideal<br />carat: 1.57<br />price: 11361","cut: Ideal<br />cut: Ideal<br />carat: 1.60<br />price: 11608","cut: Ideal<br />cut: Ideal<br />carat: 1.62<br />price: 11852","cut: Ideal<br />cut: Ideal<br />carat: 1.65<br />price: 12091","cut: Ideal<br />cut: Ideal<br />carat: 1.68<br />price: 12326","cut: Ideal<br />cut: Ideal<br />carat: 1.70<br />price: 12558","cut: Ideal<br />cut: Ideal<br />carat: 1.73<br />price: 12786","cut: Ideal<br />cut: Ideal<br />carat: 1.76<br />price: 13010","cut: Ideal<br />cut: Ideal<br />carat: 1.78<br />price: 13230","cut: Ideal<br />cut: Ideal<br />carat: 1.81<br />price: 13446","cut: Ideal<br />cut: Ideal<br />carat: 1.84<br />price: 13658","cut: Ideal<br />cut: Ideal<br />carat: 1.86<br />price: 13867","cut: Ideal<br />cut: Ideal<br />carat: 1.89<br />price: 14072","cut: Ideal<br />cut: Ideal<br />carat: 1.92<br />price: 14273","cut: Ideal<br />cut: Ideal<br />carat: 1.94<br />price: 14470","cut: Ideal<br />cut: Ideal<br />carat: 1.97<br />price: 14664","cut: Ideal<br />cut: Ideal<br />carat: 2.00<br />price: 14854","cut: Ideal<br />cut: Ideal<br />carat: 2.02<br />price: 15040","cut: Ideal<br />cut: Ideal<br />carat: 2.05<br />price: 15222","cut: Ideal<br />cut: Ideal<br />carat: 2.08<br />price: 15401","cut: Ideal<br />cut: Ideal<br />carat: 2.11<br />price: 15576","cut: Ideal<br />cut: Ideal<br />carat: 2.13<br />price: 15747","cut: Ideal<br />cut: Ideal<br />carat: 2.16<br />price: 15915","cut: Ideal<br />cut: Ideal<br />carat: 2.19<br />price: 16079","cut: Ideal<br />cut: Ideal<br />carat: 2.21<br />price: 16239","cut: Ideal<br />cut: Ideal<br />carat: 2.24<br />price: 16395","cut: Ideal<br />cut: Ideal<br />carat: 2.27<br />price: 16548","cut: Ideal<br />cut: Ideal<br />carat: 2.29<br />price: 16698","cut: Ideal<br />cut: Ideal<br />carat: 2.32<br />price: 16843"],"type":"scatter","mode":"lines","name":"Ideal","line":{"width":3.77952755905512,"color":"rgba(253,231,37,1)","dash":"solid"},"hoveron":"points","legendgroup":"Ideal","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.31,0.331898734177215,0.35379746835443,0.375696202531646,0.397594936708861,0.419493670886076,0.441392405063291,0.463291139240506,0.485189873417722,0.507088607594937,0.528987341772152,0.550886075949367,0.572784810126582,0.594683544303797,0.616582278481013,0.638481012658228,0.660379746835443,0.682278481012658,0.704177215189873,0.726075949367089,0.747974683544304,0.769873417721519,0.791772151898734,0.813670886075949,0.835569620253165,0.85746835443038,0.879367088607595,0.90126582278481,0.923164556962025,0.94506329113924,0.966962025316456,0.988860759493671,1.01075949367089,1.0326582278481,1.05455696202532,1.07645569620253,1.09835443037975,1.12025316455696,1.14215189873418,1.16405063291139,1.18594936708861,1.20784810126582,1.22974683544304,1.25164556962025,1.27354430379747,1.29544303797468,1.3173417721519,1.33924050632911,1.36113924050633,1.38303797468354,1.40493670886076,1.42683544303797,1.44873417721519,1.47063291139241,1.49253164556962,1.51443037974684,1.53632911392405,1.55822784810127,1.58012658227848,1.6020253164557,1.62392405063291,1.64582278481013,1.66772151898734,1.68962025316456,1.71151898734177,1.73341772151899,1.7553164556962,1.77721518987342,1.79911392405063,1.82101265822785,1.84291139240506,1.86481012658228,1.88670886075949,1.90860759493671,1.93050632911392,1.95240506329114,1.97430379746835,1.99620253164557,2.01810126582278,2.04,2.04,2.01810126582278,1.99620253164557,1.97430379746835,1.95240506329114,1.93050632911392,1.90860759493671,1.88670886075949,1.86481012658228,1.84291139240506,1.82101265822785,1.79911392405063,1.77721518987342,1.7553164556962,1.73341772151899,1.71151898734177,1.68962025316456,1.66772151898734,1.64582278481013,1.62392405063291,1.6020253164557,1.58012658227848,1.55822784810127,1.53632911392405,1.51443037974684,1.49253164556962,1.47063291139241,1.44873417721519,1.42683544303797,1.40493670886076,1.38303797468354,1.36113924050633,1.33924050632911,1.3173417721519,1.29544303797468,1.27354430379747,1.25164556962025,1.22974683544304,1.20784810126582,1.18594936708861,1.16405063291139,1.14215189873418,1.12025316455696,1.09835443037975,1.07645569620253,1.05455696202532,1.0326582278481,1.01075949367089,0.988860759493671,0.966962025316456,0.94506329113924,0.923164556962025,0.90126582278481,0.879367088607595,0.85746835443038,0.835569620253165,0.813670886075949,0.791772151898734,0.769873417721519,0.747974683544304,0.726075949367089,0.704177215189873,0.682278481012658,0.660379746835443,0.638481012658228,0.616582278481013,0.594683544303797,0.572784810126582,0.550886075949367,0.528987341772152,0.507088607594937,0.485189873417722,0.463291139240506,0.441392405063291,0.419493670886076,0.397594936708861,0.375696202531646,0.35379746835443,0.331898734177215,0.31,0.31],"y":[-2677.07480462476,-2184.02544682885,-1743.11213308119,-1356.80015190166,-1027.26572640321,-755.298967501737,-538.772632721459,-371.413862300096,-242.966669065703,-140.525032325417,-45.610103179934,49.7292603918461,145.868550989284,240.725609425285,332.081355554154,419.208476159882,503.702678405056,589.479381153784,682.063938461559,787.378909742754,930.702995929791,1140.27524855358,1389.99262081492,1649.74175182857,1892.48479567033,2102.52627387207,2281.05920631104,2442.62689887313,2605.0017867157,2779.86253386965,2939.99609674541,3067.99661282515,3177.20127404031,3268.09117030149,3327.2656958384,3345.66983270643,3327.54590619052,3291.23009497766,3262.32926964015,3267.94168060582,3333.94503084721,3482.01466933108,3701.55026453889,3975.40192761128,4289.36158545744,4628.78447604082,4979.18925877946,5327.16837082388,5661.5735443674,5974.65969395635,6262.67285250171,6525.52761114197,6765.69042922923,6986.73306889552,7191.95835921289,7383.53786755517,7572.71458211268,7764.58542386892,7958.80715953545,8154.97955568987,8352.63490502452,8551.22482393686,8750.10400222108,8948.51068828423,9145.54397167777,9340.1384959378,9531.03825470933,9716.77275435929,9895.64112918928,10065.7125117337,10224.8531702612,10370.7907739684,10501.2211504662,10613.9515107669,10707.0584107049,10779.025953749,10828.8292438511,10855.9435709067,10860.2841760325,10842.1013454249,14822.6246189458,14594.5782600899,14379.2002759739,14176.9778304403,13988.0630422516,13812.1680789492,13648.5049221309,13495.7945529115,13352.3504047711,13216.216566368,13085.325742959,12957.6424813865,12831.2699275653,12704.5140916754,12575.9109856645,12444.2269935453,12308.4429866088,12167.730486037,12021.4254590271,11869.0030316322,11710.0547712924,11544.2691720509,11371.4154042461,11191.3301121013,11003.9069399742,10794.8327372294,10539.6780635791,10248.684013453,9934.54920688365,9610.24119696392,9287.62223400658,8976.0027001108,8681.02441914828,8404.33809662604,8144.19125569809,7896.57212447565,7656.39515333746,7418.41137120768,7177.80849595617,6925.6811678752,6648.13482605457,6357.12799988447,6068.77053094296,5800.39280826341,5567.83384102365,5379.66194651619,5230.35158863153,5097.91467068908,4970.99608850103,4858.13617699313,4765.89106521399,4674.31079206619,4543.68663608472,4375.41052514593,4200.43368834378,4046.8180856525,3929.27539103759,3845.62878011927,3782.35906106161,3722.87152706769,3653.44197402569,3566.92710546153,3466.86618819389,3359.92353109656,3252.36623768447,3148.85147628114,3051.71670350858,2960.9763556102,2875.15310189973,2792.90653264951,2715.3538899183,2650.93934801154,2617.74956416884,2628.63670511678,2693.84675415846,2819.64256718733,3008.14138281033,3258.54308624272,3568.66145050272,3936.0211832016,-2677.07480462476],"text":["cut: Fair<br />cut: Fair<br />carat: 0.31<br />price:   629","cut: Fair<br />cut: Fair<br />carat: 0.33<br />price:   692","cut: Fair<br />cut: Fair<br />carat: 0.35<br />price:   758","cut: Fair<br />cut: Fair<br />carat: 0.38<br />price:   826","cut: Fair<br />cut: Fair<br />carat: 0.40<br />price:   896","cut: Fair<br />cut: Fair<br />carat: 0.42<br />price:   969","cut: Fair<br />cut: Fair<br />carat: 0.44<br />price:  1045","cut: Fair<br />cut: Fair<br />carat: 0.46<br />price:  1123","cut: Fair<br />cut: Fair<br />carat: 0.49<br />price:  1204","cut: Fair<br />cut: Fair<br />carat: 0.51<br />price:  1287","cut: Fair<br />cut: Fair<br />carat: 0.53<br />price:  1374","cut: Fair<br />cut: Fair<br />carat: 0.55<br />price:  1462","cut: Fair<br />cut: Fair<br />carat: 0.57<br />price:  1553","cut: Fair<br />cut: Fair<br />carat: 0.59<br />price:  1646","cut: Fair<br />cut: Fair<br />carat: 0.62<br />price:  1740","cut: Fair<br />cut: Fair<br />carat: 0.64<br />price:  1836","cut: Fair<br />cut: Fair<br />carat: 0.66<br />price:  1932","cut: Fair<br />cut: Fair<br />carat: 0.68<br />price:  2028","cut: Fair<br />cut: Fair<br />carat: 0.70<br />price:  2124","cut: Fair<br />cut: Fair<br />carat: 0.73<br />price:  2220","cut: Fair<br />cut: Fair<br />carat: 0.75<br />price:  2327","cut: Fair<br />cut: Fair<br />carat: 0.77<br />price:  2461","cut: Fair<br />cut: Fair<br />carat: 0.79<br />price:  2618","cut: Fair<br />cut: Fair<br />carat: 0.81<br />price:  2790","cut: Fair<br />cut: Fair<br />carat: 0.84<br />price:  2970","cut: Fair<br />cut: Fair<br />carat: 0.86<br />price:  3151","cut: Fair<br />cut: Fair<br />carat: 0.88<br />price:  3328","cut: Fair<br />cut: Fair<br />carat: 0.90<br />price:  3493","cut: Fair<br />cut: Fair<br />carat: 0.92<br />price:  3640","cut: Fair<br />cut: Fair<br />carat: 0.95<br />price:  3773","cut: Fair<br />cut: Fair<br />carat: 0.97<br />price:  3899","cut: Fair<br />cut: Fair<br />carat: 0.99<br />price:  4019","cut: Fair<br />cut: Fair<br />carat: 1.01<br />price:  4138","cut: Fair<br />cut: Fair<br />carat: 1.03<br />price:  4249","cut: Fair<br />cut: Fair<br />carat: 1.05<br />price:  4353","cut: Fair<br />cut: Fair<br />carat: 1.08<br />price:  4457","cut: Fair<br />cut: Fair<br />carat: 1.10<br />price:  4564","cut: Fair<br />cut: Fair<br />carat: 1.12<br />price:  4680","cut: Fair<br />cut: Fair<br />carat: 1.14<br />price:  4810","cut: Fair<br />cut: Fair<br />carat: 1.16<br />price:  4958","cut: Fair<br />cut: Fair<br />carat: 1.19<br />price:  5130","cut: Fair<br />cut: Fair<br />carat: 1.21<br />price:  5330","cut: Fair<br />cut: Fair<br />carat: 1.23<br />price:  5560","cut: Fair<br />cut: Fair<br />carat: 1.25<br />price:  5816","cut: Fair<br />cut: Fair<br />carat: 1.27<br />price:  6093","cut: Fair<br />cut: Fair<br />carat: 1.30<br />price:  6386","cut: Fair<br />cut: Fair<br />carat: 1.32<br />price:  6692","cut: Fair<br />cut: Fair<br />carat: 1.34<br />price:  7004","cut: Fair<br />cut: Fair<br />carat: 1.36<br />price:  7319","cut: Fair<br />cut: Fair<br />carat: 1.38<br />price:  7631","cut: Fair<br />cut: Fair<br />carat: 1.40<br />price:  7936","cut: Fair<br />cut: Fair<br />carat: 1.43<br />price:  8230","cut: Fair<br />cut: Fair<br />carat: 1.45<br />price:  8507","cut: Fair<br />cut: Fair<br />carat: 1.47<br />price:  8763","cut: Fair<br />cut: Fair<br />carat: 1.49<br />price:  8993","cut: Fair<br />cut: Fair<br />carat: 1.51<br />price:  9194","cut: Fair<br />cut: Fair<br />carat: 1.54<br />price:  9382","cut: Fair<br />cut: Fair<br />carat: 1.56<br />price:  9568","cut: Fair<br />cut: Fair<br />carat: 1.58<br />price:  9752","cut: Fair<br />cut: Fair<br />carat: 1.60<br />price:  9933","cut: Fair<br />cut: Fair<br />carat: 1.62<br />price: 10111","cut: Fair<br />cut: Fair<br />carat: 1.65<br />price: 10286","cut: Fair<br />cut: Fair<br />carat: 1.67<br />price: 10459","cut: Fair<br />cut: Fair<br />carat: 1.69<br />price: 10628","cut: Fair<br />cut: Fair<br />carat: 1.71<br />price: 10795","cut: Fair<br />cut: Fair<br />carat: 1.73<br />price: 10958","cut: Fair<br />cut: Fair<br />carat: 1.76<br />price: 11118","cut: Fair<br />cut: Fair<br />carat: 1.78<br />price: 11274","cut: Fair<br />cut: Fair<br />carat: 1.80<br />price: 11427","cut: Fair<br />cut: Fair<br />carat: 1.82<br />price: 11576","cut: Fair<br />cut: Fair<br />carat: 1.84<br />price: 11721","cut: Fair<br />cut: Fair<br />carat: 1.86<br />price: 11862","cut: Fair<br />cut: Fair<br />carat: 1.89<br />price: 11999","cut: Fair<br />cut: Fair<br />carat: 1.91<br />price: 12131","cut: Fair<br />cut: Fair<br />carat: 1.93<br />price: 12260","cut: Fair<br />cut: Fair<br />carat: 1.95<br />price: 12384","cut: Fair<br />cut: Fair<br />carat: 1.97<br />price: 12503","cut: Fair<br />cut: Fair<br />carat: 2.00<br />price: 12618","cut: Fair<br />cut: Fair<br />carat: 2.02<br />price: 12727","cut: Fair<br />cut: Fair<br />carat: 2.04<br />price: 12832","cut: Fair<br />cut: Fair<br />carat: 2.04<br />price: 12832","cut: Fair<br />cut: Fair<br />carat: 2.02<br />price: 12727","cut: Fair<br />cut: Fair<br />carat: 2.00<br />price: 12618","cut: Fair<br />cut: Fair<br />carat: 1.97<br />price: 12503","cut: Fair<br />cut: Fair<br />carat: 1.95<br />price: 12384","cut: Fair<br />cut: Fair<br />carat: 1.93<br />price: 12260","cut: Fair<br />cut: Fair<br />carat: 1.91<br />price: 12131","cut: Fair<br />cut: Fair<br />carat: 1.89<br />price: 11999","cut: Fair<br />cut: Fair<br />carat: 1.86<br />price: 11862","cut: Fair<br />cut: Fair<br />carat: 1.84<br />price: 11721","cut: Fair<br />cut: Fair<br />carat: 1.82<br />price: 11576","cut: Fair<br />cut: Fair<br />carat: 1.80<br />price: 11427","cut: Fair<br />cut: Fair<br />carat: 1.78<br />price: 11274","cut: Fair<br />cut: Fair<br />carat: 1.76<br />price: 11118","cut: Fair<br />cut: Fair<br />carat: 1.73<br />price: 10958","cut: Fair<br />cut: Fair<br />carat: 1.71<br />price: 10795","cut: Fair<br />cut: Fair<br />carat: 1.69<br />price: 10628","cut: Fair<br />cut: Fair<br />carat: 1.67<br />price: 10459","cut: Fair<br />cut: Fair<br />carat: 1.65<br />price: 10286","cut: Fair<br />cut: Fair<br />carat: 1.62<br />price: 10111","cut: Fair<br />cut: Fair<br />carat: 1.60<br />price:  9933","cut: Fair<br />cut: Fair<br />carat: 1.58<br />price:  9752","cut: Fair<br />cut: Fair<br />carat: 1.56<br />price:  9568","cut: Fair<br />cut: Fair<br />carat: 1.54<br />price:  9382","cut: Fair<br />cut: Fair<br />carat: 1.51<br />price:  9194","cut: Fair<br />cut: Fair<br />carat: 1.49<br />price:  8993","cut: Fair<br />cut: Fair<br />carat: 1.47<br />price:  8763","cut: Fair<br />cut: Fair<br />carat: 1.45<br />price:  8507","cut: Fair<br />cut: Fair<br />carat: 1.43<br />price:  8230","cut: Fair<br />cut: Fair<br />carat: 1.40<br />price:  7936","cut: Fair<br />cut: Fair<br />carat: 1.38<br />price:  7631","cut: Fair<br />cut: Fair<br />carat: 1.36<br />price:  7319","cut: Fair<br />cut: Fair<br />carat: 1.34<br />price:  7004","cut: Fair<br />cut: Fair<br />carat: 1.32<br />price:  6692","cut: Fair<br />cut: Fair<br />carat: 1.30<br />price:  6386","cut: Fair<br />cut: Fair<br />carat: 1.27<br />price:  6093","cut: Fair<br />cut: Fair<br />carat: 1.25<br />price:  5816","cut: Fair<br />cut: Fair<br />carat: 1.23<br />price:  5560","cut: Fair<br />cut: Fair<br />carat: 1.21<br />price:  5330","cut: Fair<br />cut: Fair<br />carat: 1.19<br />price:  5130","cut: Fair<br />cut: Fair<br />carat: 1.16<br />price:  4958","cut: Fair<br />cut: Fair<br />carat: 1.14<br />price:  4810","cut: Fair<br />cut: Fair<br />carat: 1.12<br />price:  4680","cut: Fair<br />cut: Fair<br />carat: 1.10<br />price:  4564","cut: Fair<br />cut: Fair<br />carat: 1.08<br />price:  4457","cut: Fair<br />cut: Fair<br />carat: 1.05<br />price:  4353","cut: Fair<br />cut: Fair<br />carat: 1.03<br />price:  4249","cut: Fair<br />cut: Fair<br />carat: 1.01<br />price:  4138","cut: Fair<br />cut: Fair<br />carat: 0.99<br />price:  4019","cut: Fair<br />cut: Fair<br />carat: 0.97<br />price:  3899","cut: Fair<br />cut: Fair<br />carat: 0.95<br />price:  3773","cut: Fair<br />cut: Fair<br />carat: 0.92<br />price:  3640","cut: Fair<br />cut: Fair<br />carat: 0.90<br />price:  3493","cut: Fair<br />cut: Fair<br />carat: 0.88<br />price:  3328","cut: Fair<br />cut: Fair<br />carat: 0.86<br />price:  3151","cut: Fair<br />cut: Fair<br />carat: 0.84<br />price:  2970","cut: Fair<br />cut: Fair<br />carat: 0.81<br />price:  2790","cut: Fair<br />cut: Fair<br />carat: 0.79<br />price:  2618","cut: Fair<br />cut: Fair<br />carat: 0.77<br />price:  2461","cut: Fair<br />cut: Fair<br />carat: 0.75<br />price:  2327","cut: Fair<br />cut: Fair<br />carat: 0.73<br />price:  2220","cut: Fair<br />cut: Fair<br />carat: 0.70<br />price:  2124","cut: Fair<br />cut: Fair<br />carat: 0.68<br />price:  2028","cut: Fair<br />cut: Fair<br />carat: 0.66<br />price:  1932","cut: Fair<br />cut: Fair<br />carat: 0.64<br />price:  1836","cut: Fair<br />cut: Fair<br />carat: 0.62<br />price:  1740","cut: Fair<br />cut: Fair<br />carat: 0.59<br />price:  1646","cut: Fair<br />cut: Fair<br />carat: 0.57<br />price:  1553","cut: Fair<br />cut: Fair<br />carat: 0.55<br />price:  1462","cut: Fair<br />cut: Fair<br />carat: 0.53<br />price:  1374","cut: Fair<br />cut: Fair<br />carat: 0.51<br />price:  1287","cut: Fair<br />cut: Fair<br />carat: 0.49<br />price:  1204","cut: Fair<br />cut: Fair<br />carat: 0.46<br />price:  1123","cut: Fair<br />cut: Fair<br />carat: 0.44<br />price:  1045","cut: Fair<br />cut: Fair<br />carat: 0.42<br />price:   969","cut: Fair<br />cut: Fair<br />carat: 0.40<br />price:   896","cut: Fair<br />cut: Fair<br />carat: 0.38<br />price:   826","cut: Fair<br />cut: Fair<br />carat: 0.35<br />price:   758","cut: Fair<br />cut: Fair<br />carat: 0.33<br />price:   692","cut: Fair<br />cut: Fair<br />carat: 0.31<br />price:   629","cut: Fair<br />cut: Fair<br />carat: 0.31<br />price:   629"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(68,1,84,0.4)","hoveron":"points","hoverinfo":"x+y","name":"Fair","legendgroup":"Fair","showlegend":false,"xaxis":"x","yaxis":"y","frame":null},{"x":[0.3,0.321898734177215,0.34379746835443,0.365696202531646,0.387594936708861,0.409493670886076,0.431392405063291,0.453291139240506,0.475189873417721,0.497088607594937,0.518987341772152,0.540886075949367,0.562784810126582,0.584683544303797,0.606582278481013,0.628481012658228,0.650379746835443,0.672278481012658,0.694177215189873,0.716075949367089,0.737974683544304,0.759873417721519,0.781772151898734,0.803670886075949,0.825569620253164,0.84746835443038,0.869367088607595,0.89126582278481,0.913164556962025,0.93506329113924,0.956962025316456,0.978860759493671,1.00075949367089,1.0226582278481,1.04455696202532,1.06645569620253,1.08835443037975,1.11025316455696,1.13215189873418,1.15405063291139,1.17594936708861,1.19784810126582,1.21974683544304,1.24164556962025,1.26354430379747,1.28544303797468,1.3073417721519,1.32924050632911,1.35113924050633,1.37303797468354,1.39493670886076,1.41683544303797,1.43873417721519,1.46063291139241,1.48253164556962,1.50443037974684,1.52632911392405,1.54822784810127,1.57012658227848,1.5920253164557,1.61392405063291,1.63582278481013,1.65772151898734,1.67962025316456,1.70151898734177,1.72341772151899,1.7453164556962,1.76721518987342,1.78911392405063,1.81101265822785,1.83291139240506,1.85481012658228,1.87670886075949,1.89860759493671,1.92050632911392,1.94240506329114,1.96430379746835,1.98620253164557,2.00810126582278,2.03,2.03,2.00810126582278,1.98620253164557,1.96430379746835,1.94240506329114,1.92050632911392,1.89860759493671,1.87670886075949,1.85481012658228,1.83291139240506,1.81101265822785,1.78911392405063,1.76721518987342,1.7453164556962,1.72341772151899,1.70151898734177,1.67962025316456,1.65772151898734,1.63582278481013,1.61392405063291,1.5920253164557,1.57012658227848,1.54822784810127,1.52632911392405,1.50443037974684,1.48253164556962,1.46063291139241,1.43873417721519,1.41683544303797,1.39493670886076,1.37303797468354,1.35113924050633,1.32924050632911,1.3073417721519,1.28544303797468,1.26354430379747,1.24164556962025,1.21974683544304,1.19784810126582,1.17594936708861,1.15405063291139,1.13215189873418,1.11025316455696,1.08835443037975,1.06645569620253,1.04455696202532,1.0226582278481,1.00075949367089,0.978860759493671,0.956962025316456,0.93506329113924,0.913164556962025,0.89126582278481,0.869367088607595,0.84746835443038,0.825569620253164,0.803670886075949,0.781772151898734,0.759873417721519,0.737974683544304,0.716075949367089,0.694177215189873,0.672278481012658,0.650379746835443,0.628481012658228,0.606582278481013,0.584683544303797,0.562784810126582,0.540886075949367,0.518987341772152,0.497088607594937,0.475189873417721,0.453291139240506,0.431392405063291,0.409493670886076,0.387594936708861,0.365696202531646,0.34379746835443,0.321898734177215,0.3,0.3],"y":[-405.647621138581,-198.503402118229,-26.6182109821715,108.183392130094,209.655583458738,285.25238868066,344.668372250171,399.721538420547,458.251282275735,521.954488245637,590.99786171444,665.73633203096,747.521328477962,838.852549565545,943.059106014645,1073.49446265484,1243.76636308134,1444.39027354865,1665.20493026504,1896.49322847833,2129.84314373195,2358.98125522725,2580.21864034761,2792.22019144394,2995.15918101187,3189.57189815237,3376.97118298094,3567.6541058247,3754.51078544221,3928.85465172303,4087.50084495246,4234.25103959243,4377.76943627339,4511.18602088438,4668.09076132484,4823.29281567566,4977.15228659641,5129.87860677072,5281.59486989269,5432.39190073052,5582.37377771677,5731.69532606125,5880.59119791193,6029.39581873309,6178.5537516542,6328.62075232284,6480.25665141891,6634.21188745005,6791.3098036607,6952.42667400867,7118.47093140953,7290.36239673868,7469.0115913648,7655.29853735152,7850.04981502107,8054.0120108636,8267.56242417914,8486.71892274999,8709.86662383535,8936.86129543414,9167.51880217758,9401.61147766313,9638.86521634538,9878.95791127538,10121.5200075196,10366.1380177598,10612.3617824709,10859.7159725396,11107.7157775008,11355.8859288828,11603.7813293961,11851.006863416,12097.2337473075,12342.210213372,12585.7653393096,12827.8061239521,13068.3090568421,13307.3081167766,13544.8812644814,13781.1371779692,16445.7175736883,16058.7380740358,15683.5389247383,15320.0556817902,14968.1931838985,14627.8122878416,14298.7163611437,13980.6392806178,13673.2370019456,13376.0846354098,13088.6802753569,12810.4556841435,12540.7926424616,12279.042759821,12024.5481037378,11776.6602230804,11534.7558363049,11298.2483340745,11066.5950394372,10839.3007234255,10615.9181584752,10396.0465561654,10179.3286591086,9965.44711328512,9754.32760743943,9546.28012138195,9341.14905795068,9138.85584945416,8939.40192203298,8742.84214356915,8549.26188124975,8358.75580176851,8171.40718385941,7987.26714729864,7806.333881149,7628.53266973651,7453.69818955945,7281.56104208377,7111.74063625732,6943.74624336277,6776.98736136644,6610.79366129654,6444.444067404,6277.20425027538,6108.37214942319,5937.3320433494,5763.61888053198,5613.78562124481,5453.88990231345,5294.93277514783,5144.87211809178,5006.66622921484,4876.28687240993,4744.20410117421,4596.4713031165,4419.43121730504,4220.1716564988,4008.45968576479,3793.69935356472,3583.78632821557,3384.2624630668,3198.08511328584,3026.07303038218,2867.73988556972,2722.1551910228,2588.48965905493,2457.43072308044,2325.64007308754,2195.35868360909,2067.99811696712,1943.82166625635,1822.09612463751,1701.90006130672,1583.84222450583,1476.9664233928,1394.83739249454,1345.92674194081,1336.45487507191,1368.63306534241,1441.71889887054,-405.647621138581],"text":["cut: Good<br />cut: Good<br />carat: 0.30<br />price:   518","cut: Good<br />cut: Good<br />carat: 0.32<br />price:   585","cut: Good<br />cut: Good<br />carat: 0.34<br />price:   655","cut: Good<br />cut: Good<br />carat: 0.37<br />price:   727","cut: Good<br />cut: Good<br />carat: 0.39<br />price:   802","cut: Good<br />cut: Good<br />carat: 0.41<br />price:   881","cut: Good<br />cut: Good<br />carat: 0.43<br />price:   964","cut: Good<br />cut: Good<br />carat: 0.45<br />price:  1051","cut: Good<br />cut: Good<br />carat: 0.48<br />price:  1140","cut: Good<br />cut: Good<br />carat: 0.50<br />price:  1233","cut: Good<br />cut: Good<br />carat: 0.52<br />price:  1329","cut: Good<br />cut: Good<br />carat: 0.54<br />price:  1431","cut: Good<br />cut: Good<br />carat: 0.56<br />price:  1537","cut: Good<br />cut: Good<br />carat: 0.58<br />price:  1648","cut: Good<br />cut: Good<br />carat: 0.61<br />price:  1766","cut: Good<br />cut: Good<br />carat: 0.63<br />price:  1898","cut: Good<br />cut: Good<br />carat: 0.65<br />price:  2056","cut: Good<br />cut: Good<br />carat: 0.67<br />price:  2235","cut: Good<br />cut: Good<br />carat: 0.69<br />price:  2432","cut: Good<br />cut: Good<br />carat: 0.72<br />price:  2640","cut: Good<br />cut: Good<br />carat: 0.74<br />price:  2857","cut: Good<br />cut: Good<br />carat: 0.76<br />price:  3076","cut: Good<br />cut: Good<br />carat: 0.78<br />price:  3294","cut: Good<br />cut: Good<br />carat: 0.80<br />price:  3506","cut: Good<br />cut: Good<br />carat: 0.83<br />price:  3707","cut: Good<br />cut: Good<br />carat: 0.85<br />price:  3893","cut: Good<br />cut: Good<br />carat: 0.87<br />price:  4061","cut: Good<br />cut: Good<br />carat: 0.89<br />price:  4222","cut: Good<br />cut: Good<br />carat: 0.91<br />price:  4381","cut: Good<br />cut: Good<br />carat: 0.94<br />price:  4537","cut: Good<br />cut: Good<br />carat: 0.96<br />price:  4691","cut: Good<br />cut: Good<br />carat: 0.98<br />price:  4844","cut: Good<br />cut: Good<br />carat: 1.00<br />price:  4996","cut: Good<br />cut: Good<br />carat: 1.02<br />price:  5137","cut: Good<br />cut: Good<br />carat: 1.04<br />price:  5303","cut: Good<br />cut: Good<br />carat: 1.07<br />price:  5466","cut: Good<br />cut: Good<br />carat: 1.09<br />price:  5627","cut: Good<br />cut: Good<br />carat: 1.11<br />price:  5787","cut: Good<br />cut: Good<br />carat: 1.13<br />price:  5946","cut: Good<br />cut: Good<br />carat: 1.15<br />price:  6105","cut: Good<br />cut: Good<br />carat: 1.18<br />price:  6263","cut: Good<br />cut: Good<br />carat: 1.20<br />price:  6422","cut: Good<br />cut: Good<br />carat: 1.22<br />price:  6581","cut: Good<br />cut: Good<br />carat: 1.24<br />price:  6742","cut: Good<br />cut: Good<br />carat: 1.26<br />price:  6904","cut: Good<br />cut: Good<br />carat: 1.29<br />price:  7067","cut: Good<br />cut: Good<br />carat: 1.31<br />price:  7234","cut: Good<br />cut: Good<br />carat: 1.33<br />price:  7403","cut: Good<br />cut: Good<br />carat: 1.35<br />price:  7575","cut: Good<br />cut: Good<br />carat: 1.37<br />price:  7751","cut: Good<br />cut: Good<br />carat: 1.39<br />price:  7931","cut: Good<br />cut: Good<br />carat: 1.42<br />price:  8115","cut: Good<br />cut: Good<br />carat: 1.44<br />price:  8304","cut: Good<br />cut: Good<br />carat: 1.46<br />price:  8498","cut: Good<br />cut: Good<br />carat: 1.48<br />price:  8698","cut: Good<br />cut: Good<br />carat: 1.50<br />price:  8904","cut: Good<br />cut: Good<br />carat: 1.53<br />price:  9117","cut: Good<br />cut: Good<br />carat: 1.55<br />price:  9333","cut: Good<br />cut: Good<br />carat: 1.57<br />price:  9553","cut: Good<br />cut: Good<br />carat: 1.59<br />price:  9776","cut: Good<br />cut: Good<br />carat: 1.61<br />price: 10003","cut: Good<br />cut: Good<br />carat: 1.64<br />price: 10234","cut: Good<br />cut: Good<br />carat: 1.66<br />price: 10469","cut: Good<br />cut: Good<br />carat: 1.68<br />price: 10707","cut: Good<br />cut: Good<br />carat: 1.70<br />price: 10949","cut: Good<br />cut: Good<br />carat: 1.72<br />price: 11195","cut: Good<br />cut: Good<br />carat: 1.75<br />price: 11446","cut: Good<br />cut: Good<br />carat: 1.77<br />price: 11700","cut: Good<br />cut: Good<br />carat: 1.79<br />price: 11959","cut: Good<br />cut: Good<br />carat: 1.81<br />price: 12222","cut: Good<br />cut: Good<br />carat: 1.83<br />price: 12490","cut: Good<br />cut: Good<br />carat: 1.85<br />price: 12762","cut: Good<br />cut: Good<br />carat: 1.88<br />price: 13039","cut: Good<br />cut: Good<br />carat: 1.90<br />price: 13320","cut: Good<br />cut: Good<br />carat: 1.92<br />price: 13607","cut: Good<br />cut: Good<br />carat: 1.94<br />price: 13898","cut: Good<br />cut: Good<br />carat: 1.96<br />price: 14194","cut: Good<br />cut: Good<br />carat: 1.99<br />price: 14495","cut: Good<br />cut: Good<br />carat: 2.01<br />price: 14802","cut: Good<br />cut: Good<br />carat: 2.03<br />price: 15113","cut: Good<br />cut: Good<br />carat: 2.03<br />price: 15113","cut: Good<br />cut: Good<br />carat: 2.01<br />price: 14802","cut: Good<br />cut: Good<br />carat: 1.99<br />price: 14495","cut: Good<br />cut: Good<br />carat: 1.96<br />price: 14194","cut: Good<br />cut: Good<br />carat: 1.94<br />price: 13898","cut: Good<br />cut: Good<br />carat: 1.92<br />price: 13607","cut: Good<br />cut: Good<br />carat: 1.90<br />price: 13320","cut: Good<br />cut: Good<br />carat: 1.88<br />price: 13039","cut: Good<br />cut: Good<br />carat: 1.85<br />price: 12762","cut: Good<br />cut: Good<br />carat: 1.83<br />price: 12490","cut: Good<br />cut: Good<br />carat: 1.81<br />price: 12222","cut: Good<br />cut: Good<br />carat: 1.79<br />price: 11959","cut: Good<br />cut: Good<br />carat: 1.77<br />price: 11700","cut: Good<br />cut: Good<br />carat: 1.75<br />price: 11446","cut: Good<br />cut: Good<br />carat: 1.72<br />price: 11195","cut: Good<br />cut: Good<br />carat: 1.70<br />price: 10949","cut: Good<br />cut: Good<br />carat: 1.68<br />price: 10707","cut: Good<br />cut: Good<br />carat: 1.66<br />price: 10469","cut: Good<br />cut: Good<br />carat: 1.64<br />price: 10234","cut: Good<br />cut: Good<br />carat: 1.61<br />price: 10003","cut: Good<br />cut: Good<br />carat: 1.59<br />price:  9776","cut: Good<br />cut: Good<br />carat: 1.57<br />price:  9553","cut: Good<br />cut: Good<br />carat: 1.55<br />price:  9333","cut: Good<br />cut: Good<br />carat: 1.53<br />price:  9117","cut: Good<br />cut: Good<br />carat: 1.50<br />price:  8904","cut: Good<br />cut: Good<br />carat: 1.48<br />price:  8698","cut: Good<br />cut: Good<br />carat: 1.46<br />price:  8498","cut: Good<br />cut: Good<br />carat: 1.44<br />price:  8304","cut: Good<br />cut: Good<br />carat: 1.42<br />price:  8115","cut: Good<br />cut: Good<br />carat: 1.39<br />price:  7931","cut: Good<br />cut: Good<br />carat: 1.37<br />price:  7751","cut: Good<br />cut: Good<br />carat: 1.35<br />price:  7575","cut: Good<br />cut: Good<br />carat: 1.33<br />price:  7403","cut: Good<br />cut: Good<br />carat: 1.31<br />price:  7234","cut: Good<br />cut: Good<br />carat: 1.29<br />price:  7067","cut: Good<br />cut: Good<br />carat: 1.26<br />price:  6904","cut: Good<br />cut: Good<br />carat: 1.24<br />price:  6742","cut: Good<br />cut: Good<br />carat: 1.22<br />price:  6581","cut: Good<br />cut: Good<br />carat: 1.20<br />price:  6422","cut: Good<br />cut: Good<br />carat: 1.18<br />price:  6263","cut: Good<br />cut: Good<br />carat: 1.15<br />price:  6105","cut: Good<br />cut: Good<br />carat: 1.13<br />price:  5946","cut: Good<br />cut: Good<br />carat: 1.11<br />price:  5787","cut: Good<br />cut: Good<br />carat: 1.09<br />price:  5627","cut: Good<br />cut: Good<br />carat: 1.07<br />price:  5466","cut: Good<br />cut: Good<br />carat: 1.04<br />price:  5303","cut: Good<br />cut: Good<br />carat: 1.02<br />price:  5137","cut: Good<br />cut: Good<br />carat: 1.00<br />price:  4996","cut: Good<br />cut: Good<br />carat: 0.98<br />price:  4844","cut: Good<br />cut: Good<br />carat: 0.96<br />price:  4691","cut: Good<br />cut: Good<br />carat: 0.94<br />price:  4537","cut: Good<br />cut: Good<br />carat: 0.91<br />price:  4381","cut: Good<br />cut: Good<br />carat: 0.89<br />price:  4222","cut: Good<br />cut: Good<br />carat: 0.87<br />price:  4061","cut: Good<br />cut: Good<br />carat: 0.85<br />price:  3893","cut: Good<br />cut: Good<br />carat: 0.83<br />price:  3707","cut: Good<br />cut: Good<br />carat: 0.80<br />price:  3506","cut: Good<br />cut: Good<br />carat: 0.78<br />price:  3294","cut: Good<br />cut: Good<br />carat: 0.76<br />price:  3076","cut: Good<br />cut: Good<br />carat: 0.74<br />price:  2857","cut: Good<br />cut: Good<br />carat: 0.72<br />price:  2640","cut: Good<br />cut: Good<br />carat: 0.69<br />price:  2432","cut: Good<br />cut: Good<br />carat: 0.67<br />price:  2235","cut: Good<br />cut: Good<br />carat: 0.65<br />price:  2056","cut: Good<br />cut: Good<br />carat: 0.63<br />price:  1898","cut: Good<br />cut: Good<br />carat: 0.61<br />price:  1766","cut: Good<br />cut: Good<br />carat: 0.58<br />price:  1648","cut: Good<br />cut: Good<br />carat: 0.56<br />price:  1537","cut: Good<br />cut: Good<br />carat: 0.54<br />price:  1431","cut: Good<br />cut: Good<br />carat: 0.52<br />price:  1329","cut: Good<br />cut: Good<br />carat: 0.50<br />price:  1233","cut: Good<br />cut: Good<br />carat: 0.48<br />price:  1140","cut: Good<br />cut: Good<br />carat: 0.45<br />price:  1051","cut: Good<br />cut: Good<br />carat: 0.43<br />price:   964","cut: Good<br />cut: Good<br />carat: 0.41<br />price:   881","cut: Good<br />cut: Good<br />carat: 0.39<br />price:   802","cut: Good<br />cut: Good<br />carat: 0.37<br />price:   727","cut: Good<br />cut: Good<br />carat: 0.34<br />price:   655","cut: Good<br />cut: Good<br />carat: 0.32<br />price:   585","cut: Good<br />cut: Good<br />carat: 0.30<br />price:   518","cut: Good<br />cut: Good<br />carat: 0.30<br />price:   518"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(59,82,139,0.4)","hoveron":"points","hoverinfo":"x+y","name":"Good","legendgroup":"Good","showlegend":false,"xaxis":"x2","yaxis":"y","frame":null},{"x":[0.23,0.255949367088608,0.281898734177215,0.307848101265823,0.33379746835443,0.359746835443038,0.385696202531646,0.411645569620253,0.437594936708861,0.463544303797468,0.489493670886076,0.515443037974683,0.541392405063291,0.567341772151899,0.593291139240506,0.619240506329114,0.645189873417721,0.671139240506329,0.697088607594937,0.723037974683544,0.748987341772152,0.774936708860759,0.800886075949367,0.826835443037975,0.852784810126582,0.87873417721519,0.904683544303797,0.930632911392405,0.956582278481013,0.98253164556962,1.00848101265823,1.03443037974684,1.06037974683544,1.08632911392405,1.11227848101266,1.13822784810127,1.16417721518987,1.19012658227848,1.21607594936709,1.2420253164557,1.2679746835443,1.29392405063291,1.31987341772152,1.34582278481013,1.37177215189873,1.39772151898734,1.42367088607595,1.44962025316456,1.47556962025316,1.50151898734177,1.52746835443038,1.55341772151899,1.57936708860759,1.6053164556962,1.63126582278481,1.65721518987342,1.68316455696203,1.70911392405063,1.73506329113924,1.76101265822785,1.78696202531646,1.81291139240506,1.83886075949367,1.86481012658228,1.89075949367089,1.91670886075949,1.9426582278481,1.96860759493671,1.99455696202532,2.02050632911392,2.04645569620253,2.07240506329114,2.09835443037975,2.12430379746835,2.15025316455696,2.17620253164557,2.20215189873418,2.22810126582278,2.25405063291139,2.28,2.28,2.25405063291139,2.22810126582278,2.20215189873418,2.17620253164557,2.15025316455696,2.12430379746835,2.09835443037975,2.07240506329114,2.04645569620253,2.02050632911392,1.99455696202532,1.96860759493671,1.9426582278481,1.91670886075949,1.89075949367089,1.86481012658228,1.83886075949367,1.81291139240506,1.78696202531646,1.76101265822785,1.73506329113924,1.70911392405063,1.68316455696203,1.65721518987342,1.63126582278481,1.6053164556962,1.57936708860759,1.55341772151899,1.52746835443038,1.50151898734177,1.47556962025316,1.44962025316456,1.42367088607595,1.39772151898734,1.37177215189873,1.34582278481013,1.31987341772152,1.29392405063291,1.2679746835443,1.2420253164557,1.21607594936709,1.19012658227848,1.16417721518987,1.13822784810127,1.11227848101266,1.08632911392405,1.06037974683544,1.03443037974684,1.00848101265823,0.98253164556962,0.956582278481013,0.930632911392405,0.904683544303797,0.87873417721519,0.852784810126582,0.826835443037975,0.800886075949367,0.774936708860759,0.748987341772152,0.723037974683544,0.697088607594937,0.671139240506329,0.645189873417721,0.619240506329114,0.593291139240506,0.567341772151899,0.541392405063291,0.515443037974683,0.489493670886076,0.463544303797468,0.437594936708861,0.411645569620253,0.385696202531646,0.359746835443038,0.33379746835443,0.307848101265823,0.281898734177215,0.255949367088608,0.23,0.23],"y":[-75.0421483124968,72.2811603906288,206.24916544495,323.498540758089,422.672412053187,505.420191551163,578.076636230676,650.533568234271,727.881459348693,812.411062735262,905.276182978099,1007.97511997115,1122.05099982838,1242.13888335143,1362.97895831664,1483.27557835122,1607.46699787797,1744.59015474934,1905.5351814261,2107.00147127492,2353.37300492797,2628.82452943946,2917.55731482626,3205.54398800982,3482.19248649597,3740.85385478697,3977.32623144424,4194.23991721123,4403.0276548967,4606.55619649886,4816.97173883773,5040.49072337922,5268.63695749479,5501.06007792876,5737.71137356804,5978.83845248367,6224.95466856798,6476.75615002567,6735.00449535883,6996.98248095048,7257.23533142671,7516.00374965094,7773.54840028974,8030.05076037756,8285.62312392135,8540.31803638273,8794.1363256586,9047.03349148111,9298.92452651069,9549.68738806051,9799.16540132643,10047.1689024116,10293.4764482483,10537.8359409899,10779.9660356128,11019.5582113655,11256.2798729174,11489.778783824,11719.6890033455,11945.6382898002,12167.2566651606,12384.1855530249,12596.0866778898,12802.6498247555,13003.598653181,13198.6940316171,13387.7347382572,13570.5557603419,13747.0247178872,13917.037085192,14080.5108827465,14237.381402514,14387.5963660976,14531.1117471138,14667.8883478244,14797.889118887,14921.0771496142,15037.4142267854,15146.8598531126,15249.3706230775,17863.6484465217,17620.1619451718,17375.8914601544,17130.9400976203,16885.4138719505,16639.4210815934,16393.0713275306,16146.4740720889,15899.7366291988,15652.9614841462,15406.2428702029,15159.6625910014,14913.2851787008,14667.1526192691,14421.2790443914,14175.6459529771,13930.1986348889,13684.8444702465,13439.4536302777,13193.8624116521,12947.8790505351,12701.2914821942,12453.8762402708,12205.4075947521,11955.6661165675,11704.4460809414,11451.5614042123,11196.8500772977,10940.1772668431,10681.4373866707,10420.5555053819,10157.4884707489,9892.22611963662,9624.79292102717,9355.25037925002,9083.70050570637,8810.2906399621,8535.21983914788,8258.74690893968,7981.19983804097,7702.98580278733,7424.67096100007,7150.65780780812,6883.52199165001,6623.61340566865,6371.21647270952,6126.43284130577,5889.09841416924,5658.75277482765,5434.69848249527,5224.90305019407,5033.24842251653,4849.59784313153,4653.94110810861,4426.56702750539,4175.48502047552,3915.1308877606,3657.49333604305,3410.61796500885,3179.11506375961,2965.82356449235,2773.26010683528,2591.40274729258,2416.56613120573,2254.67498171308,2109.80082734472,1981.41651320105,1863.26098358688,1745.10901695615,1617.85854094918,1491.02123810134,1369.01933894672,1253.60526726864,1147.66839542756,1056.75570676991,989.970279299272,953.790789633497,950.494053586386,979.019454650171,1035.199423215,-75.0421483124968],"text":["cut: Very Good<br />cut: Very Good<br />carat: 0.23<br />price:   480","cut: Very Good<br />cut: Very Good<br />carat: 0.26<br />price:   526","cut: Very Good<br />cut: Very Good<br />carat: 0.28<br />price:   578","cut: Very Good<br />cut: Very Good<br />carat: 0.31<br />price:   639","cut: Very Good<br />cut: Very Good<br />carat: 0.33<br />price:   706","cut: Very Good<br />cut: Very Good<br />carat: 0.36<br />price:   781","cut: Very Good<br />cut: Very Good<br />carat: 0.39<br />price:   863","cut: Very Good<br />cut: Very Good<br />carat: 0.41<br />price:   952","cut: Very Good<br />cut: Very Good<br />carat: 0.44<br />price:  1048","cut: Very Good<br />cut: Very Good<br />carat: 0.46<br />price:  1152","cut: Very Good<br />cut: Very Good<br />carat: 0.49<br />price:  1262","cut: Very Good<br />cut: Very Good<br />carat: 0.52<br />price:  1377","cut: Very Good<br />cut: Very Good<br />carat: 0.54<br />price:  1493","cut: Very Good<br />cut: Very Good<br />carat: 0.57<br />price:  1612","cut: Very Good<br />cut: Very Good<br />carat: 0.59<br />price:  1736","cut: Very Good<br />cut: Very Good<br />carat: 0.62<br />price:  1869","cut: Very Good<br />cut: Very Good<br />carat: 0.65<br />price:  2012","cut: Very Good<br />cut: Very Good<br />carat: 0.67<br />price:  2168","cut: Very Good<br />cut: Very Good<br />carat: 0.70<br />price:  2339","cut: Very Good<br />cut: Very Good<br />carat: 0.72<br />price:  2536","cut: Very Good<br />cut: Very Good<br />carat: 0.75<br />price:  2766","cut: Very Good<br />cut: Very Good<br />carat: 0.77<br />price:  3020","cut: Very Good<br />cut: Very Good<br />carat: 0.80<br />price:  3288","cut: Very Good<br />cut: Very Good<br />carat: 0.83<br />price:  3560","cut: Very Good<br />cut: Very Good<br />carat: 0.85<br />price:  3829","cut: Very Good<br />cut: Very Good<br />carat: 0.88<br />price:  4084","cut: Very Good<br />cut: Very Good<br />carat: 0.90<br />price:  4316","cut: Very Good<br />cut: Very Good<br />carat: 0.93<br />price:  4522","cut: Very Good<br />cut: Very Good<br />carat: 0.96<br />price:  4718","cut: Very Good<br />cut: Very Good<br />carat: 0.98<br />price:  4916","cut: Very Good<br />cut: Very Good<br />carat: 1.01<br />price:  5126","cut: Very Good<br />cut: Very Good<br />carat: 1.03<br />price:  5350","cut: Very Good<br />cut: Very Good<br />carat: 1.06<br />price:  5579","cut: Very Good<br />cut: Very Good<br />carat: 1.09<br />price:  5814","cut: Very Good<br />cut: Very Good<br />carat: 1.11<br />price:  6054","cut: Very Good<br />cut: Very Good<br />carat: 1.14<br />price:  6301","cut: Very Good<br />cut: Very Good<br />carat: 1.16<br />price:  6554","cut: Very Good<br />cut: Very Good<br />carat: 1.19<br />price:  6814","cut: Very Good<br />cut: Very Good<br />carat: 1.22<br />price:  7080","cut: Very Good<br />cut: Very Good<br />carat: 1.24<br />price:  7350","cut: Very Good<br />cut: Very Good<br />carat: 1.27<br />price:  7619","cut: Very Good<br />cut: Very Good<br />carat: 1.29<br />price:  7887","cut: Very Good<br />cut: Very Good<br />carat: 1.32<br />price:  8154","cut: Very Good<br />cut: Very Good<br />carat: 1.35<br />price:  8420","cut: Very Good<br />cut: Very Good<br />carat: 1.37<br />price:  8685","cut: Very Good<br />cut: Very Good<br />carat: 1.40<br />price:  8948","cut: Very Good<br />cut: Very Good<br />carat: 1.42<br />price:  9209","cut: Very Good<br />cut: Very Good<br />carat: 1.45<br />price:  9470","cut: Very Good<br />cut: Very Good<br />carat: 1.48<br />price:  9728","cut: Very Good<br />cut: Very Good<br />carat: 1.50<br />price:  9985","cut: Very Good<br />cut: Very Good<br />carat: 1.53<br />price: 10240","cut: Very Good<br />cut: Very Good<br />carat: 1.55<br />price: 10494","cut: Very Good<br />cut: Very Good<br />carat: 1.58<br />price: 10745","cut: Very Good<br />cut: Very Good<br />carat: 1.61<br />price: 10995","cut: Very Good<br />cut: Very Good<br />carat: 1.63<br />price: 11242","cut: Very Good<br />cut: Very Good<br />carat: 1.66<br />price: 11488","cut: Very Good<br />cut: Very Good<br />carat: 1.68<br />price: 11731","cut: Very Good<br />cut: Very Good<br />carat: 1.71<br />price: 11972","cut: Very Good<br />cut: Very Good<br />carat: 1.74<br />price: 12210","cut: Very Good<br />cut: Very Good<br />carat: 1.76<br />price: 12447","cut: Very Good<br />cut: Very Good<br />carat: 1.79<br />price: 12681","cut: Very Good<br />cut: Very Good<br />carat: 1.81<br />price: 12912","cut: Very Good<br />cut: Very Good<br />carat: 1.84<br />price: 13140","cut: Very Good<br />cut: Very Good<br />carat: 1.86<br />price: 13366","cut: Very Good<br />cut: Very Good<br />carat: 1.89<br />price: 13590","cut: Very Good<br />cut: Very Good<br />carat: 1.92<br />price: 13810","cut: Very Good<br />cut: Very Good<br />carat: 1.94<br />price: 14027","cut: Very Good<br />cut: Very Good<br />carat: 1.97<br />price: 14242","cut: Very Good<br />cut: Very Good<br />carat: 1.99<br />price: 14453","cut: Very Good<br />cut: Very Good<br />carat: 2.02<br />price: 14662","cut: Very Good<br />cut: Very Good<br />carat: 2.05<br />price: 14867","cut: Very Good<br />cut: Very Good<br />carat: 2.07<br />price: 15069","cut: Very Good<br />cut: Very Good<br />carat: 2.10<br />price: 15267","cut: Very Good<br />cut: Very Good<br />carat: 2.12<br />price: 15462","cut: Very Good<br />cut: Very Good<br />carat: 2.15<br />price: 15654","cut: Very Good<br />cut: Very Good<br />carat: 2.18<br />price: 15842","cut: Very Good<br />cut: Very Good<br />carat: 2.20<br />price: 16026","cut: Very Good<br />cut: Very Good<br />carat: 2.23<br />price: 16207","cut: Very Good<br />cut: Very Good<br />carat: 2.25<br />price: 16384","cut: Very Good<br />cut: Very Good<br />carat: 2.28<br />price: 16557","cut: Very Good<br />cut: Very Good<br />carat: 2.28<br />price: 16557","cut: Very Good<br />cut: Very Good<br />carat: 2.25<br />price: 16384","cut: Very Good<br />cut: Very Good<br />carat: 2.23<br />price: 16207","cut: Very Good<br />cut: Very Good<br />carat: 2.20<br />price: 16026","cut: Very Good<br />cut: Very Good<br />carat: 2.18<br />price: 15842","cut: Very Good<br />cut: Very Good<br />carat: 2.15<br />price: 15654","cut: Very Good<br />cut: Very Good<br />carat: 2.12<br />price: 15462","cut: Very Good<br />cut: Very Good<br />carat: 2.10<br />price: 15267","cut: Very Good<br />cut: Very Good<br />carat: 2.07<br />price: 15069","cut: Very Good<br />cut: Very Good<br />carat: 2.05<br />price: 14867","cut: Very Good<br />cut: Very Good<br />carat: 2.02<br />price: 14662","cut: Very Good<br />cut: Very Good<br />carat: 1.99<br />price: 14453","cut: Very Good<br />cut: Very Good<br />carat: 1.97<br />price: 14242","cut: Very Good<br />cut: Very Good<br />carat: 1.94<br />price: 14027","cut: Very Good<br />cut: Very Good<br />carat: 1.92<br />price: 13810","cut: Very Good<br />cut: Very Good<br />carat: 1.89<br />price: 13590","cut: Very Good<br />cut: Very Good<br />carat: 1.86<br />price: 13366","cut: Very Good<br />cut: Very Good<br />carat: 1.84<br />price: 13140","cut: Very Good<br />cut: Very Good<br />carat: 1.81<br />price: 12912","cut: Very Good<br />cut: Very Good<br />carat: 1.79<br />price: 12681","cut: Very Good<br />cut: Very Good<br />carat: 1.76<br />price: 12447","cut: Very Good<br />cut: Very Good<br />carat: 1.74<br />price: 12210","cut: Very Good<br />cut: Very Good<br />carat: 1.71<br />price: 11972","cut: Very Good<br />cut: Very Good<br />carat: 1.68<br />price: 11731","cut: Very Good<br />cut: Very Good<br />carat: 1.66<br />price: 11488","cut: Very Good<br />cut: Very Good<br />carat: 1.63<br />price: 11242","cut: Very Good<br />cut: Very Good<br />carat: 1.61<br />price: 10995","cut: Very Good<br />cut: Very Good<br />carat: 1.58<br />price: 10745","cut: Very Good<br />cut: Very Good<br />carat: 1.55<br />price: 10494","cut: Very Good<br />cut: Very Good<br />carat: 1.53<br />price: 10240","cut: Very Good<br />cut: Very Good<br />carat: 1.50<br />price:  9985","cut: Very Good<br />cut: Very Good<br />carat: 1.48<br />price:  9728","cut: Very Good<br />cut: Very Good<br />carat: 1.45<br />price:  9470","cut: Very Good<br />cut: Very Good<br />carat: 1.42<br />price:  9209","cut: Very Good<br />cut: Very Good<br />carat: 1.40<br />price:  8948","cut: Very Good<br />cut: Very Good<br />carat: 1.37<br />price:  8685","cut: Very Good<br />cut: Very Good<br />carat: 1.35<br />price:  8420","cut: Very Good<br />cut: Very Good<br />carat: 1.32<br />price:  8154","cut: Very Good<br />cut: Very Good<br />carat: 1.29<br />price:  7887","cut: Very Good<br />cut: Very Good<br />carat: 1.27<br />price:  7619","cut: Very Good<br />cut: Very Good<br />carat: 1.24<br />price:  7350","cut: Very Good<br />cut: Very Good<br />carat: 1.22<br />price:  7080","cut: Very Good<br />cut: Very Good<br />carat: 1.19<br />price:  6814","cut: Very Good<br />cut: Very Good<br />carat: 1.16<br />price:  6554","cut: Very Good<br />cut: Very Good<br />carat: 1.14<br />price:  6301","cut: Very Good<br />cut: Very Good<br />carat: 1.11<br />price:  6054","cut: Very Good<br />cut: Very Good<br />carat: 1.09<br />price:  5814","cut: Very Good<br />cut: Very Good<br />carat: 1.06<br />price:  5579","cut: Very Good<br />cut: Very Good<br />carat: 1.03<br />price:  5350","cut: Very Good<br />cut: Very Good<br />carat: 1.01<br />price:  5126","cut: Very Good<br />cut: Very Good<br />carat: 0.98<br />price:  4916","cut: Very Good<br />cut: Very Good<br />carat: 0.96<br />price:  4718","cut: Very Good<br />cut: Very Good<br />carat: 0.93<br />price:  4522","cut: Very Good<br />cut: Very Good<br />carat: 0.90<br />price:  4316","cut: Very Good<br />cut: Very Good<br />carat: 0.88<br />price:  4084","cut: Very Good<br />cut: Very Good<br />carat: 0.85<br />price:  3829","cut: Very Good<br />cut: Very Good<br />carat: 0.83<br />price:  3560","cut: Very Good<br />cut: Very Good<br />carat: 0.80<br />price:  3288","cut: Very Good<br />cut: Very Good<br />carat: 0.77<br />price:  3020","cut: Very Good<br />cut: Very Good<br />carat: 0.75<br />price:  2766","cut: Very Good<br />cut: Very Good<br />carat: 0.72<br />price:  2536","cut: Very Good<br />cut: Very Good<br />carat: 0.70<br />price:  2339","cut: Very Good<br />cut: Very Good<br />carat: 0.67<br />price:  2168","cut: Very Good<br />cut: Very Good<br />carat: 0.65<br />price:  2012","cut: Very Good<br />cut: Very Good<br />carat: 0.62<br />price:  1869","cut: Very Good<br />cut: Very Good<br />carat: 0.59<br />price:  1736","cut: Very Good<br />cut: Very Good<br />carat: 0.57<br />price:  1612","cut: Very Good<br />cut: Very Good<br />carat: 0.54<br />price:  1493","cut: Very Good<br />cut: Very Good<br />carat: 0.52<br />price:  1377","cut: Very Good<br />cut: Very Good<br />carat: 0.49<br />price:  1262","cut: Very Good<br />cut: Very Good<br />carat: 0.46<br />price:  1152","cut: Very Good<br />cut: Very Good<br />carat: 0.44<br />price:  1048","cut: Very Good<br />cut: Very Good<br />carat: 0.41<br />price:   952","cut: Very Good<br />cut: Very Good<br />carat: 0.39<br />price:   863","cut: Very Good<br />cut: Very Good<br />carat: 0.36<br />price:   781","cut: Very Good<br />cut: Very Good<br />carat: 0.33<br />price:   706","cut: Very Good<br />cut: Very Good<br />carat: 0.31<br />price:   639","cut: Very Good<br />cut: Very Good<br />carat: 0.28<br />price:   578","cut: Very Good<br />cut: Very Good<br />carat: 0.26<br />price:   526","cut: Very Good<br />cut: Very Good<br />carat: 0.23<br />price:   480","cut: Very Good<br />cut: Very Good<br />carat: 0.23<br />price:   480"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(33,144,140,0.4)","hoveron":"points","hoverinfo":"x+y","name":"Very Good","legendgroup":"Very Good","showlegend":false,"xaxis":"x3","yaxis":"y","frame":null},{"x":[0.26,0.286075949367089,0.312151898734177,0.338227848101266,0.364303797468354,0.390379746835443,0.416455696202532,0.44253164556962,0.468607594936709,0.494683544303797,0.520759493670886,0.546835443037975,0.572911392405063,0.598987341772152,0.62506329113924,0.651139240506329,0.677215189873418,0.703291139240506,0.729367088607595,0.755443037974683,0.781518987341772,0.807594936708861,0.833670886075949,0.859746835443038,0.885822784810127,0.911898734177215,0.937974683544304,0.964050632911392,0.990126582278481,1.01620253164557,1.04227848101266,1.06835443037975,1.09443037974684,1.12050632911392,1.14658227848101,1.1726582278481,1.19873417721519,1.22481012658228,1.25088607594937,1.27696202531646,1.30303797468354,1.32911392405063,1.35518987341772,1.38126582278481,1.4073417721519,1.43341772151899,1.45949367088608,1.48556962025316,1.51164556962025,1.53772151898734,1.56379746835443,1.58987341772152,1.61594936708861,1.6420253164557,1.66810126582278,1.69417721518987,1.72025316455696,1.74632911392405,1.77240506329114,1.79848101265823,1.82455696202532,1.8506329113924,1.87670886075949,1.90278481012658,1.92886075949367,1.95493670886076,1.98101265822785,2.00708860759494,2.03316455696203,2.05924050632911,2.0853164556962,2.11139240506329,2.13746835443038,2.16354430379747,2.18962025316456,2.21569620253165,2.24177215189873,2.26784810126582,2.29392405063291,2.32,2.32,2.29392405063291,2.26784810126582,2.24177215189873,2.21569620253165,2.18962025316456,2.16354430379747,2.13746835443038,2.11139240506329,2.0853164556962,2.05924050632911,2.03316455696203,2.00708860759494,1.98101265822785,1.95493670886076,1.92886075949367,1.90278481012658,1.87670886075949,1.8506329113924,1.82455696202532,1.79848101265823,1.77240506329114,1.74632911392405,1.72025316455696,1.69417721518987,1.66810126582278,1.6420253164557,1.61594936708861,1.58987341772152,1.56379746835443,1.53772151898734,1.51164556962025,1.48556962025316,1.45949367088608,1.43341772151899,1.4073417721519,1.38126582278481,1.35518987341772,1.32911392405063,1.30303797468354,1.27696202531646,1.25088607594937,1.22481012658228,1.19873417721519,1.1726582278481,1.14658227848101,1.12050632911392,1.09443037974684,1.06835443037975,1.04227848101266,1.01620253164557,0.990126582278481,0.964050632911392,0.937974683544304,0.911898734177215,0.885822784810127,0.859746835443038,0.833670886075949,0.807594936708861,0.781518987341772,0.755443037974683,0.729367088607595,0.703291139240506,0.677215189873418,0.651139240506329,0.62506329113924,0.598987341772152,0.572911392405063,0.546835443037975,0.520759493670886,0.494683544303797,0.468607594936709,0.44253164556962,0.416455696202532,0.390379746835443,0.364303797468354,0.338227848101266,0.312151898734177,0.286075949367089,0.26,0.26],"y":[-0.697236885628172,144.670998165203,279.986387622577,402.546176473691,511.176095170621,605.283158043749,687.558893471562,763.362293470524,838.770979595599,918.558472799396,1006.07259768658,1103.6591281888,1213.12907883132,1345.70280450443,1505.38359475488,1687.67528829125,1887.62415989137,2100.09129154834,2320.05116781548,2542.98469514741,2765.33207899489,2984.84979579164,3200.67898439585,3413.0634813983,3622.84523270636,3830.91590500247,4037.16038044056,4232.44730783111,4417.23851388988,4620.00729662877,4841.60472661866,5069.30648661459,5300.48807428266,5533.39297870831,5767.24636101973,6002.08430127271,6238.35078427056,6477.53000211709,6720.11184588079,6964.67085699003,7209.93910219677,7454.89180004995,7698.7966867578,7941.22023917154,8181.99079789987,8421.12954431202,8658.7649466544,8895.04310213314,9130.03852746263,9363.48226781883,9594.63532591589,9823.3118504098,10049.3284127009,10272.462255808,10492.4540263379,10709.0118581417,10921.8172089985,11130.5326725399,11334.8116912241,11534.3097109899,11728.6959220172,11917.664438695,12100.9436998002,12278.3030748404,12449.5561067255,12614.5603776391,12773.2144922087,12925.4530024863,13071.2402048322,13210.5636508141,13343.4280095905,13469.8496797385,13589.8523337799,13703.463418357,13810.7115321149,13911.6245525599,14006.2283680346,14094.5460776017,14176.597539308,14252.3991688069,17273.9442202979,17031.5017815783,16789.6734767583,16548.5004727275,16308.027378769,16068.3020451817,15829.3751115445,15591.2992065998,15354.1276802291,15117.912730311,14882.7027806033,14648.5389809196,14415.4507516545,14183.450395612,13952.5269603886,13722.6397492727,13493.7121181278,13265.6264003739,13038.2208901572,12811.2897082213,12584.5860445797,12357.8287648573,12130.7118104706,11902.9153785943,11674.1176629231,11444.0060083247,11212.2866238145,10978.6923944798,10742.9887181638,10504.9775891214,10264.5003299892,10021.2668292569,9773.11245616552,9520.33626463647,9264.25499132392,9006.2569533739,8747.7128389727,8489.88604942939,8233.84714529255,7980.40482335329,7730.06903975969,7483.05723300057,7239.34368976776,6998.73330534508,6757.69657906508,6515.50909493284,6275.16151946861,6039.23661444512,5809.50622270749,5586.76051505811,5370.92167088,5177.35772252479,5030.41862500128,4889.01526627105,4704.59991390278,4502.23973778087,4289.27913062501,4070.65660366066,3851.26094733818,3635.3828427913,3426.21027342122,3225.54656020464,3033.87875313532,2850.73460321084,2675.13543952753,2505.98918862147,2342.38896981348,2183.88546635512,2030.77928325985,1883.64591395409,1743.3113332929,1611.24846755197,1489.93229368,1383.26348497361,1297.17161553313,1238.26861535181,1209.16440664681,1209.11328550124,1235.3154108003,1285.54411804348,-0.697236885628172],"text":["cut: Premium<br />cut: Premium<br />carat: 0.26<br />price:   642","cut: Premium<br />cut: Premium<br />carat: 0.29<br />price:   690","cut: Premium<br />cut: Premium<br />carat: 0.31<br />price:   745","cut: Premium<br />cut: Premium<br />carat: 0.34<br />price:   806","cut: Premium<br />cut: Premium<br />carat: 0.36<br />price:   875","cut: Premium<br />cut: Premium<br />carat: 0.39<br />price:   951","cut: Premium<br />cut: Premium<br />carat: 0.42<br />price:  1035","cut: Premium<br />cut: Premium<br />carat: 0.44<br />price:  1127","cut: Premium<br />cut: Premium<br />carat: 0.47<br />price:  1225","cut: Premium<br />cut: Premium<br />carat: 0.49<br />price:  1331","cut: Premium<br />cut: Premium<br />carat: 0.52<br />price:  1445","cut: Premium<br />cut: Premium<br />carat: 0.55<br />price:  1567","cut: Premium<br />cut: Premium<br />carat: 0.57<br />price:  1699","cut: Premium<br />cut: Premium<br />carat: 0.60<br />price:  1844","cut: Premium<br />cut: Premium<br />carat: 0.63<br />price:  2006","cut: Premium<br />cut: Premium<br />carat: 0.65<br />price:  2181","cut: Premium<br />cut: Premium<br />carat: 0.68<br />price:  2369","cut: Premium<br />cut: Premium<br />carat: 0.70<br />price:  2567","cut: Premium<br />cut: Premium<br />carat: 0.73<br />price:  2773","cut: Premium<br />cut: Premium<br />carat: 0.76<br />price:  2985","cut: Premium<br />cut: Premium<br />carat: 0.78<br />price:  3200","cut: Premium<br />cut: Premium<br />carat: 0.81<br />price:  3418","cut: Premium<br />cut: Premium<br />carat: 0.83<br />price:  3636","cut: Premium<br />cut: Premium<br />carat: 0.86<br />price:  3851","cut: Premium<br />cut: Premium<br />carat: 0.89<br />price:  4063","cut: Premium<br />cut: Premium<br />carat: 0.91<br />price:  4268","cut: Premium<br />cut: Premium<br />carat: 0.94<br />price:  4463","cut: Premium<br />cut: Premium<br />carat: 0.96<br />price:  4631","cut: Premium<br />cut: Premium<br />carat: 0.99<br />price:  4797","cut: Premium<br />cut: Premium<br />carat: 1.02<br />price:  4995","cut: Premium<br />cut: Premium<br />carat: 1.04<br />price:  5214","cut: Premium<br />cut: Premium<br />carat: 1.07<br />price:  5439","cut: Premium<br />cut: Premium<br />carat: 1.09<br />price:  5670","cut: Premium<br />cut: Premium<br />carat: 1.12<br />price:  5904","cut: Premium<br />cut: Premium<br />carat: 1.15<br />price:  6141","cut: Premium<br />cut: Premium<br />carat: 1.17<br />price:  6380","cut: Premium<br />cut: Premium<br />carat: 1.20<br />price:  6619","cut: Premium<br />cut: Premium<br />carat: 1.22<br />price:  6858","cut: Premium<br />cut: Premium<br />carat: 1.25<br />price:  7102","cut: Premium<br />cut: Premium<br />carat: 1.28<br />price:  7347","cut: Premium<br />cut: Premium<br />carat: 1.30<br />price:  7595","cut: Premium<br />cut: Premium<br />carat: 1.33<br />price:  7844","cut: Premium<br />cut: Premium<br />carat: 1.36<br />price:  8094","cut: Premium<br />cut: Premium<br />carat: 1.38<br />price:  8344","cut: Premium<br />cut: Premium<br />carat: 1.41<br />price:  8594","cut: Premium<br />cut: Premium<br />carat: 1.43<br />price:  8843","cut: Premium<br />cut: Premium<br />carat: 1.46<br />price:  9090","cut: Premium<br />cut: Premium<br />carat: 1.49<br />price:  9334","cut: Premium<br />cut: Premium<br />carat: 1.51<br />price:  9576","cut: Premium<br />cut: Premium<br />carat: 1.54<br />price:  9814","cut: Premium<br />cut: Premium<br />carat: 1.56<br />price: 10050","cut: Premium<br />cut: Premium<br />carat: 1.59<br />price: 10283","cut: Premium<br />cut: Premium<br />carat: 1.62<br />price: 10514","cut: Premium<br />cut: Premium<br />carat: 1.64<br />price: 10742","cut: Premium<br />cut: Premium<br />carat: 1.67<br />price: 10968","cut: Premium<br />cut: Premium<br />carat: 1.69<br />price: 11192","cut: Premium<br />cut: Premium<br />carat: 1.72<br />price: 11412","cut: Premium<br />cut: Premium<br />carat: 1.75<br />price: 11631","cut: Premium<br />cut: Premium<br />carat: 1.77<br />price: 11846","cut: Premium<br />cut: Premium<br />carat: 1.80<br />price: 12059","cut: Premium<br />cut: Premium<br />carat: 1.82<br />price: 12270","cut: Premium<br />cut: Premium<br />carat: 1.85<br />price: 12478","cut: Premium<br />cut: Premium<br />carat: 1.88<br />price: 12683","cut: Premium<br />cut: Premium<br />carat: 1.90<br />price: 12886","cut: Premium<br />cut: Premium<br />carat: 1.93<br />price: 13086","cut: Premium<br />cut: Premium<br />carat: 1.95<br />price: 13284","cut: Premium<br />cut: Premium<br />carat: 1.98<br />price: 13478","cut: Premium<br />cut: Premium<br />carat: 2.01<br />price: 13670","cut: Premium<br />cut: Premium<br />carat: 2.03<br />price: 13860","cut: Premium<br />cut: Premium<br />carat: 2.06<br />price: 14047","cut: Premium<br />cut: Premium<br />carat: 2.09<br />price: 14231","cut: Premium<br />cut: Premium<br />carat: 2.11<br />price: 14412","cut: Premium<br />cut: Premium<br />carat: 2.14<br />price: 14591","cut: Premium<br />cut: Premium<br />carat: 2.16<br />price: 14766","cut: Premium<br />cut: Premium<br />carat: 2.19<br />price: 14940","cut: Premium<br />cut: Premium<br />carat: 2.22<br />price: 15110","cut: Premium<br />cut: Premium<br />carat: 2.24<br />price: 15277","cut: Premium<br />cut: Premium<br />carat: 2.27<br />price: 15442","cut: Premium<br />cut: Premium<br />carat: 2.29<br />price: 15604","cut: Premium<br />cut: Premium<br />carat: 2.32<br />price: 15763","cut: Premium<br />cut: Premium<br />carat: 2.32<br />price: 15763","cut: Premium<br />cut: Premium<br />carat: 2.29<br />price: 15604","cut: Premium<br />cut: Premium<br />carat: 2.27<br />price: 15442","cut: Premium<br />cut: Premium<br />carat: 2.24<br />price: 15277","cut: Premium<br />cut: Premium<br />carat: 2.22<br />price: 15110","cut: Premium<br />cut: Premium<br />carat: 2.19<br />price: 14940","cut: Premium<br />cut: Premium<br />carat: 2.16<br />price: 14766","cut: Premium<br />cut: Premium<br />carat: 2.14<br />price: 14591","cut: Premium<br />cut: Premium<br />carat: 2.11<br />price: 14412","cut: Premium<br />cut: Premium<br />carat: 2.09<br />price: 14231","cut: Premium<br />cut: Premium<br />carat: 2.06<br />price: 14047","cut: Premium<br />cut: Premium<br />carat: 2.03<br />price: 13860","cut: Premium<br />cut: Premium<br />carat: 2.01<br />price: 13670","cut: Premium<br />cut: Premium<br />carat: 1.98<br />price: 13478","cut: Premium<br />cut: Premium<br />carat: 1.95<br />price: 13284","cut: Premium<br />cut: Premium<br />carat: 1.93<br />price: 13086","cut: Premium<br />cut: Premium<br />carat: 1.90<br />price: 12886","cut: Premium<br />cut: Premium<br />carat: 1.88<br />price: 12683","cut: Premium<br />cut: Premium<br />carat: 1.85<br />price: 12478","cut: Premium<br />cut: Premium<br />carat: 1.82<br />price: 12270","cut: Premium<br />cut: Premium<br />carat: 1.80<br />price: 12059","cut: Premium<br />cut: Premium<br />carat: 1.77<br />price: 11846","cut: Premium<br />cut: Premium<br />carat: 1.75<br />price: 11631","cut: Premium<br />cut: Premium<br />carat: 1.72<br />price: 11412","cut: Premium<br />cut: Premium<br />carat: 1.69<br />price: 11192","cut: Premium<br />cut: Premium<br />carat: 1.67<br />price: 10968","cut: Premium<br />cut: Premium<br />carat: 1.64<br />price: 10742","cut: Premium<br />cut: Premium<br />carat: 1.62<br />price: 10514","cut: Premium<br />cut: Premium<br />carat: 1.59<br />price: 10283","cut: Premium<br />cut: Premium<br />carat: 1.56<br />price: 10050","cut: Premium<br />cut: Premium<br />carat: 1.54<br />price:  9814","cut: Premium<br />cut: Premium<br />carat: 1.51<br />price:  9576","cut: Premium<br />cut: Premium<br />carat: 1.49<br />price:  9334","cut: Premium<br />cut: Premium<br />carat: 1.46<br />price:  9090","cut: Premium<br />cut: Premium<br />carat: 1.43<br />price:  8843","cut: Premium<br />cut: Premium<br />carat: 1.41<br />price:  8594","cut: Premium<br />cut: Premium<br />carat: 1.38<br />price:  8344","cut: Premium<br />cut: Premium<br />carat: 1.36<br />price:  8094","cut: Premium<br />cut: Premium<br />carat: 1.33<br />price:  7844","cut: Premium<br />cut: Premium<br />carat: 1.30<br />price:  7595","cut: Premium<br />cut: Premium<br />carat: 1.28<br />price:  7347","cut: Premium<br />cut: Premium<br />carat: 1.25<br />price:  7102","cut: Premium<br />cut: Premium<br />carat: 1.22<br />price:  6858","cut: Premium<br />cut: Premium<br />carat: 1.20<br />price:  6619","cut: Premium<br />cut: Premium<br />carat: 1.17<br />price:  6380","cut: Premium<br />cut: Premium<br />carat: 1.15<br />price:  6141","cut: Premium<br />cut: Premium<br />carat: 1.12<br />price:  5904","cut: Premium<br />cut: Premium<br />carat: 1.09<br />price:  5670","cut: Premium<br />cut: Premium<br />carat: 1.07<br />price:  5439","cut: Premium<br />cut: Premium<br />carat: 1.04<br />price:  5214","cut: Premium<br />cut: Premium<br />carat: 1.02<br />price:  4995","cut: Premium<br />cut: Premium<br />carat: 0.99<br />price:  4797","cut: Premium<br />cut: Premium<br />carat: 0.96<br />price:  4631","cut: Premium<br />cut: Premium<br />carat: 0.94<br />price:  4463","cut: Premium<br />cut: Premium<br />carat: 0.91<br />price:  4268","cut: Premium<br />cut: Premium<br />carat: 0.89<br />price:  4063","cut: Premium<br />cut: Premium<br />carat: 0.86<br />price:  3851","cut: Premium<br />cut: Premium<br />carat: 0.83<br />price:  3636","cut: Premium<br />cut: Premium<br />carat: 0.81<br />price:  3418","cut: Premium<br />cut: Premium<br />carat: 0.78<br />price:  3200","cut: Premium<br />cut: Premium<br />carat: 0.76<br />price:  2985","cut: Premium<br />cut: Premium<br />carat: 0.73<br />price:  2773","cut: Premium<br />cut: Premium<br />carat: 0.70<br />price:  2567","cut: Premium<br />cut: Premium<br />carat: 0.68<br />price:  2369","cut: Premium<br />cut: Premium<br />carat: 0.65<br />price:  2181","cut: Premium<br />cut: Premium<br />carat: 0.63<br />price:  2006","cut: Premium<br />cut: Premium<br />carat: 0.60<br />price:  1844","cut: Premium<br />cut: Premium<br />carat: 0.57<br />price:  1699","cut: Premium<br />cut: Premium<br />carat: 0.55<br />price:  1567","cut: Premium<br />cut: Premium<br />carat: 0.52<br />price:  1445","cut: Premium<br />cut: Premium<br />carat: 0.49<br />price:  1331","cut: Premium<br />cut: Premium<br />carat: 0.47<br />price:  1225","cut: Premium<br />cut: Premium<br />carat: 0.44<br />price:  1127","cut: Premium<br />cut: Premium<br />carat: 0.42<br />price:  1035","cut: Premium<br />cut: Premium<br />carat: 0.39<br />price:   951","cut: Premium<br />cut: Premium<br />carat: 0.36<br />price:   875","cut: Premium<br />cut: Premium<br />carat: 0.34<br />price:   806","cut: Premium<br />cut: Premium<br />carat: 0.31<br />price:   745","cut: Premium<br />cut: Premium<br />carat: 0.29<br />price:   690","cut: Premium<br />cut: Premium<br />carat: 0.26<br />price:   642","cut: Premium<br />cut: Premium<br />carat: 0.26<br />price:   642"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(93,200,99,0.4)","hoveron":"points","hoverinfo":"x+y","name":"Premium","legendgroup":"Premium","showlegend":false,"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.2,0.226835443037975,0.253670886075949,0.280506329113924,0.307341772151899,0.334177215189873,0.361012658227848,0.387848101265823,0.414683544303797,0.441518987341772,0.468354430379747,0.495189873417721,0.522025316455696,0.548860759493671,0.575696202531645,0.60253164556962,0.629367088607595,0.65620253164557,0.683037974683544,0.709873417721519,0.736708860759494,0.763544303797468,0.790379746835443,0.817215189873418,0.844050632911392,0.870886075949367,0.897721518987342,0.924556962025316,0.951392405063291,0.978227848101266,1.00506329113924,1.03189873417722,1.05873417721519,1.08556962025316,1.11240506329114,1.13924050632911,1.16607594936709,1.19291139240506,1.21974683544304,1.24658227848101,1.27341772151899,1.30025316455696,1.32708860759494,1.35392405063291,1.38075949367089,1.40759493670886,1.43443037974684,1.46126582278481,1.48810126582278,1.51493670886076,1.54177215189873,1.56860759493671,1.59544303797468,1.62227848101266,1.64911392405063,1.67594936708861,1.70278481012658,1.72962025316456,1.75645569620253,1.78329113924051,1.81012658227848,1.83696202531646,1.86379746835443,1.8906329113924,1.91746835443038,1.94430379746835,1.97113924050633,1.9979746835443,2.02481012658228,2.05164556962025,2.07848101265823,2.1053164556962,2.13215189873418,2.15898734177215,2.18582278481013,2.2126582278481,2.23949367088608,2.26632911392405,2.29316455696203,2.32,2.32,2.32,2.29316455696203,2.26632911392405,2.23949367088608,2.2126582278481,2.18582278481013,2.15898734177215,2.13215189873418,2.1053164556962,2.07848101265823,2.05164556962025,2.02481012658228,1.9979746835443,1.97113924050633,1.94430379746835,1.91746835443038,1.8906329113924,1.86379746835443,1.83696202531646,1.81012658227848,1.78329113924051,1.75645569620253,1.72962025316456,1.70278481012658,1.67594936708861,1.64911392405063,1.62227848101266,1.59544303797468,1.56860759493671,1.54177215189873,1.51493670886076,1.48810126582278,1.46126582278481,1.43443037974684,1.40759493670886,1.38075949367089,1.35392405063291,1.32708860759494,1.30025316455696,1.27341772151899,1.24658227848101,1.21974683544304,1.19291139240506,1.16607594936709,1.13924050632911,1.11240506329114,1.08556962025316,1.05873417721519,1.03189873417722,1.00506329113924,0.978227848101266,0.951392405063291,0.924556962025316,0.897721518987342,0.870886075949367,0.844050632911392,0.817215189873418,0.790379746835443,0.763544303797468,0.736708860759494,0.709873417721519,0.683037974683544,0.65620253164557,0.629367088607595,0.60253164556962,0.575696202531645,0.548860759493671,0.522025316455696,0.495189873417721,0.468354430379747,0.441518987341772,0.414683544303797,0.387848101265823,0.361012658227848,0.334177215189873,0.307341772151899,0.280506329113924,0.253670886075949,0.226835443037975,0.2,0.2],"y":[-40.5526545937881,102.00362250019,241.060285862918,375.496150413276,503.759752255408,623.286906891187,731.380749820798,831.298716737845,930.5490520378,1032.84648021656,1146.12576588681,1270.97540331194,1405.76366548251,1549.22434611552,1701.79733458704,1865.69992875838,2033.61619769953,2200.4828007705,2368.24117945663,2544.9057901346,2739.94332787134,2952.62021784439,3178.95585571095,3416.3925871083,3662.22416910941,3913.8961237984,4169.37137626413,4427.47923314523,4688.06183722677,4951.7922491211,5219.73207868178,5493.22288130622,5775.1526569698,6064.30570771754,6358.85652194525,6657.18097188286,6957.79463248482,7259.23106732021,7558.77411333883,7852.95715536798,8142.05349666783,8426.44115660255,8706.42852476279,8982.25688622265,9254.10686090261,9522.10608766486,9786.33665174102,10046.8415796455,10303.6302200586,10556.6825897406,10805.9528838915,11051.3723952511,11292.8520930602,11530.2850997514,11763.5492758643,11992.5100817015,12217.0238251206,12436.9413277233,12652.1119504421,12862.3878246313,13067.6280527626,13267.7025926418,13462.495535965,13651.9075411862,13835.8572737014,14014.2818229075,14187.136179922,14354.3919486886,14516.0355133886,14672.0658947262,14822.4925044896,14967.3329644082,15106.611104558,15240.3552083568,15368.5965314458,15491.3680927201,15608.7037170766,15720.6372993265,15827.2022549306,15928.4311236153,15928.4311236153,17758.17032476,17568.124788071,17376.154382091,17182.2721917836,16986.4921778466,16788.8287803282,16589.2963693624,16387.9085090814,16184.6770003634,15979.6106718632,15772.7138988938,15563.9848484218,15353.4134774724,15140.9793519867,14926.6494013832,14710.3757748426,14492.0940087194,14271.7217376477,14049.1581722603,13824.2845162484,13596.9654065452,13367.0513461934,13134.3819829017,12898.7899932617,12660.1052834428,12418.1592202836,12172.788656879,11923.8395987685,11671.1704517288,11414.6548834294,11154.1844083484,10889.6708644625,10621.0489922087,10348.2793535844,10071.3518425069,9790.29003072769,9505.15654871541,9216.05958056931,8923.1602914469,8626.68051165934,8326.90917603432,8024.20484917305,7719.0534510428,7413.45557871204,7109.44044153569,6808.78006641958,6513.22849165489,6224.40005280828,5943.7077016123,5670.87788775284,5400.18125222363,5132.85991018572,4871.2695334746,4617.37724468457,4372.31924858264,4136.2189137894,3908.33322737564,3687.40177340742,3472.01237093968,3260.90142759162,3052.16865701993,2846.61809493436,2651.84379878895,2473.86597229014,2312.63180425302,2161.08370136735,2009.53437102663,1856.86274677708,1706.15458624836,1559.86416438115,1420.08023538967,1288.85872202608,1168.53594243359,1067.17952470773,991.417403350722,943.970751497405,925.021398207396,932.199372409189,961.883481826287,1010.88281299693,-40.5526545937881],"text":["cut: Ideal<br />cut: Ideal<br />carat: 0.20<br />price:   485","cut: Ideal<br />cut: Ideal<br />carat: 0.23<br />price:   532","cut: Ideal<br />cut: Ideal<br />carat: 0.25<br />price:   587","cut: Ideal<br />cut: Ideal<br />carat: 0.28<br />price:   650","cut: Ideal<br />cut: Ideal<br />carat: 0.31<br />price:   724","cut: Ideal<br />cut: Ideal<br />carat: 0.33<br />price:   807","cut: Ideal<br />cut: Ideal<br />carat: 0.36<br />price:   899","cut: Ideal<br />cut: Ideal<br />carat: 0.39<br />price:  1000","cut: Ideal<br />cut: Ideal<br />carat: 0.41<br />price:  1110","cut: Ideal<br />cut: Ideal<br />carat: 0.44<br />price:  1226","cut: Ideal<br />cut: Ideal<br />carat: 0.47<br />price:  1353","cut: Ideal<br />cut: Ideal<br />carat: 0.50<br />price:  1489","cut: Ideal<br />cut: Ideal<br />carat: 0.52<br />price:  1631","cut: Ideal<br />cut: Ideal<br />carat: 0.55<br />price:  1779","cut: Ideal<br />cut: Ideal<br />carat: 0.58<br />price:  1931","cut: Ideal<br />cut: Ideal<br />carat: 0.60<br />price:  2089","cut: Ideal<br />cut: Ideal<br />carat: 0.63<br />price:  2254","cut: Ideal<br />cut: Ideal<br />carat: 0.66<br />price:  2426","cut: Ideal<br />cut: Ideal<br />carat: 0.68<br />price:  2607","cut: Ideal<br />cut: Ideal<br />carat: 0.71<br />price:  2799","cut: Ideal<br />cut: Ideal<br />carat: 0.74<br />price:  3000","cut: Ideal<br />cut: Ideal<br />carat: 0.76<br />price:  3212","cut: Ideal<br />cut: Ideal<br />carat: 0.79<br />price:  3433","cut: Ideal<br />cut: Ideal<br />carat: 0.82<br />price:  3662","cut: Ideal<br />cut: Ideal<br />carat: 0.84<br />price:  3899","cut: Ideal<br />cut: Ideal<br />carat: 0.87<br />price:  4143","cut: Ideal<br />cut: Ideal<br />carat: 0.90<br />price:  4393","cut: Ideal<br />cut: Ideal<br />carat: 0.92<br />price:  4649","cut: Ideal<br />cut: Ideal<br />carat: 0.95<br />price:  4910","cut: Ideal<br />cut: Ideal<br />carat: 0.98<br />price:  5176","cut: Ideal<br />cut: Ideal<br />carat: 1.01<br />price:  5445","cut: Ideal<br />cut: Ideal<br />carat: 1.03<br />price:  5718","cut: Ideal<br />cut: Ideal<br />carat: 1.06<br />price:  6000","cut: Ideal<br />cut: Ideal<br />carat: 1.09<br />price:  6289","cut: Ideal<br />cut: Ideal<br />carat: 1.11<br />price:  6584","cut: Ideal<br />cut: Ideal<br />carat: 1.14<br />price:  6883","cut: Ideal<br />cut: Ideal<br />carat: 1.17<br />price:  7186","cut: Ideal<br />cut: Ideal<br />carat: 1.19<br />price:  7489","cut: Ideal<br />cut: Ideal<br />carat: 1.22<br />price:  7791","cut: Ideal<br />cut: Ideal<br />carat: 1.25<br />price:  8090","cut: Ideal<br />cut: Ideal<br />carat: 1.27<br />price:  8384","cut: Ideal<br />cut: Ideal<br />carat: 1.30<br />price:  8675","cut: Ideal<br />cut: Ideal<br />carat: 1.33<br />price:  8961","cut: Ideal<br />cut: Ideal<br />carat: 1.35<br />price:  9244","cut: Ideal<br />cut: Ideal<br />carat: 1.38<br />price:  9522","cut: Ideal<br />cut: Ideal<br />carat: 1.41<br />price:  9797","cut: Ideal<br />cut: Ideal<br />carat: 1.43<br />price: 10067","cut: Ideal<br />cut: Ideal<br />carat: 1.46<br />price: 10334","cut: Ideal<br />cut: Ideal<br />carat: 1.49<br />price: 10597","cut: Ideal<br />cut: Ideal<br />carat: 1.51<br />price: 10855","cut: Ideal<br />cut: Ideal<br />carat: 1.54<br />price: 11110","cut: Ideal<br />cut: Ideal<br />carat: 1.57<br />price: 11361","cut: Ideal<br />cut: Ideal<br />carat: 1.60<br />price: 11608","cut: Ideal<br />cut: Ideal<br />carat: 1.62<br />price: 11852","cut: Ideal<br />cut: Ideal<br />carat: 1.65<br />price: 12091","cut: Ideal<br />cut: Ideal<br />carat: 1.68<br />price: 12326","cut: Ideal<br />cut: Ideal<br />carat: 1.70<br />price: 12558","cut: Ideal<br />cut: Ideal<br />carat: 1.73<br />price: 12786","cut: Ideal<br />cut: Ideal<br />carat: 1.76<br />price: 13010","cut: Ideal<br />cut: Ideal<br />carat: 1.78<br />price: 13230","cut: Ideal<br />cut: Ideal<br />carat: 1.81<br />price: 13446","cut: Ideal<br />cut: Ideal<br />carat: 1.84<br />price: 13658","cut: Ideal<br />cut: Ideal<br />carat: 1.86<br />price: 13867","cut: Ideal<br />cut: Ideal<br />carat: 1.89<br />price: 14072","cut: Ideal<br />cut: Ideal<br />carat: 1.92<br />price: 14273","cut: Ideal<br />cut: Ideal<br />carat: 1.94<br />price: 14470","cut: Ideal<br />cut: Ideal<br />carat: 1.97<br />price: 14664","cut: Ideal<br />cut: Ideal<br />carat: 2.00<br />price: 14854","cut: Ideal<br />cut: Ideal<br />carat: 2.02<br />price: 15040","cut: Ideal<br />cut: Ideal<br />carat: 2.05<br />price: 15222","cut: Ideal<br />cut: Ideal<br />carat: 2.08<br />price: 15401","cut: Ideal<br />cut: Ideal<br />carat: 2.11<br />price: 15576","cut: Ideal<br />cut: Ideal<br />carat: 2.13<br />price: 15747","cut: Ideal<br />cut: Ideal<br />carat: 2.16<br />price: 15915","cut: Ideal<br />cut: Ideal<br />carat: 2.19<br />price: 16079","cut: Ideal<br />cut: Ideal<br />carat: 2.21<br />price: 16239","cut: Ideal<br />cut: Ideal<br />carat: 2.24<br />price: 16395","cut: Ideal<br />cut: Ideal<br />carat: 2.27<br />price: 16548","cut: Ideal<br />cut: Ideal<br />carat: 2.29<br />price: 16698","cut: Ideal<br />cut: Ideal<br />carat: 2.32<br />price: 16843","cut: Ideal<br />cut: Ideal<br />carat: 2.32<br />price: 16843","cut: Ideal<br />cut: Ideal<br />carat: 2.32<br />price: 16843","cut: Ideal<br />cut: Ideal<br />carat: 2.29<br />price: 16698","cut: Ideal<br />cut: Ideal<br />carat: 2.27<br />price: 16548","cut: Ideal<br />cut: Ideal<br />carat: 2.24<br />price: 16395","cut: Ideal<br />cut: Ideal<br />carat: 2.21<br />price: 16239","cut: Ideal<br />cut: Ideal<br />carat: 2.19<br />price: 16079","cut: Ideal<br />cut: Ideal<br />carat: 2.16<br />price: 15915","cut: Ideal<br />cut: Ideal<br />carat: 2.13<br />price: 15747","cut: Ideal<br />cut: Ideal<br />carat: 2.11<br />price: 15576","cut: Ideal<br />cut: Ideal<br />carat: 2.08<br />price: 15401","cut: Ideal<br />cut: Ideal<br />carat: 2.05<br />price: 15222","cut: Ideal<br />cut: Ideal<br />carat: 2.02<br />price: 15040","cut: Ideal<br />cut: Ideal<br />carat: 2.00<br />price: 14854","cut: Ideal<br />cut: Ideal<br />carat: 1.97<br />price: 14664","cut: Ideal<br />cut: Ideal<br />carat: 1.94<br />price: 14470","cut: Ideal<br />cut: Ideal<br />carat: 1.92<br />price: 14273","cut: Ideal<br />cut: Ideal<br />carat: 1.89<br />price: 14072","cut: Ideal<br />cut: Ideal<br />carat: 1.86<br />price: 13867","cut: Ideal<br />cut: Ideal<br />carat: 1.84<br />price: 13658","cut: Ideal<br />cut: Ideal<br />carat: 1.81<br />price: 13446","cut: Ideal<br />cut: Ideal<br />carat: 1.78<br />price: 13230","cut: Ideal<br />cut: Ideal<br />carat: 1.76<br />price: 13010","cut: Ideal<br />cut: Ideal<br />carat: 1.73<br />price: 12786","cut: Ideal<br />cut: Ideal<br />carat: 1.70<br />price: 12558","cut: Ideal<br />cut: Ideal<br />carat: 1.68<br />price: 12326","cut: Ideal<br />cut: Ideal<br />carat: 1.65<br />price: 12091","cut: Ideal<br />cut: Ideal<br />carat: 1.62<br />price: 11852","cut: Ideal<br />cut: Ideal<br />carat: 1.60<br />price: 11608","cut: Ideal<br />cut: Ideal<br />carat: 1.57<br />price: 11361","cut: Ideal<br />cut: Ideal<br />carat: 1.54<br />price: 11110","cut: Ideal<br />cut: Ideal<br />carat: 1.51<br />price: 10855","cut: Ideal<br />cut: Ideal<br />carat: 1.49<br />price: 10597","cut: Ideal<br />cut: Ideal<br />carat: 1.46<br />price: 10334","cut: Ideal<br />cut: Ideal<br />carat: 1.43<br />price: 10067","cut: Ideal<br />cut: Ideal<br />carat: 1.41<br />price:  9797","cut: Ideal<br />cut: Ideal<br />carat: 1.38<br />price:  9522","cut: Ideal<br />cut: Ideal<br />carat: 1.35<br />price:  9244","cut: Ideal<br />cut: Ideal<br />carat: 1.33<br />price:  8961","cut: Ideal<br />cut: Ideal<br />carat: 1.30<br />price:  8675","cut: Ideal<br />cut: Ideal<br />carat: 1.27<br />price:  8384","cut: Ideal<br />cut: Ideal<br />carat: 1.25<br />price:  8090","cut: Ideal<br />cut: Ideal<br />carat: 1.22<br />price:  7791","cut: Ideal<br />cut: Ideal<br />carat: 1.19<br />price:  7489","cut: Ideal<br />cut: Ideal<br />carat: 1.17<br />price:  7186","cut: Ideal<br />cut: Ideal<br />carat: 1.14<br />price:  6883","cut: Ideal<br />cut: Ideal<br />carat: 1.11<br />price:  6584","cut: Ideal<br />cut: Ideal<br />carat: 1.09<br />price:  6289","cut: Ideal<br />cut: Ideal<br />carat: 1.06<br />price:  6000","cut: Ideal<br />cut: Ideal<br />carat: 1.03<br />price:  5718","cut: Ideal<br />cut: Ideal<br />carat: 1.01<br />price:  5445","cut: Ideal<br />cut: Ideal<br />carat: 0.98<br />price:  5176","cut: Ideal<br />cut: Ideal<br />carat: 0.95<br />price:  4910","cut: Ideal<br />cut: Ideal<br />carat: 0.92<br />price:  4649","cut: Ideal<br />cut: Ideal<br />carat: 0.90<br />price:  4393","cut: Ideal<br />cut: Ideal<br />carat: 0.87<br />price:  4143","cut: Ideal<br />cut: Ideal<br />carat: 0.84<br />price:  3899","cut: Ideal<br />cut: Ideal<br />carat: 0.82<br />price:  3662","cut: Ideal<br />cut: Ideal<br />carat: 0.79<br />price:  3433","cut: Ideal<br />cut: Ideal<br />carat: 0.76<br />price:  3212","cut: Ideal<br />cut: Ideal<br />carat: 0.74<br />price:  3000","cut: Ideal<br />cut: Ideal<br />carat: 0.71<br />price:  2799","cut: Ideal<br />cut: Ideal<br />carat: 0.68<br />price:  2607","cut: Ideal<br />cut: Ideal<br />carat: 0.66<br />price:  2426","cut: Ideal<br />cut: Ideal<br />carat: 0.63<br />price:  2254","cut: Ideal<br />cut: Ideal<br />carat: 0.60<br />price:  2089","cut: Ideal<br />cut: Ideal<br />carat: 0.58<br />price:  1931","cut: Ideal<br />cut: Ideal<br />carat: 0.55<br />price:  1779","cut: Ideal<br />cut: Ideal<br />carat: 0.52<br />price:  1631","cut: Ideal<br />cut: Ideal<br />carat: 0.50<br />price:  1489","cut: Ideal<br />cut: Ideal<br />carat: 0.47<br />price:  1353","cut: Ideal<br />cut: Ideal<br />carat: 0.44<br />price:  1226","cut: Ideal<br />cut: Ideal<br />carat: 0.41<br />price:  1110","cut: Ideal<br />cut: Ideal<br />carat: 0.39<br />price:  1000","cut: Ideal<br />cut: Ideal<br />carat: 0.36<br />price:   899","cut: Ideal<br />cut: Ideal<br />carat: 0.33<br />price:   807","cut: Ideal<br />cut: Ideal<br />carat: 0.31<br />price:   724","cut: Ideal<br />cut: Ideal<br />carat: 0.28<br />price:   650","cut: Ideal<br />cut: Ideal<br />carat: 0.25<br />price:   587","cut: Ideal<br />cut: Ideal<br />carat: 0.23<br />price:   532","cut: Ideal<br />cut: Ideal<br />carat: 0.20<br />price:   485","cut: Ideal<br />cut: Ideal<br />carat: 0.20<br />price:   485"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(253,231,37,0.4)","hoveron":"points","hoverinfo":"x+y","name":"Ideal","legendgroup":"Ideal","showlegend":false,"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"margin":{"t":37.9178082191781,"r":7.30593607305936,"b":40.1826484018265,"l":54.7945205479452},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.329256360078278],"automargin":true,"type":"linear","autorange":false,"range":[0.094,2.426],"tickmode":"array","ticktext":["0.5","1.0","1.5","2.0"],"tickvals":[0.5,1,1.5,2],"categoryorder":"array","categoryarray":["0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"annotations":[{"text":"carat","x":0.5,"y":-0.0176940639269406,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"price","x":-0.022423352902805,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"Fair","x":0.164628180039139,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Good","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Very Good","x":0.835371819960861,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Premium","x":0.164628180039139,"y":0.485159817351598,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Ideal","x":0.5,"y":0.485159817351598,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"cut","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"yaxis":{"domain":[0.514840182648402,1],"automargin":true,"type":"linear","autorange":false,"range":[-3750.278544856,19860.2037402312],"tickmode":"array","ticktext":["0","5000","10000","15000"],"tickvals":[0,5000,10000,15000],"categoryorder":"array","categoryarray":["0","5000","10000","15000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.329256360078278,"y0":0.514840182648402,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.329256360078278,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.337410306588389,"x1":0.662589693411611,"y0":0.514840182648402,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.337410306588389,"x1":0.662589693411611,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.670743639921722,"x1":1,"y0":0.514840182648402,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.670743639921722,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.329256360078278,"y0":0,"y1":0.485159817351598},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.329256360078278,"y0":0,"y1":23.37899543379,"yanchor":0.485159817351598,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.337410306588389,"x1":0.662589693411611,"y0":0,"y1":0.485159817351598},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.337410306588389,"x1":0.662589693411611,"y0":0,"y1":23.37899543379,"yanchor":0.485159817351598,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.094,2.426],"tickmode":"array","ticktext":["0.5","1.0","1.5","2.0"],"tickvals":[0.5,1,1.5,2],"categoryorder":"array","categoryarray":["0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.337410306588389,0.662589693411611],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[0.094,2.426],"tickmode":"array","ticktext":["0.5","1.0","1.5","2.0"],"tickvals":[0.5,1,1.5,2],"categoryorder":"array","categoryarray":["0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.670743639921722,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-3750.278544856,19860.2037402312],"tickmode":"array","ticktext":["0","5000","10000","15000"],"tickvals":[0,5000,10000,15000],"categoryorder":"array","categoryarray":["0","5000","10000","15000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.485159817351598],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"1144316e5e19":{"text":{},"x":{},"y":{},"type":"scatter"},"114447304dc4":{"colour":{},"fill":{},"x":{},"y":{}}},"cur_data":"1144316e5e19","visdat":{"1144316e5e19":["function (y) ","x"],"114447304dc4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Plotly提供免費的圖形分享空間，方便使用者將做好的圖上傳到網路上，若想使用Plotly提供圖形分享空間，必須要先申請Plotly帳號，透過<a href="https://plot.ly/settings/api">此網頁</a>取得API keys，並使用下列程式碼設定帳號與API keys</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb588-1" title="1"><span class="kw">Sys.setenv</span>(<span class="st">&quot;plotly_username&quot;</span>=<span class="st">&quot;your_plotly_username&quot;</span>)</a>
<a class="sourceLine" id="cb588-2" title="2"><span class="kw">Sys.setenv</span>(<span class="st">&quot;plotly_api_key&quot;</span>=<span class="st">&quot;your_api_key&quot;</span>)</a></code></pre></div>
<p>設定完基本資料後，使用<code>plotly_POST</code>函式將plotly物件<code>p</code>上傳到指定路徑(<code>filename</code>)的網路空間中。</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb589-1" title="1"><span class="kw">plotly_POST</span>(p, <span class="dt">filename =</span> <span class="st">&quot;file-name&quot;</span>)</a></code></pre></div>
<p>參考資料</p>
<ul>
<li><a href="https://plot.ly/" target="_blank">Plotly官網</a></li>
<li><a href="https://plot.ly/r/" target="_blank">Plotly API for R</a></li>
<li><a href="https://images.plot.ly/plotly-documentation/images/r_cheat_sheet.pdf" target="_blank">Plotly cheat sheet</a></li>
</ul>
</div>
<div id="shiny簡介" class="section level2">
<h2><span class="header-section-number">9.3</span> Shiny簡介</h2>
<p>Shiny是RStudio推出供R語言使用的網頁應用框架（Web application framework），透過Shiny，使用者可以輕鬆地將資料分析結果轉換成互動式的網頁應用，不用另外學習其他網頁程式語言（如HTML, CSS, JavaScript等），若要使用Shiny，RStudio IDE提供完整測試預覽功能，建議一起使用。使用前必須先安裝並載入<code>shiny</code> <span class="citation">(Chang et al. <a href="#ref-R-shiny" role="doc-biblioref">2019</a>)</span> package</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb590-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;shiny&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb591-1" title="1"><span class="kw">library</span>(shiny)</a></code></pre></div>
<p>shiny package內提供11個網頁部署範例，使用者可以直接用下列程式碼觀看相關範例的呈現效果與原始碼</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb592-1" title="1"><span class="kw">runExample</span>(<span class="st">&quot;01_hello&quot;</span>) <span class="co"># a histogram</span></a>
<a class="sourceLine" id="cb592-2" title="2"><span class="kw">runExample</span>(<span class="st">&quot;02_text&quot;</span>) <span class="co"># tables and data frames</span></a>
<a class="sourceLine" id="cb592-3" title="3"><span class="kw">runExample</span>(<span class="st">&quot;03_reactivity&quot;</span>) <span class="co"># a reactive expression</span></a>
<a class="sourceLine" id="cb592-4" title="4"><span class="kw">runExample</span>(<span class="st">&quot;04_mpg&quot;</span>) <span class="co"># global variables</span></a>
<a class="sourceLine" id="cb592-5" title="5"><span class="kw">runExample</span>(<span class="st">&quot;05_sliders&quot;</span>) <span class="co"># slider bars</span></a>
<a class="sourceLine" id="cb592-6" title="6"><span class="kw">runExample</span>(<span class="st">&quot;06_tabsets&quot;</span>) <span class="co"># tabbed panels</span></a>
<a class="sourceLine" id="cb592-7" title="7"><span class="kw">runExample</span>(<span class="st">&quot;07_widgets&quot;</span>) <span class="co"># help text and submit buttons</span></a>
<a class="sourceLine" id="cb592-8" title="8"><span class="kw">runExample</span>(<span class="st">&quot;08_html&quot;</span>) <span class="co"># Shiny app built from HTML</span></a>
<a class="sourceLine" id="cb592-9" title="9"><span class="kw">runExample</span>(<span class="st">&quot;09_upload&quot;</span>) <span class="co"># file upload wizard</span></a>
<a class="sourceLine" id="cb592-10" title="10"><span class="kw">runExample</span>(<span class="st">&quot;10_download&quot;</span>) <span class="co"># file download wizard</span></a>
<a class="sourceLine" id="cb592-11" title="11"><span class="kw">runExample</span>(<span class="st">&quot;11_timer&quot;</span>) <span class="co"># an automated timer</span></a></code></pre></div>
<p>在RStudio內，可直接透過新增專案 <strong>New Project</strong>新增Shiny應用程式</p>
<p><img src="figure/shiny1.png" width="246" /></p>
<p><img src="figure/shiny2.png" width="276" /></p>
<p><img src="figure/shiny3.png" width="278" /></p>
<p><img src="figure/shiny4.png" width="276" /></p>
<p>Shiny應用程式包括兩個元件：</p>
<ul>
<li><strong>ui.R</strong> : 使用者介面（前端）程式碼 user-interface script</li>
<li><strong>server.R</strong> : 伺服器端（後端）程式碼 server script</li>
</ul>
<p>使用者介面程式碼<strong>ui.R</strong>控制Shiny應用程式的外觀，伺服器端程式碼<strong>server.R</strong>控制Shiny應用程式的功能。</p>
<p><strong>ui.R範例</strong></p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb593-1" title="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb593-2" title="2"></a>
<a class="sourceLine" id="cb593-3" title="3"><span class="kw">shinyUI</span>(<span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb593-4" title="4"></a>
<a class="sourceLine" id="cb593-5" title="5">  <span class="co"># 網頁標題</span></a>
<a class="sourceLine" id="cb593-6" title="6">  <span class="kw">titlePanel</span>(<span class="st">&quot;Hello Shiny!&quot;</span>),</a>
<a class="sourceLine" id="cb593-7" title="7"></a>
<a class="sourceLine" id="cb593-8" title="8">  <span class="co"># Sidebar + slider</span></a>
<a class="sourceLine" id="cb593-9" title="9">  <span class="kw">sidebarLayout</span>(</a>
<a class="sourceLine" id="cb593-10" title="10">    <span class="kw">sidebarPanel</span>(</a>
<a class="sourceLine" id="cb593-11" title="11">      <span class="kw">sliderInput</span>(<span class="st">&quot;bins&quot;</span>,</a>
<a class="sourceLine" id="cb593-12" title="12">                  <span class="st">&quot;Number of bins:&quot;</span>,</a>
<a class="sourceLine" id="cb593-13" title="13">                  <span class="dt">min =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb593-14" title="14">                  <span class="dt">max =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb593-15" title="15">                  <span class="dt">value =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb593-16" title="16">    ),</a>
<a class="sourceLine" id="cb593-17" title="17"></a>
<a class="sourceLine" id="cb593-18" title="18">    <span class="co"># 圖形呈現</span></a>
<a class="sourceLine" id="cb593-19" title="19">    <span class="kw">mainPanel</span>(</a>
<a class="sourceLine" id="cb593-20" title="20">      <span class="kw">plotOutput</span>(<span class="st">&quot;distPlot&quot;</span>)</a>
<a class="sourceLine" id="cb593-21" title="21">    )</a>
<a class="sourceLine" id="cb593-22" title="22">  )</a>
<a class="sourceLine" id="cb593-23" title="23">))</a></code></pre></div>
<p><strong>server.R範例</strong></p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb594-1" title="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb594-2" title="2"></a>
<a class="sourceLine" id="cb594-3" title="3"><span class="kw">shinyServer</span>(<span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb594-4" title="4"></a>
<a class="sourceLine" id="cb594-5" title="5"> </a>
<a class="sourceLine" id="cb594-6" title="6">  <span class="co"># 將直方圖Histogram存入distPlot變數，在UI端用plotOutput呈現</span></a>
<a class="sourceLine" id="cb594-7" title="7">  output<span class="op">$</span>distPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb594-8" title="8">    x  &lt;-<span class="st"> </span>faithful[, <span class="dv">2</span>]  <span class="co"># Old Faithful Geyser data</span></a>
<a class="sourceLine" id="cb594-9" title="9">    <span class="co"># input$bins是用UI端的Sidebar + slider調整</span></a>
<a class="sourceLine" id="cb594-10" title="10">    bins &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x), <span class="kw">max</span>(x), <span class="dt">length.out =</span> input<span class="op">$</span>bins <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb594-11" title="11">    <span class="kw">hist</span>(x, <span class="dt">breaks =</span> bins, <span class="dt">col =</span> <span class="st">&#39;darkgray&#39;</span>, <span class="dt">border =</span> <span class="st">&#39;white&#39;</span>)</a>
<a class="sourceLine" id="cb594-12" title="12">  })</a>
<a class="sourceLine" id="cb594-13" title="13">})</a></code></pre></div>
<p>若想使用介紹過的Plotly與Shiny結合，可參考<a href="https://plot.ly/r/shiny-tutorial/" target="_blank">此教學網頁</a></p>
<p>參考資料</p>
<ul>
<li><a href="http://shiny.rstudio.com/" target="_blank">Shiny官網</a></li>
<li><a href="https://www.rstudio.com/wp-content/uploads/2016/01/shiny-cheatsheet.pdf" target="_blank">Shiny cheat sheet</a></li>
</ul>
<!--chapter:end:09-InteractiveGraphics.Rmd-->
</div>
</div>
<div id="datamining" class="section level1">
<h1><span class="header-section-number">10</span> 資料探勘</h1>
<p><strong>撰寫中</strong></p>
<div id="什麼是資料探勘" class="section level2">
<h2><span class="header-section-number">10.1</span> 什麼是資料探勘</h2>
<p><strong>資料探勘（Data mining）</strong>是用人工智慧、機器學習、統計學的交叉方法，在相對較大型的資料集中發現模式的計算過程。使用資料探勘技術可以建立從<strong>輸入資料</strong>學習新資訊，變成智慧的<strong>演算法</strong>或<strong>資料模式</strong>，用來<strong>預測事件</strong>或<strong>協助決策</strong>。所以，當資料太<code>少</code>或<code>太髒</code>的時候，資料探勘的效力會被影響。</p>
<p>資料探勘要派上用場，必須有以下條件：</p>
<ul>
<li>有一些模式/模型可<code>學</code></li>
<li>很難定義這些模式/模型</li>
<li>有資料可<code>學</code>這些模式/模型</li>
</ul>
<p>資料探勘的應用範例如下：</p>
<ul>
<li>天氣預測</li>
<li>搜尋建議、購物建議</li>
<li>股市預測</li>
<li>臉部辨識、指紋辨識</li>
<li>垃圾郵件標記</li>
<li>尿布啤酒</li>
</ul>
<p>資料探勘可分為<strong>監督式</strong>學習與<strong>非監督式</strong>學習，監督式學習的特點是訓練資料中有<strong>正確答案</strong>，由輸入物件和預期輸出所組成，而演算法可以由訓練資料中學到或建立一個模式，並依此模式推測新的實例；非監督式學習則不用提供<strong>正確答案</strong>，也就是不需要人力來輸入標籤，單純利用訓練資料的特性，將資料分群分組。</p>
<p>此兩種學習可解決不同的問題，條列如下：</p>
<ul>
<li>Supervised learning 監督式學習
<ul>
<li>Regression 迴歸：真實的’值’（股票、氣溫）</li>
<li>Classification 分類：分兩類（P/N, Yes/No, M/F, Sick/Not sick）/分多類 (A/B/C/D)</li>
</ul></li>
<li>Unsupervised learning 非監督式學習
<ul>
<li>Clustering 分群</li>
<li>Association Rules 關聯式規則</li>
</ul></li>
</ul>
<p>在<strong>監督式</strong>學習中常見的資料探勘演算法如下：</p>
<ul>
<li>Linear Regression 線性迴歸</li>
<li>Logistic Regression 羅吉斯迴歸、邏輯迴歸</li>
<li>Support Vector Machines 支持向量機</li>
<li>Decision Trees 決策樹</li>
<li>K-Nearest Neighbor</li>
<li>Neural Networks 神經網路</li>
<li>Deep Learning 深度學習</li>
</ul>
<p>在<strong>非監督式</strong>學習中常見的資料探勘演算法如下：</p>
<ul>
<li>Hierarchical clustering 階層式分群</li>
<li>K-means clustering</li>
<li>Neural Networks 神經網路</li>
<li>Deep Learning 深度學習</li>
</ul>
<p>以下介紹在R中使用各類演算法的方法</p>
</div>
<div id="regression-迴歸" class="section level2">
<h2><span class="header-section-number">10.2</span> Regression 迴歸</h2>
<p>Regression Analysis 迴歸分析主要用在了解兩個或多個變數間<code>是否相關</code>、<code>相關方向與強度</code>，並建立<code>數學模型</code>以便觀察特定變數來預測研究者感興趣的變數，常見的迴歸分析演算法包括：</p>
<ul>
<li>Linear Regression 線性迴歸</li>
<li>Logistic Regression 羅吉斯迴歸、邏輯迴歸</li>
</ul>
<div id="linear-regression-線性迴歸" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Linear Regression 線性迴歸</h3>
<p>首先，嘗試將Linear Regression 線性迴歸用在NBA的資料看看，做NBA<code>得分</code>與<code>上場分鐘數</code>的線性迴歸觀察</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb595-1" title="1"><span class="co">#讀入SportsAnalytics package</span></a>
<a class="sourceLine" id="cb595-2" title="2"><span class="kw">library</span>(SportsAnalytics)</a>
<a class="sourceLine" id="cb595-3" title="3"><span class="co">#擷取2015-2016年球季球員資料</span></a>
<a class="sourceLine" id="cb595-4" title="4">NBA1516&lt;-<span class="kw">fetch_NBAPlayerStatistics</span>(<span class="st">&quot;15-16&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb596-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb596-2" title="2"><span class="kw">ggplot</span>(NBA1516,<span class="kw">aes</span>(<span class="dt">x=</span>TotalMinutesPlayed,<span class="dt">y=</span>TotalPoints))<span class="op">+</span></a>
<a class="sourceLine" id="cb596-3" title="3"><span class="st">    </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/linear2-1.png" width="672" /></p>
<p>在R中，最基本的簡單線性迴歸分析為<code>lm()</code>，使用方法為<code>lm(formula,data=資料名稱)</code>，搭配formula使用，formula的撰寫方法為：依變項~自變項1＋自變項2＋….</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb597-1" title="1"><span class="kw">lm</span>(TotalPoints<span class="op">~</span>TotalMinutesPlayed,<span class="dt">data =</span>NBA1516)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = TotalPoints ~ TotalMinutesPlayed, data = NBA1516)
## 
## Coefficients:
##        (Intercept)  TotalMinutesPlayed  
##            -85.907               0.493</code></pre>
<p>由此可知總得分數TotalPoints等於<code>0.4931</code> * 總出場分鐘數 <code>-85.9071</code></p>
<p>TotalPoints = <code>0.4931</code> * TotalMinutesPlayed <code>-85.9071</code></p>
<p>更被廣泛使用的是廣義線性迴歸模型generalized linear models (glm)，函數為<code>glm()</code>，使用方法與<code>lm()</code>類似，包括了線性迴歸模型和邏輯迴歸模型。
如果需要修改預設模型，可設定family參數：</p>
<pre><code>- `family=&quot;gaussian&quot;` 線性模型模型
- `family=&quot;binomial&quot;` 邏輯迴歸模型
- `family=&quot;poisson&quot;` 卜瓦松迴歸模型</code></pre>
<p>Gaussian distribution高斯函數是<code>常態分布</code>的密度函數</p>
<p>Binomial distribution二項分布是<code>n個獨立的是/非試驗中成功的次數</code>的離散機率分布</p>
<p>Poisson distribution<code>次數</code>分佈：</p>
<ul>
<li>某一服務設施在一定時間內受到的服務請求的次數</li>
<li>公車站的候客人數</li>
<li>機器故障數</li>
<li>自然災害發生的次數</li>
<li>DNA序列的變異數…..</li>
</ul>
<p>以下為使用多變量線性迴歸來分析<code>得分</code>與<code>上場分鐘數</code>和<code>兩分球出手數</code>的關係範例</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb600-1" title="1"><span class="co"># e+01: 10^1 / e-04: 10^(-4)</span></a>
<a class="sourceLine" id="cb600-2" title="2"><span class="kw">glm</span>(TotalPoints<span class="op">~</span>TotalMinutesPlayed<span class="op">+</span>FieldGoalsAttempted,</a>
<a class="sourceLine" id="cb600-3" title="3">    <span class="dt">data =</span>NBA1516)</a></code></pre></div>
<pre><code>## 
## Call:  glm(formula = TotalPoints ~ TotalMinutesPlayed + FieldGoalsAttempted, 
##     data = NBA1516)
## 
## Coefficients:
##         (Intercept)   TotalMinutesPlayed  FieldGoalsAttempted  
##           -1.80e+01            -2.35e-04             1.26e+00  
## 
## Degrees of Freedom: 475 Total (i.e. Null);  473 Residual
## Null Deviance:       9.9e+07 
## Residual Deviance: 2160000   AIC: 5370</code></pre>
<p>由此可知總得分數等於<code>-0.0002347</code> * 總出場分鐘數 + <code>1.255794</code> * 兩分球出手數 <code>-17.99</code>
TotalPoints = <code>-0.0002347</code> * TotalMinutesPlayed + <code>1.255794</code> * FieldGoalsAttempted <code>-17.99</code></p>
<p>如需使用多變量線性迴歸來分析<code>得分</code>與<code>上場分鐘數</code>和<code>兩分球出手數</code>和<code>守備位置</code>的關係，可修改formula</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb602-1" title="1"><span class="kw">glm</span>(TotalPoints<span class="op">~</span>TotalMinutesPlayed<span class="op">+</span>FieldGoalsAttempted<span class="op">+</span>Position,</a>
<a class="sourceLine" id="cb602-2" title="2">    <span class="dt">data =</span>NBA1516)</a></code></pre></div>
<pre><code>## 
## Call:  glm(formula = TotalPoints ~ TotalMinutesPlayed + FieldGoalsAttempted + 
##     Position, data = NBA1516)
## 
## Coefficients:
##         (Intercept)   TotalMinutesPlayed  FieldGoalsAttempted  
##            22.85222             -0.00654              1.27572  
##          PositionPF           PositionPG           PositionSF  
##           -39.41633            -65.03465            -38.52230  
##          PositionSG  
##           -52.17514  
## 
## Degrees of Freedom: 474 Total (i.e. Null);  468 Residual
##   (1 observation deleted due to missingness)
## Null Deviance:       9.9e+07 
## Residual Deviance: 2e+06     AIC: 5320</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb604-1" title="1"><span class="co"># e+01: 10^1 / e-04: 10^(-4)</span></a></code></pre></div>
<p>由此可知總得分數TotalPoints和<code>上場分鐘數</code>和<code>兩分球出手數</code>和<code>守備位置</code>的關係為：
TotalPoints = <code>-0.0065</code> * TotalMinutesPlayed + <code>1.28</code> <em>FieldGoalsAttempted <code>+22.85</code> + <code>22.85</code> </em> PositionPF + <code>-65.03</code> * PositionPG + <code>-38.52</code> * PositionSF + <code>-52.18</code> * PositionSG</p>
<p>由上述結果可發現，<code>守備位置</code>的變項被轉為<strong>虛擬變項 Dummy Variable</strong>：PositionPF、PositionPG、PositionSF、PositionSG，如果是控球後衛（PG），會得到：</p>
<ul>
<li>PositionPF=0</li>
<li>PositionPG=1</li>
<li>PositionSF=0</li>
<li>PositionSG=0</li>
</ul>
<p>可能有人會問，那中鋒去哪了？其實中鋒被當作基準項，也就是當守備位置是中鋒(C)時，會得到：</p>
<ul>
<li>PositionPF=0</li>
<li>PositionPG=0</li>
<li>PositionSF=0</li>
<li>PositionSG=0</li>
</ul>
<p>總結以上，多變量線性迴歸分析有下列特色：</p>
<ul>
<li>假設：各變數相互獨立！</li>
<li>若自變項X是類別變項，需要建立<code>虛擬變項</code></li>
<li>在R裡，<code>類別變項</code>請記得轉成factor，R會自動建立<code>虛擬變項</code></li>
<li>用在<code>依變數為連續變數</code>，<code>自變數為連續變數或虛擬變數</code>的場合</li>
</ul>
</div>
<div id="logistic-regression-羅吉斯迴歸" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Logistic Regression 羅吉斯迴歸</h3>
<p>Logistic Regression 羅吉斯迴歸常用在<code>依變數為二元變數（非0即1）</code>的場合，如：
- 生病/沒生病
- 錄取/不錄取
- <code>family="binomial"</code> 邏輯迴歸模型</p>
<p>以分數資料為例，分析為什麼錄取/不錄取？</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb605-1" title="1">mydata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/CGUIM-BigDataAnalysis/BigDataCGUIM/master/binary.csv&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" title="1"><span class="co"># GRE:某考試成績, GPA:在校平均成績, rank:學校聲望</span></a>
<a class="sourceLine" id="cb606-2" title="2"><span class="kw">head</span>(mydata)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">admit</th>
<th align="right">gre</th>
<th align="right">gpa</th>
<th align="right">rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">380</td>
<td align="right">3.6</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">660</td>
<td align="right">3.7</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">800</td>
<td align="right">4.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">640</td>
<td align="right">3.2</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">520</td>
<td align="right">2.9</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">760</td>
<td align="right">3.0</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb607-1" title="1">mydata<span class="op">$</span>rank &lt;-<span class="st"> </span><span class="kw">factor</span>(mydata<span class="op">$</span>rank)</a>
<a class="sourceLine" id="cb607-2" title="2">mylogit &lt;-<span class="st"> </span><span class="kw">glm</span>(admit <span class="op">~</span><span class="st"> </span>gre <span class="op">+</span><span class="st"> </span>gpa <span class="op">+</span><span class="st"> </span>rank,</a>
<a class="sourceLine" id="cb607-3" title="3">               <span class="dt">data =</span> mydata, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb607-4" title="4">sum&lt;-<span class="kw">summary</span>(mylogit)</a>
<a class="sourceLine" id="cb607-5" title="5">sum<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  -3.9900     1.1400    -3.5  0.00047
## gre           0.0023     0.0011     2.1  0.03847
## gpa           0.8040     0.3318     2.4  0.01539
## rank2        -0.6754     0.3165    -2.1  0.03283
## rank3        -1.3402     0.3453    -3.9  0.00010
## rank4        -1.5515     0.4178    -3.7  0.00020</code></pre>
</div>
<div id="最佳模型篩選" class="section level3">
<h3><span class="header-section-number">10.2.3</span> 最佳模型篩選</h3>
<p>到底該用哪個模型來預測，會得到最準確的結果？在迴歸模型中，常用的判斷準則包括：</p>
<ul>
<li>Akaike’s Information Criterion (AIC)</li>
<li>Bayesian Information Criterion (BIC)</li>
</ul>
<p>AIC和BIC都是數值越小越好，以下建立三個模型，並比較其AIC，</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb609-1" title="1">OneVar&lt;-<span class="kw">glm</span>(TotalPoints<span class="op">~</span>TotalMinutesPlayed,<span class="dt">data =</span>NBA1516)</a>
<a class="sourceLine" id="cb609-2" title="2">TwoVar&lt;-<span class="kw">glm</span>(TotalPoints<span class="op">~</span>TotalMinutesPlayed<span class="op">+</span>FieldGoalsAttempted,</a>
<a class="sourceLine" id="cb609-3" title="3">            <span class="dt">data =</span>NBA1516)</a>
<a class="sourceLine" id="cb609-4" title="4">ThreeVar&lt;-<span class="kw">glm</span>(TotalPoints<span class="op">~</span>TotalMinutesPlayed<span class="op">+</span>FieldGoalsAttempted<span class="op">+</span>Position,</a>
<a class="sourceLine" id="cb609-5" title="5">              <span class="dt">data =</span>NBA1516)</a>
<a class="sourceLine" id="cb609-6" title="6"><span class="kw">c</span>(OneVar<span class="op">$</span>aic,TwoVar<span class="op">$</span>aic,ThreeVar<span class="op">$</span>aic)</a></code></pre></div>
<pre><code>## [1] 6339 5367 5322</code></pre>
<p>在建立迴歸模型時，常會遇到到底該放多少參數？所有參數都有用嗎？這類的問題，我們可以藉由觀察coefficients來判斷參數在模型中的“實用程度”</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" title="1">sum2&lt;-<span class="kw">summary</span>(TwoVar)</a>
<a class="sourceLine" id="cb611-2" title="2">sum2<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)         -1.8e+01     5.6598  -3.178  1.6e-03
## TotalMinutesPlayed  -2.3e-04     0.0095  -0.025  9.8e-01
## FieldGoalsAttempted  1.3e+00     0.0222  56.467 2.5e-212</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb613-1" title="1">sum3&lt;-<span class="kw">summary</span>(ThreeVar)</a>
<a class="sourceLine" id="cb613-2" title="2">sum3<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)          22.8522     9.0147    2.53  1.2e-02
## TotalMinutesPlayed   -0.0065     0.0092   -0.71  4.8e-01
## FieldGoalsAttempted   1.2757     0.0216   58.93 1.1e-218
## PositionPF          -39.4163     9.9365   -3.97  8.4e-05
## PositionPG          -65.0346    10.2693   -6.33  5.6e-10
## PositionSF          -38.5223    10.4882   -3.67  2.7e-04
## PositionSG          -52.1751     9.9853   -5.23  2.6e-07</code></pre>
</div>
</div>
<div id="decision-trees-決策樹" class="section level2">
<h2><span class="header-section-number">10.3</span> Decision Trees 決策樹</h2>
<p>決策樹是在<code>樹狀目錄</code>中建立一系列分割，以建立模型。這些分割會表示成<code>「節點」(Node)</code>。每次發現輸入資料行與可預測資料行有明顯地相互關聯時，此演算法就會在模型中加入一個<code>節點</code>。演算法決定分岔的方式不同，視它預測連續資料行或分隔資料行而定。</p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
<p>以下介紹常見的Classification And Regression Tree (CART)，使用前須先安裝<code>rpart</code> packages <span class="citation">(Therneau and Atkinson <a href="#ref-R-rpart" role="doc-biblioref">2019</a>)</span></p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb615-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;rpart&quot;</span>)</a></code></pre></div>
<p>以前述NBA資料為例，嘗試用用籃板/三分/助攻/抄截數據來判斷守備位置，建立決策樹的函數為<code>rpart()</code>，使用方式為<code>rpart(formula, data)</code></p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1"><span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb616-2" title="2">DT&lt;-<span class="kw">rpart</span>(Position<span class="op">~</span>Blocks<span class="op">+</span>ThreesMade<span class="op">+</span>Assists<span class="op">+</span>Steals,<span class="dt">data=</span>NBA1516)</a>
<a class="sourceLine" id="cb616-3" title="3">DT</a></code></pre></div>
<pre><code>## n=475 (1 observation deleted due to missingness)
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##   1) root 475 360 PF (0.15 0.23 0.21 0.18 0.23)  
##     2) ThreesMade&lt; 2.5 132  74 C (0.44 0.35 0.098 0.053 0.061)  
##       4) Blocks&gt;=4.5 89  37 C (0.58 0.38 0.011 0.011 0.011) *
##       5) Blocks&lt; 4.5 43  31 PF (0.14 0.28 0.28 0.14 0.16)  
##        10) Steals&lt; 2.5 29  19 PF (0.17 0.34 0.14 0.21 0.14) *
##        11) Steals&gt;=2.5 14   6 PG (0.071 0.14 0.57 0 0.21) *
##     3) ThreesMade&gt;=2.5 343 240 SG (0.035 0.19 0.25 0.23 0.29)  
##       6) Assists&gt;=1.7e+02 96  39 PG (0.031 0.052 0.59 0.15 0.18) *
##       7) Assists&lt; 1.7e+02 247 160 SG (0.036 0.24 0.12 0.26 0.34)  
##        14) Blocks&gt;=20 80  42 PF (0.062 0.48 0 0.26 0.2)  
##          28) Steals&lt; 60 58  21 PF (0.069 0.64 0 0.14 0.16) *
##          29) Steals&gt;=60 22   9 SF (0.045 0.045 0 0.59 0.32) *
##        15) Blocks&lt; 20 167  99 SG (0.024 0.13 0.17 0.26 0.41)  
##          30) Assists&lt; 82 110  68 SG (0.027 0.18 0.091 0.32 0.38)  
##            60) Blocks&gt;=4.5 63  39 SF (0.032 0.29 0.016 0.38 0.29)  
##             120) ThreesMade&lt; 14 19   9 PF (0.11 0.53 0 0.26 0.11) *
##             121) ThreesMade&gt;=14 44  25 SF (0 0.18 0.023 0.43 0.36)  
##               242) Blocks&lt; 9.5 17   7 SF (0 0.18 0.059 0.59 0.18) *
##               243) Blocks&gt;=9.5 27  14 SG (0 0.19 0 0.33 0.48) *
##            61) Blocks&lt; 4.5 47  23 SG (0.021 0.043 0.19 0.23 0.51) *
##          31) Assists&gt;=82 57  31 SG (0.018 0.035 0.33 0.16 0.46)  
##            62) ThreesMade&lt; 37 17   5 PG (0 0.12 0.71 0.059 0.12) *
##            63) ThreesMade&gt;=37 40  16 SG (0.025 0 0.17 0.2 0.6) *</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1"><span class="co">#控球後衛（PG）、得分後衛（SG）、小前鋒（SF）、大前鋒（PF）和中鋒（C）</span></a></code></pre></div>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="co">#下,左,上,右</span></a>
<a class="sourceLine" id="cb619-2" title="2"><span class="kw">plot</span>(DT)</a>
<a class="sourceLine" id="cb619-3" title="3"><span class="kw">text</span>(DT, <span class="dt">use.n=</span>F, <span class="dt">all=</span>F, <span class="dt">cex=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/rpart3-1.png" width="672" /></p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1"><span class="co">#控球後衛（PG）、得分後衛（SG）、小前鋒（SF）、大前鋒（PF）和中鋒（C）</span></a></code></pre></div>
<p>可以看出預設的<code>plot()</code>畫出來的圖很難看懂，可以改用<code>rpart.plot</code> package <span class="citation">(Milborrow <a href="#ref-R-rpart.plot" role="doc-biblioref">2019</a>)</span>裡面的<code>prp()</code></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;rpart.plot&quot;</span>) <span class="co">#第一次使用前須先安裝</span></a></code></pre></div>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1"><span class="kw">library</span>(rpart.plot)</a>
<a class="sourceLine" id="cb622-2" title="2"><span class="kw">prp</span>(DT) </a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/rpart4-1.png" width="672" /></p>
<p>決策樹演算法決定<code>節點</code>的方式如下：</p>
<ul>
<li>Gini impurity</li>
<li>Information gain</li>
<li>Variance reduction</li>
</ul>
<p>細節可參考<a href="https://en.wikipedia.org/wiki/Decision_tree_learning">維基百科</a></p>
</div>
<div id="clustering-分群" class="section level2">
<h2><span class="header-section-number">10.4</span> Clustering 分群</h2>
<p>Clustering 分群的目的是將相近的觀察值作做分群，分群過程中，可能會遇到以下問題：</p>
<ul>
<li>如何定義相近？</li>
<li>如何分群？</li>
<li>如何視覺化？</li>
<li>如何解釋分群？</li>
</ul>
<div id="hierarchical-clustering-階層式分群" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Hierarchical clustering 階層式分群</h3>
<ul>
<li>An agglomerative approach
<ul>
<li>Find closest two things</li>
<li>Put them together</li>
<li>Find next closest</li>
</ul></li>
<li>Requires
<ul>
<li>A defined distance</li>
<li>A merging approach</li>
</ul></li>
<li>Produces
<ul>
<li>A tree showing how close things are to each other</li>
</ul></li>
</ul>
<p>如何定義相近？用距離<code>distance</code>的概念來定義相近。</p>
<ul>
<li>Distance or similarity
<ul>
<li>Continuous - euclidean distance</li>
<li>Continuous - correlation similarity</li>
<li>Binary - manhattan distance</li>
</ul></li>
<li>Pick a distance/similarity that makes sense for your problem</li>
</ul>
<p>Example distances - Euclidean</p>
<p><span class="math display">\[\sqrt{(A_1-A_2)^2 + (B_1-B_2)^2 + \ldots + (Z_1-Z_2)^2}\]</span></p>
<p>Example distances - Manhattan</p>
<p><span class="math display">\[|A_1-A_2| + |B_1-B_2| + \ldots + |Z_1-Z_2|\]</span></p>
<p>Merging apporach</p>
<ul>
<li><p>Agglomerative 聚合</p>
<ul>
<li>Single-linkage：取最小值</li>
<li>Complete-linkage：取最大值</li>
<li>Average-linkage：取平均值</li>
</ul></li>
</ul>
<p>Hierarchical clustering - hp vs. mpg
<img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-191-1.png" width="768" /></p>
<p>Hierarchical clustering - #1</p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-192-1.png" width="768" /></p>
<p>Hierarchical clustering - #2
<img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-193-1.png" width="768" /></p>
<p>Hierarchical clustering - #3</p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-194-1.png" width="768" /></p>
<p>可用<code>dist()</code>函數計算距離，使用method=""設定計算距離的依據</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb623-1" title="1">mtcars.mxs&lt;-<span class="kw">as.matrix</span>(mtcars)</a>
<a class="sourceLine" id="cb623-2" title="2">d&lt;-<span class="kw">dist</span>(mtcars.mxs) <span class="co">#預設為euclidean</span></a>
<a class="sourceLine" id="cb623-3" title="3"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## [1]   0.62  54.91  98.11 210.34  65.47 241.41</code></pre>
<p><code>dist()</code>函數可用方法包括：
“euclidean”, “maximum”, “manhattan”, “canberra”, “binary” or “minkowski”</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" title="1">d&lt;-<span class="kw">dist</span>(mtcars.mxs, <span class="dt">method=</span><span class="st">&quot;manhattan&quot;</span>) <span class="co">#計算manhattan距離</span></a>
<a class="sourceLine" id="cb625-2" title="2"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## [1]   0.81  79.30 108.80 275.43  84.64 347.96</code></pre>
<p>用<code>hclust</code>函數畫圖，必要參數是各觀察值的距離（可用<code>dist()</code>函數計算）</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb627-2" title="2">hc&lt;-<span class="kw">hclust</span>(<span class="kw">dist</span>(mtcars.mxs)) <span class="co">#可用method參數設定聚合方法，預設為complete</span></a>
<a class="sourceLine" id="cb627-3" title="3"><span class="kw">plot</span>(hc)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-197-1.png" width="576" /></p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb628-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb628-2" title="2">hc&lt;-<span class="kw">hclust</span>(<span class="kw">dist</span>(mtcars.mxs),<span class="dt">method=</span><span class="st">&quot;average&quot;</span>) <span class="co">#聚合方法為計算平均距離</span></a>
<a class="sourceLine" id="cb628-3" title="3"><span class="kw">plot</span>(hc)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-198-1.png" width="576" /></p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb629-1" title="1">clusterCut &lt;-<span class="st"> </span><span class="kw">cutree</span>(hc, <span class="dt">k=</span><span class="dv">5</span>) <span class="co">#分5群</span></a>
<a class="sourceLine" id="cb629-2" title="2"><span class="kw">sort</span>(clusterCut)</a></code></pre></div>
<pre><code>##           Mazda RX4       Mazda RX4 Wag          Datsun 710           Merc 240D 
##                   1                   1                   1                   1 
##            Merc 230            Merc 280           Merc 280C            Fiat 128 
##                   1                   1                   1                   1 
##         Honda Civic      Toyota Corolla       Toyota Corona           Fiat X1-9 
##                   1                   1                   1                   1 
##       Porsche 914-2        Lotus Europa        Ferrari Dino          Volvo 142E 
##                   1                   1                   1                   1 
##      Hornet 4 Drive             Valiant          Merc 450SE          Merc 450SL 
##                   2                   2                   2                   2 
##         Merc 450SLC    Dodge Challenger         AMC Javelin   Hornet Sportabout 
##                   2                   2                   2                   3 
##          Duster 360          Camaro Z28    Pontiac Firebird      Ford Pantera L 
##                   3                   3                   3                   3 
##  Cadillac Fleetwood Lincoln Continental   Chrysler Imperial       Maserati Bora 
##                   4                   4                   4                   5</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb631-1" title="1"><span class="kw">ggplot</span>()<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">data=</span>mtcars,</a>
<a class="sourceLine" id="cb631-2" title="2">                    <span class="kw">aes</span>(<span class="dt">x=</span>hp,<span class="dt">y=</span>mpg,<span class="dt">color=</span><span class="kw">as.factor</span>(clusterCut)))</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-200-1.png" width="576" /></p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb632-1" title="1">clusterCut &lt;-<span class="st"> </span><span class="kw">cutree</span>(hc,<span class="dt">h =</span><span class="dv">4</span>) <span class="co">#切在高度=4的地方（距離=4）</span></a>
<a class="sourceLine" id="cb632-2" title="2"><span class="kw">sort</span>(clusterCut)</a></code></pre></div>
<pre><code>##           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
##                   1                   1                   2                   3 
##   Hornet Sportabout             Valiant          Duster 360           Merc 240D 
##                   4                   5                   6                   7 
##            Merc 230            Merc 280           Merc 280C          Merc 450SE 
##                   8                   9                   9                  10 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
##                  10                  10                  11                  12 
##   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
##                  13                  14                  15                  16 
##       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
##                  17                  18                  19                  20 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
##                  21                  22                  23                  24 
##      Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
##                  25                  26                  27                  28</code></pre>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.2</span>,<span class="dv">4</span>),<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb634-2" title="2"><span class="kw">heatmap</span>(mtcars.mxs)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-202-1.png" width="576" /></p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb635-1" title="1">distxy &lt;-<span class="st"> </span><span class="kw">dist</span>(mtcars.mxs)</a>
<a class="sourceLine" id="cb635-2" title="2">hClustering &lt;-<span class="st"> </span><span class="kw">hclust</span>(distxy)</a>
<a class="sourceLine" id="cb635-3" title="3"><span class="kw">plot</span>(hClustering)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-203-1.png" width="384" /></p>
<p>Hierarchical clustering: summary
- 可快速瀏覽觀察值與各欄位的關係</p>
<ul>
<li>分群結果可能被以下參數影響：
<ul>
<li>計算距離的方法</li>
<li>分群依據</li>
<li>更改數值的大小</li>
</ul></li>
<li>可能會遇到的問題：
<ul>
<li>有時會不太清楚要如何切割分群結果</li>
</ul></li>
</ul>
</div>
<div id="k-means-clustering" class="section level3">
<h3><span class="header-section-number">10.4.2</span> K-means clustering</h3>
<ul>
<li>執行步驟
<ul>
<li>指定要分幾群</li>
<li>計算每一群的中心點</li>
<li>將各個物件/觀察值指定給最近的中心點</li>
<li>依照新的分群計算新的中心點</li>
</ul></li>
<li>輸入
<ul>
<li>計算距離的資料（數值）</li>
<li>要分成幾群 # of clusters</li>
<li>預設個群的中間點位置</li>
</ul></li>
<li>產出
<ul>
<li>計算出每’群‘的中心點</li>
<li>指定每個觀察值所在的’群‘</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb636-1" title="1">x&lt;-<span class="kw">scale</span>(mtcars<span class="op">$</span>hp[<span class="op">-</span><span class="dv">1</span>]);y&lt;-<span class="kw">scale</span>(mtcars<span class="op">$</span>mpg[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb636-2" title="2"><span class="kw">plot</span>(x,y,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb636-3" title="3"><span class="kw">text</span>(x<span class="fl">+0.05</span>,y<span class="fl">+0.05</span>,<span class="dt">labels=</span>labelCar)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-204-1.png" width="576" /></p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-205-1.png" width="480" /></p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-206-1.png" width="480" /></p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-207-1.png" width="480" /></p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-208-1.png" width="480" /></p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-209-1.png" width="480" /></p>
<p><code>kmeans()</code></p>
<ul>
<li>Important parameters: <code>x</code>, <code>centers</code>, <code>iter.max</code>, <code>nstart</code></li>
</ul>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb637-1" title="1">dataFrame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x,y)</a>
<a class="sourceLine" id="cb637-2" title="2">kmeansObj &lt;-<span class="st"> </span><span class="kw">kmeans</span>(dataFrame,<span class="dt">centers=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb637-3" title="3"><span class="kw">names</span>(kmeansObj)</a></code></pre></div>
<pre><code>## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb639-1" title="1">kmeansObj<span class="op">$</span>cluster</a></code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 2 3 1 1 1 1 1 1 2 2 2 3 3 3 1 1 1 2 1 3 3 3 2 1 2 1</code></pre>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb641-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">rep</span>(<span class="fl">0.2</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb641-2" title="2"><span class="kw">plot</span>(x,y,<span class="dt">col=</span>kmeansObj<span class="op">$</span>cluster,<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb641-3" title="3"><span class="kw">points</span>(kmeansObj<span class="op">$</span>centers,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">pch=</span><span class="dv">3</span>,<span class="dt">cex=</span><span class="dv">3</span>,<span class="dt">lwd=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-210-1.png" width="384" /></p>
<p>Heatmaps</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb642-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb642-2" title="2">dataMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(dataFrame)[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>),]</a>
<a class="sourceLine" id="cb642-3" title="3">kmeansObj &lt;-<span class="st"> </span><span class="kw">kmeans</span>(dataMatrix,<span class="dt">centers=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb642-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb642-5" title="5"><span class="kw">image</span>(<span class="kw">t</span>(dataMatrix)[,<span class="kw">nrow</span>(dataMatrix)<span class="op">:</span><span class="dv">1</span>],<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb642-6" title="6"><span class="kw">image</span>(<span class="kw">t</span>(dataMatrix)[,<span class="kw">order</span>(kmeansObj<span class="op">$</span>cluster)],<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-211-1.png" width="768" /></p>
<p>K-means注意事項</p>
<ul>
<li>需要決定# of clusters
<ul>
<li>用眼睛/人工/特殊要求選</li>
<li>用 cross validation/information theory選</li>
<li><a href="http://en.wikipedia.org/wiki/Determining_the_number_of_clusters_in_a_data_set">Determining the number of clusters</a></li>
</ul></li>
<li>K-means 沒有一定的結果
<ul>
<li>不同的 # of clusters</li>
<li>不同的 # of iterations</li>
</ul></li>
</ul>
<p><code>kmeans()</code>, k=2</p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-212-1.png" width="384" /></p>
<p><code>kmeans()</code>, k=3</p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-213-1.png" width="384" /></p>
<p><code>kmeans()</code>, k=4</p>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-214-1.png" width="384" /></p>
</div>
</div>
<div id="association-rules-關聯式規則" class="section level2">
<h2><span class="header-section-number">10.5</span> Association Rules 關聯式規則</h2>
<p><strong>關聯式規則</strong>用於從大量數據中挖掘出有價值的數據項之間的相關關係，原則為不考慮項目的次序，而僅考慮其組合。著名的<code>購物籃分析 (Market Basket Analysis)</code>即為關聯式規則分析的應用。而<strong>Apriori演算法</strong>是挖掘<code>布林關聯規則</code> (Boolean association rules) 頻繁項集的算法，在R中，可以使用<code>arules</code><span class="citation">(Hahsler et al. <a href="#ref-R-arules" role="doc-biblioref">2019</a>)</span> 套件來執行關聯式規則分析。</p>
<p>以下以超市資料為例，使用關聯式規則分析執行購物籃分析。</p>
<p>首先先讀入超市消費資料</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb643-1" title="1"><span class="co"># Load the libraries</span></a>
<a class="sourceLine" id="cb643-2" title="2"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;arules&#39;</span>)){</a>
<a class="sourceLine" id="cb643-3" title="3">  <span class="kw">install.packages</span>(<span class="st">&quot;arules&quot;</span>);</a>
<a class="sourceLine" id="cb643-4" title="4">  <span class="kw">library</span>(arules) <span class="co">#for Apriori演算法</span></a>
<a class="sourceLine" id="cb643-5" title="5">}</a>
<a class="sourceLine" id="cb643-6" title="6"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;datasets&#39;</span>)){</a>
<a class="sourceLine" id="cb643-7" title="7">  <span class="kw">install.packages</span>(<span class="st">&quot;datasets&quot;</span>);</a>
<a class="sourceLine" id="cb643-8" title="8">  <span class="kw">library</span>(datasets) <span class="co">#for Groceries data</span></a>
<a class="sourceLine" id="cb643-9" title="9">}</a>
<a class="sourceLine" id="cb643-10" title="10"><span class="kw">data</span>(Groceries) <span class="co"># Load the data set</span></a>
<a class="sourceLine" id="cb643-11" title="11">Groceries<span class="op">@</span>data<span class="op">@</span>Dim <span class="co">#169 種商品，9835筆交易資料</span></a></code></pre></div>
<pre><code>## [1]  169 9835</code></pre>
<p>超市資料的原始樣貌為：
<img src="figure/groceries.png" width="778" /></p>
<p>可使用arules套件中的apriori函數來實作apriori演算法</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb645-1" title="1"><span class="co"># Get the rules</span></a>
<a class="sourceLine" id="cb645-2" title="2">rules &lt;-<span class="st"> </span><span class="kw">apriori</span>(Groceries, <span class="co"># data= Groceries</span></a>
<a class="sourceLine" id="cb645-3" title="3">                 <span class="dt">parameter =</span> <span class="kw">list</span>(<span class="dt">supp =</span> <span class="fl">0.001</span>, <span class="dt">conf =</span> <span class="fl">0.8</span>), <span class="co">#參數最低限度</span></a>
<a class="sourceLine" id="cb645-4" title="4">                 <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">verbose=</span>F)) <span class="co">#不要顯示output</span></a>
<a class="sourceLine" id="cb645-5" title="5"><span class="kw">options</span>(<span class="dt">digits=</span><span class="dv">2</span>) <span class="co"># Only 2 digits</span></a>
<a class="sourceLine" id="cb645-6" title="6"><span class="kw">inspect</span>(rules[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]) <span class="co"># Show the top 5 rules</span></a></code></pre></div>
<pre><code>##     lhs                        rhs            support confidence lift count
## [1] {liquor,red/blush wine} =&gt; {bottled beer} 0.0019  0.90       11.2 19   
## [2] {curd,cereals}          =&gt; {whole milk}   0.0010  0.91        3.6 10   
## [3] {yogurt,cereals}        =&gt; {whole milk}   0.0017  0.81        3.2 17   
## [4] {butter,jam}            =&gt; {whole milk}   0.0010  0.83        3.3 10   
## [5] {soups,bottled beer}    =&gt; {whole milk}   0.0011  0.92        3.6 11</code></pre>
<p>根據計算結果，解讀模型的方法如下：</p>
<p>啤酒=&gt;尿布</p>
<ul>
<li><code>Support</code>: 一次交易中，包括規則內的物品的機率。買啤酒同時買尿布的機率。交集</li>
<li><code>Confidence</code>: 包含左邊物品A的交易也會包含右邊物品B的條件機率。在買了啤酒的顧客中，有買尿布的比例。</li>
<li><code>Lift</code>: 規則的信心比期望值高多少。（買了啤酒以後，有買尿布的機率）/（在所有顧客群中買尿布的機率）
<ul>
<li><code>lift</code>=1: items on the left and right are independent.</li>
</ul></li>
</ul>
<p>可用排序功能排序後，列出最有關連（confidence最高）的幾條規則</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb647-1" title="1">rules&lt;-<span class="kw">sort</span>(rules, <span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>, <span class="dt">decreasing=</span><span class="ot">TRUE</span>) <span class="co">#按照confidence排序</span></a>
<a class="sourceLine" id="cb647-2" title="2"><span class="kw">inspect</span>(rules[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]) <span class="co"># Show the top 5 rules</span></a></code></pre></div>
<pre><code>##     lhs                     rhs          support confidence lift count
## [1] {rice,                                                            
##      sugar}              =&gt; {whole milk}  0.0012          1  3.9    12
## [2] {canned fish,                                                     
##      hygiene articles}   =&gt; {whole milk}  0.0011          1  3.9    11
## [3] {root vegetables,                                                 
##      butter,                                                          
##      rice}               =&gt; {whole milk}  0.0010          1  3.9    10
## [4] {root vegetables,                                                 
##      whipped/sour cream,                                              
##      flour}              =&gt; {whole milk}  0.0017          1  3.9    17
## [5] {butter,                                                          
##      soft cheese,                                                     
##      domestic eggs}      =&gt; {whole milk}  0.0010          1  3.9    10</code></pre>
<p>特別針對某項商品（右側變數），像是：買了什麼東西的人，會買<code>牛奶</code>呢？</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb649-1" title="1">rulesR&lt;-<span class="kw">apriori</span>(<span class="dt">data=</span>Groceries, <span class="dt">parameter=</span><span class="kw">list</span>(<span class="dt">supp=</span><span class="fl">0.001</span>,<span class="dt">conf =</span> <span class="fl">0.08</span>),</a>
<a class="sourceLine" id="cb649-2" title="2">        <span class="dt">appearance =</span> <span class="kw">list</span>(<span class="dt">default=</span><span class="st">&quot;lhs&quot;</span>,<span class="dt">rhs=</span><span class="st">&quot;whole milk&quot;</span>), <span class="co">#設定右邊一定要是牛奶</span></a>
<a class="sourceLine" id="cb649-3" title="3">        <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">verbose=</span>F)) <span class="co">#不要顯示output</span></a>
<a class="sourceLine" id="cb649-4" title="4">rulesR&lt;-<span class="kw">sort</span>(rulesR, <span class="dt">decreasing=</span><span class="ot">TRUE</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>) <span class="co">#按照confidence排序</span></a>
<a class="sourceLine" id="cb649-5" title="5"><span class="kw">inspect</span>(rulesR[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]) <span class="co"># Show the top 5 rules</span></a></code></pre></div>
<pre><code>##     lhs                     rhs          support confidence lift count
## [1] {rice,                                                            
##      sugar}              =&gt; {whole milk}  0.0012          1  3.9    12
## [2] {canned fish,                                                     
##      hygiene articles}   =&gt; {whole milk}  0.0011          1  3.9    11
## [3] {root vegetables,                                                 
##      butter,                                                          
##      rice}               =&gt; {whole milk}  0.0010          1  3.9    10
## [4] {root vegetables,                                                 
##      whipped/sour cream,                                              
##      flour}              =&gt; {whole milk}  0.0017          1  3.9    17
## [5] {butter,                                                          
##      soft cheese,                                                     
##      domestic eggs}      =&gt; {whole milk}  0.0010          1  3.9    10</code></pre>
<p>特別針對某項商品（左側變數），像是：買了<code>牛奶</code>的人，會買什麼呢？</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb651-1" title="1">rulesL&lt;-<span class="kw">apriori</span>(<span class="dt">data=</span>Groceries, <span class="dt">parameter=</span><span class="kw">list</span>(<span class="dt">supp=</span><span class="fl">0.001</span>,<span class="dt">conf =</span> <span class="fl">0.15</span>,<span class="dt">minlen=</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb651-2" title="2">        <span class="dt">appearance =</span> <span class="kw">list</span>(<span class="dt">default=</span><span class="st">&quot;rhs&quot;</span>,<span class="dt">lhs=</span><span class="st">&quot;whole milk&quot;</span>), <span class="co">#設定左邊一定要是牛奶</span></a>
<a class="sourceLine" id="cb651-3" title="3">        <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">verbose=</span>F)) <span class="co">#不要顯示output</span></a>
<a class="sourceLine" id="cb651-4" title="4">rulesL&lt;-<span class="kw">sort</span>(rulesL, <span class="dt">decreasing=</span><span class="ot">TRUE</span>,<span class="dt">by=</span><span class="st">&quot;confidence&quot;</span>) <span class="co">#按照confidence排序</span></a>
<a class="sourceLine" id="cb651-5" title="5"><span class="kw">inspect</span>(rulesL[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]) <span class="co"># Show the top 5 rules</span></a></code></pre></div>
<pre><code>##     lhs             rhs                support confidence lift count
## [1] {whole milk} =&gt; {other vegetables} 0.075   0.29       1.5  736  
## [2] {whole milk} =&gt; {rolls/buns}       0.057   0.22       1.2  557  
## [3] {whole milk} =&gt; {yogurt}           0.056   0.22       1.6  551  
## [4] {whole milk} =&gt; {root vegetables}  0.049   0.19       1.8  481  
## [5] {whole milk} =&gt; {tropical fruit}   0.042   0.17       1.6  416</code></pre>
<p>規則視覺化</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb653-1" title="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;arulesViz&#39;</span>)){</a>
<a class="sourceLine" id="cb653-2" title="2">  <span class="kw">install.packages</span>(<span class="st">&quot;arulesViz&quot;</span>); </a>
<a class="sourceLine" id="cb653-3" title="3">  <span class="kw">library</span>(arulesViz)</a>
<a class="sourceLine" id="cb653-4" title="4">}</a>
<a class="sourceLine" id="cb653-5" title="5"><span class="co">#Mac-&gt;http://planspace.org/2013/01/17/fix-r-tcltk-dependency-problem-on-mac/</span></a>
<a class="sourceLine" id="cb653-6" title="6"><span class="kw">plot</span>(rules,<span class="dt">method=</span><span class="st">&quot;graph&quot;</span>,<span class="dt">interactive=</span><span class="ot">TRUE</span>,<span class="dt">shading=</span><span class="ot">NA</span>) <span class="co">#會跑一陣子</span></a></code></pre></div>
<p><img src="figure/arulesViz.png" width="531" />
<img src="figure/arulesVizBig.png" width="194" /></p>
</div>
<div id="open-source-packages" class="section level2">
<h2><span class="header-section-number">10.6</span> Open Source Packages</h2>
<div id="prophet" class="section level3">
<h3><span class="header-section-number">10.6.1</span> Prophet</h3>
<p>Prophet 是 Facebook在2017年開放出來的時序性預測演算法，用來預測各類資料的時序變化，像是顧客造訪數、溫度、疾病發生率等等，以下是Prophet for R的安裝使用範例</p>
<ul>
<li>C/C++ Tool
<ul>
<li><a href="https://cran.r-project.org/bin/windows/Rtools/">R Tools</a> on Windows</li>
<li><a href="http://osxdaily.com/2014/02/12/install-command-line-tools-mac-os-x/">Command Line Tools</a> on OS X</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb654-1" title="1"><span class="kw">install.packages</span>(<span class="st">&#39;prophet&#39;</span>)</a></code></pre></div>
<p><a href="https://facebookincubator.github.io/prophet/docs/quick_start.html#r-api">R API</a></p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb655-1" title="1"><span class="kw">library</span>(prophet)</a>
<a class="sourceLine" id="cb655-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb655-3" title="3">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/facebookincubator/prophet/master/examples/example_wp_peyton_manning.csv&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb655-4" title="4"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">log</span>(y))</a>
<a class="sourceLine" id="cb655-5" title="5">m &lt;-<span class="st"> </span><span class="kw">prophet</span>(df)</a>
<a class="sourceLine" id="cb655-6" title="6">future &lt;-<span class="st"> </span><span class="kw">make_future_dataframe</span>(m, <span class="dt">periods =</span> <span class="dv">365</span>)</a>
<a class="sourceLine" id="cb655-7" title="7"><span class="kw">tail</span>(future)</a>
<a class="sourceLine" id="cb655-8" title="8">forecast &lt;-<span class="st"> </span><span class="kw">predict</span>(m, future)</a>
<a class="sourceLine" id="cb655-9" title="9"><span class="kw">tail</span>(forecast[<span class="kw">c</span>(<span class="st">&#39;ds&#39;</span>, <span class="st">&#39;yhat&#39;</span>, <span class="st">&#39;yhat_lower&#39;</span>, <span class="st">&#39;yhat_upper&#39;</span>)])</a>
<a class="sourceLine" id="cb655-10" title="10"><span class="kw">plot</span>(m, forecast)</a>
<a class="sourceLine" id="cb655-11" title="11"><span class="kw">prophet_plot_components</span>(m, forecast)</a></code></pre></div>
<p><a href="https://facebookincubator.github.io/prophet/">Prophet官網</a></p>
</div>
<div id="tensorflow" class="section level3">
<h3><span class="header-section-number">10.6.2</span> TensorFlow</h3>
<ul>
<li>Python 3.5.3 <strong>64 bit</strong> <a href="https://www.python.org/downloads/release/python-353/">網站</a>
<ul>
<li>Windows x86-64 executable installer</li>
</ul></li>
<li>TensorFlow 1.0.1 <a href="https://www.tensorflow.org/install/">網站</a>
<ul>
<li>pip3 install –upgrade tensorflow</li>
<li>pip3 install –upgrade tensorflow-gpu</li>
</ul></li>
<li>C/C++ Tool
<ul>
<li><a href="https://cran.r-project.org/bin/windows/Rtools/">R Tools</a> on Windows</li>
<li><a href="http://osxdaily.com/2014/02/12/install-command-line-tools-mac-os-x/">Command Line Tools</a> on OS X</li>
</ul></li>
<li>tensorflow package for R <a href="https://rstudio.github.io/tensorflow/index.html">網站</a></li>
</ul>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb656-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;rstudio/tensorflow&quot;</span>)</a></code></pre></div>
<p>TensorFlow for R</p>
<ul>
<li>Locating TensorFlow (optional)</li>
<li>Hello World</li>
</ul>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb657-1" title="1"><span class="kw">library</span>(tensorflow)</a>
<a class="sourceLine" id="cb657-2" title="2">sess =<span class="st"> </span>tf<span class="op">$</span><span class="kw">Session</span>()</a>
<a class="sourceLine" id="cb657-3" title="3">hello &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">constant</span>(<span class="st">&#39;Hello, TensorFlow!&#39;</span>)</a>
<a class="sourceLine" id="cb657-4" title="4">sess<span class="op">$</span><span class="kw">run</span>(hello)</a></code></pre></div>
</div>
<div id="mxnet" class="section level3">
<h3><span class="header-section-number">10.6.3</span> MXNet</h3>
<p>Amazon
<a href="http://mxnet.io/get_started/windows_setup.html#install-mxnet-for-r">Install MXNet for R</a>
MXNet for R <a href="http://mxnet.io/tutorials/index.html#r">Tutorials</a></p>
<p>MXNet for R</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb658-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;drat&quot;</span>, <span class="dt">repos=</span><span class="st">&quot;https://cran.rstudio.com&quot;</span>)</a>
<a class="sourceLine" id="cb658-2" title="2">drat<span class="op">:::</span><span class="kw">addRepo</span>(<span class="st">&quot;dmlc&quot;</span>)</a>
<a class="sourceLine" id="cb658-3" title="3"><span class="kw">install.packages</span>(<span class="st">&quot;mxnet&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="模型驗證" class="section level2">
<h2><span class="header-section-number">10.7</span> 模型驗證</h2>
<p>在完成模型訓練後，為了驗證模型訓練的好不好，需要用一組<strong>獨立</strong>的測試資料，來做模型的驗證。所以，在訓練模型前，必須特別留意是否有保留一份<strong>獨立的資料</strong>，並確保在訓練模型時都不用到此獨立資料集。因此，資料集可分為以下兩種：</p>
<ul>
<li><strong>訓練組</strong> Training set, Development set: 讓演算法<code>學</code>到<code>知識</code></li>
<li><strong>測試組</strong> Test set, Validation set: 驗證<code>學</code>的怎麼樣</li>
</ul>
<p>Training set和Test set通常會比例分配，如2/3的資料設為<code>Training set</code>，剩下的1/3做驗證<code>Test set</code>。以下圖的監督式學習流程圖為例，可以注意到綠色箭頭的資料集在訓練過程中從未被使用。</p>
<p><img src="figure/SupervisedLearning.png" width="450" /></p>
<div id="regression-迴歸驗證" class="section level3">
<h3><span class="header-section-number">10.7.1</span> Regression 迴歸驗證</h3>
<p>以NBA資料為例，首先先將資料讀入</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb659-1" title="1"><span class="co">#讀入SportsAnalytics package</span></a>
<a class="sourceLine" id="cb659-2" title="2"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;SportsAnalytics&#39;</span>)){</a>
<a class="sourceLine" id="cb659-3" title="3">    <span class="kw">install.packages</span>(<span class="st">&quot;SportsAnalytics&quot;</span>)</a>
<a class="sourceLine" id="cb659-4" title="4">    <span class="kw">library</span>(SportsAnalytics)</a>
<a class="sourceLine" id="cb659-5" title="5">}</a>
<a class="sourceLine" id="cb659-6" title="6"><span class="co">#擷取2015-2016年球季球員資料</span></a>
<a class="sourceLine" id="cb659-7" title="7">NBA1516&lt;-<span class="kw">fetch_NBAPlayerStatistics</span>(<span class="st">&quot;15-16&quot;</span>)</a>
<a class="sourceLine" id="cb659-8" title="8">NBA1516&lt;-NBA1516[<span class="kw">complete.cases</span>(NBA1516),]</a></code></pre></div>
<ul>
<li>以Training set來<code>選看起來最好的模型</code></li>
<li>用Test set來<code>驗證模型是不是真的很好</code></li>
<li>想像…..訓練出來題庫答得好的學生，寫到新題目不一定會寫！？</li>
<li>訓練模型時，只能看Training set，用Training set來選一個最好的模型</li>
<li>訓練模型時，不能偷看Test set，才是真正的驗證</li>
</ul>
<p>為分出訓練組與測試組，需使用隨機抽樣的方式</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb660-1" title="1"><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>) <span class="co"># 從1到10，隨機取三個數字</span></a></code></pre></div>
<pre><code>## [1] 3 8 5</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb662-1" title="1"><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBA1516),<span class="kw">nrow</span>(NBA1516)<span class="op">/</span><span class="dv">3</span>) <span class="co">#從第一行到最後一行，隨機取1/3行數</span></a></code></pre></div>
<pre><code>##   [1] 435 395  22 216 125 144 238  85 355  94 121 461 374 256 298 470 286 152
##  [19] 230 309 221 111 347  34 140 323 227  69 226 455 335  78 376 383  19 451
##  [37]   7 105 456 135 222  23 245  53 385 439 336  39 475 164  30 136 283 391
##  [55] 199  60 229  83 375 163 130  67 371 448 413  55  54  43 209 122  11 126
##  [73] 300  15 449 113  82 409 415  62  52 172  16 280  40 411  48  86 354 366
##  [91] 108 389 306 285 349 378 358 184 107  95 189 186 119 379 236 384 157 337
## [109] 394 333 219 457 316 182 356 117 173 128 225 265 201 348 204 155  81  29
## [127] 297 399 343 407 345 397 191 147 197 148  77 350 215 145  25 269 109 252
## [145] 194 234 141 400 249 139 183  38  98 352 454 193 445 305</code></pre>
<p>使用上述方法，選出1/3的元素位置，把NBA的資料分成Training 和 Test set</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb664-1" title="1">NBA1516<span class="op">$</span>Test&lt;-F <span class="co">#新增一個參數紀錄分組</span></a>
<a class="sourceLine" id="cb664-2" title="2"><span class="co">#隨機取1/3當Test set</span></a>
<a class="sourceLine" id="cb664-3" title="3">NBA1516[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBA1516),<span class="kw">nrow</span>(NBA1516)<span class="op">/</span><span class="dv">3</span>),]<span class="op">$</span>Test&lt;-T</a>
<a class="sourceLine" id="cb664-4" title="4"><span class="co"># Training set : Test set球員數</span></a>
<a class="sourceLine" id="cb664-5" title="5"><span class="kw">c</span>(<span class="kw">sum</span>(NBA1516<span class="op">$</span>Test<span class="op">==</span>F),<span class="kw">sum</span>(NBA1516<span class="op">$</span>Test<span class="op">==</span>T))</a></code></pre></div>
<pre><code>## [1] 317 158</code></pre>
<p>並用訓練組的資料（NBA1516$Test==F），訓練一個多變數線性迴歸模型</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb666-1" title="1">fit&lt;-<span class="kw">glm</span>(TotalPoints<span class="op">~</span>TotalMinutesPlayed<span class="op">+</span>FieldGoalsAttempted<span class="op">+</span></a>
<a class="sourceLine" id="cb666-2" title="2"><span class="st">             </span>Position<span class="op">+</span>ThreesAttempted<span class="op">+</span>FreeThrowsAttempted,</a>
<a class="sourceLine" id="cb666-3" title="3">              <span class="dt">data =</span>NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>F,])</a>
<a class="sourceLine" id="cb666-4" title="4"><span class="kw">summary</span>(fit)<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)          14.6138     8.5471     1.7  8.8e-02
## TotalMinutesPlayed    0.0037     0.0074     0.5  6.2e-01
## FieldGoalsAttempted   1.0066     0.0229    44.0 9.0e-135
## PositionPF          -24.6204     9.0380    -2.7  6.8e-03
## PositionPG          -44.5870     9.5232    -4.7  4.3e-06
## PositionSF          -13.3311     9.6856    -1.4  1.7e-01
## PositionSG          -34.8667     9.7711    -3.6  4.2e-04
## ThreesAttempted       0.0968     0.0310     3.1  2.0e-03
## FreeThrowsAttempted   0.6890     0.0388    17.8  3.8e-49</code></pre>
<p>逐步選擇模型 stepwise 後退學習：一開始先將所有參數加到模型裡，再一個一個拿掉</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb668-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb668-2" title="2"><span class="co">##根據AIC，做逐步選擇, 預設倒退學習 direction = &quot;backward&quot;</span></a>
<a class="sourceLine" id="cb668-3" title="3"><span class="co">##trace=FALSE: 不要顯示步驟</span></a>
<a class="sourceLine" id="cb668-4" title="4">finalModel_B&lt;-<span class="kw">stepAIC</span>(fit,<span class="dt">direction =</span> <span class="st">&quot;backward&quot;</span>,<span class="dt">trace=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb668-5" title="5"><span class="kw">summary</span>(finalModel_B)<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)           16.034      8.052     2.0  4.7e-02
## FieldGoalsAttempted    1.014      0.018    57.9 6.1e-168
## PositionPF           -24.934      9.005    -2.8  6.0e-03
## PositionPG           -45.141      9.447    -4.8  2.7e-06
## PositionSF           -13.516      9.667    -1.4  1.6e-01
## PositionSG           -35.176      9.740    -3.6  3.5e-04
## ThreesAttempted        0.098      0.031     3.2  1.6e-03
## FreeThrowsAttempted    0.690      0.039    17.8  2.4e-49</code></pre>
<p>逐步選擇模型 stepwise 往前學習：一開始先做一個沒有參數的模型，再把參數一個一個加進去</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb670-1" title="1"><span class="co">##根據AIC，做逐步選擇, 往前學習 direction = &quot;forward&quot;</span></a>
<a class="sourceLine" id="cb670-2" title="2">finalModel_F&lt;-<span class="kw">stepAIC</span>(fit,<span class="dt">direction =</span> <span class="st">&quot;forward&quot;</span>,<span class="dt">trace=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb670-3" title="3"><span class="kw">summary</span>(finalModel_F)<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)          14.6138     8.5471     1.7  8.8e-02
## TotalMinutesPlayed    0.0037     0.0074     0.5  6.2e-01
## FieldGoalsAttempted   1.0066     0.0229    44.0 9.0e-135
## PositionPF          -24.6204     9.0380    -2.7  6.8e-03
## PositionPG          -44.5870     9.5232    -4.7  4.3e-06
## PositionSF          -13.3311     9.6856    -1.4  1.7e-01
## PositionSG          -34.8667     9.7711    -3.6  4.2e-04
## ThreesAttempted       0.0968     0.0310     3.1  2.0e-03
## FreeThrowsAttempted   0.6890     0.0388    17.8  3.8e-49</code></pre>
<p>逐步選擇模型 stepwise 雙向學習：參數加加減減</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb672-1" title="1"><span class="co">##根據AIC，做逐步選擇, 雙向學習 direction = &quot;both&quot;</span></a>
<a class="sourceLine" id="cb672-2" title="2">finalModel_Both&lt;-<span class="kw">stepAIC</span>(fit,<span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>,<span class="dt">trace=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb672-3" title="3"><span class="kw">summary</span>(finalModel_Both)<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##                     Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)           16.034      8.052     2.0  4.7e-02
## FieldGoalsAttempted    1.014      0.018    57.9 6.1e-168
## PositionPF           -24.934      9.005    -2.8  6.0e-03
## PositionPG           -45.141      9.447    -4.8  2.7e-06
## PositionSF           -13.516      9.667    -1.4  1.6e-01
## PositionSG           -35.176      9.740    -3.6  3.5e-04
## ThreesAttempted        0.098      0.031     3.2  1.6e-03
## FreeThrowsAttempted    0.690      0.039    17.8  2.4e-49</code></pre>
<p>用Test set來評估模型好不好，使用predict函數，將測試組資料放入預測模型中，預測測試組的結果</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb674-1" title="1">predictPoint&lt;-<span class="kw">predict</span>(finalModel_Both, <span class="co">#Test==T, test data</span></a>
<a class="sourceLine" id="cb674-2" title="2">                      <span class="dt">newdata =</span> NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,])</a>
<a class="sourceLine" id="cb674-3" title="3"><span class="kw">cor</span>(<span class="dt">x=</span>predictPoint,<span class="dt">y=</span>NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>TotalPoints) <span class="co">#相關係數</span></a></code></pre></div>
<pre><code>## [1] 0.99</code></pre>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb676-1" title="1"><span class="kw">plot</span>(<span class="dt">x=</span>predictPoint,<span class="dt">y=</span>NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>TotalPoints)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
</div>
<div id="logistic-regression-邏輯迴歸驗證" class="section level3">
<h3><span class="header-section-number">10.7.2</span> Logistic Regression 邏輯迴歸驗證</h3>
<p>首先，先把入學資料分成Training 和 Test set。這邊要特別留意，當答案有正反兩面時，<code>Level 1 要放正面答案</code>–&gt;有病/錄取…</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb677-1" title="1">mydata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/CGUIM-BigDataAnalysis/BigDataCGUIM/master/binary.csv&quot;</span>)</a>
<a class="sourceLine" id="cb677-2" title="2">mydata<span class="op">$</span>admit &lt;-<span class="st"> </span><span class="kw">factor</span>(mydata<span class="op">$</span>admit) <span class="co"># 類別變項要轉為factor</span></a>
<a class="sourceLine" id="cb677-3" title="3">mydata<span class="op">$</span>rank &lt;-<span class="st"> </span><span class="kw">factor</span>(mydata<span class="op">$</span>rank) <span class="co"># 類別變項要轉為factor</span></a>
<a class="sourceLine" id="cb677-4" title="4">mydata<span class="op">$</span>Test&lt;-F <span class="co">#新增一個參數紀錄分組</span></a>
<a class="sourceLine" id="cb677-5" title="5">mydata[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mydata),<span class="kw">nrow</span>(mydata)<span class="op">/</span><span class="dv">3</span>),<span class="st">&quot;Test&quot;</span>]&lt;-T <span class="co">#隨機取1/3當Test set</span></a>
<a class="sourceLine" id="cb677-6" title="6"><span class="kw">c</span>(<span class="kw">sum</span>(mydata<span class="op">$</span>Test<span class="op">==</span>F),<span class="kw">sum</span>(mydata<span class="op">$</span>Test<span class="op">==</span>T)) <span class="co"># Training set : Test set學生數</span></a></code></pre></div>
<pre><code>## [1] 267 133</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" title="1"><span class="co">#修改一下factor的level: 改成Level 1為錄取，2為不錄取--&gt;Level 1 要放正面答案</span></a>
<a class="sourceLine" id="cb679-2" title="2">mydata<span class="op">$</span>admit&lt;-<span class="kw">factor</span>(mydata<span class="op">$</span>admit,<span class="dt">levels=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))</a></code></pre></div>
<p>逐步選擇最好的模型</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb680-1" title="1"><span class="co"># GRE:某考試成績, GPA:在校平均成績, rank:學校聲望</span></a>
<a class="sourceLine" id="cb680-2" title="2">mylogit &lt;-<span class="st"> </span><span class="kw">glm</span>(admit <span class="op">~</span><span class="st"> </span>gre <span class="op">+</span><span class="st"> </span>gpa <span class="op">+</span><span class="st"> </span>rank,</a>
<a class="sourceLine" id="cb680-3" title="3">               <span class="dt">data =</span> mydata[mydata<span class="op">$</span>Test<span class="op">==</span>F,], <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb680-4" title="4">finalFit&lt;-<span class="kw">stepAIC</span>(mylogit,<span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>,<span class="dt">trace=</span><span class="ot">FALSE</span>) <span class="co"># 雙向逐步選擇模型</span></a>
<a class="sourceLine" id="cb680-5" title="5"><span class="kw">summary</span>(finalFit)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = admit ~ gre + rank, family = &quot;binomial&quot;, data = mydata[mydata$Test == 
##     F, ])
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -2.149  -1.085   0.613   0.855   1.537  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.06544    0.79793    2.59  0.00964 ** 
## gre         -0.00400    0.00124   -3.24  0.00121 ** 
## rank2        0.91208    0.39550    2.31  0.02110 *  
## rank3        1.67005    0.43595    3.83  0.00013 ***
## rank4        1.73871    0.48597    3.58  0.00035 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 332.54  on 266  degrees of freedom
## Residual deviance: 299.33  on 262  degrees of freedom
## AIC: 309.3
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>用預測組預測新學生可不可以錄取，並驗證答案</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb682-1" title="1">AdmitProb&lt;-<span class="kw">predict</span>(finalFit, <span class="co"># 用Training set做的模型</span></a>
<a class="sourceLine" id="cb682-2" title="2">                   <span class="dt">newdata =</span> mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,], <span class="co">#Test==T, test data</span></a>
<a class="sourceLine" id="cb682-3" title="3">                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>) <span class="co">#結果為每個人被錄取的機率</span></a>
<a class="sourceLine" id="cb682-4" title="4"><span class="kw">head</span>(AdmitProb)</a></code></pre></div>
<pre><code>##    4   13   14   15   20   23 
## 0.78 0.27 0.54 0.32 0.48 0.80</code></pre>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb684-1" title="1"><span class="kw">table</span>(AdmitProb<span class="op">&lt;</span><span class="fl">0.5</span>,mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>admit) <span class="co"># row,column</span></a></code></pre></div>
<pre><code>##        
##          1  0
##   FALSE 33 80
##   TRUE  10 10</code></pre>
<p>當答案是二元時：效能指標</p>
<ul>
<li>Sensitivity 敏感性</li>
<li>Specificity 特異性</li>
<li>Positive Predictive Value (PPV) 陽性預測值</li>
<li>Negative Predictive Value (NPV) 陰性預測值</li>
</ul>
<p>名詞解釋</p>
<p><img src="figure/Cond.png" width="720" /></p>
<ul>
<li>TP: 有病且預測也有病</li>
<li>TN: 沒病且預測也沒病</li>
<li>FP: 沒病但是預測有病</li>
<li>FN: 有病但預測沒病</li>
</ul>
<p><img src="figure/para.png" width="598" /></p>
<p>當答案是二元時：效能指標公式</p>
<ul>
<li>Sensitivity 敏感性：所有<code>真的有病</code>的人，被<code>預測有病</code>的比例</li>
<li>Specificity 特異性：所有<code>真的沒病</code>的人，被<code>預測沒病</code>的比例</li>
<li>Positive Predictive Value (PPV) 陽性預測值：所有被<code>預測有病</code>的人，<code>真的有病</code>的比例</li>
<li>Negative Predictive Value (NPV) 陰性預測值：所有被<code>預測沒病</code>的人，<code>真的沒病</code>的比例</li>
</ul>
<p>回想一下剛剛的驗證結果</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb686-1" title="1"><span class="kw">table</span>(AdmitProb<span class="op">&lt;</span><span class="fl">0.5</span>,mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>admit) <span class="co"># row,column</span></a></code></pre></div>
<pre><code>##        
##          1  0
##   FALSE 33 80
##   TRUE  10 10</code></pre>
<p><img src="figure/para.png" width="598" /></p>
<p>計算預測效能參數</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb688-1" title="1">AdmitProb&lt;-<span class="kw">predict</span>(finalFit,</a>
<a class="sourceLine" id="cb688-2" title="2">                   <span class="dt">newdata =</span> mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,], <span class="co">#Test==T, test data</span></a>
<a class="sourceLine" id="cb688-3" title="3">                   <span class="dt">type=</span><span class="st">&quot;response&quot;</span>) <span class="co">#結果為每個人『不』被錄取的機率</span></a>
<a class="sourceLine" id="cb688-4" title="4">AdmitAns&lt;-<span class="kw">factor</span>(<span class="kw">ifelse</span>(AdmitProb<span class="op">&lt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">levels=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb688-5" title="5"><span class="kw">str</span>(AdmitAns)</a></code></pre></div>
<pre><code>##  Factor w/ 2 levels &quot;1&quot;,&quot;0&quot;: 2 1 2 1 1 2 2 1 2 2 ...
##  - attr(*, &quot;names&quot;)= chr [1:133] &quot;4&quot; &quot;13&quot; &quot;14&quot; &quot;15&quot; ...</code></pre>
<p>計算預測效能參數</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb690-1" title="1"><span class="kw">library</span>(caret) <span class="co"># install.packages(&quot;caret&quot;) #計算參數的packages</span></a>
<a class="sourceLine" id="cb690-2" title="2"><span class="kw">sensitivity</span>(AdmitAns,mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>admit)</a></code></pre></div>
<pre><code>## [1] 0.23</code></pre>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb692-1" title="1"><span class="kw">specificity</span>(AdmitAns,mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>admit)</a></code></pre></div>
<pre><code>## [1] 0.89</code></pre>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb694-1" title="1"><span class="kw">posPredValue</span>(AdmitAns,mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>admit)</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb696-1" title="1"><span class="kw">negPredValue</span>(AdmitAns,mydata[mydata<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>admit)</a></code></pre></div>
<pre><code>## [1] 0.71</code></pre>
</div>
<div id="decision-trees-決策樹驗證" class="section level3">
<h3><span class="header-section-number">10.7.3</span> Decision Trees 決策樹驗證</h3>
<p>阻攻/籃板/三分/助攻/抄截判斷位置-訓練</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb698-1" title="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;rpart&#39;</span>)){</a>
<a class="sourceLine" id="cb698-2" title="2">    <span class="kw">install.packages</span>(<span class="st">&quot;rpart&quot;</span>); <span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb698-3" title="3">}</a>
<a class="sourceLine" id="cb698-4" title="4">DT&lt;-<span class="kw">rpart</span>(Position<span class="op">~</span>Blocks<span class="op">+</span>TotalRebounds<span class="op">+</span>ThreesMade<span class="op">+</span>Assists<span class="op">+</span>Steals,</a>
<a class="sourceLine" id="cb698-5" title="5">          <span class="dt">data=</span>NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>F,]) <span class="co">#訓練組 Training set</span></a>
<a class="sourceLine" id="cb698-6" title="6"><span class="co">#控球後衛（PG）、得分後衛（SG）、小前鋒（SF）、大前鋒（PF）和中鋒（C）</span></a>
<a class="sourceLine" id="cb698-7" title="7">DT</a></code></pre></div>
<pre><code>## n= 317 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##   1) root 317 240 SG (0.13 0.22 0.22 0.2 0.24)  
##     2) Assists&lt; 2.3e+02 272 200 SG (0.15 0.25 0.14 0.2 0.26)  
##       4) ThreesMade&lt; 2.5 82  51 C (0.38 0.34 0.13 0.085 0.061)  
##         8) TotalRebounds&gt;=10 61  31 C (0.49 0.41 0.049 0.016 0.033)  
##          16) TotalRebounds&gt;=4.7e+02 18   3 C (0.83 0.17 0 0 0) *
##          17) TotalRebounds&lt; 4.7e+02 43  21 PF (0.35 0.51 0.07 0.023 0.047)  
##            34) Steals&gt;=10 19   6 PF (0.26 0.68 0.053 0 0) *
##            35) Steals&lt; 10 24  14 C (0.42 0.38 0.083 0.042 0.083)  
##              70) TotalRebounds&gt;=20 16   7 C (0.56 0.25 0.062 0.062 0.062) *
##              71) TotalRebounds&lt; 20 8   3 PF (0.12 0.62 0.12 0 0.12) *
##         9) TotalRebounds&lt; 10 21  13 PG (0.048 0.14 0.38 0.29 0.14)  
##          18) Steals&gt;=0.5 13   5 PG (0.077 0.077 0.62 0.15 0.077) *
##          19) Steals&lt; 0.5 8   4 SF (0 0.25 0 0.5 0.25) *
##       5) ThreesMade&gt;=2.5 190 120 SG (0.047 0.22 0.14 0.25 0.35)  
##        10) TotalRebounds&gt;=2.9e+02 44  23 PF (0.11 0.48 0.023 0.32 0.068)  
##          20) Steals&lt; 60 24   5 PF (0.083 0.79 0 0.12 0) *
##          21) Steals&gt;=60 20   9 SF (0.15 0.1 0.05 0.55 0.15) *
##        11) TotalRebounds&lt; 2.9e+02 146  82 SG (0.027 0.14 0.17 0.23 0.44)  
##          22) Assists&lt; 82 87  53 SG (0.023 0.22 0.057 0.31 0.39)  
##            44) Blocks&gt;=6.5 49  31 PF (0.02 0.37 0.02 0.29 0.31)  
##              88) Assists&lt; 40 16   5 PF (0.062 0.69 0 0.19 0.062) *
##              89) Assists&gt;=40 33  19 SG (0 0.21 0.03 0.33 0.42)  
##               178) Blocks&lt; 18 17   8 SF (0 0.18 0.059 0.53 0.24) *
##               179) Blocks&gt;=18 16   6 SG (0 0.25 0 0.12 0.62) *
##            45) Blocks&lt; 6.5 38  19 SG (0.026 0.026 0.11 0.34 0.5)  
##              90) Blocks&lt; 2.5 22   9 SG (0.045 0.045 0.14 0.18 0.59) *
##              91) Blocks&gt;=2.5 16   7 SF (0 0 0.062 0.56 0.38) *
##          23) Assists&gt;=82 59  29 SG (0.034 0.017 0.34 0.1 0.51)  
##            46) TotalRebounds&lt; 1.4e+02 22   5 PG (0 0 0.77 0 0.23) *
##            47) TotalRebounds&gt;=1.4e+02 37  12 SG (0.054 0.027 0.081 0.16 0.68) *
##     3) Assists&gt;=2.3e+02 45  13 PG (0 0.044 0.71 0.18 0.067)  
##       6) TotalRebounds&lt; 5e+02 36   5 PG (0 0 0.86 0.056 0.083) *
##       7) TotalRebounds&gt;=5e+02 9   3 SF (0 0.22 0.11 0.67 0) *</code></pre>
<p>阻攻/籃板/三分/助攻/抄截判斷位置-訓練</p>
<p>預設的<code>plot()</code>真的太難用，改用<code>rpart.plot</code> package的<code>prp()</code></p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb700-1" title="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;rpart.plot&#39;</span>)){</a>
<a class="sourceLine" id="cb700-2" title="2">  <span class="kw">install.packages</span>(<span class="st">&quot;rpart.plot&quot;</span>); </a>
<a class="sourceLine" id="cb700-3" title="3">  <span class="kw">library</span>(rpart.plot)</a>
<a class="sourceLine" id="cb700-4" title="4">}</a>
<a class="sourceLine" id="cb700-5" title="5"><span class="kw">prp</span>(DT) <span class="co"># 把決策樹畫出來</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-248-1.png" width="672" /></p>
<p>阻攻/籃板/三分/助攻/抄截判斷位置-訓練</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" title="1"><span class="kw">prp</span>(DT)</a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
<p>有批球員沒寫守備位置？–預測</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb702-1" title="1">posPred&lt;-<span class="kw">predict</span>(DT,<span class="dt">newdata=</span> NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,]) <span class="co">#Test==T, test data</span></a>
<a class="sourceLine" id="cb702-2" title="2"><span class="co"># 預設為class probabilities, type = &quot;prob&quot;</span></a>
<a class="sourceLine" id="cb702-3" title="3"><span class="kw">head</span>(posPred)</a></code></pre></div>
<pre><code>##        C    PF    PG   SF   SG
## 1  0.083 0.792 0.000 0.12 0.00
## 2  0.054 0.027 0.081 0.16 0.68
## 8  0.045 0.045 0.136 0.18 0.59
## 13 0.000 0.222 0.111 0.67 0.00
## 17 0.150 0.100 0.050 0.55 0.15
## 18 0.263 0.684 0.053 0.00 0.00</code></pre>
<p>有個人沒寫守備位置–對答案</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb704-1" title="1">result&lt;-<span class="kw">cbind</span>(<span class="kw">round</span>(posPred,<span class="dt">digits =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb704-2" title="2">              NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Name,</a>
<a class="sourceLine" id="cb704-3" title="3">      <span class="kw">as.character</span>(NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Position))</a>
<a class="sourceLine" id="cb704-4" title="4"><span class="kw">head</span>(result)</a></code></pre></div>
<pre><code>##    C      PF     PG     SF     SG                            
## 1  &quot;0.08&quot; &quot;0.79&quot; &quot;0&quot;    &quot;0.12&quot; &quot;0&quot;    &quot;Chris Bosh&quot;       &quot;PF&quot;
## 2  &quot;0.05&quot; &quot;0.03&quot; &quot;0.08&quot; &quot;0.16&quot; &quot;0.68&quot; &quot;Danilo Gallinari&quot; &quot;SF&quot;
## 8  &quot;0.05&quot; &quot;0.05&quot; &quot;0.14&quot; &quot;0.18&quot; &quot;0.59&quot; &quot;Justin Harper&quot;    &quot;PF&quot;
## 13 &quot;0&quot;    &quot;0.22&quot; &quot;0.11&quot; &quot;0.67&quot; &quot;0&quot;    &quot;Paul George&quot;      &quot;SF&quot;
## 17 &quot;0.15&quot; &quot;0.1&quot;  &quot;0.05&quot; &quot;0.55&quot; &quot;0.15&quot; &quot;Langsto Galloway&quot; &quot;PG&quot;
## 18 &quot;0.26&quot; &quot;0.68&quot; &quot;0.05&quot; &quot;0&quot;    &quot;0&quot;    &quot;Kendrick Perkins&quot; &quot;C&quot;</code></pre>
<p>有個人沒寫守備位置–預測-2</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb706-1" title="1">posPredC&lt;-<span class="kw">predict</span>(DT,<span class="dt">newdata=</span> NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,],<span class="dt">type =</span> <span class="st">&quot;class&quot;</span>)</a>
<a class="sourceLine" id="cb706-2" title="2"><span class="co"># type = &quot;class&quot; 直接預測類別</span></a>
<a class="sourceLine" id="cb706-3" title="3"><span class="kw">head</span>(posPredC)</a></code></pre></div>
<pre><code>##  1  2  8 13 17 18 
## PF SG SG SF SF PF 
## Levels: C PF PG SF SG</code></pre>
<p>有個人沒寫守備位置–對答案-2</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb708-1" title="1">resultC&lt;-<span class="kw">cbind</span>(<span class="kw">as.character</span>(posPredC),NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Name,</a>
<a class="sourceLine" id="cb708-2" title="2">      <span class="kw">as.character</span>(NBA1516[NBA1516<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Position))</a>
<a class="sourceLine" id="cb708-3" title="3"><span class="kw">head</span>(resultC)</a></code></pre></div>
<pre><code>##      [,1] [,2]               [,3]
## [1,] &quot;PF&quot; &quot;Chris Bosh&quot;       &quot;PF&quot;
## [2,] &quot;SG&quot; &quot;Danilo Gallinari&quot; &quot;SF&quot;
## [3,] &quot;SG&quot; &quot;Justin Harper&quot;    &quot;PF&quot;
## [4,] &quot;SF&quot; &quot;Paul George&quot;      &quot;SF&quot;
## [5,] &quot;SF&quot; &quot;Langsto Galloway&quot; &quot;PG&quot;
## [6,] &quot;PF&quot; &quot;Kendrick Perkins&quot; &quot;C&quot;</code></pre>
</div>
</div>
<div id="case-study" class="section level2">
<h2><span class="header-section-number">10.8</span> Case Study</h2>
<p>完整的模型建立步驟範例：</p>
<ul>
<li>標題：以聲波撞擊礦石的回聲預測礦石是否為礦物</li>
<li>以Sonar, Mines vs. Rocks為例</li>
</ul>
<p><strong>步驟1.1:讀資料</strong></p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb710-1" title="1"><span class="co">#install.packages(&quot;mlbench&quot;) # 此package內有很多dataset可練習</span></a>
<a class="sourceLine" id="cb710-2" title="2"><span class="kw">library</span>(mlbench)</a>
<a class="sourceLine" id="cb710-3" title="3"><span class="kw">data</span>(Sonar)</a>
<a class="sourceLine" id="cb710-4" title="4"><span class="kw">str</span>(Sonar) <span class="co">#看一下資料型別，有沒有缺值，類別變項是不是factor</span></a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    208 obs. of  61 variables:
##  $ V1   : num  0.02 0.0453 0.0262 0.01 0.0762 0.0286 0.0317 0.0519 0.0223 0.0164 ...
##  $ V2   : num  0.0371 0.0523 0.0582 0.0171 0.0666 0.0453 0.0956 0.0548 0.0375 0.0173 ...
##  $ V3   : num  0.0428 0.0843 0.1099 0.0623 0.0481 ...
##  $ V4   : num  0.0207 0.0689 0.1083 0.0205 0.0394 ...
##  $ V5   : num  0.0954 0.1183 0.0974 0.0205 0.059 ...
##  $ V6   : num  0.0986 0.2583 0.228 0.0368 0.0649 ...
##  $ V7   : num  0.154 0.216 0.243 0.11 0.121 ...
##  $ V8   : num  0.16 0.348 0.377 0.128 0.247 ...
##  $ V9   : num  0.3109 0.3337 0.5598 0.0598 0.3564 ...
##  $ V10  : num  0.211 0.287 0.619 0.126 0.446 ...
##  $ V11  : num  0.1609 0.4918 0.6333 0.0881 0.4152 ...
##  $ V12  : num  0.158 0.655 0.706 0.199 0.395 ...
##  $ V13  : num  0.2238 0.6919 0.5544 0.0184 0.4256 ...
##  $ V14  : num  0.0645 0.7797 0.532 0.2261 0.4135 ...
##  $ V15  : num  0.066 0.746 0.648 0.173 0.453 ...
##  $ V16  : num  0.227 0.944 0.693 0.213 0.533 ...
##  $ V17  : num  0.31 1 0.6759 0.0693 0.7306 ...
##  $ V18  : num  0.3 0.887 0.755 0.228 0.619 ...
##  $ V19  : num  0.508 0.802 0.893 0.406 0.203 ...
##  $ V20  : num  0.48 0.782 0.862 0.397 0.464 ...
##  $ V21  : num  0.578 0.521 0.797 0.274 0.415 ...
##  $ V22  : num  0.507 0.405 0.674 0.369 0.429 ...
##  $ V23  : num  0.433 0.396 0.429 0.556 0.573 ...
##  $ V24  : num  0.555 0.391 0.365 0.485 0.54 ...
##  $ V25  : num  0.671 0.325 0.533 0.314 0.316 ...
##  $ V26  : num  0.641 0.32 0.241 0.533 0.229 ...
##  $ V27  : num  0.71 0.327 0.507 0.526 0.7 ...
##  $ V28  : num  0.808 0.277 0.853 0.252 1 ...
##  $ V29  : num  0.679 0.442 0.604 0.209 0.726 ...
##  $ V30  : num  0.386 0.203 0.851 0.356 0.472 ...
##  $ V31  : num  0.131 0.379 0.851 0.626 0.51 ...
##  $ V32  : num  0.26 0.295 0.504 0.734 0.546 ...
##  $ V33  : num  0.512 0.198 0.186 0.612 0.288 ...
##  $ V34  : num  0.7547 0.2341 0.2709 0.3497 0.0981 ...
##  $ V35  : num  0.854 0.131 0.423 0.395 0.195 ...
##  $ V36  : num  0.851 0.418 0.304 0.301 0.418 ...
##  $ V37  : num  0.669 0.384 0.612 0.541 0.46 ...
##  $ V38  : num  0.61 0.106 0.676 0.881 0.322 ...
##  $ V39  : num  0.494 0.184 0.537 0.986 0.283 ...
##  $ V40  : num  0.274 0.197 0.472 0.917 0.243 ...
##  $ V41  : num  0.051 0.167 0.465 0.612 0.198 ...
##  $ V42  : num  0.2834 0.0583 0.2587 0.5006 0.2444 ...
##  $ V43  : num  0.282 0.14 0.213 0.321 0.185 ...
##  $ V44  : num  0.4256 0.1628 0.2222 0.3202 0.0841 ...
##  $ V45  : num  0.2641 0.0621 0.2111 0.4295 0.0692 ...
##  $ V46  : num  0.1386 0.0203 0.0176 0.3654 0.0528 ...
##  $ V47  : num  0.1051 0.053 0.1348 0.2655 0.0357 ...
##  $ V48  : num  0.1343 0.0742 0.0744 0.1576 0.0085 ...
##  $ V49  : num  0.0383 0.0409 0.013 0.0681 0.023 0.0264 0.0507 0.0285 0.0777 0.0092 ...
##  $ V50  : num  0.0324 0.0061 0.0106 0.0294 0.0046 0.0081 0.0159 0.0178 0.0439 0.0198 ...
##  $ V51  : num  0.0232 0.0125 0.0033 0.0241 0.0156 0.0104 0.0195 0.0052 0.0061 0.0118 ...
##  $ V52  : num  0.0027 0.0084 0.0232 0.0121 0.0031 0.0045 0.0201 0.0081 0.0145 0.009 ...
##  $ V53  : num  0.0065 0.0089 0.0166 0.0036 0.0054 0.0014 0.0248 0.012 0.0128 0.0223 ...
##  $ V54  : num  0.0159 0.0048 0.0095 0.015 0.0105 0.0038 0.0131 0.0045 0.0145 0.0179 ...
##  $ V55  : num  0.0072 0.0094 0.018 0.0085 0.011 0.0013 0.007 0.0121 0.0058 0.0084 ...
##  $ V56  : num  0.0167 0.0191 0.0244 0.0073 0.0015 0.0089 0.0138 0.0097 0.0049 0.0068 ...
##  $ V57  : num  0.018 0.014 0.0316 0.005 0.0072 0.0057 0.0092 0.0085 0.0065 0.0032 ...
##  $ V58  : num  0.0084 0.0049 0.0164 0.0044 0.0048 0.0027 0.0143 0.0047 0.0093 0.0035 ...
##  $ V59  : num  0.009 0.0052 0.0095 0.004 0.0107 0.0051 0.0036 0.0048 0.0059 0.0056 ...
##  $ V60  : num  0.0032 0.0044 0.0078 0.0117 0.0094 0.0062 0.0103 0.0053 0.0022 0.004 ...
##  $ Class: Factor w/ 2 levels &quot;M&quot;,&quot;R&quot;: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<p>在建立模型之前…別忘了基本的資料分析，使用<code>探索性分析 Exploratory data analysis</code>，看看資料長怎麼樣，要是有一個參數可以完美的把礦物跟石頭分開，那就不用麻煩建模了…</p>
<p>探索性分析 Exploratory data analysis</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb712-1" title="1"><span class="kw">library</span>(ggplot2);<span class="kw">library</span>(reshape2) <span class="co">#install.packages(c(&quot;ggplot2&quot;,&quot;reshape2&quot;))</span></a>
<a class="sourceLine" id="cb712-2" title="2">Sonar.m&lt;-<span class="kw">melt</span>(Sonar,<span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;Class&quot;</span>))</a>
<a class="sourceLine" id="cb712-3" title="3"><span class="kw">ggplot</span>(Sonar.m)<span class="op">+</span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Class,<span class="dt">y=</span>value))<span class="op">+</span></a>
<a class="sourceLine" id="cb712-4" title="4"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">nrow=</span><span class="dv">5</span>,<span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="co">#圖片太小了</span></a></code></pre></div>
<p><img src="DataAnalyticsWithR_files/figure-html/unnamed-chunk-255-1.png" width="672" /></p>
<p><strong>步驟1.2: 資料前處理</strong></p>
<ul>
<li>缺值？
<ul>
<li>沒有缺值，不需要處理</li>
</ul></li>
<li>答案種類？
<ul>
<li>類別變項叫<code>Class</code>，M: mine礦–&gt;+, R: rock–&gt;-，不需要處理</li>
</ul></li>
<li>類別變項的型別是不是factor？
<ul>
<li>是，不需要處理</li>
</ul></li>
<li>有沒有無關的參數？
<ul>
<li>沒有無關的參數，不需要處理</li>
</ul></li>
</ul>
<p><strong>步驟2:分成訓練組與測試組</strong></p>
<p>該怎麼分可以自己決定，1/3，1/5…都可以</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" title="1">Sonar<span class="op">$</span>Test&lt;-F <span class="co">#新增一個參數紀錄分組</span></a>
<a class="sourceLine" id="cb713-2" title="2"><span class="co">#隨機取1/3當Test set</span></a>
<a class="sourceLine" id="cb713-3" title="3">Sonar[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Sonar),<span class="kw">nrow</span>(Sonar)<span class="op">/</span><span class="dv">3</span>),]<span class="op">$</span>Test&lt;-T</a>
<a class="sourceLine" id="cb713-4" title="4"><span class="co"># 看一下 Training set : Test set 案例數</span></a>
<a class="sourceLine" id="cb713-5" title="5"><span class="kw">c</span>(<span class="kw">sum</span>(Sonar<span class="op">$</span>Test<span class="op">==</span>F),<span class="kw">sum</span>(Sonar<span class="op">$</span>Test<span class="op">==</span>T))</a></code></pre></div>
<pre><code>## [1] 139  69</code></pre>
<p><strong>步驟3:訓練模型</strong></p>
<ul>
<li>注意只能用<code>訓練組</code>的資料，<code>Test</code>參數==F，忘記可以看前面範例</li>
<li>數值自變項X很多，先用迴歸好了～</li>
<li>要解釋一下模型</li>
</ul>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" title="1">fit&lt;-<span class="kw">glm</span>(Class<span class="op">~</span>., Sonar[Sonar<span class="op">$</span>Test<span class="op">==</span>F,],<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb715-2" title="2">finalFit&lt;-<span class="kw">stepAIC</span>(fit,<span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>,<span class="dt">trace =</span> F)</a>
<a class="sourceLine" id="cb715-3" title="3"><span class="kw">summary</span>(finalFit)<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)     1360     106076  0.0128     0.99
## V1            -17982    1586741 -0.0113     0.99
## V3             13470    1070284  0.0126     0.99
## V6             -6741     531117 -0.0127     0.99
## V7              8606     580826  0.0148     0.99
## V11            -5790     387660 -0.0149     0.99
## V17             5393     369435  0.0146     0.99
## V18            -4341     293739 -0.0148     0.99
## V23             -830      73145 -0.0113     0.99
## V26              287      40536  0.0071     0.99
## V29             2486     213067  0.0117     0.99
## V30            -6584     494910 -0.0133     0.99
## V31             5735     421578  0.0136     0.99
## V32            -3137     232317 -0.0135     0.99
## V34             3901     281374  0.0139     0.99
## V35            -3774     278846 -0.0135     0.99
## V36             3180     231656  0.0137     0.99
## V39             -808      56514 -0.0143     0.99
## V46            -4007     293557 -0.0137     0.99
## V50            29058    2009780  0.0145     0.99
## V52           -26602    1970864 -0.0135     0.99
## V56           -62815    4266136 -0.0147     0.99
## V59           -75377    5503831 -0.0137     0.99
## V60            79535    6740701  0.0118     0.99</code></pre>
<p><strong>步驟4.1:用測試組驗證模型-預測</strong></p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" title="1">MinePred&lt;-<span class="kw">predict</span>(finalFit,<span class="dt">newdata =</span> Sonar[Sonar<span class="op">$</span>Test<span class="op">==</span>T,])</a>
<a class="sourceLine" id="cb717-2" title="2">MineAns&lt;-<span class="kw">ifelse</span>(MinePred<span class="op">&lt;</span><span class="fl">0.5</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;R&quot;</span>) <span class="co">#&lt;0.5: Level 1</span></a>
<a class="sourceLine" id="cb717-3" title="3">MineAns&lt;-<span class="kw">factor</span>(MineAns,<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;R&quot;</span>))</a>
<a class="sourceLine" id="cb717-4" title="4">MineAns</a></code></pre></div>
<pre><code>##   1   3   7  10  19  21  24  25  26  29  31  34  36  38  40  42  45  47  48  49 
##   M   M   R   M   R   R   M   R   M   R   M   M   M   R   M   M   M   M   M   M 
##  50  51  52  58  61  65  71  72  75  77  83  85  88  91  92  94  96  98  99 101 
##   M   M   M   M   R   M   M   M   R   M   M   M   R   M   M   M   M   M   R   R 
## 103 108 127 128 131 132 134 140 142 147 154 155 156 160 163 165 167 170 172 175 
##   M   R   R   R   R   M   R   R   M   M   R   M   M   R   M   R   M   M   R   M 
## 176 177 182 191 193 194 198 201 202 
##   M   M   R   M   R   R   M   M   R 
## Levels: M R</code></pre>
<p><strong>步驟4.2:用測試組驗證模型-效能</strong></p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" title="1"><span class="kw">library</span>(caret) <span class="co"># install.packages(&quot;caret&quot;) #計算參數的packages</span></a>
<a class="sourceLine" id="cb719-2" title="2"><span class="kw">sensitivity</span>(MineAns,Sonar[Sonar<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Class)</a></code></pre></div>
<pre><code>## [1] 0.98</code></pre>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" title="1"><span class="kw">specificity</span>(MineAns,Sonar[Sonar<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Class)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" title="1"><span class="kw">posPredValue</span>(MineAns,Sonar[Sonar<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Class)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb725-1" title="1"><span class="kw">negPredValue</span>(MineAns,Sonar[Sonar<span class="op">$</span>Test<span class="op">==</span>T,]<span class="op">$</span>Class)</a></code></pre></div>
<pre><code>## [1] 0.96</code></pre>
<p><strong>解釋範例 - 資料說明</strong></p>
<p>此資料來源為UCI Machine Learning Repository。</p>
<p>記載礦物與石頭接受各個不同角度的聲波撞擊後，接收到的回聲數值，一共有60個參數，代表使用一特別角度的聲波撞擊礦石所得回聲。另外，分類結果為二元分類，包括礦物 (M) 與石頭 (R) 。</p>
<p><strong>解釋範例 - 模型說明</strong></p>
<p>使用聲波在不同角度撞擊<code>礦石</code>所得到的回聲資料，以邏輯迴歸建立模型預測礦石是否為礦物，經最佳化後，模型使用參數為V1 + V2 + V3 + V4 + V7 + V11 + V12 + V13 + V17 + V18 + V22 + V24 + V25 + V26 + V30 + V31 + V32 + V38 + V39 + V48 + V50 + V52 + V53 + V58 + V59，共25個參數，各參數代表從一特別角度所得的礦石回聲</p>
<p><strong>解釋範例 - 預測效能說明</strong></p>
<p>使用聲波在不同角度撞擊<code>礦石</code>所得到的回聲資料，以邏輯迴歸模型預測礦石是否為礦物，可得敏感度97%，特異性89%，陽性預測率89%，陰性預測率97%。</p>
</div>
<div id="參考資料-1" class="section level2">
<h2><span class="header-section-number">10.9</span> 參考資料</h2>
<ul>
<li><p>台大資工林軒田教授：</p>
<ul>
<li><a href="www.coursera.org/course/ntumlone">Machine Learning Foundations</a></li>
<li><a href="www.coursera.org/course/ntumltwo">Machine Learning Techniques</a></li>
</ul></li>
<li><p><a href="http://www.salemmarafi.com/code/market-basket-analysis-with-r/">Market Basket Analysis with R</a></p></li>
<li><p><a href="https://www.r-bloggers.com/deep-learning-in-r-2/">Deep Learning in R</a></p></li>
</ul>
<!--chapter:end:10-DataMining.Rmd-->
</div>
</div>
<div id="big" class="section level1">
<h1><span class="header-section-number">11</span> 從小數據到大數據分析</h1>
<div id="r-hadoop" class="section level2">
<h2><span class="header-section-number">11.1</span> R + Hadoop</h2>
</div>
<div id="rhadoop安裝測試流程-cloudera" class="section level2">
<h2><span class="header-section-number">11.2</span> RHadoop安裝測試流程 (Cloudera)</h2>
<p>安裝與測試日期2016/05/12</p>
<div id="系統軟體版本資訊" class="section level3">
<h3><span class="header-section-number">11.2.1</span> 系統/軟體版本資訊</h3>
<ul>
<li>Cloudera Hadoop Platform: CDH-5.4.5 <a href="http://www.cloudera.com/downloads/cdh/5-4-5.html" target="_blank">下載</a></li>
<li>R for Linux 3.3.0 <a href="https://cran.rstudio.com/bin/linux/redhat/README" target="_blank">安裝說明</a></li>
<li>RStudio Server <a href="https://www.rstudio.com/products/rstudio/download-server/" target="_blank">下載</a></li>
<li>RHadoop (latest version on May 12, 2016) <a href="https://github.com/RevolutionAnalytics/RHadoop/wiki/Downloads" target="_blank">下載</a>
<ul>
<li>ravro-1.0.3</li>
<li>plyrmr-0.6.0</li>
<li>rmr-3.3.1</li>
<li>rhdfs-1.0.8</li>
<li>rhbase-1.2.1</li>
</ul></li>
</ul>
</div>
<div id="參考資料-2" class="section level3">
<h3><span class="header-section-number">11.2.2</span> 參考資料</h3>
<ul>
<li><a href="https://github.com/RevolutionAnalytics/RHadoop/wiki/Installing-RHadoop-on-RHEL" target="_blank">RHadoop安裝說明文件</a></li>
<li><a href="https://bigdatastudy.hackpad.com/ep/pad/static/IADMBeqF0vV" target="_blank">RHadoop安裝步驟</a></li>
<li><a href="http://unix.stackexchange.com/questions/271514/setting-persistent-environment-variable-in-centos-7-issue" target="_blank">Setting persistent environment variable in CentOS 7 issue</a></li>
<li><a href="https://community.cloudera.com/t5/CDH-Manual-Installation/How-to-resolve-quot-Permission-denied-quot-errors-in-CDH/ta-p/36141" target="_blank">How to resolve “Permission denied” errors in CDH</a></li>
</ul>
</div>
<div id="安裝步驟" class="section level3">
<h3><span class="header-section-number">11.2.3</span> 安裝步驟</h3>
<ol style="list-style-type: decimal">
<li>下載Cloudera CDH QuickStart VM <a href="http://www.cloudera.com/developers/get-started-with-hadoop-tutorial.html" target="_blank">Cloudera VM</a></li>
<li>安裝R <a href="https://cran.rstudio.com/bin/linux/redhat/README" target="_blank">安裝說明</a></li>
<li>安裝RHadoop <a href="https://bigdatastudy.hackpad.com/ep/pad/static/IADMBeqF0vV" target="_blank">RHadoop安裝步驟</a></li>
<li>安裝RStudio Server <a href="https://www.rstudio.com/products/rstudio/download-server/" target="_blank">說明</a></li>
</ol>
<div id="cloudera-cdh-quickstart-vm" class="section level4">
<h4><span class="header-section-number">11.2.3.1</span> Cloudera CDH QuickStart VM</h4>
<p>Cloudera CDH QuickStart VM是由Cloudera提供的虛擬機器，內涵Linux系統與預載多項Hadoop相關服務，適合想了解Hadoop運作的初學者。</p>
<p>下載VM後，用Virtural Box 開啟即可。</p>
<ul>
<li><a href="http://www.cloudera.com/developers/get-started-with-hadoop-tutorial.html" target="_blank">Cloudera CDH QuickStart VM下載處</a></li>
<li><a href="https://www.virtualbox.org/" target="_blank">Virtural Box下載處</a></li>
</ul>
<p>以下安裝步驟都在Cloudera CDH QuickStart VM內進行</p>
</div>
<div id="安裝r" class="section level4">
<h4><span class="header-section-number">11.2.3.2</span> 安裝R</h4>
<ul>
<li>Cloudera CDH用的Linux作業系統是CentOS</li>
<li>依照安裝說明，需要先安裝Extra
Packages for Enterprise Linux (EPEL)，但系統內有預載，所以可以不用按照說明重新下載安裝，直接執行<code>sudo yum install epel-release</code>指令即可</li>
<li>步驟：安裝最新EPRL，更新yum，安裝R。打開Terminal輸入以下指令。</li>
</ul>
<pre><code>sudo yum install epel-release
sudo yum update
sudo yum install R</code></pre>
</div>
<div id="安裝rhadoop-1-先進行環境設定" class="section level4">
<h4><span class="header-section-number">11.2.3.3</span> 安裝RHadoop-1 先進行環境設定</h4>
<p>設定<code>HADOOP_CMD</code>與<code>HADOOP_STREAMING</code>兩項環境參數，路徑可能會不同（尤其是<code>HADOOP_STREAMING</code>）</p>
<ol style="list-style-type: decimal">
<li>尋找<code>HADOOP_STREAMING</code>路徑方法</li>
</ol>
<pre><code>find / -name hadoop-streaming-*.jar</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>設定<code>HADOOP_CMD</code>與<code>HADOOP_STREAMING</code>兩項環境參數，路徑記得換成自己的</li>
</ol>
<pre><code>echo export HADOOP_CMD=&quot;/usr/bin/hadoop&quot;&gt;/etc/profile.d/hadoopenv.sh
echo export HADOOP_STREAMING=
    &quot;/opt/cloudera/parcels/CDH-5.4.5-1.cdh5.4.5.p0.7/lib/hadoop-mapreduce/
        hadoop-streaming-2.6.0-cdh5.4.5.jar&quot; &gt; /etc/profile.d/hadoopenv.sh
chmod 0755 /etc/profile.d/hadoopenv.sh</code></pre>
</div>
<div id="安裝rhadoop-2-rmr2" class="section level4">
<h4><span class="header-section-number">11.2.3.4</span> 安裝RHadoop-2 rmr2</h4>
<ul>
<li>每個Node都要裝</li>
<li>安裝前先至<a href="https://github.com/RevolutionAnalytics/rmr2/blob/master/pkg/DESCRIPTION" target="_blank">說明檔</a>看需要先安裝哪些其他的packages，Depends 和 Imports 所列的packages都要裝</li>
<li>以下為安裝packages的程式碼，在R內執行（在Terminal輸入<code>R</code>，就能進入R軟體）</li>
</ul>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb730-1" title="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;methods&quot;</span>,<span class="st">&quot;Rcpp&quot;</span>, <span class="st">&quot;RJSONIO&quot;</span>, <span class="st">&quot;digest&quot;</span>, <span class="st">&quot;functional&quot;</span>, </a>
<a class="sourceLine" id="cb730-2" title="2">                   <span class="st">&quot;reshape2&quot;</span>,<span class="st">&quot;stringr&quot;</span>, <span class="st">&quot;plyr&quot;</span>, <span class="st">&quot;caTools&quot;</span>,<span class="st">&quot;quickcheck&quot;</span>,<span class="st">&quot;testthat&quot;</span>), </a>
<a class="sourceLine" id="cb730-3" title="3">                 <span class="dt">dependencies=</span><span class="ot">TRUE</span>, <span class="dt">repos=</span><span class="st">&#39;http://cran.rstudio.com/&#39;</span>)</a></code></pre></div>
<ul>
<li>使用<code>q()</code>指令，跳出R軟體</li>
<li><a href="https://github.com/RevolutionAnalytics/RHadoop/wiki/Downloads" target="_blank">下載rmr2</a></li>
<li>安裝（請將<code>rmr2_2.3.0.tar.gz</code>替換成剛剛下載的安裝檔路徑）</li>
</ul>
<pre><code>sudo R CMD INSTALL rmr2_2.3.0.tar.gz</code></pre>
</div>
<div id="安裝rhadoop-3-rhdfs" class="section level4">
<h4><span class="header-section-number">11.2.3.5</span> 安裝RHadoop-3 rhdfs</h4>
<ul>
<li>只要裝在會跑R的那個Node</li>
<li>在裝之前，先Check是否有安裝JDK （測試JDK 1.8.0_91沒問題）</li>
<li>Check環境變數JAVA_HOME是否有設好</li>
</ul>
<pre><code>echo $JAVA_HOME</code></pre>
<p>若什麼都沒有回傳，先設定環境變數（將<code>/usr/java/jdk1.8.0_91</code>換成自己的路徑）</p>
<pre><code>echo export JAVA_HOME=&quot;/usr/java/jdk1.8.0_91&quot;&gt;/etc/profile.d/jdkenv.sh</code></pre>
<p>為了讓R可以跑JAVA，在Terminal輸入</p>
<pre><code>R CMD javareconf</code></pre>
<p>然後進到R程式（在Terminal輸入<code>R</code>，就能進入R軟體），安裝<code>rJava</code> package</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb735-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;rJava&quot;</span>,<span class="dt">dependencies=</span><span class="ot">TRUE</span>, <span class="dt">repos=</span><span class="st">&#39;http://cran.rstudio.com/&#39;</span>){target=<span class="st">&quot;_blank&quot;</span>}</a></code></pre></div>
<p>最後跳出R程式，<a href="https://github.com/RevolutionAnalytics/RHadoop/wiki/Downloads" target="_blank">下載rhdfs</a>，安裝rhdfs</p>
<ul>
<li>將<code>/usr/bin/hadoop</code>換成自己的<code>HADOOP_CMD</code>路徑</li>
<li><code>rhdfs_1.0.8.tar.gz</code>換成下載的安裝檔路徑）</li>
</ul>
<pre><code>sudo HADOOP_CMD=/usr/bin/hadoop R CMD INSTALL rhdfs_1.0.8.tar.gz</code></pre>
</div>
</div>
<div id="測試前先解決權限問題" class="section level3">
<h3><span class="header-section-number">11.2.4</span> 測試前，先解決權限問題</h3>
<ul>
<li>預設hdfs的存取權限不足，所以要打開</li>
<li>將<code>user01</code>改為自己的使用者名稱</li>
</ul>
<pre><code>sudo -u hdfs hadoop fs -mkdir /user/user01
sudo -u hdfs hadoop fs -chown user01 /user/user01</code></pre>
</div>
<div id="測試" class="section level3">
<h3><span class="header-section-number">11.2.5</span> 測試</h3>
<p>進入R測試以下程式碼是否能執行</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb738-1" title="1"><span class="kw">Sys.setenv</span>(<span class="dt">HADOOP_CMD=</span><span class="st">&quot;/usr/bin/hadoop&quot;</span>)</a>
<a class="sourceLine" id="cb738-2" title="2"><span class="kw">Sys.setenv</span>(<span class="dt">HADOOP_STREAMING=</span><span class="st">&quot;/opt/cloudera/parcels/CDH-5.4.5-1.cdh5.4.5.p0.7/lib/hadoop-mapreduce/hadoop-streaming-2.6.0-cdh5.4.5.jar&quot;</span>)</a>
<a class="sourceLine" id="cb738-3" title="3"><span class="kw">library</span>(rmr2)</a>
<a class="sourceLine" id="cb738-4" title="4"><span class="co">#test mapreduce</span></a>
<a class="sourceLine" id="cb738-5" title="5">small.ints =<span class="st"> </span><span class="kw">to.dfs</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb738-6" title="6">out&lt;-<span class="kw">mapreduce</span>(</a>
<a class="sourceLine" id="cb738-7" title="7">    <span class="dt">input =</span> small.ints, </a>
<a class="sourceLine" id="cb738-8" title="8">    <span class="dt">map =</span> <span class="cf">function</span>(., v) <span class="kw">cbind</span>(v, v<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb738-9" title="9"><span class="kw">head</span>(<span class="kw">from.dfs</span>(out))</a></code></pre></div>
</div>
<div id="安裝rstudio-server" class="section level3">
<h3><span class="header-section-number">11.2.6</span> 安裝RStudio Server</h3>
<p><a href="https://www.rstudio.com/products/rstudio/download-server/" target="_blank">官方下載與安裝說明</a></p>
<p>在Terminal執行以下程式碼</p>
<ul>
<li>檔案連結<code>https://download2.rstudio.org/rstudio-server-rhel-0.99.896-x86_64.rpm</code>可能有最新版，請Check<a href="https://www.rstudio.com/products/rstudio/download-server/" target="_blank">官網</a></li>
</ul>
<pre><code>wget https://download2.rstudio.org/rstudio-server-rhel-0.99.896-x86_64.rpm
sudo yum install --nogpgcheck rstudio-server-rhel-0.99.896-x86_64.rpm
</code></pre>
<p>打開瀏覽器，輸入<code>http://localhost:8787/</code>，就能進入RStudio Server了！</p>
<p>測完收工～</p>
</div>
</div>
<div id="rhadoop-mapreduce-easy-word-count" class="section level2">
<h2><span class="header-section-number">11.3</span> RHadoop MapReduce: easy word count</h2>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb740-1" title="1">Debate&lt;-<span class="kw">readLines</span>(<span class="st">&quot;https://raw.githubusercontent.com/CGUIM-BigDataAnalysis/BigDataCGUIM/master/104/RepDebateMiami.txt&quot;</span>)</a>
<a class="sourceLine" id="cb740-2" title="2">DebateSplit&lt;-<span class="kw">unlist</span>(<span class="kw">strsplit</span>(<span class="kw">tolower</span>(Debate),<span class="dt">split =</span> <span class="st">&#39; |</span><span class="ch">\\</span><span class="st">.|</span><span class="ch">\\</span><span class="st">,|</span><span class="ch">\\</span><span class="st">?&#39;</span>))</a>
<a class="sourceLine" id="cb740-3" title="3"><span class="co">#table(DebateSplit)</span></a></code></pre></div>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb741-1" title="1">DebateSplitDFS =<span class="st"> </span><span class="kw">to.dfs</span>(DebateSplit)</a>
<a class="sourceLine" id="cb741-2" title="2">result =<span class="st"> </span><span class="kw">mapreduce</span>(</a>
<a class="sourceLine" id="cb741-3" title="3">    <span class="dt">input =</span> DebateSplitDFS,</a>
<a class="sourceLine" id="cb741-4" title="4">    <span class="dt">map =</span> <span class="cf">function</span>(.,v) <span class="kw">keyval</span>(v, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb741-5" title="5">    <span class="dt">reduce =</span> <span class="cf">function</span>(k,vv) <span class="kw">keyval</span>(k, <span class="kw">sum</span>(vv)))</a>
<a class="sourceLine" id="cb741-6" title="6"><span class="kw">head</span>(result)</a></code></pre></div>
</div>
<div id="r-spark" class="section level2">
<h2><span class="header-section-number">11.4</span> R + Spark</h2>
<p>sparklyr
SparkR</p>
<p>Supports dplyr, Spark ML and H2O
Distributed on CRAN
Easy to install
Extensible</p>
<p>測試環境</p>
<ul>
<li>R version 3.3.2 (2016-10-31)</li>
<li>Platform: x86_64-w64-mingw32/x64 (64-bit)</li>
<li>Running under: Windows &gt;= 8 x64 (build 9200)</li>
<li>sparklyr_0.5.3-9002</li>
</ul>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb742-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;sparklyr&quot;</span>)</a>
<a class="sourceLine" id="cb742-2" title="2"><span class="co">#devtools::install_github(&quot;rstudio/sparklyr&quot;)</span></a></code></pre></div>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb743-1" title="1"><span class="kw">library</span>(sparklyr)</a>
<a class="sourceLine" id="cb743-2" title="2"><span class="kw">spark_install</span>(<span class="dt">version =</span> <span class="st">&quot;2.1.0&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb744-1" title="1"><span class="co">#Sys.setenv(SPARK_HOME=&quot;C:/Users/yjtseng/AppData/Local/rstudio/spark/Cache/spark-2.0.1-bin-hadoop2.7&quot;)</span></a>
<a class="sourceLine" id="cb744-2" title="2"><span class="co">#Sys.setenv(HADOOP_HOME=&quot;C:\\Program Files\\RStudio\\bin\\winutils\\x64\\&quot;)</span></a>
<a class="sourceLine" id="cb744-3" title="3"><span class="kw">library</span>(sparklyr)</a>
<a class="sourceLine" id="cb744-4" title="4"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb744-5" title="5">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>, <span class="dt">version =</span> <span class="st">&quot;2.1.0&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb745-1" title="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;nycflights13&quot;</span>, <span class="st">&quot;Lahman&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb746-1" title="1">iris_tbl &lt;-<span class="st"> </span><span class="kw">copy_to</span>(sc, iris)</a>
<a class="sourceLine" id="cb746-2" title="2">flights_tbl &lt;-<span class="st"> </span><span class="kw">copy_to</span>(sc, nycflights13<span class="op">::</span>flights, <span class="st">&quot;flights&quot;</span>)</a>
<a class="sourceLine" id="cb746-3" title="3">batting_tbl &lt;-<span class="st"> </span><span class="kw">copy_to</span>(sc, Lahman<span class="op">::</span>Batting, <span class="st">&quot;batting&quot;</span>)</a>
<a class="sourceLine" id="cb746-4" title="4"><span class="kw">src_tbls</span>(sc)</a>
<a class="sourceLine" id="cb746-5" title="5">flights_tbl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(dep_delay <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>Source:   query [6,233 x 19]
Database: spark connection master=local[8] app=sparklyr local=TRUE

    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;
1   2013     1     1      517            515         2      830            819        11
2   2013     1     1      542            540         2      923            850        33
3   2013     1     1      702            700         2     1058           1014        44
4   2013     1     1      715            713         2      911            850        21
5   2013     1     1      752            750         2     1025           1029        -4
6   2013     1     1      917            915         2     1206           1211        -5
7   2013     1     1      932            930         2     1219           1225        -6
8   2013     1     1     1028           1026         2     1350           1339        11
9   2013     1     1     1042           1040         2     1325           1326        -1
10  2013     1     1     1231           1229         2     1523           1529        -6
# ... with 6,223 more rows, and 10 more variables: carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb748-1" title="1"><span class="kw">spark_disconnect</span>(sc)</a></code></pre></div>
<p>在RStudio中有整合Spark連線功能，右上角的Spark頁籤可供使用者開啟特定版本的Spark connections，除此之外，也可使用Spark頁籤瀏覽在Spark中的表格結構與資料的前1000列。</p>
<p>參考資料</p>
<ul>
<li><a href="http://spark.rstudio.com/" class="uri">http://spark.rstudio.com/</a></li>
<li><a href="https://shiring.github.io/machine_learning/2017/02/19/food_spark" class="uri">https://shiring.github.io/machine_learning/2017/02/19/food_spark</a></li>
</ul>
<!--chapter:end:11-bigData.Rmd-->
</div>
</div>
<div id="install" class="section level1">
<h1><span class="header-section-number">12</span> 軟體安裝介紹</h1>
<p>本章節將介紹R與RStudio的安裝與基本使用方式</p>
<div id="r安裝" class="section level2">
<h2><span class="header-section-number">12.1</span> R安裝</h2>
<p><a href="http://www.r-project.org/" target="_blank">R語言</a>是一種自由軟體程式語言，主要用於資料分析與統計運算，2000年時終於發表R 1.0.0，有關R語言的發展歷史可參考<a href="https://zh.wikipedia.org/wiki/R%E8%AF%AD%E8%A8%80" target="_blank">維基百科</a>。</p>
<p>安裝步驟如下:</p>
<p><strong>Step 1. 從R的官網下載安裝檔</strong></p>
<ul>
<li>進入R官網 <a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a></li>
<li>選擇<strong>Download</strong>下方的<strong>CRAN</strong>連結</li>
<li>進入CRAN子網頁後，請選擇離所在地最近的載點，以臺灣桃園為例，可選擇元智大學 ( Department of Computer Science and Engineering, Yuan Ze University) 的載點。</li>
</ul>
<p>進入下載網頁後，可看到多個選項:</p>
<ul>
<li>Download R for Linux</li>
<li>Download R for (Mac) OS X</li>
<li>Download R for Windows</li>
</ul>
<p>依作業系統選擇適當連結後，點選<strong>base</strong> (Binaries for base distribution)，下載最新版本的R安裝檔。</p>
<p><strong>Step 2. 依安裝檔指示完成安裝</strong></p>
</div>
<div id="rstudio安裝" class="section level2">
<h2><span class="header-section-number">12.2</span> RStudio安裝</h2>
<p><a href="https://www.rstudio.com/" target="_blank">RStudio</a>是R語言的IDE，屬於免費自由軟體，提供一般桌面板與伺服器版，以下介紹桌面板安裝方式，伺服器版安裝可參考Chapter @ref(big)。</p>
<p><strong>Step 1. 從RStudio的官網下載安裝檔</strong></p>
<ul>
<li>進入RStudio官網 <a href="https://www.rstudio.com/" class="uri">https://www.rstudio.com/</a></li>
<li>選擇網頁上方<strong>Products</strong>連結內的<strong>RStudio</strong></li>
<li>選擇<strong>Desktop</strong>版本</li>
<li>點選<strong>Open Source Edition</strong>下方的<strong>DOWNLOAD RSTUDIO DESKTOP</strong></li>
<li>點選RStudio Desktop Open Source License下方的<strong>DOWNLOAD</strong></li>
</ul>
<p>選單中會出現多種作業系統版本，以RStudio 1.0.136為例，各作業系統版本如下</p>
<ul>
<li>RStudio 1.0.136 - Windows Vista/7/8/10<br />
</li>
<li>RStudio 1.0.136 - Mac OS X 10.6+ (64-bit)</li>
<li>RStudio 1.0.136 - Ubuntu 12.04+/Debian 8+ (32-bit)</li>
<li>RStudio 1.0.136 - Ubuntu 12.04+/Debian 8+ (64-bit)</li>
<li>RStudio 1.0.136 - Fedora 19+/RedHat 7+/openSUSE 13.1+ (32-bit)</li>
<li>RStudio 1.0.136 - Fedora 19+/RedHat 7+/openSUSE 13.1+ (64-bit)</li>
</ul>
<p>依作業系統選擇適當連結</p>
<p><strong>Step 2. 依安裝檔指示完成安裝</strong></p>
</div>
<div id="rstudio使用簡介" class="section level2">
<h2><span class="header-section-number">12.3</span> RStudio使用簡介</h2>
<div id="專案" class="section level3">
<h3><span class="header-section-number">12.3.1</span> 專案</h3>
<p>RStudio引進專案(Project)的概念，幫助使用者管理同一專案之R程式碼檔案，同時完成工作路徑的設定 (設定為專案所在資料夾)。除快速測試外，建議一開始就以專案形式新增R程式碼。</p>
<p>以本課程為例，開啟RStudio視窗後，可在左上<strong>File</strong>選項中選擇<strong>New Project</strong>後，依需求選擇<strong>New Directory</strong>或<strong>Existing Directory</strong></p>
<p><img src="figure/NewProject.png" width="296" /></p>
<p>若選擇的是<strong>New Directory</strong>，則會出現下列三個選項</p>
<ul>
<li>Empty Project</li>
<li>R Package</li>
<li>Shiny Web Application</li>
</ul>
<p>若是新增一般分析專案，選擇<strong>Empty Project</strong>後，輸入<strong>專案路徑</strong>與<strong>專案名稱</strong>，完成專案新增。</p>
<p><img src="figure/NewProject1.png" width="339" /></p>
<p>完成專案新增後，在專案內新增R程式碼檔案(File -&gt; New file -&gt; R Script)後，<strong>程式碼編輯區 Source editor</strong>就會出現在左上角。</p>
</div>
<div id="rstudio介面" class="section level3">
<h3><span class="header-section-number">12.3.2</span> RStudio介面</h3>
<p>RStudio的介面共有四個區塊，分別為</p>
<ul>
<li>程式碼編輯區 Source editor</li>
<li>執行視窗 Console</li>
<li>環境/物件</li>
<li>檔案/圖表/說明文件</li>
</ul>
<p>剛開啟一個新的RStudio視窗時不會有<strong>程式碼編輯區 Source editor</strong>，必須要新增專案後才會出現。</p>
<p><img src="figure/RStudio.png" width="634" /></p>
<p>建議使用方式如下:</p>
<ul>
<li>在左上方<strong>程式碼編輯區 Source editor</strong>撰寫程式碼</li>
<li>完成程式碼撰寫後，將需要執行的程式碼反白，點選<strong>Run</strong> (見下圖)，執行程式碼</li>
<li>除了反白外，將游標移至需要執行的程式碼，，點選<strong>Run</strong> (見下圖)也可執行該行程式碼</li>
<li>程式碼會在左下方Console視窗執行，顯示結果</li>
<li>如果有畫圖，會出現在右下方視窗</li>
<li>可在右上方視窗檢查所有變數</li>
</ul>
<p><img src="figure/ed.png" width="394" /></p>
<p>RStudio的其他使用細節，可參考<a href="https://www.rstudio.com/wp-content/uploads/2016/01/rstudio-IDE-cheatsheet.pdf" target="_blank">RStudio IDE Cheat Sheet</a></p>
<!--chapter:end:12-install.Rmd-->
</div>
</div>
</div>
<div id="author" class="section level1 unnumbered">
<h1>作者資訊</h1>
<p>曾意儒 Yi-Ju Tseng</p>
<p><a href="http://im.cgu.edu.tw/bin/home.php" target="_blank">長庚大學 資訊管理學系</a> 助理教授</p>
<p><a href="http://yijutseng.github.io" target="_blank">個人網站</a></p>
<p>Lab: <a href="https://dhlab-cgu.github.io/" target="_blank">數位健康實驗室</a></p>
<p>歡迎提供<a href="https://goo.gl/forms/5Htobvwy2vsB7yiF3" target="_blank">建議與回饋</a></p>
<!--chapter:end:13-author.Rmd-->
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<!--chapter:end:14-references.Rmd-->
<div id="refs" class="references">
<div id="ref-R-WDI">
<p>Arel-Bundock, Vincent. 2019. <em>WDI: World Development Indicators (World Bank)</em>. <a href="https://CRAN.R-project.org/package=WDI">https://CRAN.R-project.org/package=WDI</a>.</p>
</div>
<div id="ref-R-Rfacebook">
<p>Barbera, Pablo, Michael Piccirilli, Andrew Geisler, and Wouter van Atteveldt. 2017. <em>Rfacebook: Access to Facebook Api via R</em>. <a href="https://CRAN.R-project.org/package=Rfacebook">https://CRAN.R-project.org/package=Rfacebook</a>.</p>
</div>
<div id="ref-R-shiny">
<p>Chang, Winston, Joe Cheng, JJ Allaire, Yihui Xie, and Jonathan McPherson. 2019. <em>Shiny: Web Application Framework for R</em>. <a href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</a>.</p>
</div>
<div id="ref-R-ggvis">
<p>Chang, Winston, and Hadley Wickham. 2018. <em>Ggvis: Interactive Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggvis">https://CRAN.R-project.org/package=ggvis</a>.</p>
</div>
<div id="ref-R-data.table">
<p>Dowle, Matt, and Arun Srinivasan. 2019. <em>Data.table: Extension of ‘Data.frame‘</em>. <a href="https://CRAN.R-project.org/package=data.table">https://CRAN.R-project.org/package=data.table</a>.</p>
</div>
<div id="ref-R-SportsAnalytics">
<p>Eugster, Manuel J. A. 2013. <em>SportsAnalytics: Infrastructure for Sports Analytics</em>. <a href="https://CRAN.R-project.org/package=SportsAnalytics">https://CRAN.R-project.org/package=SportsAnalytics</a>.</p>
</div>
<div id="ref-R-googleVis">
<p>Gesmann, Markus, and Diego de Castillo. 2019. <em>GoogleVis: R Interface to Google Charts</em>. <a href="https://CRAN.R-project.org/package=googleVis">https://CRAN.R-project.org/package=googleVis</a>.</p>
</div>
<div id="ref-R-arules">
<p>Hahsler, Michael, Christian Buchta, Bettina Gruen, and Kurt Hornik. 2019. <em>Arules: Mining Association Rules and Frequent Itemsets</em>. <a href="https://CRAN.R-project.org/package=arules">https://CRAN.R-project.org/package=arules</a>.</p>
</div>
<div id="ref-R-ggmap">
<p>Kahle, David, Hadley Wickham, and Scott Jackson. 2019. <em>Ggmap: Spatial Visualization with Ggplot2</em>. <a href="https://CRAN.R-project.org/package=ggmap">https://CRAN.R-project.org/package=ggmap</a>.</p>
</div>
<div id="ref-R-choroplethr">
<p>Lamstein, Ari. 2018. <em>Choroplethr: Simplify the Creation of Choropleth Maps in R</em>. <a href="https://CRAN.R-project.org/package=choroplethr">https://CRAN.R-project.org/package=choroplethr</a>.</p>
</div>
<div id="ref-R-rpart.plot">
<p>Milborrow, Stephen. 2019. <em>Rpart.plot: Plot ’Rpart’ Models: An Enhanced Version of ’Plot.rpart’</em>. <a href="https://CRAN.R-project.org/package=rpart.plot">https://CRAN.R-project.org/package=rpart.plot</a>.</p>
</div>
<div id="ref-R-bit64">
<p>Oehlschlagel, Jens. 2017. <em>Bit64: A S3 Class for Vectors of 64bit Integers</em>. <a href="https://CRAN.R-project.org/package=bit64">https://CRAN.R-project.org/package=bit64</a>.</p>
</div>
<div id="ref-R-jsonlite">
<p>Ooms, Jeroen, Duncan Temple Lang, and Lloyd Hilaiel. 2018. <em>Jsonlite: A Robust, High Performance Json Parser and Generator for R</em>. <a href="https://CRAN.R-project.org/package=jsonlite">https://CRAN.R-project.org/package=jsonlite</a>.</p>
</div>
<div id="ref-R-plotly">
<p>Sievert, Carson, Chris Parmer, Toby Hocking, Scott Chamberlain, Karthik Ram, Marianne Corvellec, and Pedro Despouy. 2019. <em>Plotly: Create Interactive Web Graphics via ’Plotly.js’</em>. <a href="https://CRAN.R-project.org/package=plotly">https://CRAN.R-project.org/package=plotly</a>.</p>
</div>
<div id="ref-R-lubridate">
<p>Spinu, Vitalie, Garrett Grolemund, and Hadley Wickham. 2018. <em>Lubridate: Make Dealing with Dates a Little Easier</em>. <a href="https://CRAN.R-project.org/package=lubridate">https://CRAN.R-project.org/package=lubridate</a>.</p>
</div>
<div id="ref-R-XML">
<p>Temple Lang, Duncan, and the CRAN Team. 2019. <em>XML: Tools for Parsing and Generating Xml Within R and S-Plus</em>. <a href="https://CRAN.R-project.org/package=XML">https://CRAN.R-project.org/package=XML</a>.</p>
</div>
<div id="ref-R-treemap">
<p>Tennekes, Martijn. 2017. <em>Treemap: Treemap Visualization</em>. <a href="https://CRAN.R-project.org/package=treemap">https://CRAN.R-project.org/package=treemap</a>.</p>
</div>
<div id="ref-R-rpart">
<p>Therneau, Terry, and Beth Atkinson. 2019. <em>Rpart: Recursive Partitioning and Regression Trees</em>. <a href="https://CRAN.R-project.org/package=rpart">https://CRAN.R-project.org/package=rpart</a>.</p>
</div>
<div id="ref-R-reshape2">
<p>Wickham, Hadley. 2017. <em>Reshape2: Flexibly Reshape Data: A Reboot of the Reshape Package</em>. <a href="https://CRAN.R-project.org/package=reshape2">https://CRAN.R-project.org/package=reshape2</a>.</p>
</div>
<div id="ref-R-rvest">
<p>———. 2019a. <em>Rvest: Easily Harvest (Scrape) Web Pages</em>. <a href="https://CRAN.R-project.org/package=rvest">https://CRAN.R-project.org/package=rvest</a>.</p>
</div>
<div id="ref-R-stringr">
<p>———. 2019b. <em>Stringr: Simple, Consistent Wrappers for Common String Operations</em>. <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>.</p>
</div>
<div id="ref-R-readxl">
<p>Wickham, Hadley, and Jennifer Bryan. 2019. <em>Readxl: Read Excel Files</em>. <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, and Hiroaki Yutani. 2019. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
<div id="ref-R-dplyr">
<p>Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2019. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
<div id="ref-R-readr">
<p>Wickham, Hadley, Jim Hester, and Romain Francois. 2018. <em>Readr: Read Rectangular Text Data</em>. <a href="https://CRAN.R-project.org/package=readr">https://CRAN.R-project.org/package=readr</a>.</p>
</div>
<div id="ref-R-treemapify">
<p>Wilkins, David. 2019. <em>Treemapify: Draw Treemaps in ’Ggplot2’</em>. <a href="https://wilkox.org/treemapify">https://wilkox.org/treemapify</a>.</p>
</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
